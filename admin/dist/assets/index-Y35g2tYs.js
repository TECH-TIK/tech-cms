import{d as Pe,r as z,a as _e,u as we,o as be,b as He,c as L,e as N,f as e,t as s,g as Ce,h as ne,w as Ee,F as ae,i as le,n as se,j as c,k as Se,l as J,m as H,v as ee,p as Ot,q as ye,s as Te,x as X,y as Ne,z as Tt,A as pe,B as We,C as Me,D as Ve,E as je,T as ws,G as Rt,H as at,I as ft,J as ks,K as Cs,L as As,M as Es,N as Os,O as Ts,P as Rs,Q as xs}from"./vendor-KSD8T3_Y.js";import{a as me,b as vt,c as Ye,d as Xe,e as Is,f as et,m as Ps,g as Ms,h as Ds,i as Ns}from"./utils-B1b5c6um.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))i(u);new MutationObserver(u=>{for(const v of u)if(v.type==="childList")for(const n of v.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function w(u){const v={};return u.integrity&&(v.integrity=u.integrity),u.referrerPolicy&&(v.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?v.credentials="include":u.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function i(u){if(u.ep)return;u.ep=!0;const v=w(u);fetch(u.href,v)}})();const Ls=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Us=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Vs=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Fs(I,t){if(I==="__proto__"||I==="constructor"&&t&&typeof t=="object"&&"prototype"in t){qs(I);return}return t}function qs(I){console.warn(`[destr] Dropping "${I}" key to prevent prototype pollution.`)}function Bs(I,t={}){if(typeof I!="string")return I;const w=I.trim();if(I[0]==='"'&&I.endsWith('"')&&!I.includes("\\"))return w.slice(1,-1);if(w.length<=9){const i=w.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;if(i==="undefined")return;if(i==="null")return null;if(i==="nan")return Number.NaN;if(i==="infinity")return Number.POSITIVE_INFINITY;if(i==="-infinity")return Number.NEGATIVE_INFINITY}if(!Vs.test(I)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return I}try{if(Ls.test(I)||Us.test(I)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(I,Fs)}return JSON.parse(I)}catch(i){if(t.strict)throw i;return I}}function js(I,t){if(I==null)return;let w=I;for(let i=0;i<t.length;i++){if(w==null||w[t[i]]==null)return;w=w[t[i]]}return w}function bt(I,t,w){if(w.length===0)return t;const i=w[0];return w.length>1&&(t=bt(typeof I!="object"||I===null||!Object.prototype.hasOwnProperty.call(I,i)?Number.isInteger(Number(w[1]))?[]:{}:I[i],t,Array.prototype.slice.call(w,1))),Number.isInteger(Number(i))&&Array.isArray(I)?I.slice()[i]:Object.assign({},I,{[i]:t})}function xt(I,t){if(I==null||t.length===0)return I;if(t.length===1){if(I==null)return I;if(Number.isInteger(t[0])&&Array.isArray(I))return Array.prototype.slice.call(I,0).splice(t[0],1);const w={};for(const i in I)w[i]=I[i];return delete w[t[0]],w}if(I[t[0]]==null){if(Number.isInteger(t[0])&&Array.isArray(I))return Array.prototype.concat.call([],I);const w={};for(const i in I)w[i]=I[i];return w}return bt(I,xt(I[t[0]],Array.prototype.slice.call(t,1)),[t[0]])}function It(I,t){return t.map(w=>w.split(".")).map(w=>[w,js(I,w)]).filter(w=>w[1]!==void 0).reduce((w,i)=>bt(w,i[1],i[0]),{})}function Pt(I,t){return t.map(w=>w.split(".")).reduce((w,i)=>xt(w,i),I)}function kt(I,{storage:t,serializer:w,key:i,debug:u,pick:v,omit:n,beforeHydrate:x,afterHydrate:y},A,m=!0){try{m&&(x==null||x(A));const C=t.getItem(i);if(C){const $=w.deserialize(C),_=v?It($,v):$,r=n?Pt(_,n):_;I.$patch(r)}m&&(y==null||y(A))}catch(C){u&&console.error("[pinia-plugin-persistedstate]",C)}}function Ct(I,{storage:t,serializer:w,key:i,debug:u,pick:v,omit:n}){try{const x=v?It(I,v):I,y=n?Pt(x,n):x,A=w.serialize(y);t.setItem(i,A)}catch(x){u&&console.error("[pinia-plugin-persistedstate]",x)}}function Gs(I,t,w){const{pinia:i,store:u,options:{persist:v=w}}=I;if(!v)return;if(!(u.$id in i.state.value)){const y=i._s.get(u.$id.replace("__hot:",""));y&&Promise.resolve().then(()=>y.$persist());return}const x=(Array.isArray(v)?v:v===!0?[{}]:[v]).map(t);u.$hydrate=({runHooks:y=!0}={})=>{x.forEach(A=>{kt(u,A,I,y)})},u.$persist=()=>{x.forEach(y=>{Ct(u.$state,y)})},x.forEach(y=>{kt(u,y,I),u.$subscribe((A,m)=>Ct(m,y),{detached:!0})})}function zs(I={}){return function(t){Gs(t,w=>({key:(I.key?I.key:i=>i)(w.key??t.store.$id),debug:w.debug??I.debug??!1,serializer:w.serializer??I.serializer??{serialize:i=>JSON.stringify(i),deserialize:i=>Bs(i)},storage:w.storage??I.storage??window.localStorage,beforeHydrate:w.beforeHydrate,afterHydrate:w.afterHydrate,pick:w.pick,omit:w.omit}),I.auto??!1)}}var Hs=zs();const Ws=Pe("dashboard",()=>{const I=z(!1),t=z(null),w=z({clients:{total:0,active:0,new:0},services:{total:0,active:0,pending:0},tickets:{total:0,open:0,urgent:0}}),i=z({clients:[],services:[],tickets:[]});return{loading:I,error:t,stats:w,activity:i,fetchStats:async()=>{console.log("[DASHBOARD STORE] Chargement des statistiques");try{I.value=!0,t.value=null;const n=await he.get("/dashboard/stats");w.value=n.data,console.log("[DASHBOARD STORE] Statistiques chargées")}catch(n){throw console.error("[DASHBOARD STORE] Erreur de chargement des statistiques:",n),t.value=n,n}finally{I.value=!1}},fetchActivity:async()=>{console.log("[DASHBOARD STORE] Chargement de l'activité");try{I.value=!0,t.value=null;const n=await he.get("/dashboard/activity");i.value=n.data,console.log("[DASHBOARD STORE] Activité chargée")}catch(n){throw console.error("[DASHBOARD STORE] Erreur de chargement de l'activité:",n),t.value=n,n}finally{I.value=!1}}}}),Ks={id:"dashboard"},Js={class:"header-box"},Qs={class:"stats-grid box-grid"},Ys={class:"stat-card card-box"},Xs={class:"stat-number","data-type":"clients","data-count":"totalClients"},Zs={class:"stat-label"},eo={class:"stat-card card-box"},to={class:"stat-number","data-type":"services","data-count":"totalServices"},so={class:"stat-label"},oo={class:"stat-card card-box"},no={class:"stat-number","data-type":"products","data-count":"totalProducts"},io={class:"stat-label"},ro={class:"stat-card card-box"},ao={class:"stat-number","data-type":"revenue","data-amount":"revenue"},lo={class:"stat-label"},co={class:"dashboard-grid box-grid"},uo={class:"card card-box"},po={class:"card-header"},fo={class:"card-title"},vo={class:"card-body"},mo={key:0,class:"loading-state"},ho={key:1,class:"error-state"},go={key:2,class:"table-responsive"},_o={class:"table"},yo={class:"card card-box"},bo={class:"card-header"},$o={class:"card-title"},So={class:"card-body"},wo={key:0,class:"loading-state"},ko={key:1,class:"error-state"},Co={key:2,class:"tickets-list"},Ao={class:"ticket-content"},Eo={class:"ticket-meta"},Oo={class:"ticket-client"},To={class:"ticket-time"},Ro=_e({__name:"DashboardView",setup(I){const{t}=we(),w=Ws(),i=z(!0),u=z(null),v=z(0),n=z(0),x=z(0),y=z(0),A=z([]),m=z([]);be(async()=>{try{const S=await w.fetchDashboardData();v.value=S.stats.clients,n.value=S.stats.services,x.value=S.stats.products,y.value=S.stats.revenue,A.value=S.recentClients,m.value=S.recentTickets}catch(S){u.value=S.message}finally{i.value=!1}});function C(S){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(S)}function $(S){return new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"}).format(new Date(S))}function _(S){return{active:"status-badge status-success",pending:"status-badge status-warning",suspended:"status-badge status-danger"}[S]||"status-badge status-default"}function r(S){return{open:"status-open",in_progress:"status-progress",resolved:"status-resolved",closed:"status-closed"}[S]||"status-default"}function h(S){return{low:"priority-low",medium:"priority-medium",high:"priority-high",urgent:"priority-urgent"}[S]||"priority-default"}return(S,O)=>{const b=He("router-link");return N(),L("div",Ks,[e("div",Js,[e("h1",null,s(S.$t("dashboard.title")),1)]),e("div",Qs,[e("div",Ys,[O[0]||(O[0]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-users"})],-1)),e("div",Xs,s(v.value),1),e("div",Zs,s(S.$t("dashboard.stats.active_clients")),1)]),e("div",eo,[O[1]||(O[1]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-server"})],-1)),e("div",to,s(n.value),1),e("div",so,s(S.$t("dashboard.stats.active_services")),1)]),e("div",oo,[O[2]||(O[2]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-cube"})],-1)),e("div",no,s(x.value),1),e("div",io,s(S.$t("dashboard.stats.total_products")),1)]),e("div",ro,[O[3]||(O[3]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-chart-line"})],-1)),e("div",ao,s(C(y.value)),1),e("div",lo,s(S.$t("dashboard.stats.monthly_revenue")),1)])]),e("div",co,[e("div",uo,[e("div",po,[e("h3",fo,[O[4]||(O[4]=e("i",{class:"fas fa-users"},null,-1)),ne(" "+s(S.$t("dashboard.recent_clients.title")),1)]),Ce(b,{to:"/clients",class:"btn btn-sm btn-outline"},{default:Ee(()=>[ne(s(S.$t("common.view_all")),1)]),_:1})]),e("div",vo,[i.value?(N(),L("div",mo,O[5]||(O[5]=[e("i",{class:"fas fa-spinner fa-spin"},null,-1)]))):u.value?(N(),L("div",ho,s(u.value),1)):(N(),L("div",go,[e("table",_o,[e("thead",null,[e("tr",null,[e("th",null,s(S.$t("common.client")),1),e("th",null,s(S.$t("common.email")),1),e("th",null,s(S.$t("common.status")),1),e("th",null,s(S.$t("common.date")),1)])]),e("tbody",null,[(N(!0),L(ae,null,le(A.value,E=>(N(),L("tr",{key:E.id},[e("td",null,[Ce(b,{to:`/clients/${E.id}`,class:"client-link"},{default:Ee(()=>[ne(s(E.name),1)]),_:2},1032,["to"])]),e("td",null,s(E.email),1),e("td",null,[e("span",{class:se(_(E.status))},s(E.status),3)]),e("td",null,s($(E.created_at)),1)]))),128))])])]))])]),e("div",yo,[e("div",bo,[e("h3",$o,[O[6]||(O[6]=e("i",{class:"fas fa-headset"},null,-1)),ne(" "+s(S.$t("dashboard.recent_tickets.title")),1)]),Ce(b,{to:"/tickets",class:"btn btn-sm btn-outline"},{default:Ee(()=>[ne(s(S.$t("common.view_all")),1)]),_:1})]),e("div",So,[i.value?(N(),L("div",wo,O[7]||(O[7]=[e("i",{class:"fas fa-spinner fa-spin"},null,-1)]))):u.value?(N(),L("div",ko,s(u.value),1)):(N(),L("div",Co,[(N(!0),L(ae,null,le(m.value,E=>(N(),L("div",{key:E.id,class:"ticket-item"},[e("div",{class:se(["ticket-status",r(E.status)])},null,2),e("div",Ao,[Ce(b,{to:`/tickets/${E.id}`,class:"ticket-title"},{default:Ee(()=>[ne(s(E.title),1)]),_:2},1032,["to"]),e("div",Eo,[e("span",Oo,s(E.client_name),1),e("span",To,s($(E.created_at)),1)])]),e("div",{class:se(["ticket-priority",h(E.priority)])},s(E.priority),3)]))),128))]))])])])])}}}),$e=(I,t)=>{const w=I.__vccOpts||I;for(const[i,u]of t)w[i]=u;return w},Mt=$e(Ro,[["__scopeId","data-v-fd447ef2"]]),At=I=>{var t,w;return console.error("Error:",I),I.response?(console.error("Response data:",I.response.data),console.error("Response status:",I.response.status),console.error("Response headers:",I.response.headers)):I.request?console.error("Request:",I.request):console.error("Error message:",I.message),(w=(t=I.response)==null?void 0:t.data)!=null&&w.message?I.response.data.message:I.message?I.message:"Une erreur inattendue est survenue"},xo={},Io={class:"logo"};function Po(I,t){return N(),L("div",Io,t[0]||(t[0]=[e("h1",{class:"logo-text"},"TechCMS",-1)]))}const Mo=$e(xo,[["render",Po],["__scopeId","data-v-8b8f127c"]]),Do={class:"login-view"},No={class:"login-container"},Lo={class:"login-header"},Uo={key:0,class:"login-form"},Vo={class:"form-group"},Fo={for:"email"},qo={class:"input-group"},Bo=["placeholder"],jo={class:"form-group"},Go={for:"password"},zo={class:"input-group"},Ho=["type","placeholder"],Wo={class:"form-options"},Ko={class:"remember-me"},Jo={for:"remember"},Qo={key:0,class:"error-message"},Yo=["disabled"],Xo={key:0,class:"fas fa-spinner fa-spin"},Zo={key:1},en={key:1,class:"forgot-password-form"},tn={class:"form-group"},sn={for:"forgot-email"},on={class:"input-group"},nn=["placeholder"],rn={key:0,class:"error-message"},an={key:1,class:"success-message"},ln={class:"form-actions"},cn=["disabled"],un={key:0,class:"fas fa-spinner fa-spin"},dn={key:1},pn={class:"login-footer"},fn=_e({__name:"LoginView",setup(I){console.log("[LOGIN] Initialisation du composant Login");const{t}=we(),w=Ge(),i=Te(),u=z(""),v=z(""),n=z(!1),x=z(!1),y=z(!1),A=z(""),m=z(!1),C=z(""),$=z(!1);be(()=>{console.log("[LOGIN] Composant Login monté")});const _=async()=>{if(console.log("[LOGIN] Tentative de connexion"),!u.value||!v.value){console.log("[LOGIN] Champs manquants"),A.value=t("login.errorFields");return}try{y.value=!0,A.value="",console.log("[LOGIN] Appel de authStore.login"),await w.login(u.value,v.value,n.value),console.log("[LOGIN] Connexion réussie"),i.push("/dashboard")}catch(S){console.error("[LOGIN] Erreur de connexion:",S),A.value=At(S)}finally{y.value=!1}},r=async()=>{if(console.log("[LOGIN] Tentative de réinitialisation du mot de passe"),!C.value){console.log("[LOGIN] Email manquant"),A.value=t("login.errorEmail");return}try{y.value=!0,console.log("[LOGIN] Appel de authStore.forgotPassword"),await w.forgotPassword(C.value),console.log("[LOGIN] Email de réinitialisation envoyé"),$.value=!0,A.value=""}catch(S){console.error("[LOGIN] Erreur de réinitialisation:",S),A.value=At(S)}finally{y.value=!1}},h=()=>{console.log("[LOGIN] Basculement du formulaire de réinitialisation"),m.value=!m.value,A.value="",$.value=!1};return(S,O)=>(N(),L("div",Do,[e("div",No,[e("div",Lo,[Ce(Mo,{class:"login-logo"}),e("h1",null,s(c(t)("login.welcome")),1),e("p",null,s(c(t)("login.subtitle")),1)]),m.value?(N(),L("div",en,[e("h2",null,s(c(t)("login.resetTitle")),1),e("p",null,s(c(t)("login.resetDescription")),1),e("form",{onSubmit:Se(r,["prevent"])},[e("div",tn,[e("label",sn,s(c(t)("login.email")),1),e("div",on,[O[8]||(O[8]=e("i",{class:"fas fa-envelope"},null,-1)),H(e("input",{id:"forgot-email",type:"email","onUpdate:modelValue":O[4]||(O[4]=b=>C.value=b),placeholder:c(t)("login.emailPlaceholder"),required:""},null,8,nn),[[ee,C.value]])])]),A.value?(N(),L("div",rn,[O[9]||(O[9]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),ne(" "+s(A.value),1)])):J("",!0),$.value?(N(),L("div",an,[O[10]||(O[10]=e("i",{class:"fas fa-check-circle"},null,-1)),ne(" "+s(c(t)("login.resetSuccess")),1)])):J("",!0),e("div",ln,[e("button",{type:"button",class:"back-button",onClick:h},[O[11]||(O[11]=e("i",{class:"fas fa-arrow-left"},null,-1)),ne(" "+s(c(t)("common.back")),1)]),e("button",{type:"submit",class:"reset-button",disabled:y.value},[y.value?(N(),L("i",un)):(N(),L("span",dn,s(c(t)("login.sendReset")),1))],8,cn)])],32)])):(N(),L("div",Uo,[e("form",{onSubmit:Se(_,["prevent"])},[e("div",Vo,[e("label",Fo,s(c(t)("login.email")),1),e("div",qo,[O[5]||(O[5]=e("i",{class:"fas fa-envelope"},null,-1)),H(e("input",{id:"email",type:"email","onUpdate:modelValue":O[0]||(O[0]=b=>u.value=b),placeholder:c(t)("login.emailPlaceholder"),required:"",autocomplete:"email"},null,8,Bo),[[ee,u.value]])])]),e("div",jo,[e("label",Go,s(c(t)("login.password")),1),e("div",zo,[O[6]||(O[6]=e("i",{class:"fas fa-lock"},null,-1)),H(e("input",{id:"password",type:x.value?"text":"password","onUpdate:modelValue":O[1]||(O[1]=b=>v.value=b),placeholder:c(t)("login.passwordPlaceholder"),required:"",autocomplete:"current-password"},null,8,Ho),[[Ot,v.value]]),e("button",{type:"button",class:"password-toggle",onClick:O[2]||(O[2]=b=>x.value=!x.value)},[e("i",{class:se(x.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])])]),e("div",Wo,[e("div",Ko,[H(e("input",{type:"checkbox",id:"remember","onUpdate:modelValue":O[3]||(O[3]=b=>n.value=b)},null,512),[[ye,n.value]]),e("label",Jo,s(c(t)("login.rememberMe")),1)]),e("button",{type:"button",class:"forgot-password",onClick:h},s(c(t)("login.forgotPassword")),1)]),A.value?(N(),L("div",Qo,[O[7]||(O[7]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),ne(" "+s(A.value),1)])):J("",!0),e("button",{type:"submit",class:"login-button",disabled:y.value},[y.value?(N(),L("i",Xo)):(N(),L("span",Zo,s(c(t)("login.signIn")),1))],8,Yo)],32)])),e("div",pn,[e("p",null,s(c(t)("login.copyright",{year:new Date().getFullYear()})),1)])])]))}}),Dt=$e(fn,[["__scopeId","data-v-08c7c871"]]);console.log("[CLIENTS STORE] Initialisation du store clients");const ze=Pe("clients",{state:()=>({clients:[],loading:!1,error:null,currentPage:1,totalPages:1,perPage:10}),getters:{hasClients:I=>I.clients.length>0,totalClients:I=>I.clients.length},actions:{async fetchClients(){console.log("[CLIENTS STORE] Récupération des clients..."),this.loading=!0,this.error=null;try{if(!await Ge().checkAuth())return console.error("[CLIENTS STORE] Utilisateur non authentifié"),this.error="Vous devez être connecté pour accéder à cette ressource",this.loading=!1,!1;console.log("[CLIENTS STORE] Envoi de la requête API pour récupérer les clients");const w=await he.get("/api/v1/clients");return console.log("[CLIENTS STORE] Réponse reçue:",w.status),this.clients=w.data.data.clients||[],this.loading=!1,!0}catch(I){return console.error("[CLIENTS STORE] Erreur lors de la récupération des clients:",I.message),this.error=I.message||"Erreur lors de la récupération des clients",this.loading=!1,!1}},async getClient(I){console.log(`[CLIENTS STORE] Récupération du client #${I}`);try{const t=await he.get(`/api/v1/clients/${I}`);console.log("[CLIENTS STORE] Structure de la réponse:",t.data);let w=null;return t.data&&t.data.data&&t.data.data.client?w=t.data.data.client:t.data&&t.data.data?w=t.data.data:t.data&&t.data.client?w=t.data.client:t.data&&(w=t.data),console.log("[CLIENTS STORE] Données du client extraites:",w),w}catch(t){return console.error(`[CLIENTS STORE] Erreur lors de la récupération du client #${I}:`,t.message),this.error=t.message,null}},async createClient(I){var t,w;console.log("[CLIENTS STORE] Création d'un nouveau client",I),this.loading=!0,this.error=null;try{const i=await he.post("/api/v1/clients",I);console.log("[CLIENTS STORE] Client créé avec succès:",i.data);let u=null;return i.data&&i.data.data&&i.data.data.client?u=i.data.data.client:i.data&&i.data.data?u=i.data.data:i.data&&i.data.client?u=i.data.client:i.data&&(u=i.data),console.log("[CLIENTS STORE] Données du nouveau client extraites:",u),u&&this.clients.unshift(u),this.loading=!1,u}catch(i){return console.error("[CLIENTS STORE] Erreur lors de la création du client:",i.message),this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||i.message||"Erreur lors de la création du client",this.loading=!1,null}},async updateClient(I,t){var w,i;console.log(`[CLIENTS STORE] Mise à jour du client #${I}`,t),this.loading=!0,this.error=null;try{const u=await he.put(`/api/v1/clients/${I}`,t);console.log("[CLIENTS STORE] Client mis à jour avec succès:",u.data);const v=u.data.data.client,n=this.clients.findIndex(x=>x.id===I);return n!==-1&&(this.clients[n]=v),this.loading=!1,v}catch(u){return console.error(`[CLIENTS STORE] Erreur lors de la mise à jour du client #${I}:`,u.message),this.error=((i=(w=u.response)==null?void 0:w.data)==null?void 0:i.message)||u.message||"Erreur lors de la mise à jour du client",this.loading=!1,null}},async deleteClient(I){var t,w;console.log(`[CLIENTS STORE] Suppression du client #${I}`),this.loading=!0,this.error=null;try{const i=await he.delete(`/api/v1/clients/${I}`);return console.log("[CLIENTS STORE] Client supprimé avec succès:",i.data),this.clients=this.clients.filter(u=>u.id!==I),this.loading=!1,!0}catch(i){return console.error(`[CLIENTS STORE] Erreur lors de la suppression du client #${I}:`,i.message),this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||i.message||"Erreur lors de la suppression du client",this.loading=!1,!1}}}});var Nt={exports:{}};/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.50
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */(function(I,t){(function(i,u){I.exports=u()})(window,function(){return function(w){var i={};function u(v){if(i[v])return i[v].exports;var n=i[v]={i:v,l:!1,exports:{}};return w[v].call(n.exports,n,n.exports,u),n.l=!0,n.exports}return u.m=w,u.c=i,u.d=function(v,n,x){u.o(v,n)||Object.defineProperty(v,n,{enumerable:!0,get:x})},u.r=function(v){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(v,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(v,"__esModule",{value:!0})},u.t=function(v,n){if(n&1&&(v=u(v)),n&8||n&4&&typeof v=="object"&&v&&v.__esModule)return v;var x=Object.create(null);if(u.r(x),Object.defineProperty(x,"default",{enumerable:!0,value:v}),n&2&&typeof v!="string")for(var y in v)u.d(x,y,(function(A){return v[A]}).bind(null,y));return x},u.n=function(v){var n=v&&v.__esModule?function(){return v.default}:function(){return v};return u.d(n,"a",n),n},u.o=function(v,n){return Object.prototype.hasOwnProperty.call(v,n)},u.p="",u(u.s=42)}([function(w,i,u){u.r(i),u.d(i,"__extends",function(){return n}),u.d(i,"__assign",function(){return x}),u.d(i,"__rest",function(){return y}),u.d(i,"__decorate",function(){return A}),u.d(i,"__param",function(){return m}),u.d(i,"__metadata",function(){return C}),u.d(i,"__awaiter",function(){return $}),u.d(i,"__generator",function(){return _}),u.d(i,"__createBinding",function(){return r}),u.d(i,"__exportStar",function(){return h}),u.d(i,"__values",function(){return S}),u.d(i,"__read",function(){return O}),u.d(i,"__spread",function(){return b}),u.d(i,"__spreadArrays",function(){return E}),u.d(i,"__spreadArray",function(){return P}),u.d(i,"__await",function(){return f}),u.d(i,"__asyncGenerator",function(){return p}),u.d(i,"__asyncDelegator",function(){return a}),u.d(i,"__asyncValues",function(){return o}),u.d(i,"__makeTemplateObject",function(){return d}),u.d(i,"__importStar",function(){return g}),u.d(i,"__importDefault",function(){return R}),u.d(i,"__classPrivateFieldGet",function(){return k}),u.d(i,"__classPrivateFieldSet",function(){return T});/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var v=function(V,F){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,D){M.__proto__=D}||function(M,D){for(var U in D)Object.prototype.hasOwnProperty.call(D,U)&&(M[U]=D[U])},v(V,F)};function n(V,F){if(typeof F!="function"&&F!==null)throw new TypeError("Class extends value "+String(F)+" is not a constructor or null");v(V,F);function M(){this.constructor=V}V.prototype=F===null?Object.create(F):(M.prototype=F.prototype,new M)}var x=function(){return x=Object.assign||function(F){for(var M,D=1,U=arguments.length;D<U;D++){M=arguments[D];for(var B in M)Object.prototype.hasOwnProperty.call(M,B)&&(F[B]=M[B])}return F},x.apply(this,arguments)};function y(V,F){var M={};for(var D in V)Object.prototype.hasOwnProperty.call(V,D)&&F.indexOf(D)<0&&(M[D]=V[D]);if(V!=null&&typeof Object.getOwnPropertySymbols=="function")for(var U=0,D=Object.getOwnPropertySymbols(V);U<D.length;U++)F.indexOf(D[U])<0&&Object.prototype.propertyIsEnumerable.call(V,D[U])&&(M[D[U]]=V[D[U]]);return M}function A(V,F,M,D){var U=arguments.length,B=U<3?F:D===null?D=Object.getOwnPropertyDescriptor(F,M):D,Q;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(V,F,M,D);else for(var te=V.length-1;te>=0;te--)(Q=V[te])&&(B=(U<3?Q(B):U>3?Q(F,M,B):Q(F,M))||B);return U>3&&B&&Object.defineProperty(F,M,B),B}function m(V,F){return function(M,D){F(M,D,V)}}function C(V,F){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(V,F)}function $(V,F,M,D){function U(B){return B instanceof M?B:new M(function(Q){Q(B)})}return new(M||(M=Promise))(function(B,Q){function te(j){try{q(D.next(j))}catch(G){Q(G)}}function Y(j){try{q(D.throw(j))}catch(G){Q(G)}}function q(j){j.done?B(j.value):U(j.value).then(te,Y)}q((D=D.apply(V,F||[])).next())})}function _(V,F){var M={label:0,sent:function(){if(B[0]&1)throw B[1];return B[1]},trys:[],ops:[]},D,U,B,Q;return Q={next:te(0),throw:te(1),return:te(2)},typeof Symbol=="function"&&(Q[Symbol.iterator]=function(){return this}),Q;function te(q){return function(j){return Y([q,j])}}function Y(q){if(D)throw new TypeError("Generator is already executing.");for(;M;)try{if(D=1,U&&(B=q[0]&2?U.return:q[0]?U.throw||((B=U.return)&&B.call(U),0):U.next)&&!(B=B.call(U,q[1])).done)return B;switch(U=0,B&&(q=[q[0]&2,B.value]),q[0]){case 0:case 1:B=q;break;case 4:return M.label++,{value:q[1],done:!1};case 5:M.label++,U=q[1],q=[0];continue;case 7:q=M.ops.pop(),M.trys.pop();continue;default:if(B=M.trys,!(B=B.length>0&&B[B.length-1])&&(q[0]===6||q[0]===2)){M=0;continue}if(q[0]===3&&(!B||q[1]>B[0]&&q[1]<B[3])){M.label=q[1];break}if(q[0]===6&&M.label<B[1]){M.label=B[1],B=q;break}if(B&&M.label<B[2]){M.label=B[2],M.ops.push(q);break}B[2]&&M.ops.pop(),M.trys.pop();continue}q=F.call(V,M)}catch(j){q=[6,j],U=0}finally{D=B=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}}var r=Object.create?function(V,F,M,D){D===void 0&&(D=M),Object.defineProperty(V,D,{enumerable:!0,get:function(){return F[M]}})}:function(V,F,M,D){D===void 0&&(D=M),V[D]=F[M]};function h(V,F){for(var M in V)M!=="default"&&!Object.prototype.hasOwnProperty.call(F,M)&&r(F,V,M)}function S(V){var F=typeof Symbol=="function"&&Symbol.iterator,M=F&&V[F],D=0;if(M)return M.call(V);if(V&&typeof V.length=="number")return{next:function(){return V&&D>=V.length&&(V=void 0),{value:V&&V[D++],done:!V}}};throw new TypeError(F?"Object is not iterable.":"Symbol.iterator is not defined.")}function O(V,F){var M=typeof Symbol=="function"&&V[Symbol.iterator];if(!M)return V;var D=M.call(V),U,B=[],Q;try{for(;(F===void 0||F-- >0)&&!(U=D.next()).done;)B.push(U.value)}catch(te){Q={error:te}}finally{try{U&&!U.done&&(M=D.return)&&M.call(D)}finally{if(Q)throw Q.error}}return B}function b(){for(var V=[],F=0;F<arguments.length;F++)V=V.concat(O(arguments[F]));return V}function E(){for(var V=0,F=0,M=arguments.length;F<M;F++)V+=arguments[F].length;for(var D=Array(V),U=0,F=0;F<M;F++)for(var B=arguments[F],Q=0,te=B.length;Q<te;Q++,U++)D[U]=B[Q];return D}function P(V,F,M){if(M||arguments.length===2)for(var D=0,U=F.length,B;D<U;D++)(B||!(D in F))&&(B||(B=Array.prototype.slice.call(F,0,D)),B[D]=F[D]);return V.concat(B||Array.prototype.slice.call(F))}function f(V){return this instanceof f?(this.v=V,this):new f(V)}function p(V,F,M){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var D=M.apply(V,F||[]),U,B=[];return U={},Q("next"),Q("throw"),Q("return"),U[Symbol.asyncIterator]=function(){return this},U;function Q(W){D[W]&&(U[W]=function(Z){return new Promise(function(re,ce){B.push([W,Z,re,ce])>1||te(W,Z)})})}function te(W,Z){try{Y(D[W](Z))}catch(re){G(B[0][3],re)}}function Y(W){W.value instanceof f?Promise.resolve(W.value.v).then(q,j):G(B[0][2],W)}function q(W){te("next",W)}function j(W){te("throw",W)}function G(W,Z){W(Z),B.shift(),B.length&&te(B[0][0],B[0][1])}}function a(V){var F,M;return F={},D("next"),D("throw",function(U){throw U}),D("return"),F[Symbol.iterator]=function(){return this},F;function D(U,B){F[U]=V[U]?function(Q){return(M=!M)?{value:f(V[U](Q)),done:U==="return"}:B?B(Q):Q}:B}}function o(V){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var F=V[Symbol.asyncIterator],M;return F?F.call(V):(V=typeof S=="function"?S(V):V[Symbol.iterator](),M={},D("next"),D("throw"),D("return"),M[Symbol.asyncIterator]=function(){return this},M);function D(B){M[B]=V[B]&&function(Q){return new Promise(function(te,Y){Q=V[B](Q),U(te,Y,Q.done,Q.value)})}}function U(B,Q,te,Y){Promise.resolve(Y).then(function(q){B({value:q,done:te})},Q)}}function d(V,F){return Object.defineProperty?Object.defineProperty(V,"raw",{value:F}):V.raw=F,V}var l=Object.create?function(V,F){Object.defineProperty(V,"default",{enumerable:!0,value:F})}:function(V,F){V.default=F};function g(V){if(V&&V.__esModule)return V;var F={};if(V!=null)for(var M in V)M!=="default"&&Object.prototype.hasOwnProperty.call(V,M)&&r(F,V,M);return l(F,V),F}function R(V){return V&&V.__esModule?V:{default:V}}function k(V,F,M,D){if(M==="a"&&!D)throw new TypeError("Private accessor was defined without a getter");if(typeof F=="function"?V!==F||!D:!F.has(V))throw new TypeError("Cannot read private member from an object whose class did not declare it");return M==="m"?D:M==="a"?D.call(V):D?D.value:F.get(V)}function T(V,F,M,D,U){if(D==="m")throw new TypeError("Private method is not writable");if(D==="a"&&!U)throw new TypeError("Private accessor was defined without a setter");if(typeof F=="function"?V!==F||!U:!F.has(V))throw new TypeError("Cannot write private member to an object whose class did not declare it");return D==="a"?U.call(V,M):U?U.value=M:F.set(V,M),M}},function(w,i,u){(function(v){Object.defineProperty(i,"__esModule",{value:!0}),i.allToUpperCase=i.allToLowerCase=i.encodeBody=i.decodeBody=i.Format=i.promisify=i.trim=i.arrChooseN=i.randomHexString=i.randomString=i.cheapRandStr=i.dataSizeBytes=i.inspectBody=i.inspectError=i.isErrorInfoOrPartialErrorInfo=i.now=i.parseQueryString=i.toQueryString=i.arrPopRandomElement=i.defaultPostHeaders=i.defaultGetHeaders=i.allSame=i.arrEvery=i.arrFilter=i.arrMap=i.safeArrForEach=i.arrForEach=i.forInOwnNonNullProperties=i.valuesArray=i.keysArray=i.arrWithoutValue=i.arrDeleteValue=i.arrIn=i.arrIndexOf=i.arrSubtract=i.arrIntersectOb=i.arrIntersect=i.intersect=i.containsValue=i.inherits=i.prototypicalClone=i.shallowClone=i.isEmptyArg=i.isOnlyPropIn=i.isEmpty=i.isObject=i.ensureArray=i.isArray=i.copy=i.mixin=void 0,i.arrEquals=i.toBase64=i.matchDerivedChannel=i.shallowEquals=i.getGlobalObject=i.getRetryTime=i.getJitterCoefficient=i.getBackoffCoefficient=void 0;var n=u(0),x=n.__importDefault(u(3)),y=n.__importStar(u(8)),A=n.__importDefault(u(4)),m=u(11),C=u(31);function $(K){return Math.floor(Math.random()*K.length)}function _(K){for(var oe=[],ie=1;ie<arguments.length;ie++)oe[ie-1]=arguments[ie];for(var fe=0;fe<oe.length;fe++){var ke=oe[fe];if(!ke)break;var Le=Object.prototype.hasOwnProperty;for(var Qe in ke)(!Le||Le.call(ke,Qe))&&(K[Qe]=ke[Qe])}return K}i.mixin=_;function r(K){return _({},K)}i.copy=r,i.isArray=Array.isArray||function(K){return Object.prototype.toString.call(K)=="[object Array]"};function h(K){return E(K)?[]:(0,i.isArray)(K)?K:[K]}i.ensureArray=h;function S(K){return Object.prototype.toString.call(K)=="[object Object]"}i.isObject=S;function O(K){for(var oe in K)return!1;return!0}i.isEmpty=O;function b(K,oe){for(var ie in K)if(ie!==oe)return!1;return!0}i.isOnlyPropIn=b;function E(K){return K==null}i.isEmptyArg=E;function P(K){var oe=new Object;for(var ie in K)oe[ie]=K[ie];return oe}i.shallowClone=P;function f(K,oe){var ie=function(){function ke(){}return ke}();ie.prototype=K;var fe=new ie;return oe&&_(fe,oe),fe}i.prototypicalClone=f;var p=function(K,oe){if(x.default.Config.inherits){x.default.Config.inherits(K,oe);return}K.super_=oe,K.prototype=f(oe.prototype,{constructor:K})};i.inherits=p;function a(K,oe){for(var ie in K)if(K[ie]==oe)return!0;return!1}i.containsValue=a;function o(K,oe){return(0,i.isArray)(oe)?d(K,oe):l(K,oe)}i.intersect=o;function d(K,oe){for(var ie=[],fe=0;fe<K.length;fe++){var ke=K[fe];(0,i.arrIndexOf)(oe,ke)!=-1&&ie.push(ke)}return ie}i.arrIntersect=d;function l(K,oe){for(var ie=[],fe=0;fe<K.length;fe++){var ke=K[fe];ke in oe&&ie.push(ke)}return ie}i.arrIntersectOb=l;function g(K,oe){for(var ie=[],fe=0;fe<K.length;fe++){var ke=K[fe];(0,i.arrIndexOf)(oe,ke)==-1&&ie.push(ke)}return ie}i.arrSubtract=g,i.arrIndexOf=Array.prototype.indexOf?function(K,oe,ie){return K.indexOf(oe,ie)}:function(K,oe,ie){ie=ie||0;for(var fe=K.length;ie<fe;ie++)if(K[ie]===oe)return ie;return-1};function R(K,oe){return(0,i.arrIndexOf)(K,oe)!==-1}i.arrIn=R;function k(K,oe){var ie=(0,i.arrIndexOf)(K,oe),fe=ie!=-1;return fe&&K.splice(ie,1),fe}i.arrDeleteValue=k;function T(K,oe){var ie=K.slice();return k(ie,oe),ie}i.arrWithoutValue=T;function V(K,oe){var ie=[];for(var fe in K)oe&&!Object.prototype.hasOwnProperty.call(K,fe)||ie.push(fe);return ie}i.keysArray=V;function F(K,oe){var ie=[];for(var fe in K)oe&&!Object.prototype.hasOwnProperty.call(K,fe)||ie.push(K[fe]);return ie}i.valuesArray=F;function M(K,oe){for(var ie in K)Object.prototype.hasOwnProperty.call(K,ie)&&K[ie]&&oe(ie)}i.forInOwnNonNullProperties=M,i.arrForEach=Array.prototype.forEach?function(K,oe){K.forEach(oe)}:function(K,oe){for(var ie=K.length,fe=0;fe<ie;fe++)oe(K[fe],fe,K)};function D(K,oe){return(0,i.arrForEach)(K.slice(),oe)}i.safeArrForEach=D,i.arrMap=Array.prototype.map?function(K,oe){return K.map(oe)}:function(K,oe){for(var ie=[],fe=K.length,ke=0;ke<fe;ke++)ie.push(oe(K[ke],ke,K));return ie},i.arrFilter=Array.prototype.filter?function(K,oe){return K.filter(oe)}:function(K,oe){for(var ie=[],fe=K.length,ke=0;ke<fe;ke++)oe(K[ke])&&ie.push(K[ke]);return ie},i.arrEvery=Array.prototype.every?function(K,oe){return K.every(oe)}:function(K,oe){for(var ie=K.length,fe=0;fe<ie;fe++)if(!oe(K[fe],fe,K))return!1;return!0};function U(K,oe){if(K.length===0)return!0;var ie=K[0][oe];return(0,i.arrEvery)(K,function(fe){return fe[oe]===ie})}i.allSame=U;var B={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function Q(K,oe){var ie=B[oe||Oe.json];return{accept:ie,"X-Ably-Version":y.default.protocolVersion.toString(),"Ably-Agent":(0,y.getAgentString)(K)}}i.defaultGetHeaders=Q;function te(K,oe){var ie,fe=ie=B[oe||Oe.json];return{accept:fe,"content-type":ie,"X-Ably-Version":y.default.protocolVersion.toString(),"Ably-Agent":(0,y.getAgentString)(K)}}i.defaultPostHeaders=te;function Y(K){return K.splice($(K),1)[0]}i.arrPopRandomElement=Y;function q(K){var oe=[];if(K)for(var ie in K)oe.push(encodeURIComponent(ie)+"="+encodeURIComponent(K[ie]));return oe.length?"?"+oe.join("&"):""}i.toQueryString=q;function j(K){for(var oe,ie=/([^?&=]+)=?([^&]*)/g,fe={};oe=ie.exec(K);)fe[decodeURIComponent(oe[1])]=decodeURIComponent(oe[2]);return fe}i.parseQueryString=j,i.now=Date.now||function(){return new Date().getTime()};function G(K){return typeof K=="object"&&K!==null&&(K.constructor.name=="ErrorInfo"||K.constructor.name=="PartialErrorInfo")}i.isErrorInfoOrPartialErrorInfo=G;function W(K){var oe,ie;return K instanceof Error||((oe=K==null?void 0:K.constructor)===null||oe===void 0?void 0:oe.name)==="ErrorInfo"||((ie=K==null?void 0:K.constructor)===null||ie===void 0?void 0:ie.name)==="PartialErrorInfo"?K.toString():x.default.Config.inspect(K)}i.inspectError=W;function Z(K){return x.default.BufferUtils.isBuffer(K)?K.toString():typeof K=="string"?K:x.default.Config.inspect(K)}i.inspectBody=Z;function re(K){if(x.default.BufferUtils.isBuffer(K))return x.default.BufferUtils.byteLength(K);if(typeof K=="string")return x.default.Config.stringByteSize(K);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof K)}i.dataSizeBytes=re;function ce(){return String(Math.random()).substr(2)}i.cheapRandStr=ce;var ve=function(K){if(x.default.Config.getRandomValues&&typeof Uint8Array<"u"){var oe=new Uint8Array(K);return x.default.Config.getRandomValues(oe),x.default.BufferUtils.base64Encode(oe)}for(var ie=x.default.BufferUtils.base64CharSet,fe=Math.round(K*4/3),ke="",Le=0;Le<fe;Le++)ke+=ie[$(ie)];return ke};i.randomString=ve;var ge=function(K){if(x.default.Config.getRandomValues&&typeof Uint8Array<"u"){var oe=new Uint8Array(K);return x.default.Config.getRandomValues(oe),x.default.BufferUtils.hexEncode(oe)}for(var ie=x.default.BufferUtils.hexCharSet,fe=K*2,ke="",Le=0;Le<fe;Le++)ke+=ie[$(ie)];return ke};i.randomHexString=ge;function Ae(K,oe){for(var ie=Math.min(oe,K.length),fe=K.slice(),ke=[],Le=0;Le<ie;Le++)ke.push(Y(fe));return ke}i.arrChooseN=Ae,i.trim=String.prototype.trim?function(K){return K.trim()}:function(K){return K.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function ue(K,oe,ie){return new Promise(function(fe,ke){K[oe].apply(K,n.__spreadArray(n.__spreadArray([],ie,!1),[function(Le,Qe){Le?ke(Le):fe(Qe)}],!1))})}i.promisify=ue;var Oe;(function(K){K.msgpack="msgpack",K.json="json"})(Oe=i.Format||(i.Format={}));function Ie(K,oe){return oe=="msgpack"?x.default.Config.msgpack.decode(K):JSON.parse(String(K))}i.decodeBody=Ie;function De(K,oe){return oe=="msgpack"?x.default.Config.msgpack.encode(K,!0):JSON.stringify(K)}i.encodeBody=De;function xe(K){return K.map(function(oe){return oe&&oe.toLowerCase()})}i.allToLowerCase=xe;function Be(K){return K.map(function(oe){return oe&&oe.toUpperCase()})}i.allToUpperCase=Be;function ot(K){return Math.min((K+2)/3,2)}i.getBackoffCoefficient=ot;function Ue(){return 1-Math.random()*.2}i.getJitterCoefficient=Ue;function nt(K,oe){return K*ot(oe)*Ue()}i.getRetryTime=nt;function dt(){return v||(typeof window<"u"?window:self)}i.getGlobalObject=dt;function pt(K,oe){return Object.keys(K).every(function(ie){return K[ie]===oe[ie]})&&Object.keys(oe).every(function(ie){return oe[ie]===K[ie]})}i.shallowEquals=pt;function bs(K){var oe=/^(\[([^?]*)(?:(.*))\])?(.+)$/,ie=K.match(oe);if(!ie||!ie.length||ie.length<5)throw new A.default("regex match failed",400,40010);if(ie[2])throw new A.default("cannot use a derived option with a ".concat(ie[2]," channel"),400,40010);return{qualifierParam:ie[3]||"",channelName:ie[4]}}i.matchDerivedChannel=bs;function $s(K){return x.default.Config.createHmac?Buffer.from(K,"ascii").toString("base64"):(0,m.stringify)((0,C.parse)(K))}i.toBase64=$s;function Ss(K,oe){return K.length===oe.length&&(0,i.arrEvery)(K,function(ie,fe){return ie===oe[fe]})}i.arrEquals=Ss}).call(this,u(13))},function(w,i,u){(function(v){Object.defineProperty(i,"__esModule",{value:!0});var n=u(0),x=n.__importDefault(u(3)),y=v||(typeof window<"u"?window:self),A;(function(r){r[r.None=0]="None",r[r.Error=1]="Error",r[r.Major=2]="Major",r[r.Minor=3]="Minor",r[r.Micro=4]="Micro"})(A||(A={}));function m(r,h){return"".concat(r).padStart(h?3:2,"0")}function C(r){return x.default.Config.logTimestamps?function(h){var S=new Date;r(m(S.getHours())+":"+m(S.getMinutes())+":"+m(S.getSeconds())+"."+m(S.getMilliseconds(),1)+" "+h)}:r}var $=function(){var r,h,S,O;return typeof Window>"u"&&typeof WorkerGlobalScope>"u"||typeof((h=(r=y==null?void 0:y.console)===null||r===void 0?void 0:r.log)===null||h===void 0?void 0:h.apply)=="function"?(S=function(){for(var b=[],E=0;E<arguments.length;E++)b[E]=arguments[E];console.log.apply(console,b)},O=console.warn?function(){for(var b=[],E=0;E<arguments.length;E++)b[E]=arguments[E];console.warn.apply(console,b)}:S):y!=null&&y.console.log?S=O=function(){Function.prototype.apply.call(console.log,console,arguments)}:S=O=function(){},[S,O].map(C)},_=function(){function r(){r.logLevel=r.LOG_DEFAULT}return r.initLogHandlers=function(){var h=$(),S=h[0],O=h[1];this.logHandler=S,this.logErrorHandler=O},r.renamedClientOption=function(h,S){r.deprecationWarning("The `".concat(h,"` client option has been renamed to `").concat(S,"`. Please update your code to use `").concat(S,"` instead. `").concat(h,"` will be removed in a future version."))},r.renamedMethod=function(h,S,O){r.deprecationWarning("`".concat(h,"`’s `").concat(S,"` method has been renamed to `").concat(O,"`. Please update your code to use `").concat(O,"` instead. `").concat(S,"` will be removed in a future version."))},r.deprecationWarning=function(h){r.shouldLog(A.Error)&&r.logErrorHandler("Ably: Deprecation warning - ".concat(h))},r.logLevel=A.Error,r.LOG_NONE=A.None,r.LOG_ERROR=A.Error,r.LOG_MAJOR=A.Major,r.LOG_MINOR=A.Minor,r.LOG_MICRO=A.Micro,r.LOG_DEFAULT=A.Error,r.LOG_DEBUG=A.Micro,r.logAction=function(h,S,O){r.shouldLog(h)&&(h===A.Error?r.logErrorHandler:r.logHandler)("Ably: "+S+": "+O)},r.deprecated=function(h,S){r.deprecationWarning("".concat(h," is deprecated and will be removed in a future version. ").concat(S))},r.shouldLog=function(h){return h<=r.logLevel},r.setLog=function(h,S){h!==void 0&&(r.logLevel=h),S!==void 0&&(r.logHandler=r.logErrorHandler=S)},r}();i.default=_}).call(this,u(13))},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=function(){function n(){}return n}();i.default=v},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0}),i.PartialErrorInfo=void 0;var v=u(0),n=v.__importDefault(u(3)),x=v.__importStar(u(1));function y(C){var $="["+C.constructor.name;return C.message&&($+=": "+C.message),C.statusCode&&($+="; statusCode="+C.statusCode),C.code&&($+="; code="+C.code),C.cause&&($+="; cause="+x.inspectError(C.cause)),C.href&&!(C.message&&C.message.indexOf("help.ably.io")>-1)&&($+="; see "+C.href+" "),$+="]",$}var A=function(C){v.__extends($,C);function $(_,r,h,S){var O=C.call(this,_)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(O,$.prototype),O.code=r,O.statusCode=h,O.cause=S,O}return $.prototype.toString=function(){return y(this)},$.fromValues=function(_){var r=_,h=r.message,S=r.code,O=r.statusCode;if(typeof h!="string"||typeof S!="number"||typeof O!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+n.default.Config.inspect(_));var b=Object.assign(new $(h,S,O),_);return b.code&&!b.href&&(b.href="https://help.ably.io/error/"+b.code),b},$}(Error);i.default=A;var m=function(C){v.__extends($,C);function $(_,r,h,S){var O=C.call(this,_)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(O,$.prototype),O.code=r,O.statusCode=h,O.cause=S,O}return $.prototype.toString=function(){return y(this)},$}(Error);i.PartialErrorInfo=m},function(w,i,u){(function(v,n){w.exports=n(u(6))})(this,function(v){return function(){if(typeof ArrayBuffer=="function"){var n=v,x=n.lib,y=x.WordArray,A=y.init,m=y.init=function(C){if(C instanceof ArrayBuffer&&(C=new Uint8Array(C)),(C instanceof Int8Array||typeof Uint8ClampedArray<"u"&&C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array)&&(C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength)),C instanceof Uint8Array){for(var $=C.byteLength,_=[],r=0;r<$;r++)_[r>>>2]|=C[r]<<24-r%4*8;A.call(this,_,$)}else A.apply(this,arguments)};m.prototype=y}}(),v.lib.WordArray})},function(w,i,u){(function(v){(function(n,x){w.exports=x()})(this,function(){var n=n||function(x,y){var A;if(typeof window<"u"&&window.crypto&&(A=window.crypto),!A&&typeof window<"u"&&window.msCrypto&&(A=window.msCrypto),!A&&typeof v<"u"&&v.crypto&&(A=v.crypto),!A)try{A=u(44)}catch{}var m=function(){if(A){if(typeof A.getRandomValues=="function")try{return A.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof A.randomBytes=="function")try{return A.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||function(){function p(){}return function(a){var o;return p.prototype=a,o=new p,p.prototype=null,o}}(),$={},_=$.lib={},r=_.Base=function(){return{extend:function(p){var a=C(this);return p&&a.mixIn(p),(!a.hasOwnProperty("init")||this.init===a.init)&&(a.init=function(){a.$super.init.apply(this,arguments)}),a.init.prototype=a,a.$super=this,a},create:function(){var p=this.extend();return p.init.apply(p,arguments),p},init:function(){},mixIn:function(p){for(var a in p)p.hasOwnProperty(a)&&(this[a]=p[a]);p.hasOwnProperty("toString")&&(this.toString=p.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),h=_.WordArray=r.extend({init:function(p,a){p=this.words=p||[],a!=y?this.sigBytes=a:this.sigBytes=p.length*4},toString:function(p){return(p||O).stringify(this)},concat:function(p){var a=this.words,o=p.words,d=this.sigBytes,l=p.sigBytes;if(this.clamp(),d%4)for(var g=0;g<l;g++){var R=o[g>>>2]>>>24-g%4*8&255;a[d+g>>>2]|=R<<24-(d+g)%4*8}else for(var g=0;g<l;g+=4)a[d+g>>>2]=o[g>>>2];return this.sigBytes+=l,this},clamp:function(){var p=this.words,a=this.sigBytes;p[a>>>2]&=4294967295<<32-a%4*8,p.length=x.ceil(a/4)},clone:function(){var p=r.clone.call(this);return p.words=this.words.slice(0),p},random:function(p){for(var a=[],o=0;o<p;o+=4)a.push(m());return new h.init(a,p)}}),S=$.enc={},O=S.Hex={stringify:function(p){for(var a=p.words,o=p.sigBytes,d=[],l=0;l<o;l++){var g=a[l>>>2]>>>24-l%4*8&255;d.push((g>>>4).toString(16)),d.push((g&15).toString(16))}return d.join("")},parse:function(p){for(var a=p.length,o=[],d=0;d<a;d+=2)o[d>>>3]|=parseInt(p.substr(d,2),16)<<24-d%8*4;return new h.init(o,a/2)}},b=S.Latin1={stringify:function(p){for(var a=p.words,o=p.sigBytes,d=[],l=0;l<o;l++){var g=a[l>>>2]>>>24-l%4*8&255;d.push(String.fromCharCode(g))}return d.join("")},parse:function(p){for(var a=p.length,o=[],d=0;d<a;d++)o[d>>>2]|=(p.charCodeAt(d)&255)<<24-d%4*8;return new h.init(o,a)}},E=S.Utf8={stringify:function(p){try{return decodeURIComponent(escape(b.stringify(p)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(p){return b.parse(unescape(encodeURIComponent(p)))}},P=_.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(p){typeof p=="string"&&(p=E.parse(p)),this._data.concat(p),this._nDataBytes+=p.sigBytes},_process:function(p){var a,o=this._data,d=o.words,l=o.sigBytes,g=this.blockSize,R=g*4,k=l/R;p?k=x.ceil(k):k=x.max((k|0)-this._minBufferSize,0);var T=k*g,V=x.min(T*4,l);if(T){for(var F=0;F<T;F+=g)this._doProcessBlock(d,F);a=d.splice(0,T),o.sigBytes-=V}return new h.init(a,V)},clone:function(){var p=r.clone.call(this);return p._data=this._data.clone(),p},_minBufferSize:0});_.Hasher=P.extend({cfg:r.extend(),init:function(p){this.cfg=this.cfg.extend(p),this.reset()},reset:function(){P.reset.call(this),this._doReset()},update:function(p){return this._append(p),this._process(),this},finalize:function(p){p&&this._append(p);var a=this._doFinalize();return a},blockSize:16,_createHelper:function(p){return function(a,o){return new p.init(o).finalize(a)}},_createHmacHelper:function(p){return function(a,o){return new f.HMAC.init(p,o).finalize(a)}}});var f=$.algo={};return $}(Math);return n})}).call(this,u(13))},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importStar(u(1)),x=v.__importDefault(u(2)),y=v.__importDefault(u(3));function A($,_,r){try{_.apply($,r)}catch(h){x.default.logAction(x.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+h+"; stack = "+(h&&h.stack))}}function m($,_,r){for(var h,S,O,b=0;b<$.length;b++)if(h=$[b],r&&(h=h[r]),n.isArray(h)){for(;(S=n.arrIndexOf(h,_))!==-1;)h.splice(S,1);r&&h.length===0&&delete $[b][r]}else if(n.isObject(h))for(O in h)Object.prototype.hasOwnProperty.call(h,O)&&n.isArray(h[O])&&m([h],_,O)}var C=function(){function $(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return $.prototype.on=function(){for(var _=this,r=[],h=0;h<arguments.length;h++)r[h]=arguments[h];if(r.length===1){var S=r[0];if(typeof S=="function")this.any.push(S);else throw new Error("EventListener.on(): Invalid arguments: "+y.default.Config.inspect(r))}if(r.length===2){var O=r[0],b=r[1];if(typeof b!="function")throw new Error("EventListener.on(): Invalid arguments: "+y.default.Config.inspect(r));if(n.isEmptyArg(O))this.any.push(b);else if(n.isArray(O))O.forEach(function(P){_.on(P,b)});else{if(typeof O!="string")throw new Error("EventListener.on(): Invalid arguments: "+y.default.Config.inspect(r));var E=this.events[O]||(this.events[O]=[]);E.push(b)}}},$.prototype.off=function(){for(var _,r=this,h=[],S=0;S<arguments.length;S++)h[S]=arguments[S];if(h.length==0||n.isEmptyArg(h[0])&&n.isEmptyArg(h[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}var O=h[0],b=h[1],E=null,P=null;if(h.length===1||!b)typeof O=="function"?E=O:P=O;else{if(typeof b!="function")throw new Error("EventEmitter.off(): invalid arguments:"+y.default.Config.inspect(h));_=[O,b],P=_[0],E=_[1]}if(E&&n.isEmptyArg(P)){m([this.any,this.events,this.anyOnce,this.eventsOnce],E);return}if(n.isArray(P)){P.forEach(function(f){r.off(f,E)});return}if(typeof P!="string")throw new Error("EventEmitter.off(): invalid arguments:"+y.default.Config.inspect(h));E?m([this.events,this.eventsOnce],E,P):(delete this.events[P],delete this.eventsOnce[P])},$.prototype.listeners=function(_){if(_){var r=this.events[_]||[];return this.eventsOnce[_]&&Array.prototype.push.apply(r,this.eventsOnce[_]),r.length?r:null}return this.any.length?this.any:null},$.prototype.emit=function(_){for(var r=[],h=1;h<arguments.length;h++)r[h-1]=arguments[h];var S={event:_},O=[];this.anyOnce.length&&(Array.prototype.push.apply(O,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(O,this.any);var b=this.eventsOnce[_];b&&(Array.prototype.push.apply(O,b),delete this.eventsOnce[_]);var E=this.events[_];E&&Array.prototype.push.apply(O,E),n.arrForEach(O,function(P){A(S,P,r)})},$.prototype.once=function(){for(var _=this,r=[],h=0;h<arguments.length;h++)r[h]=arguments[h];var S=r.length;if((S===0||S===1&&typeof r[0]!="function")&&y.default.Config.Promise){var O=r[0];return new y.default.Config.Promise(function(a){_.once(O,a)})}var b=r[0],E=r[1];if(r.length===1&&typeof b=="function")this.anyOnce.push(b);else if(n.isEmptyArg(b)){if(typeof E!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+y.default.Config.inspect(r));this.anyOnce.push(E)}else if(n.isArray(b)){var P=this,f=function(){var a=Array.prototype.slice.call(arguments);if(n.arrForEach(b,function(o){P.off(o,f)}),typeof E!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+y.default.Config.inspect(r));E.apply(this,a)};n.arrForEach(b,function(a){P.on(a,f)})}else{if(typeof b!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+y.default.Config.inspect(r));var p=this.eventsOnce[b]||(this.eventsOnce[b]=[]);if(E){if(typeof E!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+y.default.Config.inspect(r));p.push(E)}}},$.prototype.whenState=function(_,r,h){for(var S=this,O=[],b=3;b<arguments.length;b++)O[b-3]=arguments[b];var E={event:_};if(typeof _!="string"||typeof r!="string")throw"whenState requires a valid event String argument";if(typeof h!="function"&&y.default.Config.Promise)return new y.default.Config.Promise(function(P){$.prototype.whenState.apply(S,[_,r,P].concat(O))});_===r?A(E,h,O):this.once(_,h)},$}();i.default=C},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0}),i.getDefaults=i.normaliseOptions=i.objectifyOptions=i.getAgentString=i.getHosts=i.getFallbackHosts=i.environmentFallbackHosts=i.getHttpScheme=i.getPort=i.getHost=void 0;var v=u(0),n=v.__importDefault(u(3)),x=v.__importStar(u(1)),y=v.__importDefault(u(2)),A=v.__importDefault(u(4)),m=u(43),C="ably-js/"+m.version,$={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:m.version,protocolVersion:2,agent:C,getHost:_,getPort:r,getHttpScheme:h,environmentFallbackHosts:S,getFallbackHosts:O,getHosts:b,checkHost:E,objectifyOptions:a,normaliseOptions:o};function _(l,g,R){return R?g=g==l.restHost&&l.realtimeHost||g||l.realtimeHost:g=g||l.restHost,g}i.getHost=_;function r(l,g){return g||l.tls?l.tlsPort:l.port}i.getPort=r;function h(l){return l.tls?"https://":"http://"}i.getHttpScheme=h;function S(l){return[l+"-a-fallback.ably-realtime.com",l+"-b-fallback.ably-realtime.com",l+"-c-fallback.ably-realtime.com",l+"-d-fallback.ably-realtime.com",l+"-e-fallback.ably-realtime.com"]}i.environmentFallbackHosts=S;function O(l){var g=l.fallbackHosts,R=typeof l.httpMaxRetryCount<"u"?l.httpMaxRetryCount:$.httpMaxRetryCount;return g?x.arrChooseN(g,R):[]}i.getFallbackHosts=O;function b(l){return[l.restHost].concat(O(l))}i.getHosts=b;function E(l){if(typeof l!="string")throw new A.default("host must be a string; was a "+typeof l,4e4,400);if(!l.length)throw new A.default("host must not be zero-length",4e4,400)}function P(l,g,R){return l.realtimeHost?l.realtimeHost:l.restHost?(y.default.logAction(y.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+l.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+l.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),l.restHost):g?$.REALTIME_HOST:R+"-"+$.REALTIME_HOST}function f(l){var g={};for(var R in $.TIMEOUTS)g[R]=l[R]||$.TIMEOUTS[R];return g}function p(l){var g=$.agent;if(l.agents)for(var R in l.agents)g+=" "+R+"/"+l.agents[R];return g}i.getAgentString=p;function a(l){return typeof l=="string"?l.indexOf(":")==-1?{token:l}:{key:l}:l}i.objectifyOptions=a;function o(l){if(l.host&&(y.default.renamedClientOption("host","restHost"),l.restHost=l.host),l.wsHost&&(y.default.renamedClientOption("wsHost","realtimeHost"),l.realtimeHost=l.wsHost),l.queueEvents&&(y.default.renamedClientOption("queueEvents","queueMessages"),l.queueMessages=l.queueEvents),l.headers&&y.default.deprecated("the `headers` client option",""),l.fallbackHostsUseDefault){if(l.fallbackHosts){var g="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw y.default.logAction(y.default.LOG_ERROR,"Defaults.normaliseOptions",g),new A.default(g,4e4,400)}if(l.port||l.tlsPort){var g="fallbackHostsUseDefault cannot be set when port or tlsPort are set";throw y.default.logAction(y.default.LOG_ERROR,"Defaults.normaliseOptions",g),new A.default(g,4e4,400)}l.environment?y.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’ve set the `environment` client option, then this is no longer necessary: remove your usage of the `fallbackHostsUseDefault` client option and the library will then automatically choose the correct fallback hosts to use for the specified environment."):y.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’re not using the primary Ably environment, then stop using `fallbackHostsUseDefault`, and update your code to either pass the `environment` client option (in which case the library will automatically choose the correct fallback hosts to use for the specified environment), or to pass the `fallbackHosts` client option to specify a custom list of fallback hosts to use (for example, if you’re using a custom CNAME, in which case Ably will have provided you with an explicit list of fallback hosts)."),l.fallbackHosts=$.FALLBACK_HOSTS}l.recover===!0&&(y.default.deprecated("The ability to use a boolean value for the `recover` client option","If you wish for the connection to always be recovered, replace `{ recover: true }` with a function that always passes `true` to its callback: `{ recover: function(lastConnectionDetails, cb) { cb(true); } }`"),l.recover=function(Y,q){q(!0)}),typeof l.recover=="function"&&l.closeOnUnload===!0&&(y.default.logAction(y.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),l.recover=void 0),"closeOnUnload"in l||(l.closeOnUnload=!l.recover),l.transports&&x.arrIn(l.transports,"xhr")&&(y.default.deprecationWarning('The "xhr" transport has been renamed to "xhr_streaming". Please update your client options code to use `transports: ["xhr_streaming"]` instead. The ability to use `transports: ["xhr"]` will be removed in a future version.'),x.arrDeleteValue(l.transports,"xhr"),l.transports.push("xhr_streaming")),"queueMessages"in l||(l.queueMessages=!0);var R=l.environment&&String(l.environment).toLowerCase()||$.ENVIRONMENT,k=!R||R==="production";!l.fallbackHosts&&!l.restHost&&!l.realtimeHost&&!l.port&&!l.tlsPort&&(l.fallbackHosts=k?$.FALLBACK_HOSTS:S(R));var T=l.restHost||(k?$.REST_HOST:R+"-"+$.REST_HOST),V=P(l,k,R);x.arrForEach((l.fallbackHosts||[]).concat(T,V),E),l.port=l.port||$.PORT,l.tlsPort=l.tlsPort||$.TLS_PORT,"tls"in l||(l.tls=!0);var F=f(l);if("useBinaryProtocol"in l?l.useBinaryProtocol=n.default.Config.supportsBinary&&l.useBinaryProtocol:l.useBinaryProtocol=n.default.Config.preferBinary,l.clientId){var M=l.headers=l.headers||{};M["X-Ably-ClientId"]=n.default.BufferUtils.base64Encode(n.default.BufferUtils.utf8Encode(l.clientId))}"idempotentRestPublishing"in l||(l.idempotentRestPublishing=!0),l.promises&&!n.default.Config.Promise&&(y.default.logAction(y.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),l.promises=!1);var D=null,U=l.connectivityCheckUrl;if(l.connectivityCheckUrl){var B=l.connectivityCheckUrl.split("?"),Q=B[0],te=B[1];D=te?x.parseQueryString(te):{},Q.indexOf("://")===-1&&(Q="https://"+Q),U=Q}return v.__assign(v.__assign({},l),{useBinaryProtocol:"useBinaryProtocol"in l?n.default.Config.supportsBinary&&l.useBinaryProtocol:n.default.Config.preferBinary,realtimeHost:V,restHost:T,maxMessageSize:l.maxMessageSize||$.maxMessageSize,timeouts:F,connectivityCheckParams:D,connectivityCheckUrl:U})}i.normaliseOptions=o,i.default=$;function d(l){return Object.assign($,l)}i.getDefaults=d},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importDefault(u(3)),x=v.__importDefault(u(2)),y=v.__importDefault(u(4)),A=v.__importStar(u(1));function m(r){return!r||!r.channelOptions?{channelOptions:r,plugins:{},baseEncodedPreviousPayload:void 0}:r}function C(r){if(r&&r.cipher){if(!n.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var h=n.default.Crypto.getCipher(r.cipher);return{cipher:h.cipherParams,channelCipher:h.cipher}}return r??{}}function $(r){var h=0;return r.name&&(h+=r.name.length),r.clientId&&(h+=r.clientId.length),r.extras&&(h+=JSON.stringify(r.extras).length),r.data&&(h+=A.dataSizeBytes(r.data)),h}var _=function(){function r(){}return r.prototype.toJSON=function(){var h=this.encoding,S=this.data;return S&&n.default.BufferUtils.isBuffer(S)&&(arguments.length>0?(h=h?h+"/base64":"base64",S=n.default.BufferUtils.base64Encode(S)):S=n.default.BufferUtils.toBuffer(S)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:h,data:S}},r.prototype.toString=function(){var h="[Message";return this.name&&(h+="; name="+this.name),this.id&&(h+="; id="+this.id),this.timestamp&&(h+="; timestamp="+this.timestamp),this.clientId&&(h+="; clientId="+this.clientId),this.connectionId&&(h+="; connectionId="+this.connectionId),this.encoding&&(h+="; encoding="+this.encoding),this.extras&&(h+="; extras ="+JSON.stringify(this.extras)),this.data&&(typeof this.data=="string"?h+="; data="+this.data:n.default.BufferUtils.isBuffer(this.data)?h+="; data (buffer)="+n.default.BufferUtils.base64Encode(this.data):h+="; data (json)="+JSON.stringify(this.data)),this.extras&&(h+="; extras="+JSON.stringify(this.extras)),h+="]",h},r.encrypt=function(h,S,O){var b=h.data,E=h.encoding,P=S.channelCipher;E=E?E+"/":"",n.default.BufferUtils.isBuffer(b)||(b=n.default.BufferUtils.utf8Encode(String(b)),E=E+"utf-8/"),P.encrypt(b,function(f,p){if(f){O(f);return}h.data=p,h.encoding=E+"cipher+"+P.algorithm,O(null,h)})},r.encode=function(h,S,O){var b=h.data,E=typeof b=="string"||n.default.BufferUtils.isBuffer(b)||b===null||b===void 0;if(!E)if(A.isObject(b)||A.isArray(b))h.data=JSON.stringify(b),h.encoding=h.encoding?h.encoding+"/json":"json";else throw new y.default("Data type is unsupported",40013,400);S!=null&&S.cipher?r.encrypt(h,S,O):O(null,h)},r.encodeArray=function(h,S,O){for(var b=0,E=0;E<h.length;E++)r.encode(h[E],S,function(P){if(P){O(P);return}b++,b==h.length&&O(null,h)})},r.decode=function(h,S){var O=m(S),b=h.data,E=h.encoding;if(E){var P=E.split("/"),f=void 0,p=P.length,a=h.data,o="";try{for(;(f=p)>0;){var d=P[--p].match(/([-\w]+)(\+([\w-]+))?/);if(!d)break;switch(o=d[1],o){case"base64":a=n.default.BufferUtils.base64Decode(String(a)),f==P.length&&(b=a);continue;case"utf-8":a=n.default.BufferUtils.utf8Decode(a);continue;case"json":a=JSON.parse(a);continue;case"cipher":if(O.channelOptions!=null&&O.channelOptions.cipher&&O.channelOptions.channelCipher){var l=d[3],g=O.channelOptions.channelCipher;if(l!=g.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");a=g.decrypt(a);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!O.plugins||!O.plugins.vcdiff)throw new y.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new y.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var R=O.baseEncodedPreviousPayload;typeof R=="string"&&(R=n.default.BufferUtils.utf8Encode(R)),R=n.default.BufferUtils.toBuffer(R),a=n.default.BufferUtils.toBuffer(a),a=n.default.BufferUtils.typedArrayToBuffer(O.plugins.vcdiff.decode(a,R)),b=a}catch(T){throw new y.default("Vcdiff delta decode failed with "+T,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(T){var k=T;throw new y.default("Error processing the "+o+" encoding, decoder returned ‘"+k.message+"’",k.code||40013,400)}finally{h.encoding=f<=0?null:P.slice(0,f).join("/"),h.data=a}}O.baseEncodedPreviousPayload=b},r.fromResponseBody=function(h,S,O){O&&(h=A.decodeBody(h,O));for(var b=0;b<h.length;b++){var E=h[b]=r.fromValues(h[b]);try{r.decode(E,S)}catch(P){x.default.logAction(x.default.LOG_ERROR,"Message.fromResponseBody()",P.toString())}}return h},r.fromValues=function(h){return Object.assign(new r,h)},r.fromValuesArray=function(h){for(var S=h.length,O=new Array(S),b=0;b<S;b++)O[b]=r.fromValues(h[b]);return O},r.fromEncoded=function(h,S){var O=r.fromValues(h),b=C(S??null);try{r.decode(O,b)}catch(E){x.default.logAction(x.default.LOG_ERROR,"Message.fromEncoded()",E.toString())}return O},r.fromEncodedArray=function(h,S){return h.map(function(O){return r.fromEncoded(O,S)})},r.getMessagesSize=function(h){for(var S,O=0,b=0;b<h.length;b++)S=h[b],O+=S.size||(S.size=$(S));return O},r.serialize=A.encodeBody,r}();i.default=_},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importStar(u(1)),x=v.__importDefault(u(4)),y=v.__importDefault(u(9)),A=v.__importDefault(u(16)),m={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},C=[];Object.keys(m).forEach(function(O){C[m[O]]=O});var $={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},_=Object.keys($);$.MODE_ALL=$.PRESENCE|$.PUBLISH|$.SUBSCRIBE|$.PRESENCE_SUBSCRIBE;function r(O){var b=[];if(O)for(var E=0;E<O.length;E++)b.push(O[E].toString());return"[ "+b.join(", ")+" ]"}var h="id channel channelSerial connectionId count msgSerial timestamp".split(" "),S=function(){function O(){var b=this;this.hasFlag=function(E){return(b.flags&$[E])>0}}return O.prototype.setFlag=function(b){return this.flags=this.flags|$[b]},O.prototype.getMode=function(){return this.flags&&this.flags&$.MODE_ALL},O.prototype.encodeModesToFlags=function(b){var E=this;b.forEach(function(P){return E.setFlag(P)})},O.prototype.decodeModesFromFlags=function(){var b=this,E=[];return O.channelModes.forEach(function(P){b.hasFlag(P)&&E.push(P)}),E.length>0?E:void 0},O.fromValues=function(b){return Object.assign(new O,b)},O.Action=m,O.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],O.ActionName=C,O.serialize=n.encodeBody,O.deserialize=function(b,E){var P=n.decodeBody(b,E);return O.fromDeserialized(P)},O.fromDeserialized=function(b){var E=b.error;E&&(b.error=x.default.fromValues(E));var P=b.messages;if(P)for(var f=0;f<P.length;f++)P[f]=y.default.fromValues(P[f]);var p=b.presence;if(p)for(var f=0;f<p.length;f++)p[f]=A.default.fromValues(p[f],!0);return Object.assign(new O,b)},O.stringify=function(b){var E="[ProtocolMessage";b.action!==void 0&&(E+="; action="+O.ActionName[b.action]||!1);for(var P,f=0;f<h.length;f++)P=h[f],b[P]!==void 0&&(E+="; "+P+"="+b[P]);if(b.messages&&(E+="; messages="+r(y.default.fromValuesArray(b.messages))),b.presence&&(E+="; presence="+r(A.default.fromValuesArray(b.presence))),b.error&&(E+="; error="+x.default.fromValues(b.error).toString()),b.auth&&b.auth.accessToken&&(E+="; token="+b.auth.accessToken),b.flags&&(E+="; flags="+_.filter(b.hasFlag).join(",")),b.params){var p="";n.forInOwnNonNullProperties(b.params,function(a){p.length>0&&(p+="; "),p+=a+"="+b.params[a]}),p.length>0&&(E+="; params=["+p+"]")}return E+="]",E},O}();i.default=S},function(w,i,u){(function(v,n){w.exports=n(u(6))})(this,function(v){return function(){var n=v,x=n.lib,y=x.WordArray,A=n.enc;A.Base64={stringify:function(C){var $=C.words,_=C.sigBytes,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";C.clamp();for(var h=[],S=0;S<_;S+=3)for(var O=$[S>>>2]>>>24-S%4*8&255,b=$[S+1>>>2]>>>24-(S+1)%4*8&255,E=$[S+2>>>2]>>>24-(S+2)%4*8&255,P=O<<16|b<<8|E,f=0;f<4&&S+f*.75<_;f++)h.push(r.charAt(P>>>6*(3-f)&63));var p=r.charAt(64);if(p)for(;h.length%4;)h.push(p);return h.join("")},parse:function(C){var $=C.length,_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var h=0;h<_.length;h++)r[_.charCodeAt(h)]=h}var S=_.charAt(64);if(S){var O=C.indexOf(S);O!==-1&&($=O)}return m(C,$,r)}};function m(C,$,_){for(var r=[],h=0,S=0;S<$;S++)if(S%4){var O=_[C.charCodeAt(S-1)]<<S%4*2,b=_[C.charCodeAt(S)]>>>6-S%4*2,E=O|b;r[h>>>2]|=E<<24-h%4*8,h++}return y.create(r,h)}}(),v.enc.Base64})},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importStar(u(1)),x=v.__importDefault(u(10)),y=v.__importDefault(u(26)),A=v.__importDefault(u(2)),m=v.__importDefault(u(8)),C=v.__importDefault(u(21)),$=v.__importDefault(u(18)),_=v.__importDefault(u(4)),r=v.__importDefault(u(22)),h=v.__importDefault(u(3));function S(E){var P=[80015,80017,80030];return E.code?$.default.isTokenErr(E)?!1:n.arrIn(P,E.code)?!0:E.code>=4e4&&E.code<5e4:!1}function O(E){return S(E)?[x.default.fromValues({action:x.default.Action.ERROR,error:E})]:[x.default.fromValues({action:x.default.Action.DISCONNECTED,error:E})]}var b=function(E){v.__extends(P,E);function P(f,p,a){var o=E.call(this,f,p,a,!0)||this;return o.onAuthUpdated=function(d){o.authParams={access_token:d.token}},o.stream="stream"in a?a.stream:!0,o.sendRequest=null,o.recvRequest=null,o.pendingCallback=null,o.pendingItems=null,o}return P.prototype.connect=function(){var f=this;A.default.logAction(A.default.LOG_MINOR,"CometTransport.connect()","starting"),y.default.prototype.connect.call(this);var p=this.params,a=p.options,o=m.default.getHost(a,p.host),d=m.default.getPort(a),l=a.tls?"https://":"http://";this.baseUri=l+o+":"+d+"/comet/";var g=this.baseUri+"connect";A.default.logAction(A.default.LOG_MINOR,"CometTransport.connect()","uri: "+g),this.auth.getAuthParams(function(R,k){if(R){f.disconnect(R);return}if(!f.isDisposed){f.authParams=k;var T=f.params.getConnectParams(k);"stream"in T&&(f.stream=T.stream),A.default.logAction(A.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+n.toQueryString(T));var V=!1,F=f.recvRequest=f.createRequest(g,null,T,null,f.stream?r.default.REQ_RECV_STREAM:r.default.REQ_RECV);F.on("data",function(M){f.recvRequest&&(V||(V=!0,f.emit("preconnect")),f.onData(M))}),F.on("complete",function(M){if(f.recvRequest||(M=M||new _.default("Request cancelled",80003,400)),f.recvRequest=null,!V&&!M&&(V=!0,f.emit("preconnect")),f.onActivity(),M){M.code?f.onData(O(M)):f.disconnect(M);return}h.default.Config.nextTick(function(){f.recv()})}),F.exec()}})},P.prototype.requestClose=function(){A.default.logAction(A.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},P.prototype.requestDisconnect=function(){A.default.logAction(A.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},P.prototype._requestCloseOrDisconnect=function(f){var p=this,a=f?this.closeUri:this.disconnectUri;if(a){var o=this.createRequest(a,null,this.authParams,null,r.default.REQ_SEND);o.on("complete",function(d){d&&(A.default.logAction(A.default.LOG_ERROR,"CometTransport.request"+(f?"Close()":"Disconnect()"),"request returned err = "+n.inspectError(d)),p.finish("disconnected",d))}),o.exec()}},P.prototype.dispose=function(){var f=this;A.default.logAction(A.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(A.default.logAction(A.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",C.default.disconnected()),h.default.Config.nextTick(function(){f.emit("disposed")}))},P.prototype.onConnect=function(f){var p;if(!this.isDisposed){var a=(p=f.connectionDetails)===null||p===void 0?void 0:p.connectionKey;y.default.prototype.onConnect.call(this,f);var o=this.baseUri+a;A.default.logAction(A.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+o),this.sendUri=o+"/send",this.recvUri=o+"/recv",this.closeUri=o+"/close",this.disconnectUri=o+"/disconnect"}},P.prototype.send=function(f){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(f);return}var p=this.pendingItems||[];p.push(f),this.pendingItems=null,this.sendItems(p)},P.prototype.sendAnyPending=function(){var f=this.pendingItems;f&&(this.pendingItems=null,this.sendItems(f))},P.prototype.sendItems=function(f){var p=this,a=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(f),r.default.REQ_SEND);a.on("complete",function(o,d){if(o&&A.default.logAction(A.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+n.inspectError(o)),p.sendRequest=null,o){o.code?p.onData(O(o)):p.disconnect(o);return}d&&p.onData(d),p.pendingItems&&h.default.Config.nextTick(function(){p.sendRequest||p.sendAnyPending()})}),a.exec()},P.prototype.recv=function(){var f=this;if(!this.recvRequest&&this.isConnected){var p=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?r.default.REQ_RECV_STREAM:r.default.REQ_RECV_POLL);p.on("data",function(a){f.onData(a)}),p.on("complete",function(a){if(f.recvRequest=null,f.onActivity(),a){a.code?f.onData(O(a)):f.disconnect(a);return}h.default.Config.nextTick(function(){f.recv()})}),p.exec()}},P.prototype.onData=function(f){try{var p=this.decodeResponse(f);if(p&&p.length)for(var a=0;a<p.length;a++)this.onProtocolMessage(x.default.fromDeserialized(p[a]))}catch(o){A.default.logAction(A.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+o.stack)}},P.prototype.encodeRequest=function(f){return JSON.stringify(f)},P.prototype.decodeResponse=function(f){return typeof f=="string"?JSON.parse(f):f},P}(y.default);i.default=b},function(w,i){var u;u=function(){return this}();try{u=u||new Function("return this")()}catch{typeof window=="object"&&(u=window)}w.exports=u},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0}),i.isSuccessCode=void 0;var v;(function(x){x[x.Success=200]="Success",x[x.NoContent=204]="NoContent",x[x.BadRequest=400]="BadRequest",x[x.Unauthorized=401]="Unauthorized",x[x.Forbidden=403]="Forbidden",x[x.RequestTimeout=408]="RequestTimeout",x[x.InternalServerError=500]="InternalServerError"})(v||(v={}));function n(x){return x>=v.Success&&x<v.BadRequest}i.isSuccessCode=n,i.default=v},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importDefault(u(3)),x=v.__importStar(u(1)),y=v.__importDefault(u(2)),A=v.__importDefault(u(18)),m=v.__importDefault(u(19)),C=u(4),$=v.__importDefault(u(14));function _(E,P,f,p,a){E.http.supportsAuthHeaders?E.auth.getAuthHeaders(function(o,d){o?p(o):a(x.mixin(d,P),f)}):E.auth.getAuthParams(function(o,d){o?p(o):a(P,x.mixin(d,f))})}function r(E,P){return function(f,p,a,o,d){if(f&&!p){E(f);return}if(d===$.default.NoContent){E(f,[],a,!0,d);return}if(!o)try{p=x.decodeBody(p,P)}catch(V){x.isErrorInfoOrPartialErrorInfo(V)?E(V):E(new C.PartialErrorInfo(x.inspectError(V),null));return}if(!p){E(new C.PartialErrorInfo("unenvelope(): Response body is missing",null));return}var l=p,g=l.statusCode,R=l.response,k=l.headers;if(g===void 0){E(f,p,a,!0,d);return}if(g<200||g>=300){var T=R&&R.error||f;T||(T=new Error("Error in unenveloping "+p),T.statusCode=g),E(T,R,k,!0,g);return}E(f,R,k,!0,g)}}function h(E){var P=[];if(E)for(var f in E)P.push(f+"="+E[f]);return P.join("&")}function S(E,P){return E+(P?"?":"")+h(P)}function O(E,P,f,p){return function(a,o,d,l,g){a?y.default.logAction(y.default.LOG_MICRO,"Resource."+P+"()","Received Error; "+S(f,p)+"; Error: "+x.inspectError(a)):y.default.logAction(y.default.LOG_MICRO,"Resource."+P+"()","Received; "+S(f,p)+"; Headers: "+h(d)+"; StatusCode: "+g+"; Body: "+(n.default.BufferUtils.isBuffer(o)?o.toString():o)),E&&E(a,o,d,l,g)}}var b=function(){function E(){}return E.get=function(P,f,p,a,o,d){E.do(m.default.Get,P,f,null,p,a,o,d)},E.delete=function(P,f,p,a,o,d){E.do(m.default.Delete,P,f,null,p,a,o,d)},E.post=function(P,f,p,a,o,d,l){E.do(m.default.Post,P,f,p,a,o,d,l)},E.patch=function(P,f,p,a,o,d,l){E.do(m.default.Patch,P,f,p,a,o,d,l)},E.put=function(P,f,p,a,o,d,l){E.do(m.default.Put,P,f,p,a,o,d,l)},E.do=function(P,f,p,a,o,d,l,g){y.default.shouldLog(y.default.LOG_MICRO)&&(g=O(g,P,p,d)),l&&(g=g&&r(g,l),(d=d||{}).envelope=l);function R(k,T){var V;if(y.default.shouldLog(y.default.LOG_MICRO)&&y.default.logAction(y.default.LOG_MICRO,"Resource."+P+"()","Sending; "+S(p,T)),y.default.shouldLog(y.default.LOG_MICRO)){var F=a;if(((V=k["content-type"])===null||V===void 0?void 0:V.indexOf("msgpack"))>0)try{F=n.default.Config.msgpack.decode(a)}catch(M){y.default.logAction(y.default.LOG_MICRO,"Resource."+P+"()","Sending MsgPack Decoding Error: "+x.inspectError(M))}y.default.logAction(y.default.LOG_MICRO,"Resource."+P+"()","Sending; "+S(p,T)+"; Body: "+F)}f.http.do(P,f,p,k,a,T,function(M,D,U,B,Q){if(M&&A.default.isTokenErr(M)){f.auth.authorize(null,null,function(te){if(te){g(te);return}_(f,k,T,g,R)});return}g(M,D,U,B,Q)})}_(f,o,d,g,R)},E}();i.default=b},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importDefault(u(2)),x=v.__importDefault(u(3)),y=v.__importDefault(u(9)),A=v.__importStar(u(1));function m($){return C.Actions.indexOf($)}var C=function(){function $(){}return $.prototype.isSynthesized=function(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId},$.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var _=this.id.split(":");return{connectionId:_[0],msgSerial:parseInt(_[1],10),index:parseInt(_[2],10)}},$.prototype.toJSON=function(){var _=this.data,r=this.encoding;return _&&x.default.BufferUtils.isBuffer(_)&&(arguments.length>0?(r=r?r+"/base64":"base64",_=x.default.BufferUtils.base64Encode(_)):_=x.default.BufferUtils.toBuffer(_)),{id:this.id,clientId:this.clientId,action:m(this.action),data:_,encoding:r,extras:this.extras}},$.prototype.toString=function(){var _="[PresenceMessage";return _+="; action="+this.action,this.id&&(_+="; id="+this.id),this.timestamp&&(_+="; timestamp="+this.timestamp),this.clientId&&(_+="; clientId="+this.clientId),this.connectionId&&(_+="; connectionId="+this.connectionId),this.encoding&&(_+="; encoding="+this.encoding),this.data&&(typeof this.data=="string"?_+="; data="+this.data:x.default.BufferUtils.isBuffer(this.data)?_+="; data (buffer)="+x.default.BufferUtils.base64Encode(this.data):_+="; data (json)="+JSON.stringify(this.data)),this.extras&&(_+="; extras="+JSON.stringify(this.extras)),_+="]",_},$.fromResponseBody=function(_,r,h){var S=[];h&&(_=A.decodeBody(_,h));for(var O=0;O<_.length;O++){var b=S[O]=$.fromValues(_[O],!0);try{$.decode(b,r)}catch(E){n.default.logAction(n.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",E.toString())}}return S},$.fromValues=function(_,r){return r&&(_.action=$.Actions[_.action]),Object.assign(new $,_)},$.fromValuesArray=function(_){for(var r=_.length,h=new Array(r),S=0;S<r;S++)h[S]=$.fromValues(_[S]);return h},$.fromEncoded=function(_,r){var h=$.fromValues(_,!0);try{$.decode(h,r??{})}catch(S){n.default.logAction(n.default.LOG_ERROR,"PresenceMessage.fromEncoded()",S.toString())}return h},$.fromEncodedArray=function(_,r){return _.map(function(h){return $.fromEncoded(h,r)})},$.fromData=function(_){return _ instanceof $?_:$.fromValues({data:_})},$.Actions=["absent","present","enter","leave","update"],$.encode=y.default.encode,$.decode=y.default.decode,$.getMessagesSize=y.default.getMessagesSize,$}();i.default=C},function(w,i,u){(function(v){Object.defineProperty(i,"__esModule",{value:!0});var n=u(0),x=n.__importStar(u(1)),y=n.__importDefault(u(7)),A=n.__importStar(u(4)),m=n.__importDefault(u(2)),C=n.__importDefault(u(8)),$=n.__importDefault(u(22)),_=n.__importDefault(u(3));function r(l,g){return x.arrIn(x.allToLowerCase(x.keysArray(g)),"x-ably-errorcode")}function h(l,g){if(r(l,g))return l.error&&A.default.fromValues(l.error)}var S=function(){},O=0,b={},E=typeof v<"u"&&v.XDomainRequest;function P(){var l=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/);return l&&Number(l[1])}function f(){var l;return E&&(l=P())&&l===10}function p(l,g){return l.getResponseHeader&&l.getResponseHeader(g)}function a(l){return l.getResponseHeader&&(l.getResponseHeader("transfer-encoding")||!l.getResponseHeader("content-length"))}function o(l){for(var g=x.trim(l.getAllResponseHeaders()).split(`\r
`),R={},k=0;k<g.length;k++){var T=g[k].split(":").map(x.trim);R[T[0].toLowerCase()]=T[1]}return R}var d=function(l){n.__extends(g,l);function g(R,k,T,V,F,M,D){var U=l.call(this)||this;return T=T||{},T.rnd=x.cheapRandStr(),f()&&!T.envelope&&(T.envelope="json"),U.uri=R+x.toQueryString(T),U.headers=k||{},U.body=V,U.method=D?D.toUpperCase():x.isEmptyArg(V)?"GET":"POST",U.requestMode=F,U.timeouts=M,U.timedOut=!1,U.requestComplete=!1,U.id=String(++O),b[U.id]=U,U}return g.createRequest=function(R,k,T,V,F,M,D){var U=M||C.default.TIMEOUTS;return new g(R,k,x.copy(T),V,F,U,D)},g.prototype.complete=function(R,k,T,V,F){this.requestComplete||(this.requestComplete=!0,!R&&k&&this.emit("data",k),this.emit("complete",R,k,T,V,F),this.dispose())},g.prototype.abort=function(){this.dispose()},g.prototype.exec=function(){var R=this,k=this.headers,T=this.requestMode==$.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,V=this.timer=setTimeout(function(){R.timedOut=!0,M.abort()},T),F=this.method,M=this.xhr=new XMLHttpRequest,D=k.accept,U=this.body,B="text";if(D?D.indexOf("application/x-msgpack")===0&&(B="arraybuffer"):k.accept="application/json",U){var Q=k["content-type"]||(k["content-type"]="application/json");Q.indexOf("application/json")>-1&&typeof U!="string"&&(U=JSON.stringify(U))}M.open(F,this.uri,!0),M.responseType=B,"authorization"in k&&(M.withCredentials=!0);for(var te in k)M.setRequestHeader(te,k[te]);var Y=function(ue,Oe,Ie,De){var xe,Be=Oe+" (event type: "+ue.type+")";!((xe=R==null?void 0:R.xhr)===null||xe===void 0)&&xe.statusText&&(Be+=", current statusText is "+R.xhr.statusText),m.default.logAction(m.default.LOG_ERROR,"Request.on"+ue.type+"()",Be),R.complete(new A.PartialErrorInfo(Be,Ie,De))};M.onerror=function(ue){Y(ue,"XHR error occurred",null,400)},M.onabort=function(ue){R.timedOut?Y(ue,"Request aborted due to request timeout expiring",null,408):Y(ue,"Request cancelled",null,400)},M.ontimeout=function(ue){Y(ue,"Request timed out",null,408)};var q,j,G,W=0,Z=!1,re=function(){if(clearTimeout(V),G=j<400,j==204){R.complete(null,null,null,null,j);return}q=R.requestMode==$.default.REQ_RECV_STREAM&&G&&a(M)},ce=function(){var ue;try{var Oe=p(M,"content-type"),Ie=Oe?Oe.indexOf("application/json")>=0:M.responseType=="text";if(Ie){var De=M.responseType==="arraybuffer"?_.default.BufferUtils.utf8Decode(M.response):String(M.responseText);De.length?ue=JSON.parse(De):ue=De,Z=!0}else ue=M.response;ue.response!==void 0?(j=ue.statusCode,G=j<400,k=ue.headers,ue=ue.response):k=o(M)}catch(Be){R.complete(new A.PartialErrorInfo("Malformed response body from server: "+Be.message,null,400));return}if(G||x.isArray(ue)){R.complete(null,ue,k,Z,j);return}var xe=h(ue,k);xe||(xe=new A.PartialErrorInfo("Error response received from server: "+j+" body was: "+_.default.Config.inspect(ue),null,j)),R.complete(xe,ue,k,Z,j)};function ve(){for(var ue=M.responseText,Oe=ue.length-1,Ie,De;W<Oe&&(Ie=ue.indexOf(`
`,W))>-1;)De=ue.slice(W,Ie),W=Ie+1,ge(De)}var ge=function(ue){try{ue=JSON.parse(ue)}catch(Oe){R.complete(new A.PartialErrorInfo("Malformed response body from server: "+Oe.message,null,400));return}R.emit("data",ue)},Ae=function(){ve(),R.streamComplete=!0,_.default.Config.nextTick(function(){R.complete()})};M.onreadystatechange=function(){var ue=M.readyState;ue<3||M.status!==0&&(j===void 0&&(j=M.status,j===1223&&(j=204),re()),ue==3&&q?ve():ue==4&&(q?Ae():ce()))},M.send(U)},g.prototype.dispose=function(){var R=this.xhr;if(R){R.onreadystatechange=R.onerror=R.onabort=R.ontimeout=S,this.xhr=null;var k=this.timer;k&&(clearTimeout(k),this.timer=null),this.requestComplete||R.abort()}delete b[this.id]},g}(y.default);i.default=d}).call(this,u(13))},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importDefault(u(2)),x=v.__importStar(u(1)),y=v.__importDefault(u(24)),A=v.__importDefault(u(4)),m=v.__importDefault(u(45)),C=u(11),$=v.__importDefault(u(19)),_=v.__importDefault(u(14)),r=v.__importDefault(u(3)),h=v.__importDefault(u(15)),S=Math.pow(2,17);function O(){}function b(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function E(T){return!!T.connection}function P(T){return x.isErrorInfoOrPartialErrorInfo(T)?(T.code||(T.statusCode===403?T.code=40300:(T.code=40170,T.statusCode=401)),T):new A.default(x.inspectError(T),T.code||40170,T.statusCode||401)}var f=function(T,V){if(r.default.Config.createHmac){var F=r.default.Config.createHmac("SHA256",V);return F.update(T),F.digest("base64")}return(0,C.stringify)((0,m.default)(T,V))};function p(T){if(!T)return"";typeof T=="string"&&(T=JSON.parse(T));var V=Object.create(null),F=x.keysArray(T,!0);if(!F)return"";F.sort();for(var M=0;M<F.length;M++)V[F[M]]=T[F[M]].sort();return JSON.stringify(V)}function a(T){if(T.authCallback)n.default.logAction(n.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(T.authUrl)n.default.logAction(n.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(T.key)n.default.logAction(n.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(T.tokenDetails)n.default.logAction(n.default.LOG_MINOR,"Auth()","using token auth with supplied token only");else{var V="authOptions must include valid authentication parameters";throw n.default.logAction(n.default.LOG_ERROR,"Auth()",V),new Error(V)}}function o(T){return"useTokenAuth"in T&&!T.useTokenAuth}function d(T){return T.useTokenAuth||!o(T)&&(T.authCallback||T.authUrl||T.token||T.tokenDetails)}function l(T){return!T.key&&!T.authCallback&&!T.authUrl}var g=0;function R(){return g++}var k=function(){function T(V,F){if(this.authOptions={},this.client=V,this.tokenParams=F.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,d(F)){if(F.key&&!f){var M="client-side token request signing not supported";throw n.default.logAction(n.default.LOG_ERROR,"Auth()",M),new Error(M)}l(F)&&n.default.logAction(n.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(F.defaultTokenParams,F),a(this.authOptions)}else{if(!F.key){var M="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw n.default.logAction(n.default.LOG_ERROR,"Auth()",M),new A.default(M,40160,401)}n.default.logAction(n.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(F)}}return T.prototype.authorize=function(V,F,M){var D=this,U;if(typeof V=="function"&&!M?(M=V,U=V=null):typeof F=="function"&&!M?(M=F,U=null):U=F,!M&&this.client.options.promises)return x.promisify(this,"authorize",arguments);if(U&&U.key&&this.authOptions.key!==U.key)throw new A.default("Unable to update auth options with incompatible key",40102,401);U&&"force"in U&&(n.default.deprecated("The `force` auth option","If you’re using this option to force `authorize()` to fetch a new token even if the current token has not expired, this is no longer necessary, as `authorize()` now always fetches a new token. Update your code to no longer pass the `force` auth option. Note that, in general, passing an auth options argument to `authorize()` will overwrite the library’s stored auth options, which may not be what you want. The library currently contains a special case behavior where passing an auth options object which only contains `{ force: true }` will _not_ overwrite the stored options. This special case behavior will be removed alongside support for the `force` option, so if you’re currently passing `authorize()` an auth options object which only contains `{ force: true }`, you should stop passing it an auth options object entirely."),x.isOnlyPropIn(U,"force")&&(U=null)),this._forceNewToken(V,U,function(B,Q){if(B){D.client.connection&&B.statusCode===_.default.Forbidden&&D.client.connection.connectionManager.actOnErrorFromAuthorize(B),M==null||M(B);return}E(D.client)?D.client.connection.connectionManager.onAuthUpdated(Q,M||O):M==null||M(null,Q)})},T.prototype.authorise=function(V,F,M){n.default.renamedMethod("Auth","authorise","authorize"),this.authorize(V,F,M)},T.prototype._forceNewToken=function(V,F,M){var D=this;this.tokenDetails=null,this._saveTokenOptions(V,F),a(this.authOptions),this._ensureValidAuthCredentials(!0,function(U,B){delete D.tokenParams.timestamp,delete D.authOptions.queryTime,M(U,B)})},T.prototype.requestToken=function(V,F,M){var D=this;if(typeof V=="function"&&!M?(M=V,F=V=null):typeof F=="function"&&!M&&(M=F,F=null),!M&&this.client.options.promises)return x.promisify(this,"requestToken",arguments);F=F||this.authOptions,V=V||x.copy(this.tokenParams);var U=M||O,B,Q=this.client;if(F.authCallback)n.default.logAction(n.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),B=F.authCallback;else if(F.authUrl)n.default.logAction(n.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),B=function(W,Z){var re=x.mixin({accept:"application/json, text/plain"},F.authHeaders),ce=F.authMethod&&F.authMethod.toLowerCase()==="post",ve,ge=F.authUrl.indexOf("?");ge>-1&&(ve=x.parseQueryString(F.authUrl.slice(ge)),F.authUrl=F.authUrl.slice(0,ge),ce||(F.authParams=x.mixin(ve,F.authParams)));var Ae=x.mixin({},F.authParams||{},W),ue=function(De,xe,Be,ot){var Ue;if(De?n.default.logAction(n.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+x.inspectError(De)):(Ue=Be["content-type"],n.default.logAction(n.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+Ue+"; body: "+x.inspectBody(xe))),De||ot)return Z(De,xe);if(r.default.BufferUtils.isBuffer(xe)&&(xe=xe.toString()),!Ue){Z(new A.default("authUrl response is missing a content-type header",40170,401));return}var nt=Ue.indexOf("application/json")>-1,dt=Ue.indexOf("text/plain")>-1||Ue.indexOf("application/jwt")>-1;if(!nt&&!dt){Z(new A.default("authUrl responded with unacceptable content-type "+Ue+", should be either text/plain, application/jwt or application/json",40170,401));return}if(nt){if(xe.length>S){Z(new A.default("authUrl response exceeded max permitted length",40170,401));return}try{xe=JSON.parse(xe)}catch(pt){Z(new A.default("Unexpected error processing authURL response; err = "+pt.message,40170,401));return}}Z(null,xe,Ue)};if(n.default.logAction(n.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+F.authUrl+"; Params: "+JSON.stringify(Ae)+"; method: "+(ce?"POST":"GET")),ce){var Oe=re||{};Oe["content-type"]="application/x-www-form-urlencoded";var Ie=x.toQueryString(Ae).slice(1);D.client.http.doUri($.default.Post,Q,F.authUrl,Oe,Ie,ve,ue)}else D.client.http.doUri($.default.Get,Q,F.authUrl,re||{},null,Ae,ue)};else if(F.key)n.default.logAction(n.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),B=function(W,Z){D.createTokenRequest(W,F,Z)};else{var te="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";n.default.logAction(n.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),U(new A.default(te,40171,403));return}"capability"in V&&(V.capability=p(V.capability));var Y=function(W,Z){var re=W.keyName,ce="/keys/"+re+"/requestToken",ve=function(Ae){return Q.baseUri(Ae)+ce},ge=x.defaultPostHeaders(D.client.options);F.requestHeaders&&x.mixin(ge,F.requestHeaders),n.default.logAction(n.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+ce+"; Token params: "+JSON.stringify(W)),D.client.http.do($.default.Post,Q,ve,ge,JSON.stringify(W),null,Z)},q=!1,j=this.client.options.timeouts.realtimeRequestTimeout,G=setTimeout(function(){q=!0;var W="Token request callback timed out after "+j/1e3+" seconds";n.default.logAction(n.default.LOG_ERROR,"Auth.requestToken()",W),U(new A.default(W,40170,401))},j);B(V,function(W,Z,re){if(!q){if(clearTimeout(G),W){n.default.logAction(n.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+x.inspectError(W)),U(P(W));return}if(typeof Z=="string"){Z.length===0?U(new A.default("Token string is empty",40170,401)):Z.length>S?U(new A.default("Token string exceeded max permitted length (was "+Z.length+" bytes)",40170,401)):Z==="undefined"||Z==="null"?U(new A.default("Token string was literal null/undefined",40170,401)):Z[0]==="{"&&!(re&&re.indexOf("application/jwt")>-1)?U(new A.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):U(null,{token:Z});return}if(typeof Z!="object"){var ce="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof Z;n.default.logAction(n.default.LOG_ERROR,"Auth.requestToken()",ce),U(new A.default(ce,40170,401));return}var ve=JSON.stringify(Z).length;if(ve>S&&!F.suppressMaxLengthCheck){U(new A.default("Token request/details object exceeded max permitted stringified size (was "+ve+" bytes)",40170,401));return}if("issued"in Z){U(null,Z);return}if(!("keyName"in Z)){var ce="Expected token request callback to call back with a token string, token request object, or token details object";n.default.logAction(n.default.LOG_ERROR,"Auth.requestToken()",ce),U(new A.default(ce,40170,401));return}Y(Z,function(ge,Ae,ue,Oe){if(ge){n.default.logAction(n.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+x.inspectError(ge)),U(P(ge));return}Oe||(Ae=JSON.parse(Ae)),n.default.logAction(n.default.LOG_MINOR,"Auth.getToken()","token received"),U(null,Ae)})}})},T.prototype.createTokenRequest=function(V,F,M){var D=this;if(typeof V=="function"&&!M?(M=V,F=V=null):typeof F=="function"&&!M&&(M=F,F=null),!M&&this.client.options.promises)return x.promisify(this,"createTokenRequest",arguments);F=F||this.authOptions,V=V||x.copy(this.tokenParams);var U=F.key;if(!U){M(new A.default("No key specified",40101,403));return}var B=U.split(":"),Q=B[0],te=B[1];if(!te){M(new A.default("Invalid key specified",40101,403));return}if(V.clientId===""){M(new A.default("clientId can’t be an empty string",40012,400));return}"capability"in V&&(V.capability=p(V.capability));var Y=x.mixin({keyName:Q},V),q=V.clientId||"",j=V.ttl||"",G=V.capability||"";(function(W){if(Y.timestamp){W();return}D.getTimestamp(F&&F.queryTime,function(Z,re){if(Z){M(Z);return}Y.timestamp=re,W()})})(function(){var W=Y.nonce||(Y.nonce=b()),Z=Y.timestamp,re=Y.keyName+`
`+j+`
`+G+`
`+q+`
`+Z+`
`+W+`
`;Y.mac=Y.mac||f(re,te),n.default.logAction(n.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),M(null,Y)})},T.prototype.getAuthParams=function(V){this.method=="basic"?V(null,{key:this.key}):this._ensureValidAuthCredentials(!1,function(F,M){if(F){V(F);return}if(!M)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");V(null,{access_token:M.token})})},T.prototype.getAuthHeaders=function(V){this.method=="basic"?V(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,function(F,M){if(F){V(F);return}if(!M)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");V(null,{authorization:"Bearer "+x.toBase64(M.token)})})},T.prototype.getTimestamp=function(V,F){!this.isTimeOffsetSet()&&(V||this.authOptions.queryTime)?this.client.time(F):F(null,this.getTimestampUsingOffset())},T.prototype.getTimestampUsingOffset=function(){return x.now()+(this.client.serverTimeOffset||0)},T.prototype.isTimeOffsetSet=function(){return this.client.serverTimeOffset!==null},T.prototype._saveBasicOptions=function(V){this.method="basic",this.key=V.key,this.basicKey=x.toBase64(V.key),this.authOptions=V||{},"clientId"in V&&this._userSetClientId(V.clientId)},T.prototype._saveTokenOptions=function(V,F){this.method="token",V&&(this.tokenParams=V),F&&(F.token&&(F.tokenDetails=typeof F.token=="string"?{token:F.token}:F.token),F.tokenDetails&&(this.tokenDetails=F.tokenDetails),"clientId"in F&&this._userSetClientId(F.clientId),this.authOptions=F)},T.prototype._ensureValidAuthCredentials=function(V,F){var M=this,D=this.tokenDetails;if(D){if(this._tokenClientIdMismatch(D.clientId)){F(new A.default("Mismatch between clientId in token ("+D.clientId+") and current clientId ("+this.clientId+")",40102,403));return}if(!this.isTimeOffsetSet()||!D.expires||D.expires>=this.getTimestampUsingOffset()){n.default.logAction(n.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+D.expires),F(null,D);return}n.default.logAction(n.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=y.default.create())).push(F),!(this.currentTokenRequestId!==null&&!V)){var U=this.currentTokenRequestId=R();this.requestToken(this.tokenParams,this.authOptions,function(B,Q){if(M.currentTokenRequestId>U){n.default.logAction(n.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");return}M.currentTokenRequestId=null;var te=M.waitingForTokenRequest||O;if(M.waitingForTokenRequest=null,B){te(B);return}te(null,M.tokenDetails=Q)})}},T.prototype._userSetClientId=function(V){if(typeof V=="string"||V===null){if(V==="*")throw new A.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var F=this._uncheckedSetClientId(V);if(F)throw F}else throw new A.default("clientId must be either a string or null",40012,400)},T.prototype._uncheckedSetClientId=function(V){if(this._tokenClientIdMismatch(V)){var F="Unexpected clientId mismatch: client has "+this.clientId+", requested "+V,M=new A.default(F,40102,401);return n.default.logAction(n.default.LOG_ERROR,"Auth._uncheckedSetClientId()",F),M}else return this.clientId=this.tokenParams.clientId=V,null},T.prototype._tokenClientIdMismatch=function(V){return!!(this.clientId&&this.clientId!=="*"&&V&&V!=="*"&&this.clientId!==V)},T.isTokenErr=function(V){return V.code&&V.code>=40140&&V.code<40150},T.prototype.revokeTokens=function(V,F,M){if(d(this.client.options))throw new A.default("Cannot revoke tokens when using token auth",40162,401);var D=this.client.options.keyName,U;if(typeof F=="function"?(M=F,U={}):U=F??{},M===void 0){if(this.client.options.promises)return x.promisify(this,"revokeTokens",[V,U]);M=O}var B=M,Q=v.__assign({targets:V.map(function(j){return"".concat(j.type,":").concat(j.value)})},U),te=this.client.options.useBinaryProtocol?x.Format.msgpack:x.Format.json,Y=x.defaultPostHeaders(this.client.options,te);this.client.options.headers&&x.mixin(Y,this.client.options.headers);var q=x.encodeBody(Q,te);h.default.post(this.client,"/keys/".concat(D,"/revokeTokens"),q,Y,{newBatchResponse:"true"},null,function(j,G,W,Z){if(j){B(j);return}var re=Z?G:x.decodeBody(G,te);B(null,re)})},T}();i.default=k},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v;(function(n){n.Get="get",n.Delete="delete",n.Post="post",n.Put="put",n.Patch="patch"})(v||(v={})),i.default=v},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0}),i.HttpPaginatedResponse=i.PaginatedResult=void 0;var v=u(0),n=v.__importStar(u(1)),x=v.__importDefault(u(2)),y=v.__importDefault(u(15)),A=v.__importDefault(u(14));function m(S){var O=S.match(/^\.\/(\w+)\?(.*)$/);return O&&O[2]&&n.parseQueryString(O[2])}function C(S){typeof S=="string"&&(S=S.split(","));for(var O={},b=0;b<S.length;b++){var E=S[b].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(E){var P=m(E[1]);P&&(O[E[2]]=P)}}return O}function $(S,O,b){return!(b&&(O||typeof S.code=="number"))}var _=function(){function S(O,b,E,P,f,p){this.rest=O,this.path=b,this.headers=E,this.envelope=P??null,this.bodyHandler=f,this.useHttpPaginatedResponse=p||!1}return S.prototype.get=function(O,b){var E=this;y.default.get(this.rest,this.path,this.headers,O,this.envelope,function(P,f,p,a,o){E.handlePage(P,f,p,a,o,b)})},S.prototype.delete=function(O,b){var E=this;y.default.delete(this.rest,this.path,this.headers,O,this.envelope,function(P,f,p,a,o){E.handlePage(P,f,p,a,o,b)})},S.prototype.post=function(O,b,E){var P=this;y.default.post(this.rest,this.path,b,this.headers,O,this.envelope,function(f,p,a,o,d){E&&P.handlePage(f,p,a,o,d,E)})},S.prototype.put=function(O,b,E){var P=this;y.default.put(this.rest,this.path,b,this.headers,O,this.envelope,function(f,p,a,o,d){E&&P.handlePage(f,p,a,o,d,E)})},S.prototype.patch=function(O,b,E){var P=this;y.default.patch(this.rest,this.path,b,this.headers,O,this.envelope,function(f,p,a,o,d){E&&P.handlePage(f,p,a,o,d,E)})},S.prototype.handlePage=function(O,b,E,P,f,p){if(O&&$(O,b,this.useHttpPaginatedResponse)){x.default.logAction(x.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+n.inspectError(O)),p==null||p(O);return}var a,o,d;try{a=f==A.default.NoContent?[]:this.bodyHandler(b,E||{},P)}catch(l){p==null||p(O||l);return}E&&(o=E.Link||E.link)&&(d=C(o)),this.useHttpPaginatedResponse?p(null,new h(this,a,E||{},f,d,O)):p(null,new r(this,a,d))},S}(),r=function(){function S(O,b,E){var P=this;this.resource=O,this.items=b;var f=this;E&&("first"in E&&(this.first=function(p){if(!p&&f.resource.rest.options.promises)return n.promisify(f,"first",[]);f.get(E.first,p)}),"current"in E&&(this.current=function(p){if(!p&&f.resource.rest.options.promises)return n.promisify(f,"current",[]);f.get(E.current,p)}),this.next=function(p){if(!p&&f.resource.rest.options.promises)return n.promisify(f,"next",[]);"next"in E?f.get(E.next,p):p(null,null)},this.hasNext=function(){return"next"in E},this.isLast=function(){var p;return!(!((p=P.hasNext)===null||p===void 0)&&p.call(P))})}return S.prototype.get=function(O,b){var E=this.resource;y.default.get(E.rest,E.path,E.headers,O,E.envelope,function(P,f,p,a,o){E.handlePage(P,f,p,a,o,b)})},S}();i.PaginatedResult=r;var h=function(S){v.__extends(O,S);function O(b,E,P,f,p,a){var o=S.call(this,b,E,p)||this;return o.statusCode=f,o.success=f<300&&f>=200,o.headers=P,o.errorCode=a&&a.code,o.errorMessage=a&&a.message,o}return O.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},O}(r);i.HttpPaginatedResponse=h,i.default=_},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0}),i.isRetriable=void 0;var v=u(0),n=v.__importDefault(u(4)),x={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},y={disconnected:function(){return n.default.fromValues({statusCode:400,code:x.DISCONNECTED,message:"Connection to server temporarily unavailable"})},suspended:function(){return n.default.fromValues({statusCode:400,code:x.SUSPENDED,message:"Connection to server unavailable"})},failed:function(){return n.default.fromValues({statusCode:400,code:x.FAILED,message:"Connection failed or disconnected by server"})},closing:function(){return n.default.fromValues({statusCode:400,code:x.CLOSING,message:"Connection closing"})},closed:function(){return n.default.fromValues({statusCode:400,code:x.CLOSED,message:"Connection closed"})},unknownConnectionErr:function(){return n.default.fromValues({statusCode:500,code:x.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"})},unknownChannelErr:function(){return n.default.fromValues({statusCode:500,code:x.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})}};function A(m){return!m.statusCode||!m.code||m.statusCode>=500?!0:Object.values(x).includes(m.code)}i.isRetriable=A,i.default=y},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v;(function(n){n[n.REQ_SEND=0]="REQ_SEND",n[n.REQ_RECV=1]="REQ_RECV",n[n.REQ_RECV_POLL=2]="REQ_RECV_POLL",n[n.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"})(v||(v={})),i.default=v},function(w,i,u){(function(v,n){w.exports=n(u(6),u(5),u(58),u(11),u(40),u(32),u(25),u(27),u(28),u(59),u(60))})(this,function(v){return v})},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importDefault(u(2)),x=function(){function y(A){this.members=A||[]}return y.prototype.call=function(){for(var A=[],m=0;m<arguments.length;m++)A[m]=arguments[m];for(var C=0,$=this.members;C<$.length;C++){var _=$[C];if(_)try{_.apply(void 0,A)}catch(r){n.default.logAction(n.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+r+"; stack = "+r.stack)}}},y.prototype.push=function(){for(var A,m=[],C=0;C<arguments.length;C++)m[C]=arguments[C];(A=this.members).push.apply(A,m)},y.create=function(A){var m=new y(A);return Object.assign(function(){for(var C=[],$=0;$<arguments.length;$++)C[$]=arguments[$];return m.call.apply(m,C)},{push:function(C){return m.push(C)}})},y}();i.default=x},function(w,i,u){(function(v,n){w.exports=n(u(6))})(this,function(v){(function(){var n=v,x=n.lib,y=x.Base,A=n.enc,m=A.Utf8,C=n.algo;C.HMAC=y.extend({init:function($,_){$=this._hasher=new $.init,typeof _=="string"&&(_=m.parse(_));var r=$.blockSize,h=r*4;_.sigBytes>h&&(_=$.finalize(_)),_.clamp();for(var S=this._oKey=_.clone(),O=this._iKey=_.clone(),b=S.words,E=O.words,P=0;P<r;P++)b[P]^=1549556828,E[P]^=909522486;S.sigBytes=O.sigBytes=h,this.reset()},reset:function(){var $=this._hasher;$.reset(),$.update(this._iKey)},update:function($){return this._hasher.update($),this},finalize:function($){var _=this._hasher,r=_.finalize($);_.reset();var h=_.finalize(this._oKey.clone().concat(r));return h}})})()})},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importDefault(u(10)),x=v.__importStar(u(1)),y=v.__importDefault(u(7)),A=v.__importDefault(u(2)),m=v.__importDefault(u(21)),C=v.__importDefault(u(4)),$=v.__importDefault(u(3)),_=n.default.Action,r=n.default.fromValues({action:_.CLOSE}),h=n.default.fromValues({action:_.DISCONNECT}),S=function(O){v.__extends(b,O);function b(E,P,f,p){var a=O.call(this)||this;return p&&(f.format=void 0,f.heartbeats=!0),a.connectionManager=E,E.registerProposedTransport(a),a.auth=P,a.params=f,a.timeouts=f.options.timeouts,a.format=f.format,a.isConnected=!1,a.isFinished=!1,a.isDisposed=!1,a.maxIdleInterval=null,a.idleTimer=null,a.lastActivity=null,a}return b.prototype.connect=function(){},b.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",m.default.closed())},b.prototype.disconnect=function(E){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",E||m.default.disconnected())},b.prototype.fail=function(E){this.isConnected&&this.requestDisconnect(),this.finish("failed",E||m.default.failed())},b.prototype.finish=function(E,P){var f;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((f=this.idleTimer)!==null&&f!==void 0?f:void 0),this.idleTimer=null,this.emit(E,P),this.dispose())},b.prototype.onProtocolMessage=function(E){switch(A.default.shouldLog(A.default.LOG_MICRO)&&A.default.logAction(A.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+n.default.stringify(E)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),E.action){case _.HEARTBEAT:A.default.logAction(A.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",E.id);break;case _.CONNECTED:this.onConnect(E),this.emit("connected",E.error,E.connectionId,E.connectionDetails,E);break;case _.CLOSED:this.onClose(E);break;case _.DISCONNECTED:this.onDisconnect(E);break;case _.ACK:this.emit("ack",E.msgSerial,E.count);break;case _.NACK:this.emit("nack",E.msgSerial,E.count,E.error);break;case _.SYNC:this.connectionManager.onChannelMessage(E,this);break;case _.ACTIVATE:break;case _.AUTH:this.auth.authorize(function(P){P&&A.default.logAction(A.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+x.inspectError(P))});break;case _.ERROR:if(A.default.logAction(A.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+$.default.Config.inspect(E.error)+(E.channel?", channel: "+E.channel:"")),E.channel===void 0){this.onFatalError(E);break}this.connectionManager.onChannelMessage(E,this);break;default:this.connectionManager.onChannelMessage(E,this)}},b.prototype.onConnect=function(E){if(this.isConnected=!0,!E.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var P=E.connectionDetails.maxIdleInterval;P&&(this.maxIdleInterval=P+this.timeouts.realtimeRequestTimeout,this.onActivity())},b.prototype.onDisconnect=function(E){var P=E&&E.error;A.default.logAction(A.default.LOG_MINOR,"Transport.onDisconnect()","err = "+x.inspectError(P)),this.finish("disconnected",P)},b.prototype.onFatalError=function(E){var P=E&&E.error;A.default.logAction(A.default.LOG_MINOR,"Transport.onFatalError()","err = "+x.inspectError(P)),this.finish("failed",P)},b.prototype.onClose=function(E){var P=E&&E.error;A.default.logAction(A.default.LOG_MINOR,"Transport.onClose()","err = "+x.inspectError(P)),this.finish("closed",P)},b.prototype.requestClose=function(){A.default.logAction(A.default.LOG_MINOR,"Transport.requestClose()",""),this.send(r)},b.prototype.requestDisconnect=function(){A.default.logAction(A.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(h)},b.prototype.ping=function(E){var P={action:n.default.Action.HEARTBEAT};E&&(P.id=E),this.send(n.default.fromValues(P))},b.prototype.dispose=function(){A.default.logAction(A.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},b.prototype.onActivity=function(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=x.now(),this.setIdleTimer(this.maxIdleInterval+100))},b.prototype.setIdleTimer=function(E){var P=this;this.idleTimer||(this.idleTimer=setTimeout(function(){P.onIdleTimerExpire()},E))},b.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var E=x.now()-this.lastActivity,P=this.maxIdleInterval-E;if(P<=0){var f="No activity seen from realtime in "+E+"ms; assuming connection has dropped";A.default.logAction(A.default.LOG_ERROR,"Transport.onIdleTimerExpire()",f),this.disconnect(new C.default(f,80003,408))}else this.setIdleTimer(P+100)},b.tryConnect=function(E,P,f,p,a){var o=new E(P,f,p),d,l=function(R){clearTimeout(d),a({event:this.event,error:R})},g=P.options.timeouts.realtimeRequestTimeout;d=setTimeout(function(){o.off(["preconnect","disconnected","failed"]),o.dispose(),l.call({event:"disconnected"},new C.default("Timeout waiting for transport to indicate itself viable",5e4,500))},g),o.on(["failed","disconnected"],l),o.on("preconnect",function(){A.default.logAction(A.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+o),clearTimeout(d),o.off(["failed","disconnected"],l),a(null,o)}),o.connect()},b}(y.default);i.default=S},function(w,i,u){(function(v,n){w.exports=n(u(6),u(40),u(25))})(this,function(v){return function(){var n=v,x=n.lib,y=x.Base,A=x.WordArray,m=n.algo,C=m.MD5,$=m.EvpKDF=y.extend({cfg:y.extend({keySize:128/32,hasher:C,iterations:1}),init:function(_){this.cfg=this.cfg.extend(_)},compute:function(_,r){for(var h,S=this.cfg,O=S.hasher.create(),b=A.create(),E=b.words,P=S.keySize,f=S.iterations;E.length<P;){h&&O.update(h),h=O.update(_).finalize(r),O.reset();for(var p=1;p<f;p++)h=O.finalize(h),O.reset();b.concat(h)}return b.sigBytes=P*4,b}});n.EvpKDF=function(_,r,h){return $.create(h).compute(_,r)}}(),v.EvpKDF})},function(w,i,u){(function(v,n){w.exports=n(u(6),u(27))})(this,function(v){v.lib.Cipher||function(n){var x=v,y=x.lib,A=y.Base,m=y.WordArray,C=y.BufferedBlockAlgorithm,$=x.enc;$.Utf8;var _=$.Base64,r=x.algo,h=r.EvpKDF,S=y.Cipher=C.extend({cfg:A.extend(),createEncryptor:function(k,T){return this.create(this._ENC_XFORM_MODE,k,T)},createDecryptor:function(k,T){return this.create(this._DEC_XFORM_MODE,k,T)},init:function(k,T,V){this.cfg=this.cfg.extend(V),this._xformMode=k,this._key=T,this.reset()},reset:function(){C.reset.call(this),this._doReset()},process:function(k){return this._append(k),this._process()},finalize:function(k){k&&this._append(k);var T=this._doFinalize();return T},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function k(T){return typeof T=="string"?R:d}return function(T){return{encrypt:function(V,F,M){return k(F).encrypt(T,V,F,M)},decrypt:function(V,F,M){return k(F).decrypt(T,V,F,M)}}}}()});y.StreamCipher=S.extend({_doFinalize:function(){var k=this._process(!0);return k},blockSize:1});var O=x.mode={},b=y.BlockCipherMode=A.extend({createEncryptor:function(k,T){return this.Encryptor.create(k,T)},createDecryptor:function(k,T){return this.Decryptor.create(k,T)},init:function(k,T){this._cipher=k,this._iv=T}}),E=O.CBC=function(){var k=b.extend();k.Encryptor=k.extend({processBlock:function(V,F){var M=this._cipher,D=M.blockSize;T.call(this,V,F,D),M.encryptBlock(V,F),this._prevBlock=V.slice(F,F+D)}}),k.Decryptor=k.extend({processBlock:function(V,F){var M=this._cipher,D=M.blockSize,U=V.slice(F,F+D);M.decryptBlock(V,F),T.call(this,V,F,D),this._prevBlock=U}});function T(V,F,M){var D,U=this._iv;U?(D=U,this._iv=n):D=this._prevBlock;for(var B=0;B<M;B++)V[F+B]^=D[B]}return k}(),P=x.pad={},f=P.Pkcs7={pad:function(k,T){for(var V=T*4,F=V-k.sigBytes%V,M=F<<24|F<<16|F<<8|F,D=[],U=0;U<F;U+=4)D.push(M);var B=m.create(D,F);k.concat(B)},unpad:function(k){var T=k.words[k.sigBytes-1>>>2]&255;k.sigBytes-=T}};y.BlockCipher=S.extend({cfg:S.cfg.extend({mode:E,padding:f}),reset:function(){var k;S.reset.call(this);var T=this.cfg,V=T.iv,F=T.mode;this._xformMode==this._ENC_XFORM_MODE?k=F.createEncryptor:(k=F.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==k?this._mode.init(this,V&&V.words):(this._mode=k.call(F,this,V&&V.words),this._mode.__creator=k)},_doProcessBlock:function(k,T){this._mode.processBlock(k,T)},_doFinalize:function(){var k,T=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(T.pad(this._data,this.blockSize),k=this._process(!0)):(k=this._process(!0),T.unpad(k)),k},blockSize:128/32});var p=y.CipherParams=A.extend({init:function(k){this.mixIn(k)},toString:function(k){return(k||this.formatter).stringify(this)}}),a=x.format={},o=a.OpenSSL={stringify:function(k){var T,V=k.ciphertext,F=k.salt;return F?T=m.create([1398893684,1701076831]).concat(F).concat(V):T=V,T.toString(_)},parse:function(k){var T,V=_.parse(k),F=V.words;return F[0]==1398893684&&F[1]==1701076831&&(T=m.create(F.slice(2,4)),F.splice(0,4),V.sigBytes-=16),p.create({ciphertext:V,salt:T})}},d=y.SerializableCipher=A.extend({cfg:A.extend({format:o}),encrypt:function(k,T,V,F){F=this.cfg.extend(F);var M=k.createEncryptor(V,F),D=M.finalize(T),U=M.cfg;return p.create({ciphertext:D,key:V,iv:U.iv,algorithm:k,mode:U.mode,padding:U.padding,blockSize:k.blockSize,formatter:F.format})},decrypt:function(k,T,V,F){F=this.cfg.extend(F),T=this._parse(T,F.format);var M=k.createDecryptor(V,F).finalize(T.ciphertext);return M},_parse:function(k,T){return typeof k=="string"?T.parse(k,this):k}}),l=x.kdf={},g=l.OpenSSL={execute:function(k,T,V,F){F||(F=m.random(64/8));var M=h.create({keySize:T+V}).compute(k,F),D=m.create(M.words.slice(T),V*4);return M.sigBytes=T*4,p.create({key:M,iv:D,salt:F})}},R=y.PasswordBasedCipher=d.extend({cfg:d.cfg.extend({kdf:g}),encrypt:function(k,T,V,F){F=this.cfg.extend(F);var M=F.kdf.execute(V,k.keySize,k.ivSize);F.iv=M.iv;var D=d.encrypt.call(this,k,T,M.key,F);return D.mixIn(M),D},decrypt:function(k,T,V,F){F=this.cfg.extend(F),T=this._parse(T,F.format);var M=F.kdf.execute(V,k.keySize,k.ivSize,T.salt);F.iv=M.iv;var D=d.decrypt.call(this,k,T,M.key,F);return D}})}()})},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0}),i.Request=i.createRequest=void 0;var v=u(0),n=v.__importStar(u(1)),x=v.__importDefault(u(12)),y=v.__importDefault(u(3)),A=v.__importDefault(u(7)),m=u(4),C=v.__importDefault(u(8)),$=v.__importDefault(u(2)),_=v.__importDefault(u(22)),r=n.getGlobalObject(),h=function(){},S=r._ablyjs_jsonp={};S._=function(a){return S["_"+a]||h};var O=1,b="jsonp";function E(a,o,d,l,g,R,k){return R=R||C.default.TIMEOUTS,new f(void 0,a,o,n.copy(d),l,g,R,k)}i.createRequest=E;var P=function(a){v.__extends(o,a);function o(d,l,g){var R=a.call(this,d,l,g)||this;return R.shortName=b,g.stream=!1,R}return o.isAvailable=function(){return y.default.Config.jsonpSupported&&y.default.Config.allowComet},o.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},o.prototype.createRequest=function(d,l,g,R,k,T,V){return T=(this===null||this===void 0?void 0:this.timeouts)||T||C.default.TIMEOUTS,E(d,l,g,R,k,T,V)},o}(x.default),f=function(a){v.__extends(o,a);function o(d,l,g,R,k,T,V,F){var M=a.call(this)||this;return d===void 0&&(d=O++),M.id=d,M.uri=l,M.params=R||{},M.params.rnd=n.cheapRandStr(),g&&(g["X-Ably-Version"]&&(M.params.v=g["X-Ably-Version"]),g["X-Ably-Lib"]&&(M.params.lib=g["X-Ably-Lib"])),M.body=k,M.method=F,M.requestMode=T,M.timeouts=V,M.requestComplete=!1,M}return o.prototype.exec=function(){var d=this,l=this.id,g=this.body,R=this.method,k=this.uri,T=this.params;T.callback="_ablyjs_jsonp._("+l+")",T.envelope="jsonp",g&&(T.body=g),R&&R!=="get"&&(T.method=R);var V=this.script=document.createElement("script"),F=k+n.toQueryString(T);V.src=F,V.src.split("/").slice(-1)[0]!==F.split("/").slice(-1)[0]&&$.default.logAction($.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),V.async=!0,V.type="text/javascript",V.charset="UTF-8",V.onerror=function(U){d.complete(new m.PartialErrorInfo("JSONP script error (event: "+y.default.Config.inspect(U)+")",null,400))},S["_"+l]=function(U){if(U.statusCode){var B=U.response;if(U.statusCode==204)d.complete(null,null,null,U.statusCode);else if(!B)d.complete(new m.PartialErrorInfo("Invalid server response: no envelope detected",null,500));else if(U.statusCode<400||n.isArray(B))d.complete(null,B,U.headers,U.statusCode);else{var Q=B.error||new m.PartialErrorInfo("Error response received from server",null,U.statusCode);d.complete(Q)}}else d.complete(null,U)};var M=this.requestMode==_.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),M);var D=document.getElementsByTagName("head")[0];D.insertBefore(V,D.firstChild)},o.prototype.complete=function(d,l,g,R){if(g=g||{},!this.requestComplete){this.requestComplete=!0;var k=void 0;l&&(k=typeof l=="string"?"text/plain":"application/json",g["content-type"]=k,this.emit("data",l)),this.emit("complete",d,l,g,!0,R),this.dispose()}},o.prototype.abort=function(){this.dispose()},o.prototype.dispose=function(){var d=this.timer;d&&(clearTimeout(d),this.timer=null);var l=this.script;l.parentNode&&l.parentNode.removeChild(l),delete S[this.id],this.emit("disposed")},o}(A.default);i.Request=f;function p(a){return r.JSONPTransport=P,P.isAvailable()&&(a.supportedTransports[b]=P),P}i.default=p},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importStar(u(1)),x=v.__importDefault(u(2)),y=v.__importDefault(u(8)),A=v.__importDefault(u(18)),m=v.__importDefault(u(46)),C=v.__importDefault(u(20)),$=v.__importDefault(u(33)),_=v.__importDefault(u(4)),r=v.__importDefault(u(49)),h=v.__importDefault(u(19)),S=v.__importDefault(u(3)),O=v.__importDefault(u(9)),b=v.__importDefault(u(16)),E=v.__importDefault(u(15)),P=function(){},f=function(){function a(o){if(!o){var d="no options provided";throw x.default.logAction(x.default.LOG_ERROR,"Rest()",d),new Error(d)}var l=y.default.objectifyOptions(o);l.log?(x.default.setLog(l.log.level,l.log.handler),x.default.deprecated("The `log` client option","Equivalent functionality is provided by the `logLevel` and `logHandler` client options. Update your client options code of the form `{ log: { level: logLevel, handler: logHandler } }` to instead be `{ logLevel, logHandler }`.")):x.default.setLog(l.logLevel,l.logHandler),x.default.logAction(x.default.LOG_MICRO,"Rest()","initialized with clientOptions "+S.default.Config.inspect(o));var g=this.options=y.default.normaliseOptions(l);if(g.key){var R=g.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!R){var d="invalid key parameter";throw x.default.logAction(x.default.LOG_ERROR,"Rest()",d),new _.default(d,40400,404)}g.keyName=R[1],g.keySecret=R[2]}if("clientId"in g)if(typeof g.clientId=="string"||g.clientId===null){if(g.clientId==="*")throw new _.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new _.default("clientId must be either a string or null",40012,400);x.default.logAction(x.default.LOG_MINOR,"Rest()","started; version = "+y.default.version),this.baseUri=this.authority=function(k){return y.default.getHttpScheme(g)+k+":"+y.default.getPort(g,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new S.default.Http(g),this.auth=new A.default(this,g),this.channels=new p(this),this.push=new m.default(this)}return a.prototype.stats=function(o,d){if(d===void 0)if(typeof o=="function")d=o,o=null;else{if(this.options.promises)return n.promisify(this,"stats",[o]);d=P}var l=n.defaultGetHeaders(this.options),g=this.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,R=this.http.supportsLinkHeaders?void 0:g;this.options.headers&&n.mixin(l,this.options.headers),new C.default(this,"/stats",l,R,function(k,T,V){for(var F=V?k:JSON.parse(k),M=0;M<F.length;M++)F[M]=r.default.fromValues(F[M]);return F}).get(o,d)},a.prototype.time=function(o,d){var l=this;if(d===void 0){if(typeof o=="function")d=o,o=null;else if(this.options.promises)return n.promisify(this,"time",[o])}var g=d||P,R=n.defaultGetHeaders(this.options);this.options.headers&&n.mixin(R,this.options.headers);var k=function(T){return l.authority(T)+"/time"};this.http.do(h.default.Get,this,k,R,null,o,function(T,V,F,M){if(T){g(T);return}M||(V=JSON.parse(V));var D=V[0];if(!D){g(new _.default("Internal error (unexpected result type from GET /time)",5e4,500));return}l.serverTimeOffset=D-n.now(),g(null,D)})},a.prototype.request=function(o,d,l,g,R,k){var T=this.options.useBinaryProtocol,V=T?S.default.Config.msgpack.encode:JSON.stringify,F=T?S.default.Config.msgpack.decode:JSON.parse,M=T?n.Format.msgpack:n.Format.json,D=this.http.supportsLinkHeaders?void 0:M;l=l||{};var U=o.toLowerCase(),B=U=="get"?n.defaultGetHeaders(this.options,M):n.defaultPostHeaders(this.options,M);if(k===void 0){if(this.options.promises)return n.promisify(this,"request",[o,d,l,g,R]);k=P}typeof g!="string"&&(g=V(g)),this.options.headers&&n.mixin(B,this.options.headers),R&&n.mixin(B,R);var Q=new C.default(this,d,B,D,function(te,Y,q){return n.ensureArray(q?te:F(te))},!0);if(!n.arrIn(S.default.Http.methods,U))throw new _.default("Unsupported method "+U,40500,405);n.arrIn(S.default.Http.methodsWithBody,U)?Q[U](l,g,k):Q[U](l,k)},a.prototype.batchPublish=function(o,d){if(d===void 0){if(this.options.promises)return n.promisify(this,"batchPublish",[o]);d=P}var l=d,g,R;n.isArray(o)?(g=o,R=!1):(g=[o],R=!0);var k=this.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,T=n.defaultPostHeaders(this.options,k);this.options.headers&&n.mixin(T,this.options.headers);var V=n.encodeBody(g,k);E.default.post(this,"/messages",V,T,{newBatchResponse:"true"},null,function(F,M,D,U){if(F){l(F);return}var B=U?M:n.decodeBody(M,k);R?l(null,B[0]):l(null,B)})},a.prototype.batchPresence=function(o,d){if(d===void 0){if(this.options.promises)return n.promisify(this,"batchPresence",[o]);d=P}var l=d,g=this.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,R=n.defaultPostHeaders(this.options,g);this.options.headers&&n.mixin(R,this.options.headers);var k=o.join(",");E.default.get(this,"/presence",R,{newBatchResponse:"true",channels:k},null,function(T,V,F,M){if(T){l(T);return}var D=M?V:n.decodeBody(V,g);l(null,D)})},a.prototype.setLog=function(o){x.default.setLog(o.level,o.handler)},a.Promise=function(o){return o=y.default.objectifyOptions(o),o.promises=!0,new a(o)},a.Callbacks=a,a.Platform=S.default,a.Message=O.default,a.PresenceMessage=b.default,a}(),p=function(){function a(o){this.rest=o,this.all=Object.create(null)}return a.prototype.get=function(o,d){o=String(o);var l=this.all[o];return l?d&&l.setOptions(d):this.all[o]=l=new $.default(this.rest,o,d),l},a.prototype.release=function(o){delete this.all[String(o)]},a}();i.default=f},function(w,i,u){(function(v,n){w.exports=n(u(6))})(this,function(v){return v.enc.Utf8})},function(w,i,u){(function(v,n){w.exports=n(u(6))})(this,function(v){return function(n){var x=v,y=x.lib,A=y.WordArray,m=y.Hasher,C=x.algo,$=[],_=[];(function(){function S(P){for(var f=n.sqrt(P),p=2;p<=f;p++)if(!(P%p))return!1;return!0}function O(P){return(P-(P|0))*4294967296|0}for(var b=2,E=0;E<64;)S(b)&&(E<8&&($[E]=O(n.pow(b,1/2))),_[E]=O(n.pow(b,1/3)),E++),b++})();var r=[],h=C.SHA256=m.extend({_doReset:function(){this._hash=new A.init($.slice(0))},_doProcessBlock:function(S,O){for(var b=this._hash.words,E=b[0],P=b[1],f=b[2],p=b[3],a=b[4],o=b[5],d=b[6],l=b[7],g=0;g<64;g++){if(g<16)r[g]=S[O+g]|0;else{var R=r[g-15],k=(R<<25|R>>>7)^(R<<14|R>>>18)^R>>>3,T=r[g-2],V=(T<<15|T>>>17)^(T<<13|T>>>19)^T>>>10;r[g]=k+r[g-7]+V+r[g-16]}var F=a&o^~a&d,M=E&P^E&f^P&f,D=(E<<30|E>>>2)^(E<<19|E>>>13)^(E<<10|E>>>22),U=(a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25),B=l+U+F+_[g]+r[g],Q=D+M;l=d,d=o,o=a,a=p+B|0,p=f,f=P,P=E,E=B+Q|0}b[0]=b[0]+E|0,b[1]=b[1]+P|0,b[2]=b[2]+f|0,b[3]=b[3]+p|0,b[4]=b[4]+a|0,b[5]=b[5]+o|0,b[6]=b[6]+d|0,b[7]=b[7]+l|0},_doFinalize:function(){var S=this._data,O=S.words,b=this._nDataBytes*8,E=S.sigBytes*8;return O[E>>>5]|=128<<24-E%32,O[(E+64>>>9<<4)+14]=n.floor(b/4294967296),O[(E+64>>>9<<4)+15]=b,S.sigBytes=O.length*4,this._process(),this._hash},clone:function(){var S=m.clone.call(this);return S._hash=this._hash.clone(),S}});x.SHA256=m._createHelper(h),x.HmacSHA256=m._createHmacHelper(h)}(Math),v.SHA256})},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importStar(u(1)),x=v.__importDefault(u(7)),y=v.__importDefault(u(2)),A=v.__importDefault(u(34)),m=v.__importDefault(u(9)),C=v.__importDefault(u(4)),$=v.__importDefault(u(20)),_=v.__importDefault(u(15)),r=v.__importDefault(u(3));function h(){}var S=9;function O(P){return n.arrEvery(P,function(f){return!f.id})}function b(P){var f=P||{};if(f.cipher){if(!r.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var p=r.default.Crypto.getCipher(f.cipher);f.cipher=p.cipherParams,f.channelCipher=p.cipher}else"cipher"in f&&(f.cipher=void 0,f.channelCipher=null);return f}var E=function(P){v.__extends(f,P);function f(p,a,o){var d=P.call(this)||this;return y.default.logAction(y.default.LOG_MINOR,"Channel()","started; name = "+a),d.rest=p,d.name=a,d.basePath="/channels/"+encodeURIComponent(a),d.presence=new A.default(d),d.channelOptions=b(o),d}return f.prototype.setOptions=function(p){this.channelOptions=b(p)},f.prototype.history=function(p,a){if(y.default.logAction(y.default.LOG_MICRO,"Channel.history()","channel = "+this.name),a===void 0)if(typeof p=="function")a=p,p=null;else{if(this.rest.options.promises)return n.promisify(this,"history",arguments);a=h}this._history(p,a)},f.prototype._history=function(p,a){var o=this.rest,d=o.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,l=this.rest.http.supportsLinkHeaders?void 0:d,g=n.defaultGetHeaders(o.options,d);o.options.headers&&n.mixin(g,o.options.headers);var R=this.channelOptions;new $.default(o,this.basePath+"/messages",g,l,function(k,T,V){return m.default.fromResponseBody(k,R,V?void 0:d)}).get(p,a)},f.prototype.publish=function(){var p=this,a=arguments.length,o=arguments[0],d=arguments[1],l=arguments[a-1],g,R;if(typeof l!="function"){if(this.rest.options.promises)return n.promisify(this,"publish",arguments);l=h}if(typeof o=="string"||o===null)g=[m.default.fromValues({name:o,data:d})],R=arguments[2];else if(n.isObject(o))g=[m.default.fromValues(o)],R=arguments[1];else if(n.isArray(o))g=m.default.fromValuesArray(o),R=arguments[1];else throw new C.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);(typeof R!="object"||!R)&&(R={});var k=this.rest,T=k.options,V=T.useBinaryProtocol?n.Format.msgpack:n.Format.json,F=k.options.idempotentRestPublishing,M=n.defaultPostHeaders(k.options,V);if(T.headers&&n.mixin(M,T.headers),F&&O(g)){var D=n.randomString(S);n.arrForEach(g,function(U,B){U.id=D+":"+B.toString()})}m.default.encodeArray(g,this.channelOptions,function(U){if(U){l(U);return}var B=m.default.getMessagesSize(g),Q=T.maxMessageSize;if(B>Q){l(new C.default("Maximum size of messages that can be published at once exceeded ( was "+B+" bytes; limit is "+Q+" bytes)",40009,400));return}p._publish(m.default.serialize(g,V),M,R,l)})},f.prototype._publish=function(p,a,o,d){_.default.post(this.rest,this.basePath+"/messages",p,a,o,null,d)},f.prototype.status=function(p){if(typeof p!="function"&&this.rest.options.promises)return n.promisify(this,"status",[]);var a=this.rest.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,o=n.defaultPostHeaders(this.rest.options,a);_.default.get(this.rest,this.basePath,o,{},a,p||h)},f}(x.default);i.default=E},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importStar(u(1)),x=v.__importDefault(u(7)),y=v.__importDefault(u(2)),A=v.__importDefault(u(20)),m=v.__importDefault(u(16));function C(){}var $=function(_){v.__extends(r,_);function r(h){var S=_.call(this)||this;return S.channel=h,S.basePath=h.basePath+"/presence",S}return r.prototype.get=function(h,S){if(y.default.logAction(y.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),S===void 0)if(typeof h=="function")S=h,h=null;else{if(this.channel.rest.options.promises)return n.promisify(this,"get",arguments);S=C}var O=this.channel.rest,b=O.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,E=this.channel.rest.http.supportsLinkHeaders?void 0:b,P=n.defaultGetHeaders(O.options,b);O.options.headers&&n.mixin(P,O.options.headers);var f=this.channel.channelOptions;new A.default(O,this.basePath,P,E,function(p,a,o){return m.default.fromResponseBody(p,f,o?void 0:b)}).get(h,S)},r.prototype.history=function(h,S){return y.default.logAction(y.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(h,S)},r.prototype._history=function(h,S){if(S===void 0)if(typeof h=="function")S=h,h=null;else{if(this.channel.rest.options.promises)return n.promisify(this,"_history",[h]);S=C}var O=this.channel.rest,b=O.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,E=this.channel.rest.http.supportsLinkHeaders?void 0:b,P=n.defaultGetHeaders(O.options,b);O.options.headers&&n.mixin(P,O.options.headers);var f=this.channel.channelOptions;new A.default(O,this.basePath+"/history",P,E,function(p,a,o){return m.default.fromResponseBody(p,f,o?void 0:b)}).get(h,S)},r}(x.default);i.default=$},function(w,i,u){(function(v){Object.defineProperty(i,"__esModule",{value:!0}),i.TransportParams=void 0;var n=u(0),x=n.__importDefault(u(10)),y=n.__importStar(u(1)),A=n.__importStar(u(52)),m=n.__importStar(u(8)),C=n.__importDefault(u(3)),$=n.__importDefault(u(7)),_=n.__importDefault(u(36)),r=n.__importDefault(u(2)),h=n.__importDefault(u(37)),S=n.__importStar(u(21)),O=n.__importStar(u(4)),b=n.__importDefault(u(18)),E=n.__importDefault(u(9)),P=n.__importDefault(u(24)),f=n.__importDefault(u(53)),p=n.__importDefault(u(26)),a=n.__importDefault(u(14)),o=function(){var te;return typeof C.default.WebStorage<"u"&&((te=C.default.WebStorage)===null||te===void 0?void 0:te.localSupported)},d=function(){var te;return typeof C.default.WebStorage<"u"&&((te=C.default.WebStorage)===null||te===void 0?void 0:te.sessionSupported)},l=x.default.Action,g=function(){},R="ably-transport-preference",k="ably-connection-recovery";function T(){var te,Y;return d()&&((Y=(te=C.default.WebStorage)===null||te===void 0?void 0:te.getSession)===null||Y===void 0?void 0:Y.call(te,k))}function V(te){var Y,q;return d()&&((q=(Y=C.default.WebStorage)===null||Y===void 0?void 0:Y.setSession)===null||q===void 0?void 0:q.call(Y,k,te))}function F(){var te,Y;return d()&&((Y=(te=C.default.WebStorage)===null||te===void 0?void 0:te.removeSession)===null||Y===void 0?void 0:Y.call(te,k))}function M(te,Y){return y.arrIndexOf(C.default.Defaults.transportPreferenceOrder,te.shortName)>y.arrIndexOf(C.default.Defaults.transportPreferenceOrder,Y.shortName)}function D(te,Y,q){var j;if(te.channel!==Y.channel||(j=te.action)!==l.PRESENCE&&j!==l.MESSAGE||j!==Y.action)return!1;var G=j===l.PRESENCE?"presence":"messages",W=te[G].concat(Y[G]),Z=E.default.getMessagesSize(W);return Z>q||!y.allSame(W,"clientId")||!y.arrEvery(W,function(re){return!re.id})?!1:(te[G]=W,!0)}function U(te){try{return JSON.parse(te)}catch{return null}}var B=function(){function te(Y,q,j,G){this.options=Y,this.host=q,this.mode=j,this.connectionKey=G,this.format=Y.useBinaryProtocol?y.Format.msgpack:y.Format.json}return te.prototype.getConnectParams=function(Y){var q=Y?y.copy(Y):{},j=this.options;switch(this.mode){case"upgrade":q.upgrade=this.connectionKey;break;case"resume":q.resume=this.connectionKey;break;case"recover":{var G=U(j.recover);G&&(q.recover=G.connectionKey);break}}return j.clientId!==void 0&&(q.clientId=j.clientId),j.echoMessages===!1&&(q.echo="false"),this.format!==void 0&&(q.format=this.format),this.stream!==void 0&&(q.stream=this.stream),this.heartbeats!==void 0&&(q.heartbeats=this.heartbeats),q.v=m.default.protocolVersion,q.agent=(0,m.getAgentString)(this.options),j.transportParams!==void 0&&y.mixin(q,j.transportParams),q},te.prototype.toString=function(){var Y="[mode="+this.mode;return this.host&&(Y+=",host="+this.host),this.connectionKey&&(Y+=",connectionKey="+this.connectionKey),this.format&&(Y+=",format="+this.format),Y+="]",Y},te}();i.TransportParams=B;var Q=function(te){n.__extends(Y,te);function Y(q,j){var G=te.call(this)||this;G.disconnectedRetryCount=0,Y.initTransports(),G.realtime=q,G.options=j;var W=j.timeouts,Z=W.preferenceConnectTimeout+W.realtimeRequestTimeout;if(G.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:Z,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:W.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:W.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:W.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},G.state=G.states.initialized,G.errorReason=null,G.queuedMessages=new _.default,G.msgSerial=0,G.connectionDetails=void 0,G.connectionId=void 0,G.connectionKey=void 0,G.connectionStateTtl=W.connectionStateTtl,G.maxIdleInterval=null,G.transports=y.intersect(j.transports||m.default.defaultTransports,Y.supportedTransports),G.baseTransport=y.intersect(m.default.baseTransportOrder,G.transports)[0],G.upgradeTransports=y.intersect(G.transports,m.default.upgradeTransports),G.transportPreference=null,G.httpHosts=m.default.getHosts(j),G.activeProtocol=null,G.proposedTransports=[],G.pendingTransports=[],G.host=null,G.lastAutoReconnectAttempt=null,G.lastActivity=null,G.forceFallbackHost=!1,G.connectCounter=0,r.default.logAction(r.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),r.default.logAction(r.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(j.transports||m.default.defaultTransports)+"]"),r.default.logAction(r.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+G.transports+"]"),r.default.logAction(r.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+G.httpHosts+"]"),!G.transports.length){var re="no requested transports available";throw r.default.logAction(r.default.LOG_ERROR,"realtime.ConnectionManager()",re),new Error(re)}var ce=C.default.Config.addEventListener;return ce&&(d()&&typeof j.recover=="function"&&ce("beforeunload",G.persistConnection.bind(G)),j.closeOnUnload===!0&&ce("beforeunload",function(){r.default.logAction(r.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),G.requestState({state:"closing"})}),ce("online",function(){G.state==G.states.disconnected||G.state==G.states.suspended?(r.default.logAction(r.default.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),G.requestState({state:"connecting"})):G.state==G.states.connecting&&(G.pendingTransports.forEach(function(ve){ve.off()}),G.disconnectAllTransports(),G.startConnect())}),ce("offline",function(){G.state==G.states.connected&&(r.default.logAction(r.default.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),G.disconnectAllTransports())})),G}return Y.initTransports=function(){(0,f.default)(Y),y.arrForEach(C.default.Transports,function(q){q(Y)})},Y.prototype.createTransportParams=function(q,j){return new B(this.options,q,j,this.connectionKey)},Y.prototype.getTransportParams=function(q){var j=this,G=function(W){if(j.connectionKey){W("resume");return}if(typeof j.options.recover=="string"){W("recover");return}var Z=j.options.recover,re=T();if(re&&typeof Z=="function"){r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),Z(re,function(ce){ce?(j.options.recover=re.recoveryKey,W("recover")):W("clean")});return}W("clean")};G(function(W){var Z=j.createTransportParams(null,W);if(W==="recover"){r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+j.options.recover);var re=U(j.options.recover);re&&(j.msgSerial=re.msgSerial)}else r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+Z.toString());q(Z)})},Y.prototype.tryATransport=function(q,j,G){var W=this;r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+j),p.default.tryConnect(Y.supportedTransports[j],this,this.realtime.auth,q,function(Z,re){var ce=W.state;if(ce==W.states.closing||ce==W.states.closed||ce==W.states.failed){re&&(r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+ce.state+" while we were attempting the transport; closing "+re),re.close()),G(!0);return}if(Z){r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+j+" "+Z.event+", err: "+Z.error.toString()),b.default.isTokenErr(Z.error)&&!(W.errorReason&&b.default.isTokenErr(W.errorReason))?(W.errorReason=Z.error,W.realtime.auth._forceNewToken(null,null,function(ve){if(ve){W.actOnErrorFromAuthorize(ve);return}W.tryATransport(q,j,G)})):Z.event==="failed"?(W.notifyState({state:"failed",error:Z.error}),G(!0)):Z.event==="disconnected"&&((0,S.isRetriable)(Z.error)?G(!1):(W.notifyState({state:W.states.connecting.failState,error:Z.error}),G(!0)));return}r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+j+"; setting pending"),W.setTransportPending(re,q),G(null,re)})},Y.prototype.setTransportPending=function(q,j){var G=this,W=j.mode;r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+q+"; mode = "+W),y.arrDeleteValue(this.proposedTransports,q),this.pendingTransports.push(q);var Z=C.default.Defaults.transportPreferenceOrder[C.default.Defaults.transportPreferenceOrder.length-1];q.once("connected",function(ce,ve,ge){W=="upgrade"&&G.activeProtocol?q.shortName!==Z&&y.arrIn(G.getUpgradePossibilities(),Z)&&G.activeProtocol?setTimeout(function(){G.scheduleTransportActivation(ce,q,ve,ge)},G.options.timeouts.parallelUpgradeDelay):G.scheduleTransportActivation(ce,q,ve,ge):(G.activateTransport(ce,q,ve,ge),C.default.Config.nextTick(function(){G.connectImpl(j)})),W==="recover"&&G.options.recover&&(G.options.recover=null,G.unpersistConnection())});var re=this;q.on(["disconnected","closed","failed"],function(ce){re.deactivateTransport(q,this.event,ce)}),this.emit("transport.pending",q)},Y.prototype.scheduleTransportActivation=function(q,j,G,W){var Z=this,re=this.activeProtocol&&this.activeProtocol.getTransport(),ce=function(){j.disconnect(),y.arrDeleteValue(Z.pendingTransports,j)};if(this.state!==this.states.connected&&this.state!==this.states.connecting){r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+j.shortName),ce();return}if(re&&!M(j,re)){r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+j.shortName+" is no better than current active transport "+re.shortName+" - abandoning upgrade"),ce();return}r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+j);var ve=null;if(!j.isConnected){r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+j.shortName+"is no longer connected; abandoning upgrade"),ce();return}if(this.state===this.states.connected)r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),this.state=this.states.synchronizing,ve=this.activeProtocol;else if(this.state!==this.states.connecting){r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+j.shortName),ce();return}r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+j);var ge=function(){r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+j),j.send(x.default.fromValues({action:l.ACTIVATE})),Z.activateTransport(q,j,G,W),Z.state===Z.states.synchronizing?(r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+j),Z.state=Z.states.connected):r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+Z.state.state+", so leaving unchanged"),Z.state.sendEvents&&Z.sendQueuedMessages()};ve?ve.onceIdle(ge):ge()},Y.prototype.activateTransport=function(q,j,G,W){var Z=this;r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+j),q&&r.default.logAction(r.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+q),G&&r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+G),W&&r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(W)),this.persistTransportPreference(j);var re=this.state,ce=this.states.connected.state;if(r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+re.state),re.state==this.states.closing.state||re.state==this.states.closed.state||re.state==this.states.failed.state)return r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),j.disconnect(),!1;if(y.arrDeleteValue(this.pendingTransports,j),!j.isConnected)return r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+j+" since it appears to no longer be connected"),!1;var ve=this.activeProtocol;this.activeProtocol=new A.default(j),this.host=j.params.host;var ge=W.connectionKey;if(ge&&this.connectionKey!=ge&&this.setConnection(G,W,!!q),this.onConnectionDetailsUpdate(W,j),C.default.Config.nextTick(function(){j.on("connected",function(ue,Oe,Ie){Z.onConnectionDetailsUpdate(Ie,j),Z.emit("update",new h.default(ce,ce,null,ue))})}),re.state===this.states.connected.state?q&&(this.errorReason=this.realtime.connection.errorReason=q,this.emit("update",new h.default(ce,ce,null,q))):(this.notifyState({state:"connected",error:q}),this.errorReason=this.realtime.connection.errorReason=q||null),this.emit("transport.active",j),ve)if(ve.messageQueue.count()>0&&r.default.logAction(r.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+ve.transport.shortName+", new one is "+j.shortName+") finishing with "+ve.messageQueue.count()+" messages still pending"),ve.transport===j){var Ae="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+j.shortName+"; stack = "+new Error().stack;r.default.logAction(r.default.LOG_ERROR,"ConnectionManager.activateTransport()",Ae)}else ve.finish();return y.safeArrForEach(this.pendingTransports,function(ue){if(ue===j){var Oe="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+j.shortName+"; stack = "+new Error().stack;r.default.logAction(r.default.LOG_ERROR,"ConnectionManager.activateTransport()",Oe),y.arrDeleteValue(Z.pendingTransports,j)}else ue.disconnect()}),y.safeArrForEach(this.proposedTransports,function(ue){ue===j?(r.default.logAction(r.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+j.shortName+"; stack = "+new Error().stack),y.arrDeleteValue(Z.proposedTransports,j)):ue.dispose()}),!0},Y.prototype.deactivateTransport=function(q,j,G){var W=this.activeProtocol,Z=W&&W.getTransport()===q,re=y.arrDeleteValue(this.pendingTransports,q),ce=y.arrDeleteValue(this.proposedTransports,q),ve=this.noTransportsScheduledForActivation();if(r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+q),r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+j+(Z?"; was active":re?"; was pending":ce?"; was proposed":"")+(ve?"":"; another transport is scheduled for activation")),G&&G.message&&r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+G.message),Z&&(r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(W.getPendingMessages()),C.default.Config.nextTick(function(){W.clearPendingMessages()}),this.activeProtocol=this.host=null),this.emit("transport.inactive",q),Z&&ve||Z&&j==="failed"||j==="closed"||W===null&&re&&this.pendingTransports.length===0){if(j==="disconnected"&&G&&G.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:j,error:G,retryImmediately:!0});return}var ge=j==="failed"&&b.default.isTokenErr(G)?"disconnected":j;this.notifyState({state:ge,error:G});return}Z&&j==="disconnected"&&this.state!==this.states.synchronizing&&(r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:G}))},Y.prototype.noTransportsScheduledForActivation=function(){return y.isEmpty(this.pendingTransports)||this.pendingTransports.every(function(q){return!q.isConnected})},Y.prototype.setConnection=function(q,j,G){var W=this.connectionId,Z=W&&W!==q,re=!W&&G;(Z||re)&&(r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==q&&r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=q,this.realtime.connection.key=this.connectionKey=j.connectionKey},Y.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()},Y.prototype.createRecoveryKey=function(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null},Y.prototype.checkConnectionStateFreshness=function(){if(!(!this.lastActivity||!this.connectionId)){var q=y.now()-this.lastActivity;q>this.connectionStateTtl+this.maxIdleInterval&&(r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+q+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},Y.prototype.persistConnection=function(){if(d()){var q=this.createRecoveryKey();q&&V({recoveryKey:q,disconnectedAt:y.now(),location:v.location,clientId:this.realtime.auth.clientId})}},Y.prototype.unpersistConnection=function(){F()},Y.prototype.getError=function(){return this.errorReason||this.getStateError()},Y.prototype.getStateError=function(){var q,j;return(j=(q=S.default)[this.state.state])===null||j===void 0?void 0:j.call(q)},Y.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},Y.prototype.enactStateChange=function(q){var j=q.current==="failed"?r.default.LOG_ERROR:r.default.LOG_MAJOR;r.default.logAction(j,"Connection state",q.current+(q.reason?"; reason: "+q.reason:"")),r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+q.current+"; reason = "+(q.reason&&q.reason.message));var G=this.state=this.states[q.current];q.reason&&(this.errorReason=q.reason,this.realtime.connection.errorReason=q.reason),(G.terminal||G.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",q)},Y.prototype.startTransitionTimer=function(q){var j=this;r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+q.state),this.transitionTimer&&(r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(function(){j.transitionTimer&&(j.transitionTimer=null,r.default.logAction(r.default.LOG_MINOR,"ConnectionManager "+q.state+" timer expired","requesting new state: "+q.failState),j.notifyState({state:q.failState}))},q.retryDelay)},Y.prototype.cancelTransitionTimer=function(){r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},Y.prototype.startSuspendTimer=function(){var q=this;this.suspendTimer||(this.suspendTimer=setTimeout(function(){q.suspendTimer&&(q.suspendTimer=null,r.default.logAction(r.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),q.states.connecting.failState="suspended",q.notifyState({state:"suspended"}))},this.connectionStateTtl))},Y.prototype.checkSuspendTimer=function(q){q!=="disconnected"&&q!=="suspended"&&q!=="connecting"&&this.cancelSuspendTimer()},Y.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},Y.prototype.startRetryTimer=function(q){var j=this;this.retryTimer=setTimeout(function(){r.default.logAction(r.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),j.retryTimer=null,j.requestState({state:"connecting"})},q)},Y.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},Y.prototype.notifyState=function(q){var j=this,G,W,Z=q.state,re=Z==="disconnected"&&(this.state===this.states.connected||this.state===this.states.synchronizing||q.retryImmediately||this.state===this.states.connecting&&q.error&&b.default.isTokenErr(q.error)&&!(this.errorReason&&b.default.isTokenErr(this.errorReason)));if(r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+Z+(re?"; will retry connection immediately":"")),Z!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(q.state),(Z==="suspended"||Z==="connected")&&(this.disconnectedRetryCount=0),!this.state.terminal)){var ce=this.states[q.state],ve=ce.retryDelay;ce.state==="disconnected"&&(this.disconnectedRetryCount++,ve=y.getRetryTime(ce.retryDelay,this.disconnectedRetryCount));var ge=new h.default(this.state.state,ce.state,ve,q.error||((W=(G=S.default)[ce.state])===null||W===void 0?void 0:W.call(G)));if(re){var Ae=function(){j.state===j.states.disconnected&&(j.lastAutoReconnectAttempt=y.now(),j.requestState({state:"connecting"}))},ue=this.lastAutoReconnectAttempt&&y.now()-this.lastAutoReconnectAttempt+1;ue&&ue<1e3?(r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+ue+"ms ago, waiting another "+(1e3-ue)+"ms before trying again"),setTimeout(Ae,1e3-ue)):C.default.Config.nextTick(Ae)}else(Z==="disconnected"||Z==="suspended")&&this.startRetryTimer(ve);(Z==="disconnected"&&!re||Z==="suspended"||ce.terminal)&&C.default.Config.nextTick(function(){j.disconnectAllTransports()}),Z=="connected"&&!this.activeProtocol&&r.default.logAction(r.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(ge),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(Z,ge.reason),this.failQueuedMessages(ge.reason))}},Y.prototype.requestState=function(q){var j=this,G,W,Z=q.state;if(r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+Z+"; current state: "+this.state.state),Z!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(Z),!(Z=="connecting"&&this.state.state=="connected")&&!(Z=="closing"&&this.state.state=="closed"))){var re=this.states[Z],ce=new h.default(this.state.state,re.state,null,q.error||((W=(G=S.default)[re.state])===null||W===void 0?void 0:W.call(G)));this.enactStateChange(ce),Z=="connecting"&&C.default.Config.nextTick(function(){j.startConnect()}),Z=="closing"&&this.closeImpl()}},Y.prototype.startConnect=function(){var q=this;if(this.state!==this.states.connecting){r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}var j=this.realtime.auth,G=++this.connectCounter,W=function(){q.checkConnectionStateFreshness(),q.getTransportParams(function(re){if(re.mode==="recover"&&re.options.recover){var ce=U(re.options.recover);ce&&q.realtime.channels.recoverChannels(ce.channelSerials)}G===q.connectCounter&&q.connectImpl(re,G)})};if(r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),j.method==="basic")W();else{var Z=function(re){G===q.connectCounter&&(re?q.actOnErrorFromAuthorize(re):W())};this.errorReason&&b.default.isTokenErr(this.errorReason)?j._forceNewToken(null,null,Z):j._ensureValidAuthCredentials(!1,Z)}},Y.prototype.connectImpl=function(q,j){var G=this.state.state;G!==this.states.connecting.state&&G!==this.states.connected.state?r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+G):this.pendingTransports.length?r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):G==this.states.connected.state?this.upgradeIfNeeded(q):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(q,j):this.connectBase(q,j)},Y.prototype.connectPreference=function(q,j){var G=this,W=this.getTransportPreference(),Z=!1;y.arrIn(this.transports,W)||(this.unpersistTransportPreference(),this.connectImpl(q,j)),r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+W);var re=setTimeout(function(){Z=!0,G.state.state!==G.states.connected.state&&(r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+W+" failed; clearing preference and trying from scratch"),G.disconnectAllTransports(),G.unpersistTransportPreference()),G.connectImpl(q,j)},this.options.timeouts.preferenceConnectTimeout);q.host=this.httpHosts[0],this.tryATransport(q,W,function(ce,ve){clearTimeout(re),Z&&ve?(ve.off(),ve.disconnect(),y.arrDeleteValue(G.pendingTransports,ve)):!ve&&!ce&&(G.unpersistTransportPreference(),G.connectImpl(q,j))})},Y.prototype.connectBase=function(q,j){var G=this,W=function(ge){G.notifyState({state:G.states.connecting.failState,error:ge})},Z=this.httpHosts.slice(),re=function(ge,Ae){j===G.connectCounter&&!Ae&&!ge&&ve()};r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var ce=Z.shift();if(!ce){W(new O.default("Unable to connect (no available host)",80003,404));return}q.host=ce;var ve=function(){if(!Z.length){W(new O.default("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!G.realtime.http.checkConnectivity){W(new O.PartialErrorInfo("Internal error: Http.checkConnectivity not set",null,500));return}G.realtime.http.checkConnectivity(function(ge,Ae){if(j===G.connectCounter){if(ge){W(ge);return}if(!Ae){W(new O.default("Unable to connect (network unreachable)",80003,404));return}q.host=y.arrPopRandomElement(Z),G.tryATransport(q,G.baseTransport,re)}})};if(this.forceFallbackHost&&Z.length){this.forceFallbackHost=!1,ve();return}this.tryATransport(q,this.baseTransport,re)},Y.prototype.getUpgradePossibilities=function(){var q=this.activeProtocol.getTransport().shortName,j=y.arrIndexOf(this.upgradeTransports,q);return this.upgradeTransports.slice(j+1)},Y.prototype.upgradeIfNeeded=function(q){var j=this,G=this.getUpgradePossibilities();r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+C.default.Config.inspect(G)),G.length&&y.arrForEach(G,function(W){var Z=j.createTransportParams(q.host,"upgrade");j.tryATransport(Z,W,g)})},Y.prototype.closeImpl=function(){r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),y.safeArrForEach(this.pendingTransports,function(q){r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+q),q&&q.close()}),y.safeArrForEach(this.proposedTransports,function(q){r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+q),q&&q.dispose()}),this.activeProtocol&&(r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},Y.prototype.onAuthUpdated=function(q,j){var G=this,W;switch(this.state.state){case"connected":{if(r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var Z=this.activeProtocol.getTransport().params;C.default.Config.nextTick(function(){G.state.state==="connected"&&G.upgradeIfNeeded(Z)})}var re=(W=this.activeProtocol)===null||W===void 0?void 0:W.getTransport();re&&re.onAuthUpdated&&re.onAuthUpdated(q);var ce=x.default.fromValues({action:l.AUTH,auth:{accessToken:q.token}});this.send(ce);var ve=function(){G.off(ge),j(null,q)},ge=function(ue){ue.current==="failed"&&(G.off(ve),G.off(ge),j(ue.reason||G.getStateError()))};this.once("connectiondetails",ve),this.on("connectionstate",ge);break}case"connecting":r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");var Ae=function(ue){switch(ue.current){case"connected":G.off(Ae),j(null,q);break;case"failed":case"closed":case"suspended":G.off(Ae),j(ue.reason||G.getStateError());break}};this.on("connectionstate",Ae),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}},Y.prototype.disconnectAllTransports=function(q){r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(q?" except the active transport":"")),this.connectCounter++,y.safeArrForEach(this.pendingTransports,function(j){r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+j),j&&j.disconnect()}),this.pendingTransports=[],y.safeArrForEach(this.proposedTransports,function(j){r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+j),j&&j.dispose()}),this.proposedTransports=[],this.activeProtocol&&!q&&(r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},Y.prototype.send=function(q,j,G){G=G||g;var W=this.state;if(W.sendEvents){r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new A.PendingMessage(q,G));return}var Z=j&&W.queueEvents||W.forceQueueEvents;if(!Z){var re="rejecting event, queueEvent was "+j+", state was "+W.state;r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.send()",re),G(this.errorReason||new O.default(re,9e4,400));return}r.default.shouldLog(r.default.LOG_MICRO)&&r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+x.default.stringify(q)),this.queue(q,G)},Y.prototype.sendImpl=function(q){var j=q.message;q.ackRequired&&!q.sendAttempted&&(j.msgSerial=this.msgSerial++);try{this.activeProtocol.send(q)}catch(G){r.default.logAction(r.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+G.stack)}},Y.prototype.queue=function(q,j){r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var G=this.queuedMessages.last(),W=this.options.maxMessageSize;G&&!G.sendAttempted&&D(G.message,q,W)?(G.merged||(G.callback=P.default.create([G.callback]),G.merged=!0),G.callback.push(j)):this.queuedMessages.push(new A.PendingMessage(q,j))},Y.prototype.sendQueuedMessages=function(){r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");for(var q;q=this.queuedMessages.shift();)this.sendImpl(q)},Y.prototype.queuePendingMessages=function(q){q&&q.length&&(r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+q.length+" pending messages"),this.queuedMessages.prepend(q))},Y.prototype.failQueuedMessages=function(q){var j=this.queuedMessages.count();j>0&&(r.default.logAction(r.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+j+" queued messages, err = "+y.inspectError(q)),this.queuedMessages.completeAllMessages(q))},Y.prototype.onChannelMessage=function(q,j){var G=this.activeProtocol&&j===this.activeProtocol.getTransport(),W=y.arrIn(this.pendingTransports,j)&&this.state==this.states.synchronizing;G||W?this.realtime.channels.onChannelMessage(q):y.arrIndexOf([l.ACK,l.NACK,l.ERROR],q.action)>-1?this.realtime.channels.onChannelMessage(q):r.default.logAction(r.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(q)+"on defunct transport; discarding")},Y.prototype.ping=function(q,j){var G=this;if(q){r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+q);var W=function(){q.off("heartbeat",ce),j(new O.default("Timeout waiting for heartbeat response",5e4,500))},Z=y.now(),re=y.cheapRandStr(),ce=function(Oe){if(Oe===re){q.off("heartbeat",ce),clearTimeout(ve);var Ie=y.now()-Z;j(null,Ie)}},ve=setTimeout(W,this.options.timeouts.realtimeRequestTimeout);q.on("heartbeat",ce),q.ping(re);return}if(this.state.state!=="connected"){j(new O.default("Unable to ping service; not connected",4e4,400));return}var ge=!1,Ae=function(Oe,Ie){G.off("transport.active",ue),ge||(ge=!0,j(Oe,Ie))},ue=function(){ge||(ge=!0,C.default.Config.nextTick(function(){G.ping(null,j)}))};this.on("transport.active",ue),this.ping(this.activeProtocol.getTransport(),Ae)},Y.prototype.abort=function(q){this.activeProtocol.getTransport().fail(q)},Y.prototype.registerProposedTransport=function(q){this.proposedTransports.push(q)},Y.prototype.getTransportPreference=function(){var q,j;return this.transportPreference||o()&&((j=(q=C.default.WebStorage)===null||q===void 0?void 0:q.get)===null||j===void 0?void 0:j.call(q,R))},Y.prototype.persistTransportPreference=function(q){var j,G;y.arrIn(m.default.upgradeTransports,q.shortName)&&(this.transportPreference=q.shortName,o()&&((G=(j=C.default.WebStorage)===null||j===void 0?void 0:j.set)===null||G===void 0||G.call(j,R,q.shortName)))},Y.prototype.unpersistTransportPreference=function(){var q,j;this.transportPreference=null,o()&&((j=(q=C.default.WebStorage)===null||q===void 0?void 0:q.remove)===null||j===void 0||j.call(q,R))},Y.prototype.actOnErrorFromAuthorize=function(q){if(q.code===40171)this.notifyState({state:"failed",error:q});else if(q.code===40102)this.notifyState({state:"failed",error:q});else if(q.statusCode===a.default.Forbidden){var j="Client configured authentication provider returned 403; failing the connection";r.default.logAction(r.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",j),this.notifyState({state:"failed",error:new O.default(j,80019,403,q)})}else{var j="Client configured authentication provider request failed";r.default.logAction(r.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",j),this.notifyState({state:this.state.failState,error:new O.default(j,80019,401,q)})}},Y.prototype.onConnectionDetailsUpdate=function(q,j){if(q){this.connectionDetails=q,q.maxMessageSize&&(this.options.maxMessageSize=q.maxMessageSize);var G=q.clientId;if(G){var W=this.realtime.auth._uncheckedSetClientId(G);if(W){r.default.logAction(r.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",W.message),j.fail(W);return}}var Z=q.connectionStateTtl;Z&&(this.connectionStateTtl=Z),this.maxIdleInterval=q.maxIdleInterval,this.emit("connectiondetails",q)}},Y.supportedTransports={},Y}($.default);i.default=Q}).call(this,u(13))},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importDefault(u(7)),x=v.__importDefault(u(2)),y=function(A){v.__extends(m,A);function m(){var C=A.call(this)||this;return C.messages=[],C}return m.prototype.count=function(){return this.messages.length},m.prototype.push=function(C){this.messages.push(C)},m.prototype.shift=function(){return this.messages.shift()},m.prototype.last=function(){return this.messages[this.messages.length-1]},m.prototype.copyAll=function(){return this.messages.slice()},m.prototype.append=function(C){this.messages.push.apply(this.messages,C)},m.prototype.prepend=function(C){this.messages.unshift.apply(this.messages,C)},m.prototype.completeMessages=function(C,$,_){x.default.logAction(x.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+C+"; count = "+$),_=_||null;var r=this.messages;if(r.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var h=r[0];if(h){var S=h.message.msgSerial,O=C+$;if(O>S)for(var b=r.splice(0,O-S),E=0,P=b;E<P.length;E++){var f=P[E];f.callback(_)}r.length==0&&this.emit("idle")}},m.prototype.completeAllMessages=function(C){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,C)},m.prototype.resetSendAttempted=function(){for(var C=0,$=this.messages;C<$.length;C++){var _=$[C];_.sendAttempted=!1}},m.prototype.clear=function(){x.default.logAction(x.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},m}(n.default);i.default=y},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=function(){function n(x,y,A,m){this.previous=x,this.current=y,A&&(this.retryIn=A),m&&(this.reason=m)}return n}();i.default=v},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importDefault(u(10)),x=v.__importDefault(u(7)),y=v.__importStar(u(1)),A=v.__importDefault(u(33)),m=v.__importDefault(u(2)),C=v.__importDefault(u(54)),$=v.__importDefault(u(9)),_=v.__importDefault(u(39)),r=v.__importStar(u(4)),h=v.__importDefault(u(16)),S=v.__importDefault(u(21)),O=n.default.Action,b=function(){};function E(p){if(p&&"params"in p&&!y.isObject(p.params))return new r.default("options.params must be an object",4e4,400);if(p&&"modes"in p){if(!y.isArray(p.modes))return new r.default("options.modes must be an array",4e4,400);for(var a=0;a<p.modes.length;a++){var o=p.modes[a];if(!o||typeof o!="string"||!y.arrIn(n.default.channelModes,String.prototype.toUpperCase.call(o)))return new r.default("Invalid channel mode: "+o,4e4,400)}}}var P=function(p){v.__extends(a,p);function a(o,d,l){var g=p.call(this,o,d,l)||this;return g.retryCount=0,g.history=function(R,k){if(m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),k===void 0)if(typeof R=="function")k=R,R=null;else{if(this.rest.options.promises)return y.promisify(this,"history",arguments);k=b}if(R&&R.untilAttach){if(this.state!=="attached"){k(new r.default("option untilAttach requires the channel to be attached",4e4,400));return}if(!this.properties.attachSerial){k(new r.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));return}delete R.untilAttach,R.from_serial=this.properties.attachSerial}A.default.prototype._history.call(this,R,k)},g.whenState=function(R,k){return x.default.prototype.whenState.call(g,R,g.state,k)},m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel()","started; name = "+d),g.realtime=o,g.presence=new C.default(g),g.connectionManager=o.connection.connectionManager,g.state="initialized",g.subscriptions=new x.default,g.syncChannelSerial=void 0,g.properties={attachSerial:void 0,channelSerial:void 0},g.setOptions(l),g.errorReason=null,g._requestedFlags=null,g._mode=null,g._attachResume=!1,g._decodingContext={channelOptions:g.channelOptions,plugins:o.options.plugins||{},baseEncodedPreviousPayload:void 0},g._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},g._allChannelChanges=new x.default,g}return a.prototype.invalidStateError=function(){return new r.default("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)},a.processListenerArgs=function(o){return o=Array.prototype.slice.call(o),typeof o[0]=="function"&&o.unshift(null),o[o.length-1]==null&&o.pop(),o},a.prototype.setOptions=function(o,d){var l=this.channelOptions;if(!d&&this.rest.options.promises)return y.promisify(this,"setOptions",arguments);var g=d||function(k){k&&m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+k.toString())},R=E(o);if(R){g(R);return}A.default.prototype.setOptions.call(this,o),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(o,l)?(this.attachImpl(),this._allChannelChanges.once(["attached","update","detached","failed"],function(k){switch(this.event){case"update":case"attached":g==null||g(null);return;default:g==null||g(k.reason);return}})):g()},a.prototype._shouldReattachToSetOptions=function(o,d){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(o!=null&&o.params){var l=f(o.params),g=f(d.params);if(Object.keys(l).length!==Object.keys(g).length||!y.shallowEquals(g,l))return!0}return!!(o!=null&&o.modes&&(!d.modes||!y.arrEquals(o.modes,d.modes)))},a.prototype.publish=function(){for(var o=this,d=[],l=0;l<arguments.length;l++)d[l]=arguments[l];var g=d[0],R=d.length,k=d[R-1];if(typeof k!="function"){if(this.realtime.options.promises)return y.promisify(this,"publish",arguments);k=b,++R}if(!this.connectionManager.activeState()){k(this.connectionManager.getError());return}if(R==2)if(y.isObject(g))g=[$.default.fromValues(g)];else if(y.isArray(g))g=$.default.fromValuesArray(g);else throw new r.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else g=[$.default.fromValues({name:d[0],data:d[1]})];var T=this.realtime.options.maxMessageSize;$.default.encodeArray(g,this.channelOptions,function(V){if(V){k(V);return}var F=$.default.getMessagesSize(g);if(F>T){k(new r.default("Maximum size of messages that can be published at once exceeded ( was "+F+" bytes; limit is "+T+" bytes)",40009,400));return}o.__publish(g,k)})},a.prototype.__publish=function(o,d){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+o.length);var l=this.state;switch(l){case"failed":case"suspended":d(r.default.fromValues(this.invalidStateError()));break;default:{m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+l);var g=new n.default;g.action=O.MESSAGE,g.channel=this.name,g.messages=o,this.sendMessage(g,d);break}}},a.prototype.onEvent=function(o){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var d=this.subscriptions,l=0;l<o.length;l++){var g=o[l];d.emit(g.name,g)}},a.prototype.attach=function(o,d){var l;if(typeof o=="function"?(d=o,l=null):l=o,!d){if(this.realtime.options.promises)return y.promisify(this,"attach",arguments);d=function(g){g&&m.default.logAction(m.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+g.toString())}}if(l)m.default.deprecated("The ability to pass an array of channel mode flags as the first argument of `RealtimeChannel.attach()`","To set channel mode flags, populate the `modes` property of the channel options object that you pass to `Channels.get()` or `RealtimeChannel.setOptions()`."),this._requestedFlags=l;else if(this.state==="attached"){d(null,null);return}this._attach(!1,null,d)},a.prototype._attach=function(o,d,l){l||(l=function(R){R&&m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+R.toString())});var g=this.connectionManager;if(!g.activeState()){l(g.getError());return}(this.state!=="attaching"||o)&&this.requestState("attaching",d),this.once(function(R){switch(this.event){case"attached":l==null||l(null,R);break;case"detached":case"suspended":case"failed":l==null||l(R.reason||g.getError()||new r.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":l==null||l(new r.default("Attach request superseded by a subsequent detach request",9e4,409));break}})},a.prototype.attachImpl=function(){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");var o=n.default.fromValues({action:O.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?o.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&o.encodeModesToFlags(y.allToUpperCase(this.channelOptions.modes)),this._attachResume&&o.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(o.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(o,b)},a.prototype.detach=function(o){if(!o){if(this.realtime.options.promises)return y.promisify(this,"detach",arguments);o=b}var d=this.connectionManager;if(!d.activeState()){o(d.getError());return}switch(this.state){case"suspended":this.notifyState("detached"),o();break;case"detached":o();break;case"failed":o(new r.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once(function(l){switch(this.event){case"detached":o();break;case"attached":case"suspended":case"failed":o(l.reason||d.getError()||new r.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":o(new r.default("Detach request superseded by a subsequent attach request",9e4,409));break}})}},a.prototype.detachImpl=function(o){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");var d=n.default.fromValues({action:O.DETACH,channel:this.name});this.sendMessage(d,o||b)},a.prototype.subscribe=function(){for(var o=[],d=0;d<arguments.length;d++)o[d]=arguments[d];var l=a.processListenerArgs(o),g=l[0],R=l[1],k=l[2];if(!k&&this.realtime.options.promises)return y.promisify(this,"subscribe",[g,R]);if(this.state==="failed"){k==null||k(r.default.fromValues(this.invalidStateError()));return}return g&&typeof g=="object"&&!Array.isArray(g)?this._subscribeFilter(g,R):this.subscriptions.on(g,R),this.attach(k||b)},a.prototype._subscribeFilter=function(o,d){var l=function(g){var R,k,T,V,F,M,D={name:g.name,refTimeserial:(k=(R=g.extras)===null||R===void 0?void 0:R.ref)===null||k===void 0?void 0:k.timeserial,refType:(V=(T=g.extras)===null||T===void 0?void 0:T.ref)===null||V===void 0?void 0:V.type,isRef:!!(!((M=(F=g.extras)===null||F===void 0?void 0:F.ref)===null||M===void 0)&&M.timeserial),clientId:g.clientId};Object.entries(o).find(function(U){var B=U[0],Q=U[1];return Q!==void 0?D[B]!==Q:!1})||d(g)};this._addFilteredSubscription(o,d,l),this.subscriptions.on(l)},a.prototype._addFilteredSubscription=function(o,d,l){var g;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(d)){var R=this.filteredSubscriptions.get(d);R.set(o,((g=R==null?void 0:R.get(o))===null||g===void 0?void 0:g.concat(l))||[l])}else this.filteredSubscriptions.set(d,new Map([[o,[l]]]))},a.prototype._getAndDeleteFilteredSubscriptions=function(o,d){var l=this;if(!this.filteredSubscriptions)return[];if(!d&&o)return Array.from(this.filteredSubscriptions.entries()).map(function(T){var V,F=T[0],M=T[1],D=M.get(o);return M.delete(o),M.size===0&&((V=l.filteredSubscriptions)===null||V===void 0||V.delete(F)),D}).reduce(function(T,V){var F;return V?(F=T).concat.apply(F,V):T},[]);if(!d||!this.filteredSubscriptions.has(d))return[];var g=this.filteredSubscriptions.get(d);if(!o){var R=Array.from(g.values()).reduce(function(T,V){return T.concat.apply(T,V)},[]);return this.filteredSubscriptions.delete(d),R}var k=g.get(o);return g.delete(o),k||[]},a.prototype.unsubscribe=function(){for(var o=this,d,l=[],g=0;g<arguments.length;g++)l[g]=arguments[g];var R=a.processListenerArgs(l),k=R[0],T=R[1];if(typeof k=="object"&&!T||!((d=this.filteredSubscriptions)===null||d===void 0)&&d.has(T)){this._getAndDeleteFilteredSubscriptions(k,T).forEach(function(V){return o.subscriptions.off(V)});return}this.subscriptions.off(k,T)},a.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new r.PartialErrorInfo("Unable to sync to channel; not attached",4e4)}var o=this.connectionManager;if(!o.activeState())throw o.getError();var d=n.default.fromValues({action:O.SYNC,channel:this.name});this.syncChannelSerial&&(d.channelSerial=this.syncChannelSerial),o.send(d)},a.prototype.sendMessage=function(o,d){this.connectionManager.send(o,this.realtime.options.queueMessages,d)},a.prototype.sendPresence=function(o,d){var l=n.default.fromValues({action:O.PRESENCE,channel:this.name,presence:y.isArray(o)?h.default.fromValuesArray(o):[h.default.fromValues(o)]});this.sendMessage(l,d)},a.prototype.onMessage=function(o){(o.action===O.ATTACHED||o.action===O.MESSAGE||o.action===O.PRESENCE)&&this.setChannelSerial(o.channelSerial);var d,l=!1;switch(o.action){case O.ATTACHED:{this.properties.attachSerial=o.channelSerial,this._mode=o.getMode(),this.params=o.params||{};var g=o.decodeModesFromFlags();this.modes=g&&y.allToLowerCase(g)||void 0;var R=o.hasFlag("RESUMED"),k=o.hasFlag("HAS_PRESENCE"),T=o.hasFlag("HAS_BACKLOG");if(this.state==="attached"){R||this.presence.onAttached(k);var V=new _.default(this.state,this.state,R,T,o.error);this._allChannelChanges.emit("update",V),(!R||this.channelOptions.updateOnAttached)&&this.emit("update",V)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",o.error,R,k,T);break}case O.DETACHED:{var F=o.error?r.default.fromValues(o.error):new r.default("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",F):this.state==="attaching"?this.notifyState("suspended",F):this.requestState("attaching",F);break}case O.SYNC:if(l=!0,d=this.syncChannelSerial=o.channelSerial,!o.presence)break;case O.PRESENCE:{for(var M=o.presence,D=o.id,U=o.connectionId,B=o.timestamp,Q=this.channelOptions,te=void 0,Y=0;Y<M.length;Y++)try{te=M[Y],h.default.decode(te,Q),te.connectionId||(te.connectionId=U),te.timestamp||(te.timestamp=B),te.id||(te.id=D+":"+Y)}catch(re){m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.onMessage()",re.toString())}this.presence.setPresence(M,l,d);break}case O.MESSAGE:{if(this.state!=="attached"){m.default.logAction(m.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+o.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}var q=o.messages,j=q[0],G=q[q.length-1],D=o.id,U=o.connectionId,B=o.timestamp;if(j.extras&&j.extras.delta&&j.extras.delta.from!==this._lastPayload.messageId){var W='Delta message decode failure - previous message not available for message "'+o.id+'" on this channel "'+this.name+'".';m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.onMessage()",W),this._startDecodeFailureRecovery(new r.default(W,40018,400));break}for(var Y=0;Y<q.length;Y++){var W=q[Y];try{$.default.decode(W,this._decodingContext)}catch(ue){switch(m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.onMessage()",ue.toString()),ue.code){case 40018:this._startDecodeFailureRecovery(ue);return;case 40019:case 40021:this.notifyState("failed",ue);return}}W.connectionId||(W.connectionId=U),W.timestamp||(W.timestamp=B),W.id||(W.id=D+":"+Y)}this._lastPayload.messageId=G.id,this._lastPayload.protocolMessageChannelSerial=o.channelSerial,this.onEvent(q);break}case O.ERROR:{var Z=o.error;Z&&Z.code==80016?this.checkPendingState():this.notifyState("failed",r.default.fromValues(Z));break}default:m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+o.action+")"),this.connectionManager.abort(S.default.unknownChannelErr())}},a.prototype._startDecodeFailureRecovery=function(o){var d=this;this._lastPayload.decodeFailureRecoveryInProgress||(m.default.logAction(m.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,o,function(){d._lastPayload.decodeFailureRecoveryInProgress=!1}))},a.prototype.onAttached=function(){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},a.prototype.notifyState=function(o,d,l,g,R){if(m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+o),this.clearStateTimer(),y.arrIn(["detached","suspended","failed"],o)&&(this.properties.channelSerial=null),o!==this.state){this.presence.actOnChannelState(o,g,d),o==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),d&&(this.errorReason=d);var k=new _.default(this.state,o,l,R,d),T=o==="failed"?m.default.LOG_ERROR:m.default.LOG_MAJOR;m.default.logAction(T,'Channel state for channel "'+this.name+'"',o+(d?"; reason: "+d:"")),o!=="attaching"&&o!=="suspended"&&(this.retryCount=0),o==="attached"&&this.onAttached(),o==="attached"?this._attachResume=!0:(o==="detaching"||o==="failed")&&(this._attachResume=!1),this.state=o,this._allChannelChanges.emit(o,k),this.emit(o,k)}},a.prototype.requestState=function(o,d){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+o),this.notifyState(o,d),this.checkPendingState()},a.prototype.checkPendingState=function(){var o=this.connectionManager.state;if(!(o.sendEvents||o.forceQueueEvents)){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}},a.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":{var o=new r.default("Channel attach timed out",90007,408);this.notifyState("suspended",o);break}case"detaching":{var o=new r.default("Channel detach timed out",90007,408);this.notifyState("attached",o);break}default:this.checkPendingState();break}},a.prototype.startStateTimerIfNotRunning=function(){var o=this;this.stateTimer||(this.stateTimer=setTimeout(function(){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),o.stateTimer=null,o.timeoutPendingState()},this.realtime.options.timeouts.realtimeRequestTimeout))},a.prototype.clearStateTimer=function(){var o=this.stateTimer;o&&(clearTimeout(o),this.stateTimer=null)},a.prototype.startRetryTimer=function(){var o=this;if(!this.retryTimer){this.retryCount++;var d=y.getRetryTime(this.realtime.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(function(){o.state==="suspended"&&o.connectionManager.state.sendEvents&&(o.retryTimer=null,m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),o.requestState("attaching"))},d)}},a.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},a.prototype.getReleaseErr=function(){var o=this.state;return o==="initialized"||o==="detached"||o==="failed"?null:new r.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+o,90001,400)},a.prototype.setChannelSerial=function(o){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+o+"; previous = "+this.properties.channelSerial),o&&(this.properties.channelSerial=o)},a}(A.default);function f(p){var a=p||{};a.agent;var o=v.__rest(a,["agent"]);return o}i.default=P},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=function(){function n(x,y,A,m,C){this.previous=x,this.current=y,y==="attached"&&(this.resumed=A,this.hasBacklog=m),C&&(this.reason=C)}return n}();i.default=v},function(w,i,u){(function(v,n){w.exports=n(u(6))})(this,function(v){return function(){var n=v,x=n.lib,y=x.WordArray,A=x.Hasher,m=n.algo,C=[],$=m.SHA1=A.extend({_doReset:function(){this._hash=new y.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(_,r){for(var h=this._hash.words,S=h[0],O=h[1],b=h[2],E=h[3],P=h[4],f=0;f<80;f++){if(f<16)C[f]=_[r+f]|0;else{var p=C[f-3]^C[f-8]^C[f-14]^C[f-16];C[f]=p<<1|p>>>31}var a=(S<<5|S>>>27)+P+C[f];f<20?a+=(O&b|~O&E)+1518500249:f<40?a+=(O^b^E)+1859775393:f<60?a+=(O&b|O&E|b&E)-1894007588:a+=(O^b^E)-899497514,P=E,E=b,b=O<<30|O>>>2,O=S,S=a}h[0]=h[0]+S|0,h[1]=h[1]+O|0,h[2]=h[2]+b|0,h[3]=h[3]+E|0,h[4]=h[4]+P|0},_doFinalize:function(){var _=this._data,r=_.words,h=this._nDataBytes*8,S=_.sigBytes*8;return r[S>>>5]|=128<<24-S%32,r[(S+64>>>9<<4)+14]=Math.floor(h/4294967296),r[(S+64>>>9<<4)+15]=h,_.sigBytes=r.length*4,this._process(),this._hash},clone:function(){var _=A.clone.call(this);return _._hash=this._hash.clone(),_}});n.SHA1=A._createHelper($),n.HmacSHA1=A._createHmacHelper($)}(),v.SHA1})},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});function v(f){if(f===void 0)return"undefined";var p,a;if(f instanceof ArrayBuffer?(a="ArrayBuffer",p=new DataView(f)):f instanceof DataView&&(a="DataView",p=f),!p)return JSON.stringify(f);for(var o=[],d=0;d<f.byteLength;d++){if(d>20){o.push("...");break}var l=p.getUint8(d).toString(16);l.length===1&&(l="0"+l),o.push(l)}return"<"+a+" "+o.join(" ")+">"}function n(f,p,a){for(var o=0,d=a.length;o<d;o++){var l=a.charCodeAt(o);if(l<128){f.setUint8(p++,l>>>0&127|0);continue}if(l<2048){f.setUint8(p++,l>>>6&31|192),f.setUint8(p++,l>>>0&63|128);continue}if(l<65536){f.setUint8(p++,l>>>12&15|224),f.setUint8(p++,l>>>6&63|128),f.setUint8(p++,l>>>0&63|128);continue}if(l<1114112){f.setUint8(p++,l>>>18&7|240),f.setUint8(p++,l>>>12&63|128),f.setUint8(p++,l>>>6&63|128),f.setUint8(p++,l>>>0&63|128);continue}throw new Error("bad codepoint "+l)}}function x(f,p,a){for(var o="",d=p,l=p+a;d<l;d++){var g=f.getUint8(d);if(!(g&128)){o+=String.fromCharCode(g);continue}if((g&224)===192){o+=String.fromCharCode((g&15)<<6|f.getUint8(++d)&63);continue}if((g&240)===224){o+=String.fromCharCode((g&15)<<12|(f.getUint8(++d)&63)<<6|(f.getUint8(++d)&63)<<0);continue}if((g&248)===240){o+=String.fromCharCode((g&7)<<18|(f.getUint8(++d)&63)<<12|(f.getUint8(++d)&63)<<6|(f.getUint8(++d)&63)<<0);continue}throw new Error("Invalid byte "+g.toString(16))}return o}function y(f){for(var p=0,a=0,o=f.length;a<o;a++){var d=f.charCodeAt(a);if(d<128){p+=1;continue}if(d<2048){p+=2;continue}if(d<65536){p+=3;continue}if(d<1114112){p+=4;continue}throw new Error("bad codepoint "+d)}return p}function A(f,p){var a=P(f,p);if(a!==0){var o=new ArrayBuffer(a),d=new DataView(o);return E(f,d,0,p),o}}var m=65536*65536,C=1/m;function $(f,p){return p=p||0,f.getInt32(p)*m+f.getUint32(p+4)}function _(f,p){return p=p||0,f.getUint32(p)*m+f.getUint32(p+4)}function r(f,p,a){a<9223372036854776e3?(f.setInt32(p,Math.floor(a*C)),f.setInt32(p+4,a&-1)):(f.setUint32(p,2147483647),f.setUint32(p+4,2147483647))}function h(f,p,a){a<18446744073709552e3?(f.setUint32(p,Math.floor(a*C)),f.setInt32(p+4,a&-1)):(f.setUint32(p,4294967295),f.setUint32(p+4,4294967295))}var S=function(){function f(p,a){var o=this;this.map=function(d){for(var l={},g=0;g<d;g++){var R=o.parse();l[R]=o.parse()}return l},this.bin=function(d){var l=new ArrayBuffer(d);return new Uint8Array(l).set(new Uint8Array(o.view.buffer,o.offset,d),0),o.offset+=d,l},this.buf=this.bin,this.str=function(d){var l=x(o.view,o.offset,d);return o.offset+=d,l},this.array=function(d){for(var l=new Array(d),g=0;g<d;g++)l[g]=o.parse();return l},this.ext=function(d){return o.offset+=d,{type:o.view.getInt8(o.offset),data:o.buf(d)}},this.parse=function(){var d=o.view.getUint8(o.offset),l,g;if(!(d&128))return o.offset++,d;if((d&240)===128)return g=d&15,o.offset++,o.map(g);if((d&240)===144)return g=d&15,o.offset++,o.array(g);if((d&224)===160)return g=d&31,o.offset++,o.str(g);if((d&224)===224)return l=o.view.getInt8(o.offset),o.offset++,l;switch(d){case 192:return o.offset++,null;case 193:o.offset++;return;case 194:return o.offset++,!1;case 195:return o.offset++,!0;case 196:return g=o.view.getUint8(o.offset+1),o.offset+=2,o.bin(g);case 197:return g=o.view.getUint16(o.offset+1),o.offset+=3,o.bin(g);case 198:return g=o.view.getUint32(o.offset+1),o.offset+=5,o.bin(g);case 199:return g=o.view.getUint8(o.offset+1),o.offset+=2,o.ext(g);case 200:return g=o.view.getUint16(o.offset+1),o.offset+=3,o.ext(g);case 201:return g=o.view.getUint32(o.offset+1),o.offset+=5,o.ext(g);case 202:return l=o.view.getFloat32(o.offset+1),o.offset+=5,l;case 203:return l=o.view.getFloat64(o.offset+1),o.offset+=9,l;case 204:return l=o.view.getUint8(o.offset+1),o.offset+=2,l;case 205:return l=o.view.getUint16(o.offset+1),o.offset+=3,l;case 206:return l=o.view.getUint32(o.offset+1),o.offset+=5,l;case 207:return l=_(o.view,o.offset+1),o.offset+=9,l;case 208:return l=o.view.getInt8(o.offset+1),o.offset+=2,l;case 209:return l=o.view.getInt16(o.offset+1),o.offset+=3,l;case 210:return l=o.view.getInt32(o.offset+1),o.offset+=5,l;case 211:return l=$(o.view,o.offset+1),o.offset+=9,l;case 212:return g=1,o.offset++,o.ext(g);case 213:return g=2,o.offset++,o.ext(g);case 214:return g=4,o.offset++,o.ext(g);case 215:return g=8,o.offset++,o.ext(g);case 216:return g=16,o.offset++,o.ext(g);case 217:return g=o.view.getUint8(o.offset+1),o.offset+=2,o.str(g);case 218:return g=o.view.getUint16(o.offset+1),o.offset+=3,o.str(g);case 219:return g=o.view.getUint32(o.offset+1),o.offset+=5,o.str(g);case 220:return g=o.view.getUint16(o.offset+1),o.offset+=3,o.array(g);case 221:return g=o.view.getUint32(o.offset+1),o.offset+=5,o.array(g);case 222:return g=o.view.getUint16(o.offset+1),o.offset+=3,o.map(g);case 223:return g=o.view.getUint32(o.offset+1),o.offset+=5,o.map(g)}throw new Error("Unknown type 0x"+d.toString(16))},this.offset=a||0,this.view=p}return f}();function O(f){var p=new DataView(f),a=new S(p),o=a.parse();if(a.offset!==f.byteLength)throw new Error(f.byteLength-a.offset+" trailing bytes");return o}function b(f,p){return Object.keys(f).filter(function(a){var o=f[a],d=typeof o;return(!p||o!=null)&&(d!=="function"||!!o.toJSON)})}function E(f,p,a,o){var d=typeof f;if(typeof f=="string"){var l=y(f);if(l<32)return p.setUint8(a,l|160),n(p,a+1,f),1+l;if(l<256)return p.setUint8(a,217),p.setUint8(a+1,l),n(p,a+2,f),2+l;if(l<65536)return p.setUint8(a,218),p.setUint16(a+1,l),n(p,a+3,f),3+l;if(l<4294967296)return p.setUint8(a,219),p.setUint32(a+1,l),n(p,a+5,f),5+l}if(ArrayBuffer.isView&&ArrayBuffer.isView(f)&&(f=f.buffer),f instanceof ArrayBuffer){var g=f.byteLength;if(g<256)return p.setUint8(a,196),p.setUint8(a+1,g),new Uint8Array(p.buffer).set(new Uint8Array(f),a+2),2+g;if(g<65536)return p.setUint8(a,197),p.setUint16(a+1,g),new Uint8Array(p.buffer).set(new Uint8Array(f),a+3),3+g;if(g<4294967296)return p.setUint8(a,198),p.setUint32(a+1,g),new Uint8Array(p.buffer).set(new Uint8Array(f),a+5),5+g}if(typeof f=="number"){if(Math.floor(f)!==f)return p.setUint8(a,203),p.setFloat64(a+1,f),9;if(f>=0){if(f<128)return p.setUint8(a,f),1;if(f<256)return p.setUint8(a,204),p.setUint8(a+1,f),2;if(f<65536)return p.setUint8(a,205),p.setUint16(a+1,f),3;if(f<4294967296)return p.setUint8(a,206),p.setUint32(a+1,f),5;if(f<18446744073709552e3)return p.setUint8(a,207),h(p,a+1,f),9;throw new Error("Number too big 0x"+f.toString(16))}if(f>=-32)return p.setInt8(a,f),1;if(f>=-128)return p.setUint8(a,208),p.setInt8(a+1,f),2;if(f>=-32768)return p.setUint8(a,209),p.setInt16(a+1,f),3;if(f>=-2147483648)return p.setUint8(a,210),p.setInt32(a+1,f),5;if(f>=-9223372036854776e3)return p.setUint8(a,211),r(p,a+1,f),9;throw new Error("Number too small -0x"+(-f).toString(16).substr(1))}if(d==="undefined")return o?0:(p.setUint8(a,212),p.setUint8(a+1,0),p.setUint8(a+2,0),3);if(f===null)return o?0:(p.setUint8(a,192),1);if(d==="boolean")return p.setUint8(a,f?195:194),1;if(typeof f.toJSON=="function")return E(f.toJSON(),p,a,o);if(d==="object"){var R,k=0,T=void 0,V=Array.isArray(f);if(V?R=f.length:(T=b(f,o),R=T.length),R<16?(p.setUint8(a,R|(V?144:128)),k=1):R<65536?(p.setUint8(a,V?220:222),p.setUint16(a+1,R),k=3):R<4294967296&&(p.setUint8(a,V?221:223),p.setUint32(a+1,R),k=5),V)for(var F=0;F<R;F++)k+=E(f[F],p,a+k,o);else if(T)for(var F=0;F<R;F++){var M=T[F];k+=E(M,p,a+k),k+=E(f[M],p,a+k,o)}return k}if(d==="function")return 0;throw new Error("Unknown type "+d)}function P(f,p){var a=typeof f;if(a==="string"){var o=y(f);if(o<32)return 1+o;if(o<256)return 2+o;if(o<65536)return 3+o;if(o<4294967296)return 5+o}if(ArrayBuffer.isView&&ArrayBuffer.isView(f)&&(f=f.buffer),f instanceof ArrayBuffer){var d=f.byteLength;if(d<256)return 2+d;if(d<65536)return 3+d;if(d<4294967296)return 5+d}if(typeof f=="number"){if(Math.floor(f)!==f)return 9;if(f>=0){if(f<128)return 1;if(f<256)return 2;if(f<65536)return 3;if(f<4294967296)return 5;if(f<18446744073709552e3)return 9;throw new Error("Number too big 0x"+f.toString(16))}if(f>=-32)return 1;if(f>=-128)return 2;if(f>=-32768)return 3;if(f>=-2147483648)return 5;if(f>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+f.toString(16).substr(1))}if(a==="boolean")return 1;if(f===null)return p?0:1;if(f===void 0)return p?0:3;if(typeof f.toJSON=="function")return P(f.toJSON(),p);if(a==="object"){var l,g=0;if(Array.isArray(f)){l=f.length;for(var R=0;R<l;R++)g+=P(f[R],p)}else{var k=b(f,p);l=k.length;for(var R=0;R<l;R++){var T=k[R];g+=P(T)+P(f[T],p)}}if(l<16)return 1+g;if(l<65536)return 3+g;if(l<4294967296)return 5+g;throw new Error("Array or object too long 0x"+l.toString(16))}if(a==="function")return 0;throw new Error("Unknown type "+a)}i.default={encode:A,decode:O,inspect:v,utf8Write:n,utf8Read:x,utf8ByteCount:y}},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importDefault(u(30)),x=v.__importDefault(u(50)),y=v.__importDefault(u(3)),A=v.__importDefault(u(4)),m=v.__importDefault(u(55)),C=v.__importDefault(u(57)),$=v.__importDefault(u(62)),_=v.__importDefault(u(64)),r=v.__importDefault(u(68)),h=v.__importDefault(u(2)),S=u(8),O=v.__importDefault(u(65)),b=v.__importDefault(u(66)),E=v.__importDefault(u(41)),P=(0,C.default)(_.default,m.default);y.default.Crypto=P,y.default.BufferUtils=m.default,y.default.Http=$.default,y.default.Config=_.default,y.default.Transports=r.default,y.default.WebStorage=O.default,n.default.Crypto=P,x.default.Crypto=P,h.default.initLogHandlers(),y.default.Defaults=(0,S.getDefaults)(b.default),y.default.Config.agent&&(y.default.Defaults.agent+=" "+y.default.Config.agent),y.default.Config.noUpgrade&&(y.default.Defaults.upgradeTransports=[]),i.default={ErrorInfo:A.default,Rest:n.default,Realtime:x.default,msgpack:E.default}},function(w){w.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.50","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**","src/**","react/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.5","ws":"^8.14.2"},"peerDependencies":{"react":">=16.8.0","react-dom":">=16.8.0"},"peerDependenciesMeta":{"react":{"optional":true},"react-dom":{"optional":true}},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@arethetypeswrong/cli":"^0.13.1","@babel/preset-env":"^7.23.6","@testing-library/react":"^13.3.0","@types/crypto-js":"^4.0.1","@types/jmespath":"^0.15.2","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","@vitejs/plugin-react":"^1.3.2","async":"ably-forks/async#requirejs","aws-sdk":"^2.1413.0","babel-loader":"^8.3.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"^2.8.5","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-import":"^2.28.0","eslint-plugin-jsdoc":"^40.0.0","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.6.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","jmespath":"^0.16.0","jsdom":"^20.0.0","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","mocha-junit-reporter":"^2.2.1","null-loader":"^4.0.1","playwright":"^1.39.0","prettier":"^2.5.1","react":">=18.1.0","react-dom":">=18.1.0","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^4.0.1","tslib":"^2.3.1","typedoc":"^0.23.8","typescript":"^4.6.4","vite":"^4.4.9","vitest":"^0.18.0","webpack":"^4.44.2","webpack-cli":"^4.2.0","webpack-node-externals":"^3.0.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"build"},"main":"ably"},"scripts":{"start:react":"npx vite serve","grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:node:skip-build":"grunt mocha","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","test:react":"vitest run","concat":"grunt concat","build":"grunt build:all && npm run build:react","build:node":"grunt build:node","build:browser":"grunt build:browser","build:react":"npm run build:react:mjs && npm run build:react:cjs && cp src/platform/react-hooks/res/package.react.json react/package.json","build:react:mjs":"tsc --project src/platform/react-hooks/tsconfig.mjs.json && cp src/platform/react-hooks/res/package.mjs.json react/mjs/package.json","build:react:cjs":"tsc --project src/platform/react-hooks/tsconfig.cjs.json && cp src/platform/react-hooks/res/package.cjs.json react/cjs/package.json","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js docs/chrome-mv3.md","format:check":"prettier --check --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js","docs":"typedoc --entryPoints ably.d.ts --out docs/generated/default --readme docs/landing-pages/default.md && typedoc --entryPoints promises.d.ts --out docs/generated/promises --name \\"ably (Promise-based)\\" --readme docs/landing-pages/promises.md && cp docs/landing-pages/choose-library.html docs/generated/index.html"}}')},function(w,i){},function(w,i,u){(function(v,n){w.exports=n(u(6),u(32),u(25))})(this,function(v){return v.HmacSHA256})},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importStar(u(1)),x=v.__importDefault(u(47)),y=v.__importDefault(u(15)),A=v.__importDefault(u(20)),m=v.__importDefault(u(4)),C=v.__importDefault(u(48)),$=function(){},_=function(){function O(b){this.rest=b,this.admin=new r(b)}return O}(),r=function(){function O(b){this.rest=b,this.deviceRegistrations=new h(b),this.channelSubscriptions=new S(b)}return O.prototype.publish=function(b,E,P){var f=this.rest,p=f.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,a=n.defaultPostHeaders(f.options,p),o={},d=n.mixin({recipient:b},E);if(typeof P!="function"){if(this.rest.options.promises)return n.promisify(this,"publish",arguments);P=$}f.options.headers&&n.mixin(a,f.options.headers),f.options.pushFullWait&&n.mixin(o,{fullWait:"true"});var l=n.encodeBody(d,p);y.default.post(f,"/push/publish",l,a,o,null,function(g){return P(g)})},O}(),h=function(){function O(b){this.rest=b}return O.prototype.save=function(b,E){var P=this.rest,f=x.default.fromValues(b),p=P.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,a=n.defaultPostHeaders(P.options,p),o={};if(typeof E!="function"){if(this.rest.options.promises)return n.promisify(this,"save",arguments);E=$}P.options.headers&&n.mixin(a,P.options.headers),P.options.pushFullWait&&n.mixin(o,{fullWait:"true"});var d=n.encodeBody(f,p);y.default.put(P,"/push/deviceRegistrations/"+encodeURIComponent(b.id),d,a,o,null,function(l,g,R,k){E(l,l?void 0:x.default.fromResponseBody(g,k?void 0:p))})},O.prototype.get=function(b,E){var P=this.rest,f=P.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,p=n.defaultGetHeaders(P.options,f),a=b.id||b;if(typeof E!="function"){if(this.rest.options.promises)return n.promisify(this,"get",arguments);E=$}if(typeof a!="string"||!a.length){E(new m.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400));return}P.options.headers&&n.mixin(p,P.options.headers),y.default.get(P,"/push/deviceRegistrations/"+encodeURIComponent(a),p,{},null,function(o,d,l,g){E(o,o?void 0:x.default.fromResponseBody(d,g?void 0:f))})},O.prototype.list=function(b,E){var P=this.rest,f=P.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,p=this.rest.http.supportsLinkHeaders?void 0:f,a=n.defaultGetHeaders(P.options,f);if(typeof E!="function"){if(this.rest.options.promises)return n.promisify(this,"list",arguments);E=$}P.options.headers&&n.mixin(a,P.options.headers),new A.default(P,"/push/deviceRegistrations",a,p,function(o,d,l){return x.default.fromResponseBody(o,l?void 0:f)}).get(b,E)},O.prototype.remove=function(b,E){var P=this.rest,f=P.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,p=n.defaultGetHeaders(P.options,f),a={},o=b.id||b;if(typeof E!="function"){if(this.rest.options.promises)return n.promisify(this,"remove",arguments);E=$}if(typeof o!="string"||!o.length){E(new m.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400));return}P.options.headers&&n.mixin(p,P.options.headers),P.options.pushFullWait&&n.mixin(a,{fullWait:"true"}),y.default.delete(P,"/push/deviceRegistrations/"+encodeURIComponent(o),p,a,null,function(d){return E(d)})},O.prototype.removeWhere=function(b,E){var P=this.rest,f=P.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,p=n.defaultGetHeaders(P.options,f);if(typeof E!="function"){if(this.rest.options.promises)return n.promisify(this,"removeWhere",arguments);E=$}P.options.headers&&n.mixin(p,P.options.headers),P.options.pushFullWait&&n.mixin(b,{fullWait:"true"}),y.default.delete(P,"/push/deviceRegistrations",p,b,null,function(a){return E(a)})},O}(),S=function(){function O(b){this.remove=O.prototype.removeWhere,this.rest=b}return O.prototype.save=function(b,E){var P=this.rest,f=C.default.fromValues(b),p=P.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,a=n.defaultPostHeaders(P.options,p),o={};if(typeof E!="function"){if(this.rest.options.promises)return n.promisify(this,"save",arguments);E=$}P.options.headers&&n.mixin(a,P.options.headers),P.options.pushFullWait&&n.mixin(o,{fullWait:"true"});var d=n.encodeBody(f,p);y.default.post(P,"/push/channelSubscriptions",d,a,o,null,function(l,g,R,k){E(l,!l&&C.default.fromResponseBody(g,k?void 0:p))})},O.prototype.list=function(b,E){var P=this.rest,f=P.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,p=this.rest.http.supportsLinkHeaders?void 0:f,a=n.defaultGetHeaders(P.options,f);if(typeof E!="function"){if(this.rest.options.promises)return n.promisify(this,"list",arguments);E=$}P.options.headers&&n.mixin(a,P.options.headers),new A.default(P,"/push/channelSubscriptions",a,p,function(o,d,l){return C.default.fromResponseBody(o,l?void 0:f)}).get(b,E)},O.prototype.removeWhere=function(b,E){var P=this.rest,f=P.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,p=n.defaultGetHeaders(P.options,f);if(typeof E!="function"){if(this.rest.options.promises)return n.promisify(this,"removeWhere",arguments);E=$}P.options.headers&&n.mixin(p,P.options.headers),P.options.pushFullWait&&n.mixin(b,{fullWait:"true"}),y.default.delete(P,"/push/channelSubscriptions",p,b,null,function(a){return E(a)})},O.prototype.listChannels=function(b,E){var P=this.rest,f=P.options.useBinaryProtocol?n.Format.msgpack:n.Format.json,p=this.rest.http.supportsLinkHeaders?void 0:f,a=n.defaultGetHeaders(P.options,f);if(typeof E!="function"){if(this.rest.options.promises)return n.promisify(this,"listChannels",arguments);E=$}P.options.headers&&n.mixin(a,P.options.headers),P.options.pushFullWait&&n.mixin(b,{fullWait:"true"}),new A.default(P,"/push/channels",a,p,function(o,d,l){for(var g=!l&&f?n.decodeBody(o,f):o,R=0;R<g.length;R++)g[R]=String(g[R]);return g}).get(b,E)},O}();i.default=_},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importStar(u(1)),x=v.__importDefault(u(4)),y;(function(C){C.Phone="phone",C.Tablet="tablet",C.Desktop="desktop",C.TV="tv",C.Watch="watch",C.Car="car",C.Embedded="embedded",C.Other="other"})(y||(y={}));var A;(function(C){C.Android="android",C.IOS="ios",C.Browser="browser"})(A||(A={}));var m=function(){function C(){}return C.prototype.toJSON=function(){var $,_,r;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:($=this.push)===null||$===void 0?void 0:$.recipient,state:(_=this.push)===null||_===void 0?void 0:_.state,error:(r=this.push)===null||r===void 0?void 0:r.error}}},C.prototype.toString=function(){var $,_,r,h,S="[DeviceDetails";return this.id&&(S+="; id="+this.id),this.platform&&(S+="; platform="+this.platform),this.formFactor&&(S+="; formFactor="+this.formFactor),this.clientId&&(S+="; clientId="+this.clientId),this.metadata&&(S+="; metadata="+this.metadata),this.deviceIdentityToken&&(S+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),!(($=this.push)===null||$===void 0)&&$.recipient&&(S+="; push.recipient="+JSON.stringify(this.push.recipient)),!((_=this.push)===null||_===void 0)&&_.state&&(S+="; push.state="+this.push.state),!((r=this.push)===null||r===void 0)&&r.error&&(S+="; push.error="+JSON.stringify(this.push.error)),!((h=this.push)===null||h===void 0)&&h.metadata&&(S+="; push.metadata="+this.push.metadata),S+="]",S},C.fromResponseBody=function($,_){return _&&($=n.decodeBody($,_)),n.isArray($)?C.fromValuesArray($):C.fromValues($)},C.fromValues=function($){return $.error=$.error&&x.default.fromValues($.error),Object.assign(new C,$)},C.fromValuesArray=function($){for(var _=$.length,r=new Array(_),h=0;h<_;h++)r[h]=C.fromValues($[h]);return r},C.toRequestBody=n.encodeBody,C}();i.default=m},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importStar(u(1)),x=function(){function y(){}return y.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},y.prototype.toString=function(){var A="[PushChannelSubscription";return this.channel&&(A+="; channel="+this.channel),this.deviceId&&(A+="; deviceId="+this.deviceId),this.clientId&&(A+="; clientId="+this.clientId),A+="]",A},y.fromResponseBody=function(A,m){return m&&(A=n.decodeBody(A,m)),n.isArray(A)?y.fromValuesArray(A):y.fromValues(A)},y.fromValues=function(A){return Object.assign(new y,A)},y.fromValuesArray=function(A){for(var m=A.length,C=new Array(m),$=0;$<m;$++)C[$]=y.fromValues(A[$]);return C},y.toRequestBody=n.encodeBody,y}();i.default=x},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importStar(u(1)),x=function(){function P(f){this.count=f&&f.count||0,this.data=f&&f.data||0,this.uncompressedData=f&&f.uncompressedData||0,this.failed=f&&f.failed||0,this.refused=f&&f.refused||0}return P}(),y=function(P){v.__extends(f,P);function f(p){var a=P.call(this,p)||this;return p&&p.category&&(a.category={},n.forInOwnNonNullProperties(p.category,function(o){a.category[o]=new x(p.category[o])})),a}return f}(x),A=function(){function P(f){this.peak=f&&f.peak||0,this.min=f&&f.min||0,this.mean=f&&f.mean||0,this.opened=f&&f.opened||0,this.refused=f&&f.refused||0}return P}(),m=function(){function P(f){this.succeeded=f&&f.succeeded||0,this.failed=f&&f.failed||0,this.refused=f&&f.refused||0}return P}(),C=function(){function P(f){this.plain=new A(f&&f.plain),this.tls=new A(f&&f.tls),this.all=new A(f&&f.all)}return P}(),$=function(){function P(f){this.messages=new y(f&&f.messages),this.presence=new y(f&&f.presence),this.all=new y(f&&f.all)}return P}(),_=function(){function P(f){this.realtime=new $(f&&f.realtime),this.rest=new $(f&&f.rest),this.webhook=new $(f&&f.webhook),this.sharedQueue=new $(f&&f.sharedQueue),this.externalQueue=new $(f&&f.externalQueue),this.httpEvent=new $(f&&f.httpEvent),this.push=new $(f&&f.push),this.all=new $(f&&f.all)}return P}(),r=function(){function P(f){this.all=new $(f&&f.all),this.inbound=new _(f&&f.inbound),this.outbound=new _(f&&f.outbound)}return P}(),h=function(){function P(f){this.all=new $(f&&f.all),this.producerPaid=new r(f&&f.producerPaid),this.consumerPaid=new r(f&&f.consumerPaid)}return P}(),S=function(){function P(f){this.messages=f&&f.messages||0;var p=f&&f.notifications;this.notifications={invalid:p&&p.invalid||0,attempted:p&&p.attempted||0,successful:p&&p.successful||0,failed:p&&p.failed||0},this.directPublishes=f&&f.directPublishes||0}return P}(),O=function(){function P(f){this.succeeded=f&&f.succeeded||0,this.skipped=f&&f.skipped||0,this.failed=f&&f.failed||0}return P}(),b=function(){function P(f){var p=this;this.delta=void 0,f&&f.delta&&(this.delta={},n.forInOwnNonNullProperties(f.delta,function(a){p.delta[a]=new O(f.delta[a])}))}return P}(),E=function(P){v.__extends(f,P);function f(p){var a=P.call(this,p)||this;return a.persisted=new $(p&&p.persisted),a.connections=new C(p&&p.connections),a.channels=new A(p&&p.channels),a.apiRequests=new m(p&&p.apiRequests),a.tokenRequests=new m(p&&p.tokenRequests),a.xchgProducer=new h(p&&p.xchgProducer),a.xchgConsumer=new h(p&&p.xchgConsumer),a.push=new S(p&&p.pushStats),a.processed=new b(p&&p.processed),a.inProgress=p&&p.inProgress||void 0,a.unit=p&&p.unit||void 0,a.intervalId=p&&p.intervalId||void 0,a}return f.fromValues=function(p){return new f(p)},f}(r);i.default=E},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importStar(u(1)),x=v.__importDefault(u(30)),y=v.__importDefault(u(7)),A=v.__importDefault(u(2)),m=v.__importDefault(u(51)),C=v.__importDefault(u(38)),$=v.__importDefault(u(8)),_=v.__importDefault(u(4)),r=v.__importDefault(u(10)),h=v.__importDefault(u(35)),S=v.__importDefault(u(3)),O=v.__importDefault(u(9)),b=function(P){v.__extends(f,P);function f(p){var a=P.call(this,p)||this;return A.default.logAction(A.default.LOG_MINOR,"Realtime()",""),a.connection=new m.default(a,a.options),a.channels=new E(a),p.autoConnect!==!1&&a.connect(),a}return f.prototype.connect=function(){A.default.logAction(A.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},f.prototype.close=function(){A.default.logAction(A.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},f.Promise=function(p){return p=$.default.objectifyOptions(p),p.promises=!0,new f(p)},f.Callbacks=f,f.Utils=n,f.ConnectionManager=h.default,f.Platform=S.default,f.ProtocolMessage=r.default,f.Message=O.default,f}(x.default),E=function(P){v.__extends(f,P);function f(p){var a=P.call(this)||this;return a.realtime=p,a.all=Object.create(null),p.connection.connectionManager.on("transport.active",function(){a.onTransportActive()}),a}return f.prototype.channelSerials=function(){for(var p={},a=0,o=n.keysArray(this.all,!0);a<o.length;a++){var d=o[a],l=this.all[d];l.properties.channelSerial&&(p[d]=l.properties.channelSerial)}return p},f.prototype.recoverChannels=function(p){for(var a=0,o=n.keysArray(p,!0);a<o.length;a++){var d=o[a],l=this.get(d);l.properties.channelSerial=p[d]}},f.prototype.onChannelMessage=function(p){var a=p.channel;if(a===void 0){A.default.logAction(A.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+p.action);return}var o=this.all[a];if(!o){A.default.logAction(A.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+a);return}o.onMessage(p)},f.prototype.onTransportActive=function(){for(var p in this.all){var a=this.all[p];a.state==="attaching"||a.state==="detaching"?a.checkPendingState():a.state==="suspended"?a._attach(!1,null):a.state==="attached"&&a.requestState("attaching")}},f.prototype.propogateConnectionInterruption=function(p,a){var o={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},d=["attaching","attached","detaching","suspended"],l=o[p];for(var g in this.all){var R=this.all[g];n.arrIn(d,R.state)&&R.notifyState(l,a)}},f.prototype.get=function(p,a){p=String(p);var o=this.all[p];if(!o)o=this.all[p]=new C.default(this.realtime,p,a);else if(a){if(o._shouldReattachToSetOptions(a,o.channelOptions))throw new _.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);o.setOptions(a)}return o},f.prototype.getDerived=function(p,a,o){if(a.filter){var d=n.toBase64(a.filter),l=n.matchDerivedChannel(p);p="[filter=".concat(d).concat(l.qualifierParam,"]").concat(l.channelName)}return this.get(p,o)},f.prototype.release=function(p){p=String(p);var a=this.all[p];if(a){var o=a.getReleaseErr();if(o)throw o;delete this.all[p]}},f}(y.default);i.default=b},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importStar(u(1)),x=v.__importDefault(u(7)),y=v.__importDefault(u(35)),A=v.__importDefault(u(2)),m=v.__importDefault(u(37)),C=v.__importDefault(u(3));function $(){}var _=function(r){v.__extends(h,r);function h(S,O){var b=r.call(this)||this;return b.whenState=function(E,P){return x.default.prototype.whenState.call(b,E,b.state,P,new m.default(void 0,E))},b.ably=S,b.connectionManager=new y.default(S,O),b.state=b.connectionManager.state.state,b.key=void 0,b.id=void 0,b.errorReason=null,b.connectionManager.on("connectionstate",function(E){var P=b.state=E.current;C.default.Config.nextTick(function(){b.emit(P,E)})}),b.connectionManager.on("update",function(E){C.default.Config.nextTick(function(){b.emit("update",E)})}),b}return h.prototype.connect=function(){A.default.logAction(A.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},h.prototype.ping=function(S){if(A.default.logAction(A.default.LOG_MINOR,"Connection.ping()",""),!S){if(this.ably.options.promises)return n.promisify(this,"ping",arguments);S=$}this.connectionManager.ping(null,S)},h.prototype.close=function(){A.default.logAction(A.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},Object.defineProperty(h.prototype,"recoveryKey",{get:function(){return this.createRecoveryKey()},enumerable:!1,configurable:!0}),h.prototype.createRecoveryKey=function(){return this.connectionManager.createRecoveryKey()},h}(x.default);i.default=_},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0}),i.PendingMessage=void 0;var v=u(0),n=v.__importDefault(u(10)),x=v.__importStar(u(1)),y=v.__importDefault(u(7)),A=v.__importDefault(u(2)),m=v.__importDefault(u(36)),C=v.__importDefault(u(4)),$=n.default.Action,_=function(){function h(S,O){this.message=S,this.callback=O,this.merged=!1;var b=S.action;this.sendAttempted=!1,this.ackRequired=b==$.MESSAGE||b==$.PRESENCE}return h}();i.PendingMessage=_;var r=function(h){v.__extends(S,h);function S(O){var b=h.call(this)||this;return b.transport=O,b.messageQueue=new m.default,O.on("ack",function(E,P){b.onAck(E,P)}),O.on("nack",function(E,P,f){b.onNack(E,P,f)}),b}return S.prototype.onAck=function(O,b){A.default.logAction(A.default.LOG_MICRO,"Protocol.onAck()","serial = "+O+"; count = "+b),this.messageQueue.completeMessages(O,b)},S.prototype.onNack=function(O,b,E){A.default.logAction(A.default.LOG_ERROR,"Protocol.onNack()","serial = "+O+"; count = "+b+"; err = "+x.inspectError(E)),E||(E=new C.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(O,b,E)},S.prototype.onceIdle=function(O){var b=this.messageQueue;if(b.count()===0){O();return}b.once("idle",O)},S.prototype.send=function(O){O.ackRequired&&this.messageQueue.push(O),A.default.shouldLog(A.default.LOG_MICRO)&&A.default.logAction(A.default.LOG_MICRO,"Protocol.send()","sending msg; "+n.default.stringify(O.message)),O.sendAttempted=!0,this.transport.send(O.message)},S.prototype.getTransport=function(){return this.transport},S.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},S.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},S.prototype.finish=function(){var O=this.transport;this.onceIdle(function(){O.disconnect()})},S}(y.default);i.default=r},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importDefault(u(3)),x=v.__importStar(u(1)),y=v.__importDefault(u(26)),A=v.__importDefault(u(8)),m=v.__importDefault(u(2)),C=v.__importDefault(u(10)),$=v.__importDefault(u(4)),_="web_socket";function r(O){return!!O.on}var h=function(O){v.__extends(b,O);function b(E,P,f){var p=O.call(this,E,P,f)||this;return p.shortName=_,f.heartbeats=n.default.Config.useProtocolHeartbeats,p.wsHost=A.default.getHost(f.options,f.host,!0),p}return b.isAvailable=function(){return!!n.default.Config.WebSocket},b.prototype.createWebSocket=function(E,P){return this.uri=E+x.toQueryString(P),new n.default.Config.WebSocket(this.uri)},b.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},b.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),y.default.prototype.connect.call(this);var E=this,P=this.params,f=P.options,p=f.tls?"wss://":"ws://",a=p+this.wsHost+":"+A.default.getPort(f)+"/";m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+a),this.auth.getAuthParams(function(o,d){if(!E.isDisposed){var l="";for(var g in d)l+=" "+g+": "+d[g]+";";if(m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+l+" err: "+o),o){E.disconnect(o);return}var R=P.getConnectParams(d);try{var k=E.wsConnection=E.createWebSocket(a,R);k.binaryType=n.default.Config.binaryType,k.onopen=function(){E.onWsOpen()},k.onclose=function(T){E.onWsClose(T)},k.onmessage=function(T){E.onWsData(T.data)},k.onerror=function(T){E.onWsError(T)},r(k)&&k.on("ping",function(){E.onActivity()})}catch(T){m.default.logAction(m.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(T.stack||T.message)),E.disconnect(T)}}})},b.prototype.send=function(E){var P=this.wsConnection;if(!P){m.default.logAction(m.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{P.send(C.default.serialize(E,this.params.format))}catch(p){var f="Exception from ws connection when trying to send: "+x.inspectError(p);m.default.logAction(m.default.LOG_ERROR,"WebSocketTransport.send()",f),this.finish("disconnected",new $.default(f,5e4,500))}},b.prototype.onWsData=function(E){m.default.logAction(m.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+E.length+"; type = "+typeof E);try{this.onProtocolMessage(C.default.deserialize(E,this.format))}catch(P){m.default.logAction(m.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+P.stack)}},b.prototype.onWsOpen=function(){m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},b.prototype.onWsClose=function(E){var P,f;if(typeof E=="object"?(f=E.code,P=E.wasClean||f===1e3):(f=E,P=f==1e3),delete this.wsConnection,P){m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var p=new $.default("Websocket closed",80003,400);this.finish("disconnected",p)}else{var a="Unclean disconnection of WebSocket ; code = "+f,p=new $.default(a,80003,400);m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.onWsClose()",a),this.finish("disconnected",p)}this.emit("disposed")},b.prototype.onWsError=function(E){var P=this;m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+E.message),n.default.Config.nextTick(function(){P.disconnect(Error(E.message))})},b.prototype.dispose=function(){m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var E=this.wsConnection;E&&(E.onmessage=function(){},delete this.wsConnection,n.default.Config.nextTick(function(){if(m.default.logAction(m.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!E)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");E.close()}))},b}(y.default);function S(O){return h.isAvailable()&&(O.supportedTransports[_]=h),h}i.default=S},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importStar(u(1)),x=v.__importDefault(u(34)),y=v.__importDefault(u(7)),A=v.__importDefault(u(2)),m=v.__importDefault(u(16)),C=v.__importStar(u(4)),$=v.__importDefault(u(38)),_=v.__importDefault(u(24)),r=v.__importDefault(u(39)),h=function(){};function S(p){return p.channel.realtime.auth.clientId}function O(p){var a=p.channel.realtime,o=a.auth.clientId;return(!o||o==="*")&&a.connection.state==="connected"}function b(p,a,o){switch(p.state){case"attached":case"suspended":o();break;case"initialized":case"detached":case"detaching":case"attaching":p.attach(function(d){d?a(d):o()});break;default:a(C.default.fromValues(p.invalidStateError()))}}function E(p,a){if(p.isSynthesized()||a.isSynthesized())return p.timestamp>=a.timestamp;var o=p.parseId(),d=a.parseId();return o.msgSerial===d.msgSerial?o.index>d.index:o.msgSerial>d.msgSerial}var P=function(p){v.__extends(a,p);function a(o){var d=p.call(this,o)||this;return d.channel=o,d.syncComplete=!1,d.members=new f(d,function(l){return l.clientId+":"+l.connectionId}),d._myMembers=new f(d,function(l){return l.clientId}),d.subscriptions=new y.default,d.pendingPresence=[],d}return a.prototype.enter=function(o,d){if(O(this))throw new C.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,o,"enter",d)},a.prototype.update=function(o,d){if(O(this))throw new C.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,o,"update",d)},a.prototype.enterClient=function(o,d,l){return this._enterOrUpdateClient(void 0,o,d,"enter",l)},a.prototype.updateClient=function(o,d,l){return this._enterOrUpdateClient(void 0,o,d,"update",l)},a.prototype._enterOrUpdateClient=function(o,d,l,g,R){var k=this;if(!R)if(typeof l=="function")R=l,l=null;else{if(this.channel.realtime.options.promises)return n.promisify(this,"_enterOrUpdateClient",[o,d,l,g]);R=h}var T=this.channel;if(!T.connectionManager.activeState()){R(T.connectionManager.getError());return}A.default.logAction(A.default.LOG_MICRO,"RealtimePresence."+g+"Client()","channel = "+T.name+", id = "+o+", client = "+(d||"(implicit) "+S(this)));var V=m.default.fromData(l);V.action=g,o&&(V.id=o),d&&(V.clientId=d),m.default.encode(V,T.channelOptions,function(F){if(F){R(F);return}switch(T.state){case"attached":T.sendPresence(V,R);break;case"initialized":case"detached":T.attach();case"attaching":k.pendingPresence.push({presence:V,callback:R});break;default:F=new C.PartialErrorInfo("Unable to "+g+" presence channel while in "+T.state+" state",90001),F.code=90001,R(F)}})},a.prototype.leave=function(o,d){if(O(this))throw new C.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,o,d)},a.prototype.leaveClient=function(o,d,l){if(!l)if(typeof d=="function")l=d,d=null;else{if(this.channel.realtime.options.promises)return n.promisify(this,"leaveClient",[o,d]);l=h}var g=this.channel;if(!g.connectionManager.activeState()){l==null||l(g.connectionManager.getError());return}A.default.logAction(A.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+o);var R=m.default.fromData(d);switch(R.action="leave",o&&(R.clientId=o),g.state){case"attached":g.sendPresence(R,l);break;case"attaching":this.pendingPresence.push({presence:R,callback:l});break;case"initialized":case"failed":{var k=new C.PartialErrorInfo("Unable to leave presence channel (incompatible state)",90001);l==null||l(k);break}default:l==null||l(g.invalidStateError())}},a.prototype.get=function(o,d){var l=this,g=Array.prototype.slice.call(arguments);g.length==1&&typeof g[0]=="function"&&g.unshift(null),o=g[0],d=g[1];var R=!o||("waitForSync"in o?o.waitForSync:!0);if(!d){if(this.channel.realtime.options.promises)return n.promisify(this,"get",g);d=h}function k(T){d(null,o?T.list(o):T.values())}if(this.channel.state==="suspended"){R?d(C.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):k(this.members);return}b(this.channel,d,function(){var T=l.members;R?T.waitSync(function(){k(T)}):k(T)})},a.prototype.history=function(o,d){if(A.default.logAction(A.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),d===void 0)if(typeof o=="function")d=o,o=null;else{if(this.channel.realtime.options.promises)return n.promisify(this,"history",arguments);d=h}o&&o.untilAttach&&(this.channel.state==="attached"?(delete o.untilAttach,o.from_serial=this.channel.properties.attachSerial):d(new C.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),x.default.prototype._history.call(this,o,d)},a.prototype.setPresence=function(o,d,l){A.default.logAction(A.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+o.length+" participants; syncChannelSerial = "+l);var g,R,k=this.members,T=this._myMembers,V=[],F=this.channel.connectionManager.connectionId;d&&(this.members.startSync(),l&&(R=l.match(/^[\w-]+:(.*)$/))&&(g=R[1]));for(var M=0;M<o.length;M++){var D=m.default.fromValues(o[M]);switch(D.action){case"leave":k.remove(D)&&V.push(D),D.connectionId===F&&!D.isSynthesized()&&T.remove(D);break;case"enter":case"present":case"update":k.put(D)&&V.push(D),D.connectionId===F&&T.put(D);break}}d&&!g&&(k.endSync(),this.channel.syncChannelSerial=null);for(var M=0;M<V.length;M++){var D=V[M];this.subscriptions.emit(D.action,D)}},a.prototype.onAttached=function(o){A.default.logAction(A.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+o),o?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();var d=this.pendingPresence,l=d.length;if(l){this.pendingPresence=[];var g=[],R=_.default.create();A.default.logAction(A.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+l+" queued presence messages");for(var k=0;k<l;k++){var T=d[k];g.push(T.presence),R.push(T.callback)}this.channel.sendPresence(g,R)}},a.prototype.actOnChannelState=function(o,d,l){switch(o){case"attached":this.onAttached(d);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(l);break}},a.prototype.failPendingPresence=function(o){if(this.pendingPresence.length){A.default.logAction(A.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+n.inspectError(o));for(var d=0;d<this.pendingPresence.length;d++)try{this.pendingPresence[d].callback(o)}catch{}this.pendingPresence=[]}},a.prototype._clearMyMembers=function(){this._myMembers.clear()},a.prototype._ensureMyMembersPresent=function(){var o=this,d=this._myMembers,l=function(k){if(k){var T="Presence auto-re-enter failed: "+k.toString(),V=new C.default(T,91004,400);A.default.logAction(A.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",T);var F=new r.default(o.channel.state,o.channel.state,!0,!1,V);o.channel.emit("update",F)}};for(var g in d.map){var R=d.map[g];A.default.logAction(A.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+R.clientId+'" into the presence set'),this._enterOrUpdateClient(R.id,R.clientId,R.data,"enter",l)}},a.prototype._synthesizeLeaves=function(o){var d=this.subscriptions;n.arrForEach(o,function(l){var g=m.default.fromValues({action:"leave",connectionId:l.connectionId,clientId:l.clientId,data:l.data,encoding:l.encoding,timestamp:n.now()});d.emit("leave",g)})},a.prototype.on=function(){for(var o=[],d=0;d<arguments.length;d++)o[d]=arguments[d];A.default.renamedMethod("RealtimePresence","on","subscribe"),this.subscribe.apply(this,o)},a.prototype.off=function(){for(var o=[],d=0;d<arguments.length;d++)o[d]=arguments[d];A.default.renamedMethod("RealtimePresence","off","unsubscribe"),this.unsubscribe.apply(this,o)},a.prototype.subscribe=function(){for(var o=[],d=0;d<arguments.length;d++)o[d]=arguments[d];var l=$.default.processListenerArgs(o),g=l[0],R=l[1],k=l[2],T=this.channel;if(!k){if(this.channel.realtime.options.promises)return n.promisify(this,"subscribe",[g,R]);k=h}if(T.state==="failed"){k(C.default.fromValues(T.invalidStateError()));return}this.subscriptions.on(g,R),T.attach(k)},a.prototype.unsubscribe=function(){for(var o=[],d=0;d<arguments.length;d++)o[d]=arguments[d];var l=$.default.processListenerArgs(o),g=l[0],R=l[1];this.subscriptions.off(g,R)},a}(x.default),f=function(p){v.__extends(a,p);function a(o,d){var l=p.call(this)||this;return l.presence=o,l.map=Object.create(null),l.syncInProgress=!1,l.residualMembers=null,l.memberKey=d,l}return a.prototype.get=function(o){return this.map[o]},a.prototype.getClient=function(o){var d=this.map,l=[];for(var g in d){var R=d[g];R.clientId==o&&R.action!="absent"&&l.push(R)}return l},a.prototype.list=function(o){var d=this.map,l=o&&o.clientId,g=o&&o.connectionId,R=[];for(var k in d){var T=d[k];T.action!=="absent"&&(l&&l!=T.clientId||g&&g!=T.connectionId||R.push(T))}return R},a.prototype.put=function(o){(o.action==="enter"||o.action==="update")&&(o=m.default.fromValues(o),o.action="present");var d=this.map,l=this.memberKey(o);this.residualMembers&&delete this.residualMembers[l];var g=d[l];return g&&!E(o,g)?!1:(d[l]=o,!0)},a.prototype.values=function(){var o=this.map,d=[];for(var l in o){var g=o[l];g.action!="absent"&&d.push(g)}return d},a.prototype.remove=function(o){var d=this.map,l=this.memberKey(o),g=d[l];return g&&!E(o,g)?!1:(this.syncInProgress?(o=m.default.fromValues(o),o.action="absent",d[l]=o):delete d[l],!0)},a.prototype.startSync=function(){var o=this.map,d=this.syncInProgress;A.default.logAction(A.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+d),this.syncInProgress||(this.residualMembers=n.copy(o),this.setInProgress(!0))},a.prototype.endSync=function(){var o=this.map,d=this.syncInProgress;if(A.default.logAction(A.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+d),d){for(var l in o){var g=o[l];g.action==="absent"&&delete o[l]}this.presence._synthesizeLeaves(n.valuesArray(this.residualMembers));for(var l in this.residualMembers)delete o[l];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},a.prototype.waitSync=function(o){var d=this.syncInProgress;if(A.default.logAction(A.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+d),!d){o();return}this.once("sync",o)},a.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},a.prototype.setInProgress=function(o){A.default.logAction(A.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+o),this.syncInProgress=o,this.presence.syncComplete=!o},a}(y.default);i.default=P},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=u(56),x=u(31),y=u(11),A=v.__importDefault(u(5)),m=v.__importDefault(u(3)),C=function(){function $(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return $.prototype.isWordArray=function(_){return _!=null&&_.sigBytes!==void 0},$.prototype.isArrayBuffer=function(_){return _!=null&&_.constructor===ArrayBuffer},$.prototype.isTypedArray=function(_){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(_)},$.prototype.uint8ViewToBase64=function(_){for(var r="",h=this.base64CharSet,S=_.byteLength,O=S%3,b=S-O,E,P,f,p,a,o=0;o<b;o=o+3)a=_[o]<<16|_[o+1]<<8|_[o+2],E=(a&16515072)>>18,P=(a&258048)>>12,f=(a&4032)>>6,p=a&63,r+=h[E]+h[P]+h[f]+h[p];return O==1?(a=_[b],E=(a&252)>>2,P=(a&3)<<4,r+=h[E]+h[P]+"=="):O==2&&(a=_[b]<<8|_[b+1],E=(a&64512)>>10,P=(a&1008)>>4,f=(a&15)<<2,r+=h[E]+h[P]+h[f]+"="),r},$.prototype.base64ToArrayBuffer=function(_){for(var r=atob==null?void 0:atob(_),h=r.length,S=new Uint8Array(h),O=0;O<h;O++){var b=r.charCodeAt(O);S[O]=b}return S.buffer},$.prototype.isBuffer=function(_){return this.isArrayBuffer(_)||this.isWordArray(_)||this.isTypedArray(_)},$.prototype.toBuffer=function(_){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(_))return new Uint8Array(_);if(this.isTypedArray(_))return new Uint8Array(_.buffer);if(this.isWordArray(_)){for(var r=new ArrayBuffer(_.sigBytes),h=new Uint8Array(r),S=0;S<_.sigBytes;S++)h[S]=_.words[S>>>2]>>>24-S%4*8&255;return h}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},$.prototype.toArrayBuffer=function(_){return this.isArrayBuffer(_)?_:this.toBuffer(_).buffer},$.prototype.toWordArray=function(_){return this.isTypedArray(_)&&(_=_.buffer),this.isWordArray(_)?_:A.default.create(_)},$.prototype.base64Encode=function(_){return this.isWordArray(_)?(0,y.stringify)(_):this.uint8ViewToBase64(this.toBuffer(_))},$.prototype.base64Decode=function(_){return ArrayBuffer&&m.default.Config.atob?this.base64ToArrayBuffer(_):(0,y.parse)(_)},$.prototype.hexEncode=function(_){return(0,n.stringify)(this.toWordArray(_))},$.prototype.hexDecode=function(_){var r=(0,n.parse)(_);return ArrayBuffer?this.toArrayBuffer(r):r},$.prototype.utf8Encode=function(_){return m.default.Config.TextEncoder?new m.default.Config.TextEncoder().encode(_).buffer:(0,x.parse)(_)},$.prototype.utf8Decode=function(_){if(!this.isBuffer(_))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(_)?new TextDecoder().decode(_):(_=this.toWordArray(_),(0,x.stringify)(_))},$.prototype.bufferCompare=function(_,r){if(!_)return-1;if(!r)return 1;var h=this.toWordArray(_),S=this.toWordArray(r);h.clamp(),S.clamp();var O=h.sigBytes-S.sigBytes;if(O!=0)return O;for(var b=h.words,E=S.words,P=0;P<b.length;P++)if(O=b[P]-E[P],O!=0)return O;return 0},$.prototype.byteLength=function(_){return this.isArrayBuffer(_)||this.isTypedArray(_)?_.byteLength:this.isWordArray(_)?_.sigBytes:-1},$.prototype.typedArrayToBuffer=function(_){return _.buffer},$}();i.default=new C},function(w,i,u){(function(v,n){w.exports=n(u(6))})(this,function(v){return v.enc.Hex})},function(w,i,u){u.r(i);var v=u(5),n=u.n(v),x=u(11),y=u(23),A=u.n(y),m=u(2),C=u.n(m),$=u(4),_=u.n($),r=function(h,S){var O="aes",b=256,E="cbc",P=16,f=4,p=4294967296,a=2147483648,o;if(h.getRandomWordArray)o=h.getRandomWordArray;else if(typeof Uint32Array<"u"&&h.getRandomValues){var d=new Uint32Array(f);o=function(M,D){var U=M/4,B=U==f?d:new Uint32Array(U);h.getRandomValues(B,function(Q){typeof D<"u"&&D(Q,S.toWordArray(B))})}}else o=function(M,D){C.a.logAction(C.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var U=M/4,B=new Array(U),Q=0;Q<U;Q++)B[Q]=Math.floor(Math.random()*p)-a;D(null,n.a.create(B))};function l(M){return M+P&-16}function g(M){if(M.algorithm==="aes"&&M.mode==="cbc"){if(M.keyLength===128||M.keyLength===256)return;throw new Error("Unsupported key length "+M.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function R(M){return M.replace("_","/").replace("-","+")}var k=[n.a.create([269488144,269488144,269488144,269488144],16),n.a.create([16777216],1),n.a.create([33685504],2),n.a.create([50529024],3),n.a.create([67372036],4),n.a.create([84215045,83886080],5),n.a.create([101058054,101056512],6),n.a.create([117901063,117901056],7),n.a.create([134744072,134744072],8),n.a.create([151587081,151587081,150994944],9),n.a.create([168430090,168430090,168427520],10),n.a.create([185273099,185273099,185273088],11),n.a.create([202116108,202116108,202116108],12),n.a.create([218959117,218959117,218959117,218103808],13),n.a.create([235802126,235802126,235802126,235798528],14),n.a.create([252645135,252645135,252645135,252645135],15),n.a.create([269488144,269488144,269488144,269488144],16)];function T(){}function V(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}T.CipherParams=V,T.getDefaultParams=function(M){var D;if(typeof M=="function"||typeof M=="string"){if(C.a.deprecated("The ability to pass a callback to `Crypto.getDefaultParams()`","This method now directly returns its result, instead of returning it asynchronously via a callback. Please update your code so that it uses the return value of this method instead of passing a callback."),typeof M=="function")C.a.deprecated("The ability to call `Crypto.getDefaultParams()` without specifying an encryption key","Please update your code so that it instead passes an object whose `key` property contains an encryption key. That is, replace `Crypto.getDefaultParams()` with `Crypto.getDefaultParams({ key })`, where `key` is an encryption key that you have generated (for example from the `Crypto.generateRandomKey()` method)."),T.generateRandomKey(function(B){M(null,T.getDefaultParams({key:B}))});else if(typeof arguments[1]=="function")C.a.deprecated("The ability to pass the encryption key as the first argument of `Crypto.getDefaultParams()`","Please update your code so that it instead passes an object whose `key` property contains the key. That is, replace `Crypto.getDefaultParams(key)` with `Crypto.getDefaultParams({ key })`."),arguments[1](null,T.getDefaultParams({key:M}));else throw new Error("Invalid arguments for Crypto.getDefaultParams");return}if(!M.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof M.key=="string"?D=Object(x.parse)(R(M.key)):D=S.toWordArray(M.key);var U=new V;if(U.key=D,U.algorithm=M.algorithm||O,U.keyLength=D.words.length*(4*8),U.mode=M.mode||E,M.keyLength&&M.keyLength!==U.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+M.keyLength+" was specified, but the key actually has length "+U.keyLength);return g(U),U},T.generateRandomKey=function(M,D){arguments.length==1&&typeof M=="function"&&(D=M,M=void 0),o((M||b)/8,function(U,B){D!==void 0&&D(U?_.a.fromValues(U):null,B)})},T.getCipher=function(M){var D=M instanceof V?M:T.getDefaultParams(M);return{cipherParams:D,cipher:new F(D,f,M.iv)}};function F(M,D,U){this.algorithm=M.algorithm+"-"+String(M.keyLength)+"-"+M.mode,this.cjsAlgorithm=M.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=S.toWordArray(M.key),U&&(this.iv=S.toWordArray(U).clone()),this.blockLengthWords=D}return F.prototype.encrypt=function(M,D){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.encrypt()",""),M=S.toWordArray(M);var U=M.sigBytes,B=l(U),Q=this,te=function(){Q.getIv(function(Y,q){if(Y){D(Y);return}var j=Q.encryptCipher.process(M.concat(k[B-U])),G=q.concat(j);D(null,G)})};this.encryptCipher?te():this.iv?(this.encryptCipher=A.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),te()):o(P,function(Y,q){if(Y){D(Y);return}Q.encryptCipher=A.a.algo[Q.cjsAlgorithm].createEncryptor(Q.key,{iv:q}),Q.iv=q,te()})},F.prototype.decrypt=function(M){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.decrypt()",""),M=S.toWordArray(M);var D=this.blockLengthWords,U=M.words,B=n.a.create(U.slice(0,D)),Q=n.a.create(U.slice(D)),te=A.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:B}),Y=te.process(Q),q=te.finalize();return te.reset(),q&&q.sigBytes&&Y.concat(q),Y},F.prototype.getIv=function(M){if(this.iv){var D=this.iv;this.iv=null,M(null,D);return}var U=this;o(P,function(B,Q){if(B){M(B);return}M(null,U.encryptCipher.process(Q))})},T};i.default=r},function(w,i,u){(function(v,n){w.exports=n(u(6))})(this,function(v){return function(){var n=v,x=n.lib,y=x.WordArray,A=n.enc;A.Utf16=A.Utf16BE={stringify:function(C){for(var $=C.words,_=C.sigBytes,r=[],h=0;h<_;h+=2){var S=$[h>>>2]>>>16-h%4*8&65535;r.push(String.fromCharCode(S))}return r.join("")},parse:function(C){for(var $=C.length,_=[],r=0;r<$;r++)_[r>>>1]|=C.charCodeAt(r)<<16-r%2*16;return y.create(_,$*2)}},A.Utf16LE={stringify:function(C){for(var $=C.words,_=C.sigBytes,r=[],h=0;h<_;h+=2){var S=m($[h>>>2]>>>16-h%4*8&65535);r.push(String.fromCharCode(S))}return r.join("")},parse:function(C){for(var $=C.length,_=[],r=0;r<$;r++)_[r>>>1]|=m(C.charCodeAt(r)<<16-r%2*16);return y.create(_,$*2)}};function m(C){return C<<8&4278255360|C>>>8&16711935}}(),v.enc.Utf16})},function(w,i,u){(function(v,n){w.exports=n(u(6),u(28))})(this,function(v){return function(n){var x=v,y=x.lib,A=y.CipherParams,m=x.enc,C=m.Hex,$=x.format;$.Hex={stringify:function(_){return _.ciphertext.toString(C)},parse:function(_){var r=C.parse(_);return A.create({ciphertext:r})}}}(),v.format.Hex})},function(w,i,u){(function(v,n){w.exports=n(u(6),u(11),u(61),u(27),u(28))})(this,function(v){return function(){var n=v,x=n.lib,y=x.BlockCipher,A=n.algo,m=[],C=[],$=[],_=[],r=[],h=[],S=[],O=[],b=[],E=[];(function(){for(var p=[],a=0;a<256;a++)a<128?p[a]=a<<1:p[a]=a<<1^283;for(var o=0,d=0,a=0;a<256;a++){var l=d^d<<1^d<<2^d<<3^d<<4;l=l>>>8^l&255^99,m[o]=l,C[l]=o;var g=p[o],R=p[g],k=p[R],T=p[l]*257^l*16843008;$[o]=T<<24|T>>>8,_[o]=T<<16|T>>>16,r[o]=T<<8|T>>>24,h[o]=T;var T=k*16843009^R*65537^g*257^o*16843008;S[l]=T<<24|T>>>8,O[l]=T<<16|T>>>16,b[l]=T<<8|T>>>24,E[l]=T,o?(o=g^p[p[p[k^g]]],d^=p[p[d]]):o=d=1}})();var P=[0,1,2,4,8,16,32,64,128,27,54],f=A.AES=y.extend({_doReset:function(){var p;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var a=this._keyPriorReset=this._key,o=a.words,d=a.sigBytes/4,l=this._nRounds=d+6,g=(l+1)*4,R=this._keySchedule=[],k=0;k<g;k++)k<d?R[k]=o[k]:(p=R[k-1],k%d?d>6&&k%d==4&&(p=m[p>>>24]<<24|m[p>>>16&255]<<16|m[p>>>8&255]<<8|m[p&255]):(p=p<<8|p>>>24,p=m[p>>>24]<<24|m[p>>>16&255]<<16|m[p>>>8&255]<<8|m[p&255],p^=P[k/d|0]<<24),R[k]=R[k-d]^p);for(var T=this._invKeySchedule=[],V=0;V<g;V++){var k=g-V;if(V%4)var p=R[k];else var p=R[k-4];V<4||k<=4?T[V]=p:T[V]=S[m[p>>>24]]^O[m[p>>>16&255]]^b[m[p>>>8&255]]^E[m[p&255]]}}},encryptBlock:function(p,a){this._doCryptBlock(p,a,this._keySchedule,$,_,r,h,m)},decryptBlock:function(p,a){var o=p[a+1];p[a+1]=p[a+3],p[a+3]=o,this._doCryptBlock(p,a,this._invKeySchedule,S,O,b,E,C);var o=p[a+1];p[a+1]=p[a+3],p[a+3]=o},_doCryptBlock:function(p,a,o,d,l,g,R,k){for(var T=this._nRounds,V=p[a]^o[0],F=p[a+1]^o[1],M=p[a+2]^o[2],D=p[a+3]^o[3],U=4,B=1;B<T;B++){var Q=d[V>>>24]^l[F>>>16&255]^g[M>>>8&255]^R[D&255]^o[U++],te=d[F>>>24]^l[M>>>16&255]^g[D>>>8&255]^R[V&255]^o[U++],Y=d[M>>>24]^l[D>>>16&255]^g[V>>>8&255]^R[F&255]^o[U++],q=d[D>>>24]^l[V>>>16&255]^g[F>>>8&255]^R[M&255]^o[U++];V=Q,F=te,M=Y,D=q}var Q=(k[V>>>24]<<24|k[F>>>16&255]<<16|k[M>>>8&255]<<8|k[D&255])^o[U++],te=(k[F>>>24]<<24|k[M>>>16&255]<<16|k[D>>>8&255]<<8|k[V&255])^o[U++],Y=(k[M>>>24]<<24|k[D>>>16&255]<<16|k[V>>>8&255]<<8|k[F&255])^o[U++],q=(k[D>>>24]<<24|k[V>>>16&255]<<16|k[F>>>8&255]<<8|k[M&255])^o[U++];p[a]=Q,p[a+1]=te,p[a+2]=Y,p[a+3]=q},keySize:256/32});n.AES=y._createHelper(f)}(),v.AES})},function(w,i,u){(function(v,n){w.exports=n(u(6))})(this,function(v){return function(n){var x=v,y=x.lib,A=y.WordArray,m=y.Hasher,C=x.algo,$=[];(function(){for(var b=0;b<64;b++)$[b]=n.abs(n.sin(b+1))*4294967296|0})();var _=C.MD5=m.extend({_doReset:function(){this._hash=new A.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(b,E){for(var P=0;P<16;P++){var f=E+P,p=b[f];b[f]=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360}var a=this._hash.words,o=b[E+0],d=b[E+1],l=b[E+2],g=b[E+3],R=b[E+4],k=b[E+5],T=b[E+6],V=b[E+7],F=b[E+8],M=b[E+9],D=b[E+10],U=b[E+11],B=b[E+12],Q=b[E+13],te=b[E+14],Y=b[E+15],q=a[0],j=a[1],G=a[2],W=a[3];q=r(q,j,G,W,o,7,$[0]),W=r(W,q,j,G,d,12,$[1]),G=r(G,W,q,j,l,17,$[2]),j=r(j,G,W,q,g,22,$[3]),q=r(q,j,G,W,R,7,$[4]),W=r(W,q,j,G,k,12,$[5]),G=r(G,W,q,j,T,17,$[6]),j=r(j,G,W,q,V,22,$[7]),q=r(q,j,G,W,F,7,$[8]),W=r(W,q,j,G,M,12,$[9]),G=r(G,W,q,j,D,17,$[10]),j=r(j,G,W,q,U,22,$[11]),q=r(q,j,G,W,B,7,$[12]),W=r(W,q,j,G,Q,12,$[13]),G=r(G,W,q,j,te,17,$[14]),j=r(j,G,W,q,Y,22,$[15]),q=h(q,j,G,W,d,5,$[16]),W=h(W,q,j,G,T,9,$[17]),G=h(G,W,q,j,U,14,$[18]),j=h(j,G,W,q,o,20,$[19]),q=h(q,j,G,W,k,5,$[20]),W=h(W,q,j,G,D,9,$[21]),G=h(G,W,q,j,Y,14,$[22]),j=h(j,G,W,q,R,20,$[23]),q=h(q,j,G,W,M,5,$[24]),W=h(W,q,j,G,te,9,$[25]),G=h(G,W,q,j,g,14,$[26]),j=h(j,G,W,q,F,20,$[27]),q=h(q,j,G,W,Q,5,$[28]),W=h(W,q,j,G,l,9,$[29]),G=h(G,W,q,j,V,14,$[30]),j=h(j,G,W,q,B,20,$[31]),q=S(q,j,G,W,k,4,$[32]),W=S(W,q,j,G,F,11,$[33]),G=S(G,W,q,j,U,16,$[34]),j=S(j,G,W,q,te,23,$[35]),q=S(q,j,G,W,d,4,$[36]),W=S(W,q,j,G,R,11,$[37]),G=S(G,W,q,j,V,16,$[38]),j=S(j,G,W,q,D,23,$[39]),q=S(q,j,G,W,Q,4,$[40]),W=S(W,q,j,G,o,11,$[41]),G=S(G,W,q,j,g,16,$[42]),j=S(j,G,W,q,T,23,$[43]),q=S(q,j,G,W,M,4,$[44]),W=S(W,q,j,G,B,11,$[45]),G=S(G,W,q,j,Y,16,$[46]),j=S(j,G,W,q,l,23,$[47]),q=O(q,j,G,W,o,6,$[48]),W=O(W,q,j,G,V,10,$[49]),G=O(G,W,q,j,te,15,$[50]),j=O(j,G,W,q,k,21,$[51]),q=O(q,j,G,W,B,6,$[52]),W=O(W,q,j,G,g,10,$[53]),G=O(G,W,q,j,D,15,$[54]),j=O(j,G,W,q,d,21,$[55]),q=O(q,j,G,W,F,6,$[56]),W=O(W,q,j,G,Y,10,$[57]),G=O(G,W,q,j,T,15,$[58]),j=O(j,G,W,q,Q,21,$[59]),q=O(q,j,G,W,R,6,$[60]),W=O(W,q,j,G,U,10,$[61]),G=O(G,W,q,j,l,15,$[62]),j=O(j,G,W,q,M,21,$[63]),a[0]=a[0]+q|0,a[1]=a[1]+j|0,a[2]=a[2]+G|0,a[3]=a[3]+W|0},_doFinalize:function(){var b=this._data,E=b.words,P=this._nDataBytes*8,f=b.sigBytes*8;E[f>>>5]|=128<<24-f%32;var p=n.floor(P/4294967296),a=P;E[(f+64>>>9<<4)+15]=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,E[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360,b.sigBytes=(E.length+1)*4,this._process();for(var o=this._hash,d=o.words,l=0;l<4;l++){var g=d[l];d[l]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360}return o},clone:function(){var b=m.clone.call(this);return b._hash=this._hash.clone(),b}});function r(b,E,P,f,p,a,o){var d=b+(E&P|~E&f)+p+o;return(d<<a|d>>>32-a)+E}function h(b,E,P,f,p,a,o){var d=b+(E&f|P&~f)+p+o;return(d<<a|d>>>32-a)+E}function S(b,E,P,f,p,a,o){var d=b+(E^P^f)+p+o;return(d<<a|d>>>32-a)+E}function O(b,E,P,f,p,a,o){var d=b+(P^(E|~f))+p+o;return(d<<a|d>>>32-a)+E}x.MD5=m._createHelper(_),x.HmacMD5=m._createHmacHelper(_)}(Math),v.MD5})},function(w,i,u){var v;Object.defineProperty(i,"__esModule",{value:!0});var n=u(0),x=n.__importDefault(u(3)),y=n.__importStar(u(1)),A=n.__importDefault(u(8)),m=u(4),C=n.__importDefault(u(19)),$=n.__importDefault(u(17)),_=n.__importDefault(u(22)),r=n.__importDefault(u(2)),h=u(29),S=n.__importDefault(u(63)),O=u(14);function b(f){var p=f.statusCode;return p===408&&!f.code||p===400&&!f.code||p>=500&&p<=504}function E(f){var p=f.connection,a=p&&p.connectionManager.host;return a?[a].concat(A.default.getFallbackHosts(f.options)):A.default.getHosts(f.options)}var P=(v=function(){function f(p){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=E,this.options=p||{};var a=this.options.connectivityCheckUrl||A.default.connectivityCheckUrl,o=this.options.connectivityCheckParams,d=!this.options.connectivityCheckUrl;x.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(l,g,R,k,T,V,F){var M=$.default.createRequest(R,k,T,V,_.default.REQ_SEND,g&&g.options.timeouts,l);return M.once("complete",F),M.exec(),M},this.options.disableConnectivityCheck?this.checkConnectivity=function(l){l(null,!0)}:this.checkConnectivity=function(l){r.default.logAction(r.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+a),this.doUri(C.default.Get,null,a,null,null,o,function(g,R,k,T,V){var F=!1;d?F=!g&&(R==null?void 0:R.replace(/\n/,""))=="yes":F=!g&&(0,O.isSuccessCode)(V),r.default.logAction(r.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+F),l(null,F)})}):x.default.Config.jsonpSupported?(this.Request=function(l,g,R,k,T,V,F){var M=(0,h.createRequest)(R,k,T,V,_.default.REQ_SEND,g&&g.options.timeouts,l);return M.once("complete",F),x.default.Config.nextTick(function(){M.exec()}),M},this.options.disableConnectivityCheck?this.checkConnectivity=function(l){l(null,!0)}:this.checkConnectivity=function(l){var g=this,R=A.default.jsonpInternetUpUrl;if(this.checksInProgress){this.checksInProgress.push(l);return}this.checksInProgress=[l],r.default.logAction(r.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+R);var k=new h.Request("isTheInternetUp",R,null,null,null,_.default.REQ_SEND,A.default.TIMEOUTS);k.once("complete",function(T,V){var F=!T&&V;r.default.logAction(r.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+F);for(var M=0;M<g.checksInProgress.length;M++)g.checksInProgress[M](null,F);g.checksInProgress=null}),x.default.Config.nextTick(function(){k.exec()})}):x.default.Config.fetchSupported?(this.supportsAuthHeaders=!0,this.Request=S.default,this.checkConnectivity=function(l){r.default.logAction(r.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+a),this.doUri(C.default.Get,null,a,null,null,null,function(g,R){var k=!g&&(R==null?void 0:R.replace(/\n/,""))=="yes";r.default.logAction(r.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+k),l(null,k)})}):this.Request=function(l,g,R,k,T,V,F){F(new m.PartialErrorInfo("no supported HTTP transports available",null,400),null)}}return f.prototype.do=function(p,a,o,d,l,g,R){var k=this,T=typeof o=="function"?o:function(D){return a.baseUri(D)+o},V=a._currentFallback;if(V)if(V.validUntil>y.now()){if(!this.Request){R==null||R(new m.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(p,a,T(V.host),d,g,l,function(D){for(var U=[],B=1;B<arguments.length;B++)U[B-1]=arguments[B];if(D&&b(D)){a._currentFallback=null,k.do(p,a,o,d,l,g,R);return}R==null||R.apply(void 0,n.__spreadArray([D],U,!1))});return}else a._currentFallback=null;var F=E(a);if(F.length===1){this.doUri(p,a,T(F[0]),d,l,g,R);return}var M=function(D,U){var B=D.shift();k.doUri(p,a,T(B),d,l,g,function(Q){for(var te=[],Y=1;Y<arguments.length;Y++)te[Y-1]=arguments[Y];if(Q&&b(Q)&&D.length){M(D,!0);return}U&&(a._currentFallback={host:B,validUntil:y.now()+a.options.timeouts.fallbackRetryTimeout}),R==null||R.apply(void 0,n.__spreadArray([Q],te,!1))})};M(F)},f.prototype.doUri=function(p,a,o,d,l,g,R){if(!this.Request){R(new m.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(p,a,o,d,g,l,R)},f}(),v.methods=[C.default.Get,C.default.Delete,C.default.Post,C.default.Put,C.default.Patch],v.methodsWithoutBody=[C.default.Get,C.default.Delete],v.methodsWithBody=[C.default.Post,C.default.Put,C.default.Patch],v);i.default=P},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importStar(u(4)),x=v.__importDefault(u(3)),y=v.__importDefault(u(8)),A=v.__importStar(u(1)),m=u(1);function C(r,h){return!!h.get("x-ably-errorcode")}function $(r,h){if(C(r,h))return r.error&&n.default.fromValues(r.error)}function _(r,h,S,O,b,E,P){var f=new Headers(O||{}),p=r?r.toUpperCase():A.isEmptyArg(E)?"GET":"POST",a=new AbortController,o=setTimeout(function(){a.abort(),P(new n.PartialErrorInfo("Request timed out",null,408))},h?h.options.timeouts.httpRequestTimeout:y.default.TIMEOUTS.httpRequestTimeout),d={method:p,headers:f,body:E};x.default.Config.isWebworker||(d.credentials=f.has("authorization")?"include":"same-origin"),(0,m.getGlobalObject)().fetch(S+"?"+new URLSearchParams(b||{}),d).then(function(l){clearTimeout(o);var g=l.headers.get("Content-Type"),R;g&&g.indexOf("application/x-msgpack")>-1?R=l.arrayBuffer():g&&g.indexOf("application/json")>-1?R=l.json():R=l.text(),R.then(function(k){var T=!!g&&g.indexOf("application/x-msgpack")===-1;if(l.ok)P(null,k,l.headers,T,l.status);else{var V=$(k,l.headers)||new n.PartialErrorInfo("Error response received from server: "+l.status+" body was: "+x.default.Config.inspect(k),null,l.status);P(V,k,l.headers,T,l.status)}})}).catch(function(l){clearTimeout(o),P(l)})}i.default=_},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importDefault(u(41)),x=v.__importStar(u(1)),y=x.getGlobalObject();typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function A(){var _=y.location;return!y.WebSocket||!_||!_.origin||_.origin.indexOf("http")>-1}var m=y.navigator&&y.navigator.userAgent.toString(),C=y.location&&y.location.href,$={agent:"browser",logTimestamps:!0,userAgent:m,currentUrl:C,noUpgrade:m&&!!m.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:y.WebSocket,fetchSupported:!!y.fetch,xhrSupported:y.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:typeof document<"u",allowComet:A(),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:n.default,supportsBinary:!!y.TextDecoder,preferBinary:!1,ArrayBuffer:y.ArrayBuffer,atob:y.atob,nextTick:typeof y.setImmediate<"u"?y.setImmediate.bind(y):function(_){setTimeout(_,0)},addEventListener:y.addEventListener,inspect:JSON.stringify,stringByteSize:function(_){return y.TextDecoder&&new y.TextEncoder().encode(_).length||_.length},TextEncoder:y.TextEncoder,TextDecoder:y.TextDecoder,Promise:y.Promise,getRandomValues:function(_){if(_!==void 0)return function(r,h){_.getRandomValues(r),h&&h(null)}}(y.crypto||msCrypto)};i.default=$},function(w,i,u){(function(v){Object.defineProperty(i,"__esModule",{value:!0});var n=u(0),x=n.__importStar(u(1)),y="ablyjs-storage-test",A=function(){function m(){try{v.sessionStorage.setItem(y,y),v.sessionStorage.removeItem(y),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{v.localStorage.setItem(y,y),v.localStorage.removeItem(y),this.localSupported=!0}catch{this.localSupported=!1}}return m.prototype.get=function(C){return this._get(C,!1)},m.prototype.getSession=function(C){return this._get(C,!0)},m.prototype.remove=function(C){return this._remove(C,!1)},m.prototype.removeSession=function(C){return this._remove(C,!0)},m.prototype.set=function(C,$,_){return this._set(C,$,_,!1)},m.prototype.setSession=function(C,$,_){return this._set(C,$,_,!0)},m.prototype._set=function(C,$,_,r){var h={value:$};return _&&(h.expires=x.now()+_),this.storageInterface(r).setItem(C,JSON.stringify(h))},m.prototype._get=function(C,$){if($&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!$&&!this.localSupported)throw new Error("Local Storage not supported");var _=this.storageInterface($).getItem(C);if(!_)return null;var r=JSON.parse(_);return r.expires&&r.expires<x.now()?(this.storageInterface($).removeItem(C),null):r.value},m.prototype._remove=function(C,$){return this.storageInterface($).removeItem(C)},m.prototype.storageInterface=function(C){return C?v.sessionStorage:v.localStorage},m}();i.default=new A}).call(this,u(13))},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v=u(0),n=v.__importDefault(u(67)),x={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[n.default.XhrPolling,n.default.XhrStreaming,n.default.JsonP,n.default.WebSocket],baseTransportOrder:[n.default.XhrPolling,n.default.XhrStreaming,n.default.JsonP,n.default.WebSocket],transportPreferenceOrder:[n.default.JsonP,n.default.XhrPolling,n.default.XhrStreaming,n.default.WebSocket],upgradeTransports:[n.default.XhrStreaming,n.default.WebSocket]};i.default=x},function(w,i,u){Object.defineProperty(i,"__esModule",{value:!0});var v;(function(n){n.WebSocket="web_socket",n.Comet="comet",n.XhrStreaming="xhr_streaming",n.XhrPolling="xhr_polling",n.JsonP="jsonp"})(v||(v={})),i.default=v},function(w,i,u){u.r(i);var v=u(29),n=u.n(v),x=u(1),y=u(3),A=u.n(y),m=u(12),C=u.n(m),$=u(17),_=u.n($),r=function(b){var E="xhr_polling";function P(f,p,a){a.stream=!1,C.a.call(this,f,p,a),this.shortName=E}return x.inherits(P,C.a),P.isAvailable=function(){return A.a.Config.xhrSupported&&A.a.Config.allowComet},P.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},P.prototype.createRequest=function(f,p,a,o,d){return _.a.createRequest(f,p,a,o,d,this.timeouts)},typeof b<"u"&&P.isAvailable()&&(b.supportedTransports[E]=P),P},h=r,S=function(b){var E="xhr_streaming";function P(f,p,a){C.a.call(this,f,p,a),this.shortName=E}return x.inherits(P,C.a),P.isAvailable=function(){return A.a.Config.xhrSupported&&A.a.Config.streamingSupported&&A.a.Config.allowComet},P.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},P.prototype.createRequest=function(f,p,a,o,d){return _.a.createRequest(f,p,a,o,d,this.timeouts)},typeof b<"u"&&P.isAvailable()&&(b.supportedTransports[E]=P),P},O=S;i.default=[n.a,h,O]}]).default})})(Nt);var vn=Nt.exports;console.log("[ABLY] Initialisation du service Ably");let Re=null;const it=z(!1),qe=z([]),lt=()=>typeof window<"u"?window.location.hostname:"default",mn=async()=>{var I;console.log("[ABLY] Récupération d'un nouveau token");try{const t=await he.get("/api/v1/realtime/token");if(!((I=t.data)!=null&&I.token))throw new Error("Token Ably non trouvé dans la réponse");return console.log("[ABLY] Nouveau token obtenu avec succès"),t.data.token}catch(t){throw console.error("[ABLY] Erreur lors de la récupération du token:",t),t}},hn=async I=>{console.log("[ABLY] Connexion au service de temps réel");try{console.log("[ABLY] Initialisation sans clientId spécifique");const t={authCallback:async(w,i)=>{console.log("[ABLY] authCallback appelé pour renouveler le token");try{const u=await mn();i(null,u)}catch(u){console.error("[ABLY] Erreur dans authCallback:",u);const v={code:40170,statusCode:401,message:u instanceof Error?u.message:"Erreur de récupération du token",name:"TokenError"};i(v,null)}},token:I,echoMessages:!1,closeOnUnload:!1,recover:""};Re=new vn.Realtime(t),Re.connection.on("connected",()=>{console.log("[ABLY] Connecté au service de temps réel"),it.value=!0}),Re.connection.on("disconnected",()=>{console.log("[ABLY] Déconnecté du service de temps réel"),it.value=!1}),Re.connection.on("failed",w=>{console.error("[ABLY] Échec de connexion:",w.reason)}),Re.connection.on("suspended",()=>{console.warn("[ABLY] Connexion suspendue, tentative de reconnexion...")}),setTimeout(()=>{it.value||(console.log("[ABLY] Tentative de connexion forcée après délai d'initialisation"),Re==null||Re.connect())},1e3)}catch(t){throw console.error("[ABLY] Erreur de connexion:",t),t}},$t=(I,t,w)=>{if(console.log(`[ABLY] Abonnement au canal ${I}, événement ${t}`),!Re)return console.error("[ABLY] Client non initialisé"),()=>{};try{return Re.channels.get(I).subscribe(t,v=>{console.log(`[ABLY] Message reçu sur ${I}:${t}`,v),w(v.data)}),qe.value.findIndex(v=>v.channel===I&&v.event===t)===-1?(qe.value.push({channel:I,event:t,callback:w}),console.log(`[ABLY] Abonnement ajouté: ${I}:${t}`)):console.log(`[ABLY] Abonnement déjà existant: ${I}:${t}`),()=>gn(I,t)}catch(i){return console.error(`[ABLY] Erreur lors de l'abonnement au canal ${I}:`,i),()=>{}}},gn=(I,t)=>{if(console.log(`[ABLY] Désabonnement du canal ${I}${t?`, événement ${t}`:""}`),!Re){console.error("[ABLY] Client non initialisé");return}try{const w=Re.channels.get(I);t?(w.unsubscribe(t),qe.value=qe.value.filter(i=>!(i.channel===I&&i.event===t))):(w.unsubscribe(),qe.value=qe.value.filter(i=>i.channel!==I)),gt()}catch(w){console.error(`[ABLY] Erreur lors du désabonnement du canal ${I}:`,w)}},Lt=async(I,t,w)=>{if(console.log(`[ABLY] Publication sur le canal ${I}, événement ${t}`),!Re){console.error("[ABLY] Client non initialisé");return}try{await Re.channels.get(I).publish(t,w),console.log(`[ABLY] Message publié avec succès sur ${I}:${t}`)}catch(i){throw console.error("[ABLY] Erreur de publication:",i),i}},_n=()=>{console.log("[ABLY] Déconnexion du service de temps réel"),Re&&(Re.close(),Re=null,it.value=!1)},Et=()=>Re,yn=()=>{if(!Re)return console.error("[ABLY] Client non initialisé"),[];const I=new Map;return qe.value.forEach(w=>{var i,u;I.has(w.channel)||I.set(w.channel,[]),(i=I.get(w.channel))!=null&&i.includes(w.event)||(u=I.get(w.channel))==null||u.push(w.event)}),Array.from(I.entries()).map(([w,i])=>{let u="unknown";try{Re&&Re.channels&&(u=Re.channels.get(w).state||"attached")}catch(v){console.warn(`[ABLY] Impossible d'obtenir l'état du canal ${w}:`,v)}return{name:w,state:u,events:i}}).sort((w,i)=>w.name.localeCompare(i.name))},gt=()=>{var t;const I=yn();return console.log(`[ABLY] Nombre total d'abonnements enregistrés: ${qe.value.length}`),I.length===0?(console.log("[ABLY] Aucun canal actif"),qe.value.length>0&&console.log("[ABLY] Abonnements enregistrés mais aucun canal trouvé:",qe.value.map(w=>`${w.channel}:${w.event}`))):(console.group("[ABLY] Canaux actifs:"),I.forEach(w=>{const u=w.name.includes("private-admin")?"color: #4CAF50; font-weight: bold;":"color: #2196F3;";console.group(`%c${w.name} (${w.state})`,u),w.events.length>0?console.log("Événements:",w.events.join(", ")):console.log("Aucun événement spécifique"),console.groupEnd()}),console.groupEnd()),typeof window<"u"&&((t=window.AblyDebug)!=null&&t.isAutoDisplayActive)&&(window.AblyDebug.isAutoDisplayActive()?console.log("[ABLY] Mode d'affichage: %cAutomatique","color: green; font-weight: bold;"):(console.log("[ABLY] Mode d'affichage: %cManuel","color: orange;"),console.log("[ABLY] Astuce: utilisez AblyDebug.startAutoDisplay() pour activer l'affichage automatique"))),I},Ze=(I,t)=>{const i=`${lt()}:private-admin`;return console.log(`[ABLY] Abonnement au canal global d'administration: ${i}, événement: ${I}`),$t(i,I,t)},Ut=(I,t,w)=>{const u=`${lt()}:private-admin-${I}`;return console.log(`[ABLY] Abonnement au canal privé d'administrateur: ${u}, événement: ${t}`),$t(u,t,w)},Vt=async(I,t)=>{const i=`${lt()}:private-admin`;return Lt(i,I,t)},bn=async(I,t,w)=>{const u=`${lt()}:private-admin-${I}`;return Lt(u,t,w)},Ft=Pe("realtime",()=>{console.log("[REALTIME STORE] Initialisation du store");const I=z(!1),t=z(!1),w=z(null),i=z(!1),u=z(0),v=5,n=z(null),x=z(null),y=X(()=>I.value),A=X(()=>t.value),m=X(()=>w.value!==null),C=X(()=>u.value>0),$=async()=>{var f,p;console.log("[REALTIME STORE] Initialisation du service de temps réel");try{if(I.value){console.log("[REALTIME STORE] Service déjà initialisé");return}i.value=!0,w.value=null,console.log("[REALTIME STORE] Récupération du token API");const a=await he.get("/api/v1/realtime/token");if(console.log("[REALTIME STORE] Réponse API token:",a.data),(f=a.data)!=null&&f.error)throw new Error(`Erreur serveur: ${a.data.error}`);const o=(p=a.data)==null?void 0:p.token;if(!o)throw new Error("Token Ably non trouvé dans la réponse");console.log("[REALTIME STORE] Initialisation d'Ably avec le token"),await hn(o),_(),I.value=!0,t.value=!0,u.value=0,console.log("[REALTIME STORE] Service de temps réel initialisé avec succès"),setTimeout(()=>{console.log("[REALTIME STORE] État initial des canaux:"),b()},1e3)}catch(a){console.error("[REALTIME STORE] Erreur d'initialisation:",a),w.value=a,I.value=!1,t.value=!1,O()}finally{i.value=!1}},_=()=>{const f=Et();f&&(f.connection.on("connected",()=>{console.log("[REALTIME STORE] Connexion établie"),t.value=!0,w.value=null,u.value=0,n.value&&(clearTimeout(n.value),n.value=null)}),f.connection.on("disconnected",()=>{console.log("[REALTIME STORE] Connexion perdue"),t.value=!1}),f.connection.on("suspended",()=>{console.warn("[REALTIME STORE] Connexion suspendue"),t.value=!1,O()}),f.connection.on("failed",p=>{var a;console.error("[REALTIME STORE] Échec de connexion:",p.reason),t.value=!1,w.value=new Error(((a=p.reason)==null?void 0:a.message)||"Échec de connexion"),O()}))},r=()=>{console.log("[REALTIME STORE] Déconnexion du service de temps réel"),_n(),I.value=!1,t.value=!1,n.value&&(clearTimeout(n.value),n.value=null),P()},h=()=>{w.value=null},S=async()=>(console.log("[REALTIME STORE] Nouvelle tentative d'initialisation"),h(),u.value=0,n.value&&(clearTimeout(n.value),n.value=null),$()),O=()=>{if(u.value>=v){console.error("[REALTIME STORE] Nombre maximum de tentatives de reconnexion atteint");return}u.value++;const f=Math.min(1e3*Math.pow(2,u.value-1),3e4);console.log(`[REALTIME STORE] Tentative de reconnexion ${u.value}/${v} dans ${f}ms`),n.value=setTimeout(()=>{console.log(`[REALTIME STORE] Exécution de la tentative de reconnexion ${u.value}`),$()},f)},b=()=>(console.log("[REALTIME STORE] Affichage des canaux actifs"),gt()),E=(f=3e4)=>(P(),console.log(`[REALTIME STORE] Démarrage de l'affichage automatique des canaux (intervalle: ${f}ms)`),b(),x.value=setInterval(()=>{console.log("[REALTIME STORE] Mise à jour automatique des canaux:"),b()},f),!0),P=()=>x.value?(clearInterval(x.value),x.value=null,console.log("[REALTIME STORE] Arrêt de l'affichage automatique des canaux"),!0):!1;return Ne(t,f=>{f&&setTimeout(()=>{console.log("[REALTIME STORE] Canaux après connexion:"),b()},1e3)}),typeof window<"u"&&(window.AblyDebug={showChannels:()=>b(),getStatus:()=>{var f;return{initialized:I.value,connected:t.value,hasError:w.value!==null,error:((f=w.value)==null?void 0:f.message)||null,reconnectAttempts:u.value}},reconnect:()=>S(),testSubscription:()=>{if(console.log("[REALTIME STORE] Création d'un abonnement de test"),!I.value||!t.value){console.error("[REALTIME STORE] Client non initialisé ou non connecté");return}const f=Ze("test-event",o=>{console.log("[REALTIME STORE] Message global reçu:",o)}),p=0,a=Ut(p,"test-event",o=>{console.log(`[REALTIME STORE] Message privé pour admin ${p} reçu:`,o)});return console.log("[REALTIME STORE] Abonnements de test créés. Utilisez AblyDebug.showChannels() pour vérifier"),window.AblyDebug.testPublishGlobal=(o="test global")=>{console.log("[REALTIME STORE] Envoi d'un message de test global"),Vt("test-event",{message:o,timestamp:new Date().toISOString(),type:"global"})},window.AblyDebug.testPublishPrivate=(o="test privé")=>{console.log(`[REALTIME STORE] Envoi d'un message de test privé pour admin ${p}`),bn(p,"test-event",{message:o,timestamp:new Date().toISOString(),type:"private"})},console.log("[REALTIME STORE] Utilisez ces commandes pour tester:"),console.log('- AblyDebug.testPublishGlobal("message") : envoyer un message global'),console.log('- AblyDebug.testPublishPrivate("message") : envoyer un message privé'),()=>{f(),a()}},diagnosticComplet:()=>{var o;console.group("[REALTIME STORE] Diagnostic complet du système temps réel"),console.group("1. État de la connexion");const f={initialized:I.value,connected:t.value,hasError:w.value!==null,error:((o=w.value)==null?void 0:o.message)||null,reconnectAttempts:u.value};console.table(f),console.groupEnd(),console.group("2. Client Ably");const p=Et();console.log("Client Ably:",p?"Initialisé":"Non initialisé"),p&&(console.log("État de la connexion:",p.connection.state),console.log("ID de connexion:",p.connection.id)),console.groupEnd(),console.group("3. Abonnements et canaux"),console.log("Canaux:");const a=gt();console.groupEnd(),console.group("4. Analyse des problèmes potentiels"),I.value?t.value?p?!a||a.length===0?(console.warn("⚠️ Aucun canal n'est actuellement actif"),console.log("💡 Solution: Utilisez AblyDebug.testSubscription() pour créer un canal de test")):console.log("✅ Tout semble fonctionner correctement"):console.error("❌ Le client Ably n'est pas initialisé"):console.error("❌ Le système temps réel n'est pas connecté"):console.error("❌ Le système temps réel n'est pas initialisé"),console.groupEnd(),console.groupEnd()},startAutoDisplay:(f=3e4)=>E(f),stopAutoDisplay:()=>P(),isAutoDisplayActive:()=>x.value!==null},console.log("[REALTIME STORE] Commandes de débogage installées:"),console.log("- AblyDebug.showChannels() : afficher les canaux actifs"),console.log("- AblyDebug.startAutoDisplay(30000) : afficher automatiquement les canaux (intervalle en ms)"),console.log("- AblyDebug.stopAutoDisplay() : arrêter l'affichage automatique"),E(6e4)),{initialized:I,connected:t,error:w,loading:i,isInitialized:y,isConnected:A,hasError:m,isReconnecting:C,init:$,disconnect:r,resetError:h,retry:S,debugShowChannels:b,startAutoDisplay:E,stopAutoDisplay:P}}),de=Pe("notifications",()=>{console.log("[NOTIFICATIONS STORE] Initialisation du store");const I=z([]),t=z([]),w=z([]),i=z({email:!0,push:!0,desktop:!0,types:{ticket:!0,invoice:!0,payment:!0,client:!0,system:!0}}),u=z(!1),v=z(null),n=Ft(),x=X(()=>I.value),y=X(()=>I.value.filter(k=>!k.read).length),A=X(()=>{const k=new Date;return I.value.filter(T=>new Date(T.created_at).toDateString()===k.toDateString())}),m=X(()=>[...t.value,...w.value]),C=async()=>{console.log("[NOTIFICATIONS STORE] Chargement des notifications");try{u.value=!0;const k=await he.get("/notifications");return I.value=k.data,console.log("[NOTIFICATIONS STORE] Notifications chargées:",k.data.length),k.data}catch(k){throw console.error("[NOTIFICATIONS STORE] Erreur de chargement:",k),v.value=k,k}finally{u.value=!1}},$=async k=>{console.log(`[NOTIFICATIONS STORE] Marquer comme lu: ${k}`);try{await he.put(`/notifications/${k}/read`);const T=I.value.findIndex(V=>V.id===k);T!==-1&&(I.value[T].read=!0)}catch(T){throw console.error("[NOTIFICATIONS STORE] Erreur lors du marquage comme lu:",T),T}},_=async()=>{console.log("[NOTIFICATIONS STORE] Marquer tout comme lu");try{await he.put("/notifications/read-all"),I.value=I.value.map(k=>({...k,read:!0}))}catch(k){throw console.error("[NOTIFICATIONS STORE] Erreur lors du marquage de tout comme lu:",k),k}},r=async k=>{console.log(`[NOTIFICATIONS STORE] Supprimer la notification: ${k}`);try{await he.delete(`/notifications/${k}`),I.value=I.value.filter(T=>T.id!==k)}catch(T){throw console.error("[NOTIFICATIONS STORE] Erreur lors de la suppression:",T),T}},h=async()=>{console.log("[NOTIFICATIONS STORE] Supprimer toutes les notifications");try{await he.delete("/notifications/all"),I.value=[]}catch(k){throw console.error("[NOTIFICATIONS STORE] Erreur lors de la suppression de toutes les notifications:",k),k}},S=async k=>{console.log("[NOTIFICATIONS STORE] Mise à jour des préférences");try{await he.put("/notifications/preferences",k),i.value=k}catch(T){throw console.error("[NOTIFICATIONS STORE] Erreur lors de la mise à jour des préférences:",T),T}},O=k=>{console.log("[NOTIFICATIONS STORE] Ajout d'une notification temporaire (locale):",k);const T=Date.now(),V={id:T,...k,timeout:k.timeout||5e3,closing:!1};return t.value.push(V),setTimeout(()=>{const F=t.value.findIndex(M=>M.id===T);if(F!==-1){const M={...t.value[F],closing:!0};t.value=t.value.filter(D=>D.id!==T),w.value.push(M),setTimeout(()=>{w.value=w.value.filter(D=>D.id!==T)},500)}},V.timeout),T},b=k=>{if(console.log("[NOTIFICATIONS STORE] Ajout d'une notification temporaire (via Ably):",k),!n.isInitialized||!n.isConnected)return console.warn("[NOTIFICATIONS STORE] Service temps réel non disponible, utilisation du mode local"),O(k);const T=Date.now(),V={id:T,...k,timeout:k.timeout||5e3,timestamp:new Date().toISOString(),userId:R()};return Vt("toast:notification",V),T},E=b,P=(k,T="Succès")=>(console.log("[NOTIFICATIONS STORE] Affichage d'un message de succès:",k),b({title:T,message:k,type:"success"})),f=(k,T="Erreur")=>(console.log("[NOTIFICATIONS STORE] Affichage d'un message d'erreur:",k),b({title:T,message:k,type:"error"})),p=P,a=f,o=(k,T="Attention")=>b({title:T,message:k,type:"warning"}),d=(k,T="Information")=>b({title:T,message:k,type:"info"}),l=k=>{console.log("[NOTIFICATIONS STORE] Suppression du toast:",k);const T=t.value.findIndex(V=>V.id===k);if(T!==-1){const V={...t.value[T],closing:!0};t.value=t.value.filter(F=>F.id!==k),w.value.push(V),setTimeout(()=>{w.value=w.value.filter(F=>F.id!==k)},500)}},g=async()=>{if(console.log("[NOTIFICATIONS STORE] Configuration du temps réel"),n.isInitialized||(console.log("[NOTIFICATIONS STORE] Initialisation du service temps réel"),await n.init()),n.isConnected){console.log("[NOTIFICATIONS STORE] Abonnement au canal global d'administration"),Ze("notification:new",T=>{console.log("[NOTIFICATIONS STORE] Nouvelle notification reçue:",T),I.value.unshift(T)}),Ze("notification:update",T=>{console.log("[NOTIFICATIONS STORE] Mise à jour de notification reçue:",T);const V=I.value.findIndex(F=>F.id===T.id);V!==-1&&(I.value[V]=T)}),Ze("notification:delete",T=>{console.log("[NOTIFICATIONS STORE] Suppression de notification reçue:",T),I.value=I.value.filter(V=>V.id!==T.id)}),Ze("toast:notification",T=>{console.log("[NOTIFICATIONS STORE] Toast notification reçue:",T);const V=R();if(!T.userId||T.userId===V){const F={id:T.id,title:T.title,message:T.message,type:T.type,timeout:T.timeout||5e3,closing:!1};t.value.push(F),setTimeout(()=>{const M=t.value.findIndex(D=>D.id===F.id);if(M!==-1){const D={...t.value[M],closing:!0};t.value=t.value.filter(U=>U.id!==F.id),w.value.push(D),setTimeout(()=>{w.value=w.value.filter(U=>U.id!==F.id)},500)}},F.timeout)}else console.log("[NOTIFICATIONS STORE] Toast ignoré (destiné à un autre utilisateur)")});const k=R();k&&(console.log(`[NOTIFICATIONS STORE] Abonnement au canal privé de l'administrateur ${k}`),Ut(k,"notification:personal",T=>{console.log("[NOTIFICATIONS STORE] Notification personnelle reçue:",T),I.value.unshift({...T,isPersonal:!0})}))}else console.error("[NOTIFICATIONS STORE] Impossible de s'abonner aux notifications, temps réel non connecté")},R=()=>{try{const k=Ge();if(k.user&&k.user.id)return k.user.id;const T=localStorage.getItem("user");return T&&JSON.parse(T).id||null}catch(k){return console.error("[NOTIFICATIONS STORE] Erreur lors de la récupération de l'ID admin:",k),null}};return be(()=>{console.log("[NOTIFICATIONS STORE] Montage du store"),g()}),Tt(()=>{console.log("[NOTIFICATIONS STORE] Démontage du store")}),{notifications:I,toasts:t,closingToasts:w,preferences:i,loading:u,error:v,allNotifications:x,unreadCount:y,todayNotifications:A,activeToasts:m,fetchNotifications:C,markAsRead:$,markAllAsRead:_,deleteNotification:r,clearAll:h,updatePreferences:S,addNotification:b,addNotificationLocal:O,showNotification:E,success:P,notificationError:f,removeToast:l,showSuccess:p,showError:a,showWarning:o,showInfo:d}}),st=Pe("services",()=>{const I=z([]),t=z(null),w=z(!1),i=z(""),u=z(null),v=z(0),n=z(1),x=z(15),y=de(),A=X(()=>f=>I.value.find(p=>p.id===f)),m=X(()=>f=>I.value.filter(p=>p.status===f)),C=X(()=>f=>I.value.filter(p=>p.client_id===f)),$=async(f=1,p={})=>{w.value=!0,i.value="";try{const a=await me.get("/api/v1/services",{params:{page:f,per_page:x.value,...p}});return I.value=a.data.data,v.value=a.data.meta.total,n.value=a.data.meta.current_page,x.value=a.data.meta.per_page,$t("services","update",o=>{P(o.data)}),a.data}catch(a){throw console.error("Erreur lors de la récupération des services:",a),i.value="Erreur lors de la récupération des services",a}finally{w.value=!1}},_=async()=>(u.value={count_by_status:{active:0,pending:0,suspended:0,cancelled:0,terminated:0,fraud:0},recent_services:[],renewal_services:[]},u.value),r=async f=>{w.value=!0,i.value="";try{const p=await me.get(`/api/v1/services/${f}`);return t.value=p.data,p.data}catch(p){throw console.error(`Erreur lors de la récupération du service ${f}:`,p),i.value=`Erreur lors de la récupération du service ${f}`,p}finally{w.value=!1}},h=async(f,p)=>{w.value=!0,i.value="";try{const a=p?{status:p}:{};return(await me.get(`/api/v1/clients/${f}/services`,{params:a})).data}catch(a){throw console.error(`Erreur lors de la récupération des services du client ${f}:`,a),i.value="Erreur lors de la récupération des services du client",a}finally{w.value=!1}},S=async f=>{w.value=!0,i.value="";try{const p=await me.post("/api/v1/services",f);return y.showNotification({title:"Service créé",message:"Le service a été créé avec succès",type:"success"}),p.data}catch(p){throw console.error("Erreur lors de la création du service:",p),i.value="Erreur lors de la création du service",y.showNotification({title:"Erreur",message:"Impossible de créer le service",type:"error"}),p}finally{w.value=!1}},O=async(f,p)=>{w.value=!0,i.value="";try{const a=await me.put(`/api/v1/services/${f}`,p),o=I.value.findIndex(d=>d.id===f);return o!==-1&&(I.value[o]={...I.value[o],...a.data}),t.value&&t.value.id===f&&(t.value=a.data),y.showNotification({title:"Service mis à jour",message:"Le service a été mis à jour avec succès",type:"success"}),a.data}catch(a){throw console.error(`Erreur lors de la mise à jour du service ${f}:`,a),i.value=`Erreur lors de la mise à jour du service ${f}`,y.showNotification({title:"Erreur",message:"Impossible de mettre à jour le service",type:"error"}),a}finally{w.value=!1}},b=async f=>{console.log(`[ServicesStore] deleteService appelé pour le service ${f}`),w.value=!0,i.value="";try{return console.log(`[ServicesStore] Envoi de la requête DELETE à /api/v1/services/${f}`),await me.delete(`/api/v1/services/${f}`),console.log(`[ServicesStore] Requête DELETE réussie pour le service ${f}`),I.value=I.value.filter(p=>p.id!==f),t.value&&t.value.id===f&&(t.value=null),y.showNotification({title:"Service supprimé",message:"Le service a été supprimé avec succès",type:"success"}),!0}catch(p){throw console.error(`[ServicesStore] Erreur lors de la suppression du service ${f}:`,p),i.value=`Erreur lors de la suppression du service ${f}`,y.showNotification({title:"Erreur",message:"Impossible de supprimer le service",type:"error"}),p}finally{w.value=!1}},E=async(f,p,a)=>{console.log(`[ServicesStore] changeServiceStatus appelé pour le service ${f} avec le statut ${p}`),w.value=!0,i.value="";try{console.log(`[ServicesStore] Envoi de la requête PUT à /api/v1/services/${f}/status avec les données:`,{status:p,notes:a});const o=await me.put(`/api/v1/services/${f}/status`,{status:p,notes:a});console.log(`[ServicesStore] Requête PUT réussie pour le service ${f}`,o.data);const d=I.value.findIndex(l=>l.id===f);return d!==-1&&(I.value[d]={...I.value[d],...o.data}),t.value&&t.value.id===f&&(t.value=o.data),y.showNotification({title:"Statut modifié",message:`Le statut du service a été changé en "${p}"`,type:"success"}),o.data}catch(o){throw console.error(`[ServicesStore] Erreur lors du changement de statut du service ${f}:`,o),i.value=`Erreur lors du changement de statut du service ${f}`,y.showNotification({title:"Erreur",message:"Impossible de changer le statut du service",type:"error"}),o}finally{w.value=!1}},P=f=>{if(!f||!f.action)return;const{action:p,service:a}=f;switch(p){case"created":I.value.unshift(a);break;case"updated":const o=I.value.findIndex(l=>l.id===a.id);o!==-1&&(I.value[o]=a),t.value&&t.value.id===a.id&&(t.value=a);break;case"deleted":I.value=I.value.filter(l=>l.id!==a.id),t.value&&t.value.id===a.id&&(t.value=null);break;case"status_changed":const d=I.value.findIndex(l=>l.id===a.id);d!==-1&&(I.value[d]=a),t.value&&t.value.id===a.id&&(t.value=a);break}};return{services:I,currentService:t,loading:w,error:i,stats:u,total:v,currentPage:n,perPage:x,getServiceById:A,getServicesByStatus:m,getServicesByClient:C,fetchServices:$,fetchServiceStats:_,fetchServiceById:r,fetchClientServices:h,createService:S,updateService:O,changeServiceStatus:E,deleteService:b}}),$n={id:"clientsList",class:"view-container"},Sn={class:"header-box"},wn={class:"page-title"},kn={class:"page-description"},Cn={class:"filter-box"},An={class:"filter-grid"},En={class:"filter-group"},On={class:"filter-label"},Tn={class:"filter-input-wrapper"},Rn=["placeholder"],xn={class:"filter-group"},In={class:"filter-label"},Pn={class:"filter-input-wrapper"},Mn={value:""},Dn={value:"active"},Nn={value:"inactive"},Ln={value:"pending"},Un={class:"filter-group"},Vn={class:"filter-label"},Fn={class:"filter-input-wrapper"},qn={value:""},Bn={value:"hosting"},jn={value:"domain"},Gn={value:"ssl"},zn={key:0,class:"loading-state box"},Hn={key:1,class:"empty-state box"},Wn={class:"empty-title"},Kn={class:"empty-description"},Jn={key:2,class:"table-box"},Qn={class:"data-table"},Yn=["onClick"],Xn={class:"client-details"},Zn={class:"client-name"},ei={class:"services-list"},ti={key:0,class:"service-count"},si={key:1,class:"no-services"},oi={class:"actions"},ni={class:"action-buttons"},ii=["onClick","title"],ri=["onClick","title"],ai=["onClick","title"],li={key:3,class:"pagination"},ci=["onClick"],ui=_e({__name:"ClientsView",setup(I){console.log("[CLIENTS VIEW] Initialisation du composant");const{t}=we(),w=Te(),i=ze(),u=st(),v=z("name"),n=z(!1),x=z(""),y=z(""),A=z(""),m=z(1),C=z(10),$=z(1),_=z({});Ne([x,y,A],()=>{m.value=1});const r=X(()=>{if(!i.clients.length)return[];let p=[...i.clients];if(x.value){const d=x.value.toLowerCase();p=p.filter(l=>l.firstname&&l.firstname.toLowerCase().includes(d)||l.lastname&&l.lastname.toLowerCase().includes(d)||l.email&&l.email.toLowerCase().includes(d)||l.company&&l.company.toLowerCase().includes(d))}y.value&&(p=p.filter(d=>d.status===y.value)),A.value&&(p=p.filter(d=>(_.value[d.id]||[]).some(g=>g.type===A.value))),p.sort((d,l)=>{const g=d[v.value],R=l[v.value];return g<R?n.value?1:-1:g>R?n.value?-1:1:0}),$.value=Math.ceil(p.length/C.value);const a=(m.value-1)*C.value,o=a+C.value;return p.slice(a,o)}),h=async()=>{console.log("[ClientsView] Composant monté");try{console.log("[ClientsView] Chargement des clients..."),await i.fetchClients(),console.log("[ClientsView] Clients chargés:",i.clients.length),await S()}catch(p){console.error("[ClientsView] Erreur lors du chargement des clients:",p)}},S=async()=>{try{for(const p of i.clients)try{console.log(`[ClientsView] Récupération des services pour le client #${p.id}`);const a=await u.fetchClientServices(p.id);console.log(`[ClientsView] Services récupérés pour le client #${p.id}:`,a),a&&a.data&&(_.value[p.id]=Array.isArray(a.data)?a.data:[a.data])}catch(a){console.error(`[ClientsView] Erreur lors de la récupération des services pour le client #${p.id}:`,a),_.value[p.id]=[]}}catch(p){console.error("[ClientsView] Erreur lors de la récupération des services:",p)}},O=p=>{m.value=p,window.scrollTo({top:0,behavior:"smooth"})},b=p=>{w.push({name:"client-details",params:{id:p.toString()}})},E=p=>{w.push({name:"edit-client",params:{id:p.toString()}})},P=()=>{w.push({name:"create-client"})},f=async p=>{if(confirm(t("clients.confirm_delete")))try{await i.deleteClient(p),await h()}catch(a){console.error("[ClientsView] Erreur lors de la suppression du client:",a)}};return be(async()=>{await h()}),(p,a)=>(N(),L("div",$n,[e("div",Sn,[e("div",null,[e("h1",wn,s(c(t)("clients.title")),1),e("span",kn,s(c(t)("clients.description")),1)]),e("button",{class:"btn btn-gradient",onClick:P},[a[3]||(a[3]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(c(t)("clients.add_new")),1)])]),e("div",Cn,[e("div",An,[e("div",En,[e("label",On,s(c(t)("clients.filters.search")),1),e("div",Tn,[a[4]||(a[4]=e("i",{class:"fas fa-search"},null,-1)),H(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=o=>x.value=o),class:"filter-input",placeholder:c(t)("clients.filters.search_placeholder")},null,8,Rn),[[ee,x.value]])])]),e("div",xn,[e("label",In,s(c(t)("clients.filters.status")),1),e("div",Pn,[a[5]||(a[5]=e("i",{class:"fas fa-user-clock"},null,-1)),H(e("select",{"onUpdate:modelValue":a[1]||(a[1]=o=>y.value=o),class:"filter-input"},[e("option",Mn,s(c(t)("clients.status.all")),1),e("option",Dn,s(c(t)("clients.status.active")),1),e("option",Nn,s(c(t)("clients.status.inactive")),1),e("option",Ln,s(c(t)("clients.status.pending")),1)],512),[[pe,y.value]])])]),e("div",Un,[e("label",Vn,s(c(t)("clients.filters.service_type")),1),e("div",Fn,[a[6]||(a[6]=e("i",{class:"fas fa-cog"},null,-1)),H(e("select",{"onUpdate:modelValue":a[2]||(a[2]=o=>A.value=o),class:"filter-input"},[e("option",qn,s(c(t)("clients.services.all")),1),e("option",Bn,s(c(t)("clients.services.hosting")),1),e("option",jn,s(c(t)("clients.services.domain")),1),e("option",Gn,s(c(t)("clients.services.ssl")),1)],512),[[pe,A.value]])])])])]),c(i).loading?(N(),L("div",zn,[a[7]||(a[7]=e("div",{class:"spinner"},null,-1)),e("p",null,s(c(t)("common.loading")),1)])):r.value.length===0?(N(),L("div",Hn,[a[8]||(a[8]=e("div",{class:"empty-icon"},[e("i",{class:"fas fa-users"})],-1)),e("h3",Wn,s(c(t)("clients.empty.title")),1),e("p",Kn,s(c(t)("clients.empty.description")),1)])):(N(),L("div",Jn,[e("table",Qn,[e("thead",null,[e("tr",null,[a[9]||(a[9]=e("th",null,"ID",-1)),e("th",null,s(c(t)("clients.table.client")),1),e("th",null,s(c(t)("clients.table.company")),1),e("th",null,s(c(t)("clients.table.email")),1),e("th",null,s(c(t)("clients.table.phone")),1),e("th",null,s(c(t)("clients.table.status")),1),e("th",null,s(c(t)("clients.table.services")),1),e("th",null,s(c(t)("clients.table.actions")),1)])]),e("tbody",null,[(N(!0),L(ae,null,le(r.value,o=>(N(),L("tr",{key:o.id,onClick:d=>b(o.id)},[e("td",null,"#"+s(o.id),1),e("td",null,[e("div",Xn,[e("span",Zn,s(o.firstname)+" "+s(o.lastname),1)])]),e("td",null,s(o.company||"-"),1),e("td",null,s(o.email),1),e("td",null,s(o.phone||"-"),1),e("td",null,[e("span",{class:se(`status-badge status-${o.status}`)},s(c(t)(`clients.status.${o.status}`)),3)]),e("td",null,[e("div",ei,[_.value[o.id]&&_.value[o.id].length?(N(),L("span",ti," ("+s(_.value[o.id].length)+") ",1)):(N(),L("span",si,s(c(t)("clients.no_services")),1))])]),e("td",oi,[e("div",ni,[e("button",{onClick:Se(d=>b(o.id),["stop"]),class:"btn-icon",title:c(t)("clients.actions.view")},a[10]||(a[10]=[e("i",{class:"fas fa-eye"},null,-1)]),8,ii),e("button",{onClick:Se(d=>E(o.id),["stop"]),class:"btn-icon",title:c(t)("clients.actions.edit")},a[11]||(a[11]=[e("i",{class:"fas fa-edit"},null,-1)]),8,ri),e("button",{class:"btn-icon",onClick:Se(d=>f(o.id),["stop"]),title:c(t)("clients.actions.delete")},a[12]||(a[12]=[e("i",{class:"fas fa-trash"},null,-1)]),8,ai)])])],8,Yn))),128))])])])),$.value>1?(N(),L("div",li,[(N(!0),L(ae,null,le($.value,o=>(N(),L("a",{key:o,onClick:d=>O(o),class:se(["page-link",{active:o===m.value}])},s(o),11,ci))),128))])):J("",!0)]))}}),qt=$e(ui,[["__scopeId","data-v-47eb7768"]]),Fe=Pe("products",()=>{const I=z([]),t=z(!1),w=z(null),i=X(()=>I.value||[]),u=X(()=>(I.value||[]).filter($=>$.status==="active")),v=X(()=>(I.value||[]).filter($=>$.status==="maintenance")),n=X(()=>(I.value||[]).filter($=>$.status==="inactive"));return{products:I,loading:t,error:w,allProducts:i,activeProducts:u,maintenanceProducts:v,inactiveProducts:n,fetchProducts:async()=>{try{t.value=!0,w.value=null,console.log("Début de la récupération des produits");const $=await he.get("/api/v1/products");console.log("Réponse API produits:",$),$.data&&$.data.products?(console.log("Structure de réponse avec data.products:",$.data.products),I.value=$.data.products||[]):Array.isArray($.data)?(console.log("Structure de réponse tableau:",$.data),I.value=$.data):(console.warn("Format de réponse inattendu:",$.data),I.value=[]),console.log("Produits après traitement:",I.value)}catch($){console.error("Erreur lors de la récupération des produits:",$),w.value=$.message||"Erreur lors de la récupération des produits"}finally{t.value=!1}},fetchProduct:async $=>{try{t.value=!0,w.value=null,console.log(`Début de la récupération du produit ID: ${$}`);let _=I.value.find(r=>r.id===$);if(!_){const r=await he.get(`/api/v1/products/${$}`);console.log("Réponse API produit:",r),r.data&&(_=r.data)}return _}catch(_){throw console.error(`Erreur lors de la récupération du produit ID ${$}:`,_),w.value=_.message||"Erreur lors de la récupération du produit",_}finally{t.value=!1}},updateProduct:async $=>{try{t.value=!0,w.value=null;const _=await he.put(`/api/v1/products/${$.id}`,$),r=I.value.findIndex(h=>h.id===$.id);return r!==-1&&(I.value[r]=_.data),_.data}catch(_){throw console.error("Erreur lors de la mise à jour du produit:",_),w.value=_.message||"Erreur lors de la mise à jour du produit",_}finally{t.value=!1}},createProduct:async $=>{try{t.value=!0,w.value=null;const _=await he.post("/api/v1/products",$);return I.value.push(_.data),_.data}catch(_){throw console.error("Erreur lors de la création du produit:",_),w.value=_.message||"Erreur lors de la création du produit",_}finally{t.value=!1}},deleteProduct:async $=>{try{return t.value=!0,w.value=null,await he.delete(`/api/v1/products/${$}`),I.value=I.value.filter(_=>_.id!==$),!0}catch(_){throw console.error("Erreur lors de la suppression du produit:",_),w.value=_.message||"Erreur lors de la suppression du produit",_}finally{t.value=!1}}}}),ct=Pe("productGroups",()=>{const I=z([]),t=z(!1),w=z(null);return{productGroups:I,loading:t,error:w,fetchProductGroups:async()=>{var y,A;t.value=!0,w.value=null;try{const m=await me.get("/api/v1/product-groups");I.value=m.data.productGroups||[]}catch(m){console.error("Erreur lors de la récupération des groupes de produits:",m),w.value=((A=(y=m.response)==null?void 0:y.data)==null?void 0:A.message)||"Erreur lors de la récupération des groupes de produits"}finally{t.value=!1}},createProductGroup:async y=>{var A,m;t.value=!0,w.value=null;try{const C=await me.post("/api/v1/product-groups",y);return I.value.push(C.data),C.data}catch(C){throw console.error("Erreur lors de la création du groupe de produits:",C),w.value=((m=(A=C.response)==null?void 0:A.data)==null?void 0:m.message)||"Erreur lors de la création du groupe de produits",w.value}finally{t.value=!1}},updateProductGroup:async(y,A)=>{var m,C;t.value=!0,w.value=null;try{const $=await me.put(`/api/v1/product-groups/${y}`,A),_=I.value.findIndex(r=>r.id===y);return _!==-1&&(I.value[_]=$.data),$.data}catch($){throw console.error("Erreur lors de la mise à jour du groupe de produits:",$),w.value=((C=(m=$.response)==null?void 0:m.data)==null?void 0:C.message)||"Erreur lors de la mise à jour du groupe de produits",w.value}finally{t.value=!1}},deleteProductGroup:async y=>{var A,m;t.value=!0,w.value=null;try{return await me.delete(`/api/v1/product-groups/${y}`),I.value=I.value.filter(C=>C.id!==y),!0}catch(C){throw console.error("Erreur lors de la suppression du groupe de produits:",C),w.value=((m=(A=C.response)==null?void 0:A.data)==null?void 0:m.message)||"Erreur lors de la suppression du groupe de produits",w.value}finally{t.value=!1}},getGroupName:y=>{if(!y)return"";const A=I.value.find(m=>m.id===y);return A?A.name:""}}}),di={key:0,class:"modal-overlay"},pi={class:"modal-container"},fi={class:"modal-header"},vi={class:"modal-body"},mi={class:"form-group"},hi={for:"name"},gi=["placeholder"],_i={key:0,class:"error-message"},yi={class:"form-group"},bi={for:"slug"},$i=["placeholder"],Si={key:0,class:"error-message"},wi={class:"form-text text-muted"},ki={class:"form-group"},Ci={for:"description"},Ai=["placeholder"],Ei={class:"form-actions"},Oi={type:"submit",class:"btn btn-primary"},Ti=_e({__name:"ProductGroupModal",props:{show:{type:Boolean},editMode:{type:Boolean},groupToEdit:{}},emits:["close","created","updated"],setup(I,{emit:t}){const{t:w}=we(),i=ct(),u=I,v=t,n=z(""),x=z(""),y=z(""),A=z({});Ne(n,h=>{var S;(!u.editMode||u.editMode&&!((S=u.groupToEdit)!=null&&S.slug))&&(x.value=h.toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""))}),Ne(()=>u.groupToEdit,h=>{h&&(n.value=h.name||"",x.value=h.slug||"",y.value=h.description||"")},{immediate:!0});const m=()=>{n.value="",x.value="",y.value="",A.value={}},C=()=>(A.value={},n.value.trim()||(A.value.name=w("product_groups.errors.name_required")),x.value.trim()?/^[a-z0-9-]+$/.test(x.value)||(A.value.slug=w("product_groups.errors.slug_invalid")):A.value.slug=w("product_groups.errors.slug_required"),Object.keys(A.value).length===0),$=async()=>{if(C())try{u.editMode&&u.groupToEdit?(await i.updateProductGroup(u.groupToEdit.id,{name:n.value,slug:x.value,description:y.value}),v("updated")):(await i.createProductGroup({name:n.value,slug:x.value,description:y.value}),v("created")),m(),v("close")}catch(h){console.error("Erreur lors de la soumission du formulaire:",h)}},_=()=>{m(),v("close")},r=X(()=>u.editMode?w("product_groups.edit_title"):w("product_groups.add_title"));return(h,S)=>h.show?(N(),L("div",di,[e("div",pi,[e("div",fi,[e("h3",null,s(r.value),1),e("button",{class:"close-button",onClick:_},S[3]||(S[3]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",vi,[e("form",{onSubmit:Se($,["prevent"])},[e("div",mi,[e("label",hi,s(c(w)("product_groups.fields.name"))+" *",1),H(e("input",{id:"name","onUpdate:modelValue":S[0]||(S[0]=O=>n.value=O),type:"text",class:se(["form-control",{"is-invalid":A.value.name}]),placeholder:c(w)("product_groups.placeholders.name")},null,10,gi),[[ee,n.value]]),A.value.name?(N(),L("div",_i,s(A.value.name),1)):J("",!0)]),e("div",yi,[e("label",bi,s(c(w)("product_groups.fields.slug"))+" *",1),H(e("input",{id:"slug","onUpdate:modelValue":S[1]||(S[1]=O=>x.value=O),type:"text",class:se(["form-control",{"is-invalid":A.value.slug}]),placeholder:c(w)("product_groups.placeholders.slug")},null,10,$i),[[ee,x.value]]),A.value.slug?(N(),L("div",Si,s(A.value.slug),1)):J("",!0),e("small",wi,s(c(w)("product_groups.slug_help")),1)]),e("div",ki,[e("label",Ci,s(c(w)("product_groups.fields.description")),1),H(e("textarea",{id:"description","onUpdate:modelValue":S[2]||(S[2]=O=>y.value=O),class:"form-control",placeholder:c(w)("product_groups.placeholders.description"),rows:"3"},null,8,Ai),[[ee,y.value]])]),e("div",Ei,[e("button",{type:"button",class:"btn btn-secondary",onClick:_},s(c(w)("common.cancel")),1),e("button",Oi,s(c(w)("common.save")),1)])],32)])])])):J("",!0)}}),Ri=$e(Ti,[["__scopeId","data-v-e3d6424e"]]),xi={class:"products-view view-container"},Ii={class:"header-box"},Pi={class:"header-content"},Mi={class:"page-title"},Di={class:"page-description"},Ni={class:"header-actions"},Li={class:"filter-box"},Ui={class:"filter-grid"},Vi={class:"filter-group"},Fi={class:"filter-label"},qi={class:"filter-input-wrapper"},Bi=["placeholder"],ji={class:"filter-group"},Gi={class:"filter-label"},zi={class:"filter-input-wrapper"},Hi=["value"],Wi={class:"filter-group"},Ki={class:"filter-label"},Ji={class:"filter-input-wrapper"},Qi={value:"all"},Yi={value:"active"},Xi={value:"inactive"},Zi={value:"maintenance"},er={class:"filter-group"},tr={class:"filter-label"},sr={class:"filter-input-wrapper"},or={value:"all"},nr={value:"none"},ir=["value"],rr={class:"filter-group"},ar={class:"filter-label"},lr={class:"filter-input-wrapper"},cr={value:""},ur={value:"0-50"},dr={value:"50-200"},pr={value:"200-1000"},vr={key:0,class:"loading-state box"},mr={key:1,class:"empty-state box"},hr={key:2,class:"table-box"},gr={class:"data-table"},_r=["onClick"],yr={class:"product-name"},br={class:"actions"},$r={class:"actions-menu"},Sr=["onClick","title"],wr=["onClick","title"],kr=_e({__name:"ProductsView",setup(I){const{t}=we(),w=Te(),i=Fe(),u=de(),v=ct(),n=z([]),x=z(!0),y=z(!1),A=z(null),m=z("all"),C=z("all"),$=[{value:"all",label:t("products_services.filters.all_types")},{value:"reseller_hosting",label:t("products_services.types.reseller")},{value:"dedicated_server",label:t("products_services.types.dedicated")},{value:"vps",label:t("products_services.types.vps")},{value:"shared_hosting",label:t("products_services.types.shared")}],_=z("all"),r=z(""),h=z(""),S=z("name"),O=z(!1),b=z("DESC"),E=z(!1);t("products_services.columns.name"),t("products_services.columns.description"),t("products_services.columns.type"),t("products_services.columns.price"),t("products_services.columns.status"),t("products_services.columns.group"),t("products_services.columns.clients"),t("common.actions");const P=X(()=>{console.log("Calcul des produits filtrés"),console.log("Produits initiaux:",i.allProducts);let l=[...i.allProducts];if(console.log("Copie des produits:",l),C.value!=="all"?(console.log("Filtrage par type:",C.value),l=l.filter(g=>g.product_type===C.value)):console.log("Aucun filtrage par type"),console.log("Après filtrage par type:",l),m.value!=="all"&&(console.log("Filtrage par statut:",m.value),l=l.filter(g=>g.status===m.value)),console.log("Après filtrage par statut:",l),_.value!=="all"&&(console.log("Filtrage par groupe:",_.value),_.value==="none"?l=l.filter(g=>g&&!g.group_id):l=l.filter(g=>g&&g.group_id===_.value)),console.log("Après filtrage par groupe:",l),r.value){console.log("Filtrage par recherche:",r.value);const g=r.value.toLowerCase();l=l.filter(R=>R.name.toLowerCase().includes(g)||R.description.toLowerCase().includes(g))}if(console.log("Après filtrage par recherche:",l),h.value){console.log("Filtrage par prix:",h.value);const[g,R]=h.value.split("-").map(Number);!isNaN(g)&&!isNaN(R)&&(l=l.filter(k=>k.price>=g&&k.price<=R))}return console.log("Après filtrage par prix:",l),console.log("Résultat final du filtrage:",l),l});Ne([m,C,_,r,h],()=>{console.log("Auto-applying filters")});const f=async()=>{try{x.value=!0,await i.fetchProducts(),await v.fetchProductGroups(),n.value=i.allProducts}catch(l){console.error("Erreur lors de la récupération des données:",l),u.showNotification({type:"error",message:t("products_services.errors.fetch")})}finally{x.value=!1}},p=l=>{w.push(`/products/${l.id}`)},a=async l=>{if(confirm(t("products_services.confirm_delete")))try{await i.deleteProduct(l.id),u.showNotification({type:"success",message:t("products_services.success.delete")})}catch(g){console.error("Erreur lors de la suppression du produit:",g),u.showNotification({type:"error",message:t("products_services.errors.delete")})}},o=l=>{S.value===l?(b.value=b.value==="ASC"?"DESC":"ASC",O.value=b.value==="DESC"):(S.value=l,b.value="DESC",O.value=!0)},d=()=>{A.value={name:"",slug:"",description:""},E.value=!1,y.value=!0};return be(async()=>{x.value=!0;try{console.log("Début du chargement des produits dans ProductsView"),await i.fetchProducts(),console.log("Produits récupérés dans ProductsView:",i.allProducts),await v.fetchProductGroups(),console.log("Groupes de produits récupérés:",v.productGroups),console.log("Produits filtrés:",P.value)}catch(l){console.error("Erreur lors du chargement des produits:",l),u.showError(t("products.errors.load_failed"))}finally{x.value=!1}}),(l,g)=>{const R=He("router-link");return N(),L("div",xi,[e("div",Ii,[e("div",Pi,[e("h1",Mi,s(c(t)("products_services.title")),1),e("span",Di,s(c(t)("products_services.description")),1)]),e("div",Ni,[e("button",{class:"btn btn-outline",onClick:d},[g[10]||(g[10]=e("i",{class:"fas fa-folder-plus"},null,-1)),ne(" "+s(c(t)("product_groups.add")),1)]),Ce(R,{to:"/products/create",class:"btn btn-primary"},{default:Ee(()=>[g[11]||(g[11]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(c(t)("products_services.add")),1)]),_:1})])]),e("div",Li,[e("div",Ui,[e("div",Vi,[e("label",Fi,s(c(t)("products_services.filters.search")),1),e("div",qi,[g[12]||(g[12]=e("i",{class:"fas fa-search"},null,-1)),H(e("input",{type:"text","onUpdate:modelValue":g[0]||(g[0]=k=>r.value=k),class:"filter-input",placeholder:c(t)("products_services.search")},null,8,Bi),[[ee,r.value]])])]),e("div",ji,[e("label",Gi,s(c(t)("products_services.filters.type")),1),e("div",zi,[g[13]||(g[13]=e("i",{class:"fas fa-tags"},null,-1)),H(e("select",{"onUpdate:modelValue":g[1]||(g[1]=k=>C.value=k),class:"filter-input"},[(N(),L(ae,null,le($,k=>e("option",{key:k.value,value:k.value},s(k.label),9,Hi)),64))],512),[[pe,C.value]])])]),e("div",Wi,[e("label",Ki,s(c(t)("products_services.filters.status")),1),e("div",Ji,[g[14]||(g[14]=e("i",{class:"fas fa-server"},null,-1)),H(e("select",{"onUpdate:modelValue":g[2]||(g[2]=k=>m.value=k),class:"filter-input"},[e("option",Qi,s(c(t)("products_services.status.all")),1),e("option",Yi,s(c(t)("products_services.status.active")),1),e("option",Xi,s(c(t)("products_services.status.inactive")),1),e("option",Zi,s(c(t)("products_services.status.maintenance")),1)],512),[[pe,m.value]])])]),e("div",er,[e("label",tr,s(c(t)("products_services.filters.group")),1),e("div",sr,[g[15]||(g[15]=e("i",{class:"fas fa-users"},null,-1)),H(e("select",{"onUpdate:modelValue":g[3]||(g[3]=k=>_.value=k),class:"filter-input"},[e("option",or,s(c(t)("products_services.groups.all")),1),e("option",nr,s(c(t)("products_services.groups.none")),1),(N(!0),L(ae,null,le(c(v).productGroups,k=>(N(),L("option",{key:k.id,value:k.id},s(k.name),9,ir))),128))],512),[[pe,_.value]])])]),e("div",rr,[e("label",ar,s(c(t)("products_services.filters.price_range")),1),e("div",lr,[g[16]||(g[16]=e("i",{class:"fas fa-tag"},null,-1)),H(e("select",{"onUpdate:modelValue":g[4]||(g[4]=k=>h.value=k),class:"filter-input"},[e("option",cr,s(c(t)("products_services.filters.all_prices")),1),e("option",ur,s(c(t)("products_services.filters.price_low")),1),e("option",dr,s(c(t)("products_services.filters.price_medium")),1),e("option",pr,s(c(t)("products_services.filters.price_high")),1)],512),[[pe,h.value]])])])])]),x.value?(N(),L("div",vr,[g[17]||(g[17]=e("div",{class:"spinner"},null,-1)),e("p",null,s(c(t)("common.loading")),1)])):P.value&&P.value.length===0?(N(),L("div",mr,[g[18]||(g[18]=e("div",{class:"empty-icon"},[e("i",{class:"fas fa-box"})],-1)),e("h3",null,s(c(t)("products_services.empty.title")),1),e("p",null,s(c(t)("products_services.empty.description")),1)])):(N(),L("div",hr,[e("table",gr,[e("thead",null,[e("tr",null,[e("th",{onClick:g[5]||(g[5]=k=>o("name")),class:se({active:S.value==="name"})},[ne(s(c(t)("products_services.columns.name"))+" ",1),S.value==="name"?(N(),L("i",{key:0,class:se(b.value==="ASC"?"fas fa-sort-up":"fas fa-sort-down")},null,2)):J("",!0)],2),e("th",null,s(c(t)("products_services.columns.description")),1),e("th",{onClick:g[6]||(g[6]=k=>o("product_type")),class:se({active:S.value==="product_type"})},[ne(s(c(t)("products_services.columns.type"))+" ",1),S.value==="product_type"?(N(),L("i",{key:0,class:se(b.value==="ASC"?"fas fa-sort-up":"fas fa-sort-down")},null,2)):J("",!0)],2),e("th",{onClick:g[7]||(g[7]=k=>o("price")),class:se({active:S.value==="price"})},[ne(s(c(t)("products_services.columns.price"))+" ",1),S.value==="price"?(N(),L("i",{key:0,class:se(b.value==="ASC"?"fas fa-sort-up":"fas fa-sort-down")},null,2)):J("",!0)],2),e("th",{onClick:g[8]||(g[8]=k=>o("status")),class:se({active:S.value==="status"})},[ne(s(c(t)("products_services.columns.status"))+" ",1),S.value==="status"?(N(),L("i",{key:0,class:se(b.value==="ASC"?"fas fa-sort-up":"fas fa-sort-down")},null,2)):J("",!0)],2),e("th",null,s(c(t)("products_services.columns.group")),1),e("th",null,s(c(t)("products_services.columns.clients")),1),e("th",null,s(c(t)("common.actions")),1)])]),e("tbody",null,[(N(!0),L(ae,null,le(P.value,k=>{var T;return N(),L("tr",{key:k.id,onClick:V=>p(k)},[e("td",null,[e("span",yr,s(k.name),1)]),e("td",null,s(k.description&&k.description.length>50?k.description.substring(0,50)+"...":k.description||""),1),e("td",null,s(((T=$.find(V=>V.value===k.product_type))==null?void 0:T.label)||k.product_type),1),e("td",null,s(k.price)+" €",1),e("td",null,[e("span",{class:se("status-badge status-"+k.status)},s(c(t)(`products_services.status.${k.status}`)),3)]),e("td",null,s(k.group_id?c(v).getGroupName(k.group_id):c(t)("products_services.groups.none")),1),e("td",null,s(k.clients&&Array.isArray(k.clients)?k.clients.length:"0"),1),e("td",br,[e("div",$r,[e("button",{class:"btn-icon",onClick:Se(V=>p(k),["stop"]),title:c(t)("products_services.actions.edit")},g[19]||(g[19]=[e("i",{class:"fas fa-edit"},null,-1)]),8,Sr),e("button",{class:"btn-icon",onClick:Se(V=>a(k),["stop"]),title:c(t)("products_services.actions.delete")},g[20]||(g[20]=[e("i",{class:"fas fa-trash"},null,-1)]),8,wr)])])],8,_r)}),128))])])])),Ce(Ri,{show:y.value,"edit-mode":E.value,"group-to-edit":A.value,onClose:g[9]||(g[9]=k=>y.value=!1),onCreated:f,onUpdated:f},null,8,["show","edit-mode","group-to-edit"])])}}}),Bt=$e(kr,[["__scopeId","data-v-d2d6bb26"]]),Cr={class:"create-product-view view-container"},Ar={class:"header-box"},Er={class:"header-content"},Or={class:"page-title"},Tr={class:"page-description"},Rr={class:"tabs-navigation"},xr=["onClick"],Ir={class:"tab-label"},Pr={key:0,class:"wizard-content"},Mr={class:"product-type-selection"},Dr={class:"section-title"},Nr={class:"section-description"},Lr={class:"product-type-grid"},Ur=["onClick"],Vr={class:"product-type-icon"},Fr={class:"product-type-label"},qr={class:"product-type-help"},Br={class:"wizard-actions"},jr=_e({__name:"CreateProductView",setup(I){const{t}=we(),w=Te(),i=Me(),u=ct(),v=de(),n=Fe(),x=z(!1),y=z("shared_hosting"),A=X(()=>{const b=i.params.idOrAction;return b&&b!=="create"?parseInt(b,10):null}),m=X(()=>!!A.value),C=[{value:"shared_hosting",label:t("products_services.types.shared_hosting"),icon:"server-stack"},{value:"reseller_hosting",label:t("products_services.types.reseller_hosting"),icon:"users"},{value:"server_vps",label:t("products_services.types.server_vps"),icon:"server"},{value:"other",label:t("products_services.types.other"),icon:"box"}],$=[{id:"type",label:t("products_services.tabs.type"),icon:"tag",route:"product-type"},{id:"details",label:t("products_services.tabs.details"),icon:"info-circle",route:"product-details"},{id:"pricing",label:t("products_services.tabs.pricing"),icon:"money-bill",route:"product-pricing"},{id:"module",label:t("products_services.tabs.module"),icon:"puzzle-piece",route:"product-module"},{id:"custom_fields",label:t("products_services.tabs.custom_fields"),icon:"list-alt",route:"product-custom-fields"},{id:"configurable_options",label:t("products_services.tabs.configurable_options"),icon:"cogs",route:"product-configurable-options"},{id:"upgrades",label:t("products_services.tabs.upgrades"),icon:"arrow-up",route:"product-upgrades"},{id:"freedomain",label:t("products_services.tabs.freedomain"),icon:"globe",route:"product-freedomain"},{id:"cross_sells",label:t("products_services.tabs.cross_sells"),icon:"shopping-cart",route:"product-cross-sells"},{id:"other",label:t("products_services.tabs.other"),icon:"ellipsis-h",route:"product-other"},{id:"links",label:t("products_services.tabs.links"),icon:"link",route:"product-links"}],_=X(()=>{const b=i.name;if(b==="product-type")return"type";const E=$.find(P=>P.route===b);return E?E.id:"type"}),r=b=>{if(localStorage.setItem("productTypeData",JSON.stringify({productType:y.value})),b.id==="type")m.value?w.push({name:"product-type",params:{idOrAction:A.value}}):w.push({name:"create-product"});else{const E=m.value?A.value:"create";w.push({name:b.route,params:{idOrAction:E}})}},h=()=>{localStorage.setItem("currentProductData",JSON.stringify({productType:y.value}));const b=m.value?A.value:"create";w.push({name:"product-details",params:{idOrAction:b}})},S=()=>{w.push({name:"products"})},O=async()=>{x.value=!0;try{if(await u.fetchProductGroups(),m.value)try{const E=await n.fetchProduct(A.value);E&&(y.value=E.type||"shared_hosting",localStorage.setItem("currentProductData",JSON.stringify(E)))}catch(b){console.error("Erreur lors du chargement des données du produit:",b),v.showNotification({title:t("products_services.errors.product_load_failed_title"),message:t("products_services.errors.product_load_failed"),type:"error"})}else{const b=localStorage.getItem("productTypeData");if(b)try{const E=JSON.parse(b);E.productType&&(y.value=E.productType)}catch(E){console.error("Erreur lors du parsing des données sauvegardées:",E)}}}catch(b){console.error("Erreur lors du chargement des données:",b),v.showNotification({title:t("products_services.errors.load_data_failed_title"),message:t("products_services.errors.load_data_failed"),type:"error"})}finally{x.value=!1}};return be(()=>{O()}),(b,E)=>{const P=He("router-view");return N(),L("div",Cr,[e("div",Ar,[e("div",Er,[e("h1",Or,s(m.value?c(t)("products_services.edit_product.title"):c(t)("products_services.create_product.title")),1),e("span",Tr,s(m.value?c(t)("products_services.edit_product.description"):c(t)("products_services.create_product.description")),1)])]),e("div",Rr,[(N(),L(ae,null,le($,f=>e("div",{key:f.id,class:se(["tab-item",{active:_.value===f.id}]),onClick:p=>r(f)},[e("i",{class:se(`fas fa-${f.icon}`)},null,2),e("span",Ir,s(f.label),1)],10,xr)),64))]),_.value==="type"?(N(),L("div",Pr,[e("div",Mr,[e("h2",Dr,s(m.value?c(t)("products_services.edit_product.select_type"):c(t)("products_services.create_product.select_type")),1),e("p",Nr,s(c(t)("products_services.create_product.type_description")),1),e("div",Lr,[(N(),L(ae,null,le(C,f=>e("div",{key:f.value,class:se(["product-type-card",{selected:y.value===f.value}]),onClick:p=>y.value=f.value},[e("div",Vr,[e("i",{class:se(`fas fa-${f.icon}`)},null,2)]),e("div",Fr,s(f.label),1)],10,Ur)),64))]),e("div",qr,[e("p",null,s(c(t)("products_services.create_product.type_help")),1),e("p",null,s(c(t)("products_services.create_product.type_other_help")),1)])]),e("div",Br,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:S},s(c(t)("common.cancel")),1),e("button",{type:"button",class:"btn btn-primary",onClick:h},s(c(t)("common.continue")),1)])])):(N(),We(P,{key:1}))])}}}),rt=$e(jr,[["__scopeId","data-v-2329e72b"]]),Gr={class:"product-details-view"},zr={class:"wizard-content"},Hr={class:"form-section"},Wr={class:"form-row"},Kr={class:"form-group"},Jr={class:"form-control",disabled:""},Qr={class:"form-text text-muted"},Yr={class:"form-group"},Xr={value:""},Zr=["value"],ea={key:0,class:"invalid-feedback"},ta={class:"form-text text-muted"},sa={class:"form-group"},oa={key:0,class:"invalid-feedback"},na={class:"form-text text-muted"},ia={class:"form-group"},ra={class:"form-text text-muted"},aa={class:"form-group"},la={class:"input-group"},ca={class:"form-text text-muted"},ua={class:"form-group"},da=["value"],pa={class:"form-text text-muted"},fa={class:"form-group"},va={class:"form-text text-muted"},ma={class:"form-group"},ha={class:"form-text text-muted"},ga={class:"form-group"},_a={class:"form-text text-muted"},ya={class:"form-group"},ba=["value"],$a={class:"form-text text-muted"},Sa={class:"form-section advanced-options"},wa={class:"section-title"},ka={class:"form-check"},Ca={class:"form-check-label",for:"hidden-product"},Aa={class:"form-text text-muted"},Ea={class:"form-check"},Oa={class:"form-check-label",for:"require-domain"},Ta={class:"form-text text-muted"},Ra={class:"form-check"},xa={class:"form-check-label",for:"stock-control"},Ia={class:"form-text text-muted"},Pa={key:0,class:"form-group"},Ma={class:"form-check"},Da={class:"form-check-label",for:"apply-tax"},Na={class:"form-text text-muted"},La={class:"form-check"},Ua={class:"form-check-label",for:"featured"},Va={class:"form-text text-muted"},Fa={class:"form-check"},qa={class:"form-check-label",for:"hide-other-products"},Ba={class:"form-text text-muted"},ja={class:"wizard-actions"},Ga=["disabled"],za=["disabled"],Ha=_e({__name:"ProductDetailsView",setup(I){const{t}=we(),w=Te(),i=Me(),u=Fe(),v=ct(),n=de(),x=X(()=>i.params.type||"shared_hosting"),y=X(()=>{const l=i.params.idOrAction;return l&&l!=="create"?parseInt(l,10):null}),A=X(()=>!!y.value),m=X(()=>!!y.value),C=X(()=>{const l=localStorage.getItem("currentProductData");if(l)try{return JSON.parse(l)}catch(g){return console.error("Erreur lors du parsing des données:",g),{}}return{}}),$=[{id:"type",label:t("products_services.tabs.type"),icon:"tag",route:"create-product"},{id:"details",label:t("products_services.tabs.details"),icon:"info-circle",route:"product-details"},{id:"pricing",label:t("products_services.tabs.pricing"),icon:"money-bill",route:"product-pricing"},{id:"module",label:t("products_services.tabs.module"),icon:"puzzle-piece",route:"product-module"},{id:"custom_fields",label:t("products_services.tabs.custom_fields"),icon:"list-alt",route:"product-custom-fields"},{id:"configurable_options",label:t("products_services.tabs.configurable_options"),icon:"cogs",route:"product-configurable-options"},{id:"upgrades",label:t("products_services.tabs.upgrades"),icon:"arrow-up",route:"product-upgrades"},{id:"freedomain",label:t("products_services.tabs.freedomain"),icon:"globe",route:"product-freedomain"},{id:"cross_sells",label:t("products_services.tabs.cross_sells"),icon:"shopping-cart",route:"product-cross-sells"},{id:"other",label:t("products_services.tabs.other"),icon:"ellipsis-h",route:"product-other"},{id:"links",label:t("products_services.tabs.links"),icon:"link",route:"product-links"}];X(()=>{const l=i.name,g=$.find(R=>R.route===l);return g?g.id:"details"});const _=z(!1),r=z({}),h=z({type:"product",productType:x.value,name:"",slug:"",group_id:null,url:"",module:"",hidden:!1,tagline:"",shortDescription:"",description:"",color:"#00C3FF",welcomeEmail:"",requireDomain:!1,stockControl:!1,stockQuantity:0,applyTax:!1,featured:!1,hideOtherProducts:!1}),S=async()=>{if(y.value){_.value=!0;try{const l=await u.fetchProduct(y.value);l&&(h.value={...h.value,...l,productType:l.product_type||x.value,shortDescription:l.short_description||"",hideOtherProducts:l.hide_other_products||!1})}catch(l){console.error("Erreur lors du chargement du produit:",l),n.showNotification({title:t("products_services.errors.fetch"),message:t("products_services.errors.fetchMessage"),type:"error"})}finally{_.value=!1}}},O=l=>l.toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""),b=()=>{(!h.value.slug||h.value.slug===O(h.value.name.substring(0,h.value.name.length-1)))&&(h.value.slug=O(h.value.name))},E=()=>{h.value.slug&&(h.value.url=`/store/${h.value.slug}/`)},P=[{value:"",label:t("products_services.modules.none")},{value:"cpanel",label:"cPanel/WHM"},{value:"plesk",label:"Plesk"},{value:"directadmin",label:"DirectAdmin"},{value:"virtualizor",label:"Virtualizor"},{value:"custom",label:t("products_services.modules.custom")}],f=[{value:"",label:t("products_services.welcome_emails.none")},{value:"hosting",label:t("products_services.welcome_emails.hosting")},{value:"general",label:t("products_services.welcome_emails.general")}],p=()=>{const l={};return h.value.name.trim()||(l.name=t("products_services.errors.name_required")),h.value.group_id||(l.group_id=t("products_services.errors.group_required")),r.value=l,Object.keys(l).length===0},a=()=>{if(p()){localStorage.setItem("currentProductData",JSON.stringify(h.value));const l=A.value?y.value:"create";w.push({name:"product-pricing",params:{idOrAction:l}})}},o=()=>{y.value&&w.push(`/products/${y.value}`)},d=()=>{w.push("/products")};return be(async()=>{v.productGroups.length===0&&await v.fetchProductGroups(),A.value||m.value?await S():Object.keys(C.value).length>0&&(h.value={...h.value,...C.value})}),(l,g)=>(N(),L("div",Gr,[e("div",zr,[e("div",Hr,[e("div",Wr,[e("div",Kr,[e("label",null,s(c(t)("products_services.details.product_type")),1),e("select",Jr,[e("option",null,s(c(t)(`products_services.types.${x.value}`)),1)]),e("small",Qr,s(c(t)("products_services.details.product_type_help")),1)]),e("div",Yr,[e("label",null,s(c(t)("products_services.details.product_group")),1),H(e("select",{"onUpdate:modelValue":g[0]||(g[0]=R=>h.value.group_id=R),class:se(["form-control",{"is-invalid":r.value.group_id}])},[e("option",Xr,s(c(t)("products_services.details.select_group")),1),(N(!0),L(ae,null,le(c(v).productGroups,R=>(N(),L("option",{key:R.id,value:R.id},s(R.name),9,Zr))),128))],2),[[pe,h.value.group_id]]),r.value.group_id?(N(),L("div",ea,s(r.value.group_id),1)):J("",!0),e("small",ta,s(c(t)("products_services.details.product_group_help")),1)])]),e("div",sa,[e("label",null,s(c(t)("products_services.details.product_name")),1),H(e("input",{type:"text","onUpdate:modelValue":g[1]||(g[1]=R=>h.value.name=R),class:se(["form-control",{"is-invalid":r.value.name}]),onInput:b},null,34),[[ee,h.value.name]]),r.value.name?(N(),L("div",oa,s(r.value.name),1)):J("",!0),e("small",na,s(c(t)("products_services.details.product_name_help")),1)]),e("div",ia,[e("label",null,s(c(t)("products_services.details.product_tagline")),1),H(e("input",{type:"text","onUpdate:modelValue":g[2]||(g[2]=R=>h.value.tagline=R),class:"form-control"},null,512),[[ee,h.value.tagline]]),e("small",ra,s(c(t)("products_services.details.product_tagline_help")),1)]),e("div",aa,[e("label",null,s(c(t)("products_services.details.url")),1),e("div",la,[H(e("input",{type:"text","onUpdate:modelValue":g[3]||(g[3]=R=>h.value.url=R),class:"form-control",onInput:E},null,544),[[ee,h.value.url]]),g[16]||(g[16]=e("div",{class:"input-group-append"},[e("button",{class:"btn btn-outline-secondary",type:"button"},[e("i",{class:"fas fa-refresh"})])],-1))]),e("small",ca,s(c(t)("products_services.details.url_help")),1)]),e("div",ua,[e("label",null,s(c(t)("products_services.details.module")),1),H(e("select",{"onUpdate:modelValue":g[4]||(g[4]=R=>h.value.module=R),class:"form-control"},[(N(),L(ae,null,le(P,R=>e("option",{key:R.value,value:R.value},s(R.label),9,da)),64))],512),[[pe,h.value.module]]),e("small",pa,s(c(t)("products_services.details.module_help")),1)]),e("div",fa,[e("label",null,s(c(t)("products_services.details.product_short_description")),1),H(e("textarea",{"onUpdate:modelValue":g[5]||(g[5]=R=>h.value.shortDescription=R),class:"form-control",rows:"2"},null,512),[[ee,h.value.shortDescription]]),e("small",va,s(c(t)("products_services.details.product_short_description_help")),1)]),e("div",ma,[e("label",null,s(c(t)("products_services.details.product_description")),1),H(e("textarea",{"onUpdate:modelValue":g[6]||(g[6]=R=>h.value.description=R),class:"form-control",rows:"4"},null,512),[[ee,h.value.description]]),e("small",ha,s(c(t)("products_services.details.product_description_help")),1)]),e("div",ga,[e("label",null,s(c(t)("products_services.details.product_color")),1),H(e("input",{type:"color","onUpdate:modelValue":g[7]||(g[7]=R=>h.value.color=R),class:"form-control color-picker"},null,512),[[ee,h.value.color]]),e("small",_a,s(c(t)("products_services.details.product_color_help")),1)]),e("div",ya,[e("label",null,s(c(t)("products_services.details.welcome_email")),1),H(e("select",{"onUpdate:modelValue":g[8]||(g[8]=R=>h.value.welcomeEmail=R),class:"form-control"},[(N(),L(ae,null,le(f,R=>e("option",{key:R.value,value:R.value},s(R.label),9,ba)),64))],512),[[pe,h.value.welcomeEmail]]),e("small",$a,s(c(t)("products_services.details.welcome_email_help")),1)]),e("div",Sa,[e("h3",wa,s(c(t)("products_services.details.advanced_options")),1),e("div",ka,[H(e("input",{type:"checkbox",class:"form-check-input",id:"hidden-product","onUpdate:modelValue":g[9]||(g[9]=R=>h.value.hidden=R)},null,512),[[ye,h.value.hidden]]),e("label",Ca,s(c(t)("products_services.details.create_as_hidden")),1),e("small",Aa,s(c(t)("products_services.details.create_as_hidden_help")),1)]),e("div",Ea,[H(e("input",{type:"checkbox",class:"form-check-input",id:"require-domain","onUpdate:modelValue":g[10]||(g[10]=R=>h.value.requireDomain=R)},null,512),[[ye,h.value.requireDomain]]),e("label",Oa,s(c(t)("products_services.details.require_domain")),1),e("small",Ta,s(c(t)("products_services.details.require_domain_help")),1)]),e("div",Ra,[H(e("input",{type:"checkbox",class:"form-check-input",id:"stock-control","onUpdate:modelValue":g[11]||(g[11]=R=>h.value.stockControl=R)},null,512),[[ye,h.value.stockControl]]),e("label",xa,s(c(t)("products_services.details.stock_control")),1),e("small",Ia,s(c(t)("products_services.details.stock_control_help")),1)]),h.value.stockControl?(N(),L("div",Pa,[e("label",null,s(c(t)("products_services.details.stock_quantity")),1),H(e("input",{type:"number","onUpdate:modelValue":g[12]||(g[12]=R=>h.value.stockQuantity=R),class:"form-control",min:"0"},null,512),[[ee,h.value.stockQuantity,void 0,{number:!0}]])])):J("",!0),e("div",Ma,[H(e("input",{type:"checkbox",class:"form-check-input",id:"apply-tax","onUpdate:modelValue":g[13]||(g[13]=R=>h.value.applyTax=R)},null,512),[[ye,h.value.applyTax]]),e("label",Da,s(c(t)("products_services.details.apply_tax")),1),e("small",Na,s(c(t)("products_services.details.apply_tax_help")),1)]),e("div",La,[H(e("input",{type:"checkbox",class:"form-check-input",id:"featured","onUpdate:modelValue":g[14]||(g[14]=R=>h.value.featured=R)},null,512),[[ye,h.value.featured]]),e("label",Ua,s(c(t)("products_services.details.featured")),1),e("small",Va,s(c(t)("products_services.details.featured_help")),1)]),e("div",Fa,[H(e("input",{type:"checkbox",class:"form-check-input",id:"hide-other-products","onUpdate:modelValue":g[15]||(g[15]=R=>h.value.hideOtherProducts=R)},null,512),[[ye,h.value.hideOtherProducts]]),e("label",qa,s(c(t)("products_services.details.hide_other_products")),1),e("small",Ba,s(c(t)("products_services.details.hide_other_products_help")),1)])])])]),e("div",ja,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:d},s(c(t)("common.back")),1),A.value||!m.value?(N(),L("button",{key:0,type:"button",class:"btn btn-primary",onClick:a,disabled:_.value},s(c(t)("common.continue")),9,Ga)):(N(),L("button",{key:1,type:"button",class:"btn btn-primary",onClick:o,disabled:_.value},s(c(t)("common.edit")),9,za))])]))}}),jt=$e(Ha,[["__scopeId","data-v-533b4c3f"]]),Wa={class:"product-pricing-view"},Ka={class:"wizard-content"},Ja={class:"form-section"},Qa={class:"form-group"},Ya={class:"payment-type-options"},Xa={class:"form-check form-check-inline"},Za={class:"form-check-label",for:"payment-type-free"},el={class:"form-check form-check-inline"},tl={class:"form-check-label",for:"payment-type-one-time"},sl={class:"form-check form-check-inline"},ol={class:"form-check-label",for:"payment-type-recurring"},nl={class:"form-group"},il={class:"form-check"},rl={class:"form-check-label",for:"multiple-quantities-no"},al={class:"form-text text-muted"},ll={class:"form-check"},cl={class:"form-check-label",for:"multiple-quantities-yes"},ul={class:"form-text text-muted"},dl={key:0,class:"form-group"},pl={class:"form-text text-muted"},fl={class:"form-group"},vl={class:"form-text text-muted"},ml={class:"form-group"},hl={class:"form-text text-muted"},gl={class:"form-group"},_l={class:"form-check"},yl={class:"form-check-label",for:"prorata-billing"},bl={class:"form-text text-muted"},$l={class:"form-group"},Sl={class:"form-text text-muted"},wl={class:"form-group"},kl={class:"form-text text-muted"},Cl={key:1,class:"form-group"},Al={class:"form-check"},El={class:"form-check-label",for:"pricing-system-default"},Ol={class:"form-text text-muted"},Tl={class:"form-check"},Rl={class:"form-check-label",for:"pricing-product-specific"},xl={class:"form-text text-muted"},Il={key:2,class:"payment-options"},Pl={class:"section-title"},Ml={class:"payment-options-header"},Dl={class:"option-label"},Nl={class:"option-enabled"},Ll={class:"option-price"},Ul={class:"option-setup-fee"},Vl={class:"payment-option-row"},Fl={class:"option-label"},ql={class:"option-enabled"},Bl={class:"option-price"},jl={class:"input-group"},Gl=["disabled"],zl={class:"option-setup-fee"},Hl={class:"input-group"},Wl=["disabled"],Kl={class:"payment-option-row"},Jl={class:"option-label"},Ql={class:"option-enabled"},Yl={class:"option-price"},Xl={class:"input-group"},Zl=["disabled"],ec={class:"option-setup-fee"},tc={class:"input-group"},sc=["disabled"],oc={class:"payment-option-row"},nc={class:"option-label"},ic={class:"option-enabled"},rc={class:"option-price"},ac={class:"input-group"},lc=["disabled"],cc={class:"option-setup-fee"},uc={class:"input-group"},dc=["disabled"],pc={class:"payment-option-row"},fc={class:"option-label"},vc={class:"option-enabled"},mc={class:"option-price"},hc={class:"input-group"},gc=["disabled"],_c={class:"option-setup-fee"},yc={class:"input-group"},bc=["disabled"],$c={class:"payment-option-row"},Sc={class:"option-label"},wc={class:"option-enabled"},kc={class:"option-price"},Cc={class:"input-group"},Ac=["disabled"],Ec={class:"option-setup-fee"},Oc={class:"input-group"},Tc=["disabled"],Rc={class:"payment-option-row"},xc={class:"option-label"},Ic={class:"option-enabled"},Pc={class:"option-price"},Mc={class:"input-group"},Dc=["disabled"],Nc={class:"option-setup-fee"},Lc={class:"input-group"},Uc=["disabled"],Vc={key:0,class:"error-message"},Fc={class:"payment-options-help"},qc={class:"wizard-actions"},Bc=["disabled"],jc=_e({__name:"ProductPricingView",setup(I){const{t}=we(),w=Te(),i=Me();de(),X(()=>i.params.type||"shared_hosting");const u=X(()=>{const _=localStorage.getItem("currentProductData");if(_)try{return JSON.parse(_)}catch(r){return console.error("Erreur lors du parsing des données:",r),{}}return{}}),v=X(()=>{const _=i.params.idOrAction;return _&&_!=="create"?parseInt(_,10):null}),n=X(()=>!!v.value),x=[{id:"type",label:t("products_services.tabs.type"),icon:"tag",route:"create-product"},{id:"details",label:t("products_services.tabs.details"),icon:"info-circle",route:"product-details"},{id:"pricing",label:t("products_services.tabs.pricing"),icon:"money-bill",route:"product-pricing"},{id:"module",label:t("products_services.tabs.module"),icon:"puzzle-piece",route:"product-module"},{id:"custom_fields",label:t("products_services.tabs.custom_fields"),icon:"list-alt",route:"product-custom-fields"},{id:"configurable_options",label:t("products_services.tabs.configurable_options"),icon:"cogs",route:"product-configurable-options"},{id:"upgrades",label:t("products_services.tabs.upgrades"),icon:"arrow-up",route:"product-upgrades"},{id:"freedomain",label:t("products_services.tabs.freedomain"),icon:"globe",route:"product-freedomain"},{id:"cross_sells",label:t("products_services.tabs.cross_sells"),icon:"shopping-cart",route:"product-cross-sells"},{id:"other",label:t("products_services.tabs.other"),icon:"ellipsis-h",route:"product-other"},{id:"links",label:t("products_services.tabs.links"),icon:"link",route:"product-links"}];X(()=>{const _=i.name,r=x.find(h=>h.route===_);return r?r.id:"pricing"});const y=z(!1),A=z({}),m=z({paymentType:"free",allowMultipleQuantities:!1,recurringCyclesLimit:0,autoTerminationDays:0,promotionCode:"",prorataBilling:!1,privateBillingDate:0,chargeNextMonth:0,pricingConfiguration:"system_default",paymentOptions:{monthly:{enabled:!0,price:0,setupFee:0},quarterly:{enabled:!1,price:0,setupFee:0},semiannually:{enabled:!1,price:0,setupFee:0},annually:{enabled:!1,price:0,setupFee:0},biennially:{enabled:!1,price:0,setupFee:0},triennially:{enabled:!1,price:0,setupFee:0}}});be(()=>{u.value&&Object.keys(m.value).forEach(_=>{u.value[_]!==void 0&&(m.value[_]=u.value[_])})});const C=()=>{localStorage.setItem("pricingData",JSON.stringify(m.value));const _=n.value?v.value:"create";w.push({name:"product-module",params:{idOrAction:_}})},$=()=>{localStorage.setItem("pricingData",JSON.stringify(m.value));const _=n.value?v.value:"create";w.push({name:"product-details",params:{idOrAction:_}})};return(_,r)=>(N(),L("div",Wa,[e("div",Ka,[e("div",Ja,[e("div",Qa,[e("label",null,s(c(t)("products_services.pricing.payment_type")),1),e("div",Ya,[e("div",Xa,[H(e("input",{type:"radio",id:"payment-type-free","onUpdate:modelValue":r[0]||(r[0]=h=>m.value.paymentType=h),value:"free",class:"form-check-input"},null,512),[[Ve,m.value.paymentType]]),e("label",Za,s(c(t)("products_services.pricing.free")),1)]),e("div",el,[H(e("input",{type:"radio",id:"payment-type-one-time","onUpdate:modelValue":r[1]||(r[1]=h=>m.value.paymentType=h),value:"one_time",class:"form-check-input"},null,512),[[Ve,m.value.paymentType]]),e("label",tl,s(c(t)("products_services.pricing.one_time")),1)]),e("div",sl,[H(e("input",{type:"radio",id:"payment-type-recurring","onUpdate:modelValue":r[2]||(r[2]=h=>m.value.paymentType=h),value:"recurring",class:"form-check-input"},null,512),[[Ve,m.value.paymentType]]),e("label",ol,s(c(t)("products_services.pricing.recurring")),1)])])]),e("div",nl,[e("label",null,s(c(t)("products_services.pricing.allow_multiple_quantities")),1),e("div",il,[H(e("input",{type:"radio",id:"multiple-quantities-no","onUpdate:modelValue":r[3]||(r[3]=h=>m.value.allowMultipleQuantities=h),value:!1,class:"form-check-input"},null,512),[[Ve,m.value.allowMultipleQuantities]]),e("label",rl,s(c(t)("products_services.pricing.no")),1),e("small",al,s(c(t)("products_services.pricing.multiple_quantities_no_help")),1)]),e("div",ll,[H(e("input",{type:"radio",id:"multiple-quantities-yes","onUpdate:modelValue":r[4]||(r[4]=h=>m.value.allowMultipleQuantities=h),value:!0,class:"form-check-input"},null,512),[[Ve,m.value.allowMultipleQuantities]]),e("label",cl,s(c(t)("products_services.pricing.yes")),1),e("small",ul,s(c(t)("products_services.pricing.multiple_quantities_yes_help")),1)])]),m.value.paymentType==="recurring"?(N(),L("div",dl,[e("label",null,s(c(t)("products_services.pricing.recurring_cycles_limit")),1),H(e("input",{type:"number","onUpdate:modelValue":r[5]||(r[5]=h=>m.value.recurringCyclesLimit=h),class:"form-control",min:"0"},null,512),[[ee,m.value.recurringCyclesLimit,void 0,{number:!0}]]),e("small",pl,s(c(t)("products_services.pricing.recurring_cycles_limit_help")),1)])):J("",!0),e("div",fl,[e("label",null,s(c(t)("products_services.pricing.auto_termination_days")),1),H(e("input",{type:"number","onUpdate:modelValue":r[6]||(r[6]=h=>m.value.autoTerminationDays=h),class:"form-control",min:"0"},null,512),[[ee,m.value.autoTerminationDays,void 0,{number:!0}]]),e("small",vl,s(c(t)("products_services.pricing.auto_termination_days_help")),1)]),e("div",ml,[e("label",null,s(c(t)("products_services.pricing.promotion_code")),1),H(e("input",{type:"text","onUpdate:modelValue":r[7]||(r[7]=h=>m.value.promotionCode=h),class:"form-control"},null,512),[[ee,m.value.promotionCode]]),e("small",hl,s(c(t)("products_services.pricing.promotion_code_help")),1)]),e("div",gl,[e("div",_l,[H(e("input",{type:"checkbox",id:"prorata-billing","onUpdate:modelValue":r[8]||(r[8]=h=>m.value.prorataBilling=h),class:"form-check-input"},null,512),[[ye,m.value.prorataBilling]]),e("label",yl,s(c(t)("products_services.pricing.prorata_billing")),1),e("small",bl,s(c(t)("products_services.pricing.prorata_billing_help")),1)])]),e("div",$l,[e("label",null,s(c(t)("products_services.pricing.private_billing_date")),1),H(e("input",{type:"number","onUpdate:modelValue":r[9]||(r[9]=h=>m.value.privateBillingDate=h),class:"form-control",min:"0",max:"31"},null,512),[[ee,m.value.privateBillingDate,void 0,{number:!0}]]),e("small",Sl,s(c(t)("products_services.pricing.private_billing_date_help")),1)]),e("div",wl,[e("label",null,s(c(t)("products_services.pricing.charge_next_month")),1),H(e("input",{type:"number","onUpdate:modelValue":r[10]||(r[10]=h=>m.value.chargeNextMonth=h),class:"form-control",min:"0",max:"31"},null,512),[[ee,m.value.chargeNextMonth,void 0,{number:!0}]]),e("small",kl,s(c(t)("products_services.pricing.charge_next_month_help")),1)]),m.value.paymentType!=="free"?(N(),L("div",Cl,[e("label",null,s(c(t)("products_services.pricing.pricing_configuration")),1),e("div",Al,[H(e("input",{type:"radio",id:"pricing-system-default","onUpdate:modelValue":r[11]||(r[11]=h=>m.value.pricingConfiguration=h),value:"system_default",class:"form-check-input"},null,512),[[Ve,m.value.pricingConfiguration]]),e("label",El,s(c(t)("products_services.pricing.system_default")),1),e("small",Ol,s(c(t)("products_services.pricing.system_default_help")),1)]),e("div",Tl,[H(e("input",{type:"radio",id:"pricing-product-specific","onUpdate:modelValue":r[12]||(r[12]=h=>m.value.pricingConfiguration=h),value:"product_specific",class:"form-check-input"},null,512),[[Ve,m.value.pricingConfiguration]]),e("label",Rl,s(c(t)("products_services.pricing.product_specific")),1),e("small",xl,s(c(t)("products_services.pricing.product_specific_help")),1)])])):J("",!0),m.value.paymentType!=="free"&&m.value.pricingConfiguration==="product_specific"?(N(),L("div",Il,[e("h3",Pl,s(c(t)("products_services.pricing.payment_options")),1),e("div",Ml,[e("div",Dl,s(c(t)("products_services.pricing.option")),1),e("div",Nl,s(c(t)("products_services.pricing.enabled")),1),e("div",Ll,s(c(t)("products_services.pricing.price")),1),e("div",Ul,s(c(t)("products_services.pricing.setup_fee")),1)]),e("div",Vl,[e("div",Fl,s(c(t)("products_services.pricing.monthly")),1),e("div",ql,[H(e("input",{type:"checkbox","onUpdate:modelValue":r[13]||(r[13]=h=>m.value.paymentOptions.monthly.enabled=h),class:"form-check-input"},null,512),[[ye,m.value.paymentOptions.monthly.enabled]])]),e("div",Bl,[e("div",jl,[r[31]||(r[31]=e("div",{class:"input-group-prepend"},[e("span",{class:"input-group-text"},"$")],-1)),H(e("input",{type:"number","onUpdate:modelValue":r[14]||(r[14]=h=>m.value.paymentOptions.monthly.price=h),class:"form-control",min:"0",step:"0.01",disabled:!m.value.paymentOptions.monthly.enabled},null,8,Gl),[[ee,m.value.paymentOptions.monthly.price,void 0,{number:!0}]])])]),e("div",zl,[e("div",Hl,[r[32]||(r[32]=e("div",{class:"input-group-prepend"},[e("span",{class:"input-group-text"},"$")],-1)),H(e("input",{type:"number","onUpdate:modelValue":r[15]||(r[15]=h=>m.value.paymentOptions.monthly.setupFee=h),class:"form-control",min:"0",step:"0.01",disabled:!m.value.paymentOptions.monthly.enabled},null,8,Wl),[[ee,m.value.paymentOptions.monthly.setupFee,void 0,{number:!0}]])])])]),e("div",Kl,[e("div",Jl,s(c(t)("products_services.pricing.quarterly")),1),e("div",Ql,[H(e("input",{type:"checkbox","onUpdate:modelValue":r[16]||(r[16]=h=>m.value.paymentOptions.quarterly.enabled=h),class:"form-check-input"},null,512),[[ye,m.value.paymentOptions.quarterly.enabled]])]),e("div",Yl,[e("div",Xl,[r[33]||(r[33]=e("div",{class:"input-group-prepend"},[e("span",{class:"input-group-text"},"$")],-1)),H(e("input",{type:"number","onUpdate:modelValue":r[17]||(r[17]=h=>m.value.paymentOptions.quarterly.price=h),class:"form-control",min:"0",step:"0.01",disabled:!m.value.paymentOptions.quarterly.enabled},null,8,Zl),[[ee,m.value.paymentOptions.quarterly.price,void 0,{number:!0}]])])]),e("div",ec,[e("div",tc,[r[34]||(r[34]=e("div",{class:"input-group-prepend"},[e("span",{class:"input-group-text"},"$")],-1)),H(e("input",{type:"number","onUpdate:modelValue":r[18]||(r[18]=h=>m.value.paymentOptions.quarterly.setupFee=h),class:"form-control",min:"0",step:"0.01",disabled:!m.value.paymentOptions.quarterly.enabled},null,8,sc),[[ee,m.value.paymentOptions.quarterly.setupFee,void 0,{number:!0}]])])])]),e("div",oc,[e("div",nc,s(c(t)("products_services.pricing.semiannually")),1),e("div",ic,[H(e("input",{type:"checkbox","onUpdate:modelValue":r[19]||(r[19]=h=>m.value.paymentOptions.semiannually.enabled=h),class:"form-check-input"},null,512),[[ye,m.value.paymentOptions.semiannually.enabled]])]),e("div",rc,[e("div",ac,[r[35]||(r[35]=e("div",{class:"input-group-prepend"},[e("span",{class:"input-group-text"},"$")],-1)),H(e("input",{type:"number","onUpdate:modelValue":r[20]||(r[20]=h=>m.value.paymentOptions.semiannually.price=h),class:"form-control",min:"0",step:"0.01",disabled:!m.value.paymentOptions.semiannually.enabled},null,8,lc),[[ee,m.value.paymentOptions.semiannually.price,void 0,{number:!0}]])])]),e("div",cc,[e("div",uc,[r[36]||(r[36]=e("div",{class:"input-group-prepend"},[e("span",{class:"input-group-text"},"$")],-1)),H(e("input",{type:"number","onUpdate:modelValue":r[21]||(r[21]=h=>m.value.paymentOptions.semiannually.setupFee=h),class:"form-control",min:"0",step:"0.01",disabled:!m.value.paymentOptions.semiannually.enabled},null,8,dc),[[ee,m.value.paymentOptions.semiannually.setupFee,void 0,{number:!0}]])])])]),e("div",pc,[e("div",fc,s(c(t)("products_services.pricing.annually")),1),e("div",vc,[H(e("input",{type:"checkbox","onUpdate:modelValue":r[22]||(r[22]=h=>m.value.paymentOptions.annually.enabled=h),class:"form-check-input"},null,512),[[ye,m.value.paymentOptions.annually.enabled]])]),e("div",mc,[e("div",hc,[r[37]||(r[37]=e("div",{class:"input-group-prepend"},[e("span",{class:"input-group-text"},"$")],-1)),H(e("input",{type:"number","onUpdate:modelValue":r[23]||(r[23]=h=>m.value.paymentOptions.annually.price=h),class:"form-control",min:"0",step:"0.01",disabled:!m.value.paymentOptions.annually.enabled},null,8,gc),[[ee,m.value.paymentOptions.annually.price,void 0,{number:!0}]])])]),e("div",_c,[e("div",yc,[r[38]||(r[38]=e("div",{class:"input-group-prepend"},[e("span",{class:"input-group-text"},"$")],-1)),H(e("input",{type:"number","onUpdate:modelValue":r[24]||(r[24]=h=>m.value.paymentOptions.annually.setupFee=h),class:"form-control",min:"0",step:"0.01",disabled:!m.value.paymentOptions.annually.enabled},null,8,bc),[[ee,m.value.paymentOptions.annually.setupFee,void 0,{number:!0}]])])])]),e("div",$c,[e("div",Sc,s(c(t)("products_services.pricing.biennially")),1),e("div",wc,[H(e("input",{type:"checkbox","onUpdate:modelValue":r[25]||(r[25]=h=>m.value.paymentOptions.biennially.enabled=h),class:"form-check-input"},null,512),[[ye,m.value.paymentOptions.biennially.enabled]])]),e("div",kc,[e("div",Cc,[r[39]||(r[39]=e("div",{class:"input-group-prepend"},[e("span",{class:"input-group-text"},"$")],-1)),H(e("input",{type:"number","onUpdate:modelValue":r[26]||(r[26]=h=>m.value.paymentOptions.biennially.price=h),class:"form-control",min:"0",step:"0.01",disabled:!m.value.paymentOptions.biennially.enabled},null,8,Ac),[[ee,m.value.paymentOptions.biennially.price,void 0,{number:!0}]])])]),e("div",Ec,[e("div",Oc,[r[40]||(r[40]=e("div",{class:"input-group-prepend"},[e("span",{class:"input-group-text"},"$")],-1)),H(e("input",{type:"number","onUpdate:modelValue":r[27]||(r[27]=h=>m.value.paymentOptions.biennially.setupFee=h),class:"form-control",min:"0",step:"0.01",disabled:!m.value.paymentOptions.biennially.enabled},null,8,Tc),[[ee,m.value.paymentOptions.biennially.setupFee,void 0,{number:!0}]])])])]),e("div",Rc,[e("div",xc,s(c(t)("products_services.pricing.triennially")),1),e("div",Ic,[H(e("input",{type:"checkbox","onUpdate:modelValue":r[28]||(r[28]=h=>m.value.paymentOptions.triennially.enabled=h),class:"form-check-input"},null,512),[[ye,m.value.paymentOptions.triennially.enabled]])]),e("div",Pc,[e("div",Mc,[r[41]||(r[41]=e("div",{class:"input-group-prepend"},[e("span",{class:"input-group-text"},"$")],-1)),H(e("input",{type:"number","onUpdate:modelValue":r[29]||(r[29]=h=>m.value.paymentOptions.triennially.price=h),class:"form-control",min:"0",step:"0.01",disabled:!m.value.paymentOptions.triennially.enabled},null,8,Dc),[[ee,m.value.paymentOptions.triennially.price,void 0,{number:!0}]])])]),e("div",Nc,[e("div",Lc,[r[42]||(r[42]=e("div",{class:"input-group-prepend"},[e("span",{class:"input-group-text"},"$")],-1)),H(e("input",{type:"number","onUpdate:modelValue":r[30]||(r[30]=h=>m.value.paymentOptions.triennially.setupFee=h),class:"form-control",min:"0",step:"0.01",disabled:!m.value.paymentOptions.triennially.enabled},null,8,Uc),[[ee,m.value.paymentOptions.triennially.setupFee,void 0,{number:!0}]])])])]),A.value.paymentOptions?(N(),L("div",Vc,s(A.value.paymentOptions),1)):J("",!0),e("p",Fc,s(c(t)("products_services.pricing.payment_options_help")),1)])):J("",!0)])]),e("div",qc,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:$},s(c(t)("common.back")),1),e("button",{type:"button",class:"btn btn-primary",onClick:C,disabled:y.value},s(c(t)("common.continue")),9,Bc)])]))}}),Gt=$e(jc,[["__scopeId","data-v-fa96fe2b"]]),St=Pe("servers",()=>{const I=z([]),t=z(!1),w=z(!1),i=de();return{servers:I,loading:t,saving:w,getServerById:h=>I.value.find(S=>S.id===h),fetchServers:async()=>{try{t.value=!0;const h=await me.get("/api/v1/settings/servers");return I.value=h.data.servers||[],I.value}catch(h){throw console.error("Erreur lors de la récupération des serveurs:",h),h}finally{t.value=!1}},createServer:async h=>{try{w.value=!0;const S=await me.post("/api/v1/settings/servers",h);if(S.data.success){const O=S.data.server;return I.value.push(O),O}else throw new Error(S.data.message||"Erreur lors de la création du serveur")}catch(S){throw console.error("Erreur lors de la création du serveur:",S),S}finally{w.value=!1}},updateServer:async h=>{try{w.value=!0;const S=await me.put(`/api/v1/settings/servers/${h.id}`,h);if(S.data.success){const O=S.data.server,b=I.value.findIndex(E=>E.id===O.id);return b!==-1&&(I.value[b]=O),O}else throw new Error(S.data.message||"Erreur lors de la mise à jour du serveur")}catch(S){throw console.error("Erreur lors de la mise à jour du serveur:",S),S}finally{w.value=!1}},deleteServer:async h=>{try{w.value=!0;const S=await me.delete(`/api/v1/settings/servers/${h}`);if(S.data.success)I.value=I.value.filter(O=>O.id!==h);else throw new Error(S.data.message||"Erreur lors de la suppression du serveur")}catch(S){throw console.error("Erreur lors de la suppression du serveur:",S),S}finally{w.value=!1}},testServerConnection:async(h,S)=>{try{if(h)return(await me.post(`/api/v1/settings/servers/${h}/test`)).data;if(S)return(await me.post("/api/v1/settings/servers/test",S)).data;throw new Error("Identifiant de serveur ou données de serveur requis")}catch(O){throw console.error("Erreur lors du test de connexion au serveur:",O),O}},testNewServerConnection:async h=>{try{return(await me.post("/api/v1/settings/servers/test",h)).data}catch(S){throw console.error("Error testing new server connection:",S),S}},getServerStats:async h=>{try{return(await me.get(`/api/v1/settings/servers/${h}/stats`)).data}catch(S){throw console.error("Error getting server stats:",S),S}},getServerPlans:async h=>{try{return(await me.get(`/api/v1/settings/servers/${h}/plans`)).data}catch(S){throw console.error("Erreur lors de la récupération des plans du serveur:",S),S}},showSuccessMessage:async h=>{await i.showSuccess(h)},showErrorMessage:async h=>{await i.showError(h)}}}),mt={},Gc=()=>({token:localStorage.getItem("auth_token")||""}),zc=()=>{const I=Gc(),t=(mt==null?void 0:mt.VITE_API_URL)||"";return{getVirtualizorOptions:async v=>{var n,x;try{return(await me.get(`${t}/api/servers/${v}/virtualizor-options`,{headers:{Authorization:`Bearer ${I.token}`}})).data}catch(y){return console.error("Erreur lors de la récupération des options Virtualizor:",y),{success:!1,error:((x=(n=y.response)==null?void 0:n.data)==null?void 0:x.message)||y.message||"Une erreur est survenue"}}},getProxmoxOptions:async v=>{var n,x;try{return(await me.get(`${t}/api/servers/${v}/proxmox-options`,{headers:{Authorization:`Bearer ${I.token}`}})).data}catch(y){return console.error("Erreur lors de la récupération des options Proxmox:",y),{success:!1,error:((x=(n=y.response)==null?void 0:n.data)==null?void 0:x.message)||y.message||"Une erreur est survenue"}}},getServerPlans:async v=>{var n,x;try{return(await me.get(`${t}/api/v1/servers/${v}/plans`,{headers:{Authorization:`Bearer ${I.token}`}})).data}catch(y){return console.error("Erreur lors de la récupération des plans:",y),{success:!1,error:((x=(n=y.response)==null?void 0:n.data)==null?void 0:x.message)||y.message||"Une erreur est survenue"}}}}},Hc={class:"product-module-view"},Wc={class:"wizard-content"},Kc={class:"form-section"},Jc={class:"form-group"},Qc=["value"],Yc={class:"form-text text-muted"},Xc={key:0,class:"form-group"},Zc=["value"],eu={key:0,class:"invalid-feedback"},tu={class:"form-text text-muted"},su={key:1,class:"form-group"},ou=["disabled"],nu={value:"",disabled:""},iu=["value"],ru={key:0,class:"invalid-feedback"},au={class:"form-text text-muted"},lu={key:1,class:"spinner-container"},cu={class:"spinner-border spinner-border-sm text-primary",role:"status"},uu={class:"sr-only"},du={class:"ml-2"},pu={key:2,class:"form-group"},fu=["disabled"],vu={value:"",disabled:""},mu=["value"],hu={key:0,class:"invalid-feedback"},gu={class:"form-text text-muted"},_u={key:1,class:"spinner-container"},yu={class:"spinner-border spinner-border-sm text-primary",role:"status"},bu={class:"sr-only"},$u={class:"ml-2"},Su={key:3,class:"module-info"},wu={class:"info-box"},ku={key:4,class:"module-info"},Cu={class:"info-box"},Au={key:5,class:"resource-config-section"},Eu={class:"section-title"},Ou={class:"section-description"},Tu={class:"row"},Ru={class:"col-md-6"},xu={class:"form-group"},Iu={class:"form-text text-muted"},Pu={class:"col-md-6"},Mu={class:"form-group"},Du={class:"form-text text-muted"},Nu={class:"row"},Lu={class:"col-md-6"},Uu={class:"form-group"},Vu={class:"form-text text-muted"},Fu={class:"col-md-6"},qu={class:"form-group"},Bu={class:"form-text text-muted"},ju={class:"row"},Gu={class:"col-md-6"},zu={class:"form-group"},Hu={class:"form-text text-muted"},Wu={class:"col-md-6"},Ku={class:"form-group"},Ju={value:"",disabled:""},Qu=["value"],Yu={key:0,class:"invalid-feedback"},Xu={class:"form-text text-muted"},Zu={class:"row"},ed={class:"col-md-12"},td={class:"form-group"},sd={value:"",disabled:""},od=["value"],nd={class:"form-text text-muted"},id={key:0,class:"loading-container"},rd={class:"ml-2"},ad={key:6,class:"resource-config-section"},ld={class:"section-title"},cd={class:"section-description"},ud={class:"row"},dd={class:"col-md-6"},pd={class:"form-group"},fd={class:"form-text text-muted"},vd={class:"col-md-6"},md={class:"form-group"},hd={class:"form-text text-muted"},gd={class:"row"},_d={class:"col-md-6"},yd={class:"form-group"},bd={class:"form-text text-muted"},$d={class:"col-md-6"},Sd={class:"form-group"},wd={class:"form-text text-muted"},kd={class:"row"},Cd={class:"col-md-6"},Ad={class:"form-group"},Ed={class:"form-text text-muted"},Od={class:"col-md-6"},Td={class:"form-group"},Rd={class:"form-text text-muted"},xd={class:"row"},Id={class:"col-md-6"},Pd={class:"form-group"},Md={value:"",disabled:""},Dd=["value"],Nd={key:0,class:"invalid-feedback"},Ld={class:"form-text text-muted"},Ud={class:"col-md-6"},Vd={class:"form-group"},Fd={value:"",disabled:""},qd=["value"],Bd={class:"form-text text-muted"},jd={key:0,class:"loading-container"},Gd={class:"ml-2"},zd={key:7,class:"auto-setup-section"},Hd={class:"section-title"},Wd={class:"form-check"},Kd={class:"form-check-label",for:"auto-setup-on-order"},Jd={class:"form-text text-muted"},Qd={class:"form-check"},Yd={class:"form-check-label",for:"auto-setup-on-payment"},Xd={class:"form-text text-muted"},Zd={class:"form-check"},ep={class:"form-check-label",for:"auto-setup-on-pending-order"},tp={class:"form-text text-muted"},sp={class:"form-check"},op={class:"form-check-label",for:"no-auto-setup"},np={class:"form-text text-muted"},ip={class:"wizard-actions"},rp=["disabled"],ap=_e({__name:"ProductModuleView",setup(I){const{t}=we(),w=Te(),i=Me(),u=de(),v=St(),n=zc();X(()=>i.params.type||"shared_hosting");const x=X(()=>{const M=localStorage.getItem("currentProductData");if(M)try{return JSON.parse(M)}catch(D){return console.error("Erreur lors du parsing des données:",D),{}}return{}}),y=X(()=>{const M=i.params.idOrAction;return M&&M!=="create"?parseInt(M,10):null}),A=X(()=>!!y.value),m=[{id:"type",label:t("products_services.tabs.type"),icon:"tag",route:"create-product"},{id:"details",label:t("products_services.tabs.details"),icon:"info-circle",route:"product-details"},{id:"pricing",label:t("products_services.tabs.pricing"),icon:"money-bill",route:"product-pricing"},{id:"module",label:t("products_services.tabs.module"),icon:"puzzle-piece",route:"product-module"},{id:"custom_fields",label:t("products_services.tabs.custom_fields"),icon:"list-alt",route:"product-custom-fields"},{id:"configurable_options",label:t("products_services.tabs.configurable_options"),icon:"cogs",route:"product-configurable-options"},{id:"upgrades",label:t("products_services.tabs.upgrades"),icon:"arrow-up",route:"product-upgrades"},{id:"freedomain",label:t("products_services.tabs.freedomain"),icon:"globe",route:"product-freedomain"},{id:"cross_sells",label:t("products_services.tabs.cross_sells"),icon:"shopping-cart",route:"product-cross-sells"},{id:"other",label:t("products_services.tabs.other"),icon:"ellipsis-h",route:"product-other"},{id:"links",label:t("products_services.tabs.links"),icon:"link",route:"product-links"}];X(()=>{const M=i.name,D=m.find(U=>U.route===M);return D?D.id:"module"});const C=z(!1),$=z({}),_=je({moduleName:"",serverGroup:"",serverId:"",autoSetupOnOrder:!1,autoSetupOnPayment:!1,autoSetupOnPendingOrder:!1,noAutoSetup:!0,moduleSettings:{cpanelPlan:"",virtualizorResources:{cpu:1,memory:1024,disk_space:10,bandwidth:100,ips:1,virtualization_type:"",os_template:""},proxmoxResources:{cpu:1,memory:1024,disk_space:10,bandwidth:100,ips:1,container_type:"lxc",storage:"",template:""}}}),r=X(()=>[...[{value:"",label:t("products_services.modules.none")},{value:"custom",label:t("products_services.modules.custom")}],{value:"cpanel",label:"cPanel/WHM"},{value:"virtualizor",label:"Virtualizor"},{value:"proxmox",label:"Proxmox"}]),h=[{value:"",label:t("products_services.modules.no_server_group")},{value:"shared_servers",label:t("products_services.modules.shared_servers")},{value:"reseller_servers",label:t("products_services.modules.reseller_servers")},{value:"vps_servers",label:t("products_services.modules.vps_servers")}],S=z([]),O=z(!1),b=z([]),E=z(!1),P=z([]),f=z([]),p=z([]),a=z([]),o=z(!1),d=z(!1),l=async()=>{try{O.value=!0,await v.fetchServers(),S.value=v.servers.filter(M=>_.moduleName==="cpanel"&&M.type==="cPanel"||_.moduleName==="virtualizor"&&M.type==="Virtualizor"||_.moduleName==="proxmox"&&M.type==="Proxmox")}catch(M){console.error("Erreur lors du chargement des serveurs:",M),u.showNotification({title:"Erreur",type:"error",message:t("products_services.modules.errors.server_load_failed")})}finally{O.value=!1}},g=async M=>{if(M)try{E.value=!0;const D=await n.getServerPlans(M);D.success&&D.plans&&D.plans.length>0?(b.value=D.plans,u.showNotification({title:"Succès",type:"success",message:t("products_services.modules.plans_loaded_success")})):(u.showNotification({title:"Attention",type:"warning",message:D.error||D.message||t("products_services.modules.plans_load_empty")}),console.warn("Détails de l'erreur de chargement des plans:",D))}catch(D){console.error("Erreur lors du chargement des plans cPanel:",D);let U=t("products_services.modules.errors.plans_load_failed");D.response&&D.response.data?U=D.response.data.message||D.response.data.error||U:D.message&&(U=D.message),u.showNotification({title:"Erreur",type:"error",message:U})}finally{E.value=!1}},R=z(null);Ne(()=>_.moduleName,async M=>{R.value=null,S.value=[],b.value=[],P.value=[],f.value=[],p.value=[],a.value=[],(M==="cpanel"||M==="virtualizor"||M==="proxmox")&&l()}),Ne(()=>R.value,async M=>{_.moduleName==="cpanel"&&M!==null?await g(M):_.moduleName==="virtualizor"&&M!==null?await k(M):_.moduleName==="proxmox"&&M!==null&&await T(M)}),be(async()=>{x.value&&(x.value.module&&(_.moduleName=x.value.module),Object.keys(_).forEach(M=>{x.value[M]!==void 0&&(_[M]=x.value[M])}),x.value.serverId&&(_.moduleName==="cpanel"||_.moduleName==="virtualizor"||_.moduleName==="proxmox")&&(await l(),R.value=x.value.serverId,_.moduleName==="cpanel"&&await g(R.value)))});const k=async M=>{if(M)try{o.value=!0,setTimeout(()=>{P.value=[{id:"openvz",name:"OpenVZ"},{id:"kvm",name:"KVM"},{id:"xen",name:"Xen"},{id:"lxc",name:"LXC"}],f.value=[{id:"centos-7-x64",name:"CentOS 7 (64-bit)"},{id:"ubuntu-20-04-x64",name:"Ubuntu 20.04 (64-bit)"},{id:"debian-10-x64",name:"Debian 10 (64-bit)"},{id:"fedora-34-x64",name:"Fedora 34 (64-bit)"}],u.showNotification({title:"Succès",type:"success",message:"Options Virtualizor chargées avec succès"}),o.value=!1},1e3)}catch(D){console.error("Erreur lors du chargement des options Virtualizor:",D),u.showNotification({title:"Erreur",type:"error",message:"Erreur lors du chargement des options"}),o.value=!1}},T=async M=>{if(M)try{d.value=!0,setTimeout(()=>{p.value=[{id:"local",name:"Local"},{id:"local-lvm",name:"Local-LVM"},{id:"ceph",name:"Ceph"},{id:"nfs",name:"NFS"}],a.value=[{id:"centos-7-x64",name:"CentOS 7 (64-bit)"},{id:"ubuntu-20-04-x64",name:"Ubuntu 20.04 (64-bit)"},{id:"debian-10-x64",name:"Debian 10 (64-bit)"},{id:"alpine-3-14-x64",name:"Alpine 3.14 (64-bit)"}],u.showNotification({title:"Succès",type:"success",message:"Options Proxmox chargées avec succès"}),d.value=!1},1e3)}catch(D){console.error("Erreur lors du chargement des options Proxmox:",D),u.showNotification({title:"Erreur",type:"error",message:"Erreur lors du chargement des options"}),d.value=!1}},V=()=>{localStorage.setItem("moduleData",JSON.stringify(_.value));const M=A.value?y.value:"create";w.push({name:"product-custom-fields",params:{idOrAction:M}})},F=()=>{localStorage.setItem("moduleData",JSON.stringify(_.value));const M=A.value?y.value:"create";w.push({name:"product-pricing",params:{idOrAction:M}})};return(M,D)=>(N(),L("div",Hc,[e("div",Wc,[e("div",Kc,[e("div",Jc,[e("label",null,s(c(t)("products_services.modules.module_name")),1),H(e("select",{"onUpdate:modelValue":D[0]||(D[0]=U=>_.moduleName=U),class:"form-control"},[(N(!0),L(ae,null,le(r.value,U=>(N(),L("option",{key:U.value,value:U.value},s(U.label),9,Qc))),128))],512),[[pe,_.moduleName]]),e("small",Yc,s(c(t)("products_services.modules.module_name_help")),1)]),_.moduleName?(N(),L("div",Xc,[e("label",null,s(c(t)("products_services.modules.server_group")),1),H(e("select",{"onUpdate:modelValue":D[1]||(D[1]=U=>_.serverGroup=U),class:se(["form-control",{"is-invalid":$.value.serverGroup}])},[(N(),L(ae,null,le(h,U=>e("option",{key:U.value,value:U.value},s(U.label),9,Zc)),64))],2),[[pe,_.serverGroup]]),$.value.serverGroup?(N(),L("div",eu,s($.value.serverGroup),1)):J("",!0),e("small",tu,s(c(t)("products_services.modules.server_group_help")),1)])):J("",!0),O.value||S.value.length>0?(N(),L("div",su,[e("label",null,s(c(t)("products_services.modules.server")),1),H(e("select",{"onUpdate:modelValue":D[2]||(D[2]=U=>R.value=U),class:se(["form-control",{"is-invalid":$.value.server}]),disabled:O.value},[e("option",nu,s(O.value?c(t)("common.loading"):c(t)("products_services.modules.select_server")),1),(N(!0),L(ae,null,le(S.value,U=>(N(),L("option",{key:U.id,value:U.id},s(U.name),9,iu))),128))],10,ou),[[pe,R.value]]),$.value.server?(N(),L("div",ru,s($.value.server),1)):J("",!0),e("small",au,s(c(t)("products_services.modules.server_help")),1),O.value?(N(),L("div",lu,[e("div",cu,[e("span",uu,s(c(t)("common.loading")),1)]),e("span",du,s(c(t)("products_services.modules.loading_servers")),1)])):J("",!0)])):J("",!0),E.value||b.value.length>0?(N(),L("div",pu,[e("label",null,s(c(t)("products_services.modules.cpanel_plans")),1),H(e("select",{"onUpdate:modelValue":D[3]||(D[3]=U=>_.moduleSettings.cpanelPlan=U),class:se(["form-control",{"is-invalid":$.value.cpanelPlan}]),disabled:E.value},[e("option",vu,s(E.value?c(t)("common.loading"):c(t)("products_services.modules.select_plan")),1),(N(!0),L(ae,null,le(b.value,U=>(N(),L("option",{key:U.id,value:U.id},s(U.name),9,mu))),128))],10,fu),[[pe,_.moduleSettings.cpanelPlan]]),$.value.cpanelPlan?(N(),L("div",hu,s($.value.cpanelPlan),1)):J("",!0),e("small",gu,s(c(t)("products_services.modules.cpanel_plans_help")),1),E.value?(N(),L("div",_u,[e("div",yu,[e("span",bu,s(c(t)("common.loading")),1)]),e("span",$u,s(c(t)("products_services.modules.loading_plans")),1)])):J("",!0)])):J("",!0),_.moduleName?(N(),L("div",Su,[e("div",wu,[D[27]||(D[27]=e("i",{class:"fas fa-info-circle"},null,-1)),e("p",null,s(c(t)("products_services.modules.choose_module_info")),1)])])):(N(),L("div",ku,[e("div",Cu,[D[28]||(D[28]=e("i",{class:"fas fa-info-circle"},null,-1)),e("p",null,s(c(t)("products_services.modules.no_module_info")),1)])])),_.moduleName==="virtualizor"?(N(),L("div",Au,[e("h3",Eu,s(c(t)("products_services.modules.resources.virtualizor.title")),1),e("p",Ou,s(c(t)("products_services.modules.resources.virtualizor.description")),1),e("div",Tu,[e("div",Ru,[e("div",xu,[e("label",null,s(c(t)("products_services.modules.resources.cpu")),1),H(e("input",{type:"number","onUpdate:modelValue":D[4]||(D[4]=U=>_.moduleSettings.virtualizorResources.cpu=U),class:"form-control",min:"1",max:"32"},null,512),[[ee,_.moduleSettings.virtualizorResources.cpu]]),e("small",Iu,s(c(t)("products_services.modules.resources.cpu_help")),1)])]),e("div",Pu,[e("div",Mu,[e("label",null,s(c(t)("products_services.modules.resources.memory")),1),H(e("input",{type:"number","onUpdate:modelValue":D[5]||(D[5]=U=>_.moduleSettings.virtualizorResources.memory=U),class:"form-control",min:"512",step:"256"},null,512),[[ee,_.moduleSettings.virtualizorResources.memory]]),e("small",Du,s(c(t)("products_services.modules.resources.memory_help")),1)])])]),e("div",Nu,[e("div",Lu,[e("div",Uu,[e("label",null,s(c(t)("products_services.modules.resources.disk_space")),1),H(e("input",{type:"number","onUpdate:modelValue":D[6]||(D[6]=U=>_.moduleSettings.virtualizorResources.disk_space=U),class:"form-control",min:"5"},null,512),[[ee,_.moduleSettings.virtualizorResources.disk_space]]),e("small",Vu,s(c(t)("products_services.modules.resources.disk_space_help")),1)])]),e("div",Fu,[e("div",qu,[e("label",null,s(c(t)("products_services.modules.resources.bandwidth")),1),H(e("input",{type:"number","onUpdate:modelValue":D[7]||(D[7]=U=>_.moduleSettings.virtualizorResources.bandwidth=U),class:"form-control",min:"0"},null,512),[[ee,_.moduleSettings.virtualizorResources.bandwidth]]),e("small",Bu,s(c(t)("products_services.modules.resources.bandwidth_help")),1)])])]),e("div",ju,[e("div",Gu,[e("div",zu,[e("label",null,s(c(t)("products_services.modules.resources.ips")),1),H(e("input",{type:"number","onUpdate:modelValue":D[8]||(D[8]=U=>_.moduleSettings.virtualizorResources.ips=U),class:"form-control",min:"1",max:"10"},null,512),[[ee,_.moduleSettings.virtualizorResources.ips]]),e("small",Hu,s(c(t)("products_services.modules.resources.ips_help")),1)])]),e("div",Wu,[e("div",Ku,[e("label",null,s(c(t)("products_services.modules.resources.virtualizor.virtualization")),1),H(e("select",{"onUpdate:modelValue":D[9]||(D[9]=U=>_.moduleSettings.virtualizorResources.virtualization_type=U),class:se(["form-control",{"is-invalid":$.value.virtualizorResources}])},[e("option",Ju,s(o.value?c(t)("common.loading"):c(t)("common.select")),1),(N(!0),L(ae,null,le(P.value,U=>(N(),L("option",{key:U.id,value:U.id},s(U.name),9,Qu))),128))],2),[[pe,_.moduleSettings.virtualizorResources.virtualization_type]]),$.value.virtualizorResources?(N(),L("div",Yu,s($.value.virtualizorResources),1)):J("",!0),e("small",Xu,s(c(t)("products_services.modules.resources.virtualizor.virtualization_help")),1)])])]),e("div",Zu,[e("div",ed,[e("div",td,[e("label",null,s(c(t)("products_services.modules.resources.virtualizor.os_template")),1),H(e("select",{"onUpdate:modelValue":D[10]||(D[10]=U=>_.moduleSettings.virtualizorResources.os_template=U),class:se(["form-control",{"is-invalid":$.value.virtualizorResources}])},[e("option",sd,s(o.value?c(t)("common.loading"):c(t)("common.select")),1),(N(!0),L(ae,null,le(f.value,U=>(N(),L("option",{key:U.id,value:U.id},s(U.name),9,od))),128))],2),[[pe,_.moduleSettings.virtualizorResources.os_template]]),e("small",nd,s(c(t)("products_services.modules.resources.virtualizor.os_template_help")),1)])])]),o.value?(N(),L("div",id,[D[29]||(D[29]=e("div",{class:"loading-spinner"},[e("span",{class:"spinner-border spinner-border-sm"})],-1)),e("span",rd,s(c(t)("common.loading")),1)])):J("",!0)])):J("",!0),_.moduleName==="proxmox"?(N(),L("div",ad,[e("h3",ld,s(c(t)("products_services.modules.resources.proxmox.title")),1),e("p",cd,s(c(t)("products_services.modules.resources.proxmox.description")),1),e("div",ud,[e("div",dd,[e("div",pd,[e("label",null,s(c(t)("products_services.modules.resources.cpu")),1),H(e("input",{type:"number","onUpdate:modelValue":D[11]||(D[11]=U=>_.moduleSettings.proxmoxResources.cpu=U),class:"form-control",min:"1",max:"32"},null,512),[[ee,_.moduleSettings.proxmoxResources.cpu]]),e("small",fd,s(c(t)("products_services.modules.resources.cpu_help")),1)])]),e("div",vd,[e("div",md,[e("label",null,s(c(t)("products_services.modules.resources.memory")),1),H(e("input",{type:"number","onUpdate:modelValue":D[12]||(D[12]=U=>_.moduleSettings.proxmoxResources.memory=U),class:"form-control",min:"512",step:"256"},null,512),[[ee,_.moduleSettings.proxmoxResources.memory]]),e("small",hd,s(c(t)("products_services.modules.resources.memory_help")),1)])])]),e("div",gd,[e("div",_d,[e("div",yd,[e("label",null,s(c(t)("products_services.modules.resources.disk_space")),1),H(e("input",{type:"number","onUpdate:modelValue":D[13]||(D[13]=U=>_.moduleSettings.proxmoxResources.disk_space=U),class:"form-control",min:"5"},null,512),[[ee,_.moduleSettings.proxmoxResources.disk_space]]),e("small",bd,s(c(t)("products_services.modules.resources.disk_space_help")),1)])]),e("div",$d,[e("div",Sd,[e("label",null,s(c(t)("products_services.modules.resources.bandwidth")),1),H(e("input",{type:"number","onUpdate:modelValue":D[14]||(D[14]=U=>_.moduleSettings.proxmoxResources.bandwidth=U),class:"form-control",min:"0"},null,512),[[ee,_.moduleSettings.proxmoxResources.bandwidth]]),e("small",wd,s(c(t)("products_services.modules.resources.bandwidth_help")),1)])])]),e("div",kd,[e("div",Cd,[e("div",Ad,[e("label",null,s(c(t)("products_services.modules.resources.ips")),1),H(e("input",{type:"number","onUpdate:modelValue":D[15]||(D[15]=U=>_.moduleSettings.proxmoxResources.ips=U),class:"form-control",min:"1",max:"10"},null,512),[[ee,_.moduleSettings.proxmoxResources.ips]]),e("small",Ed,s(c(t)("products_services.modules.resources.ips_help")),1)])]),e("div",Od,[e("div",Td,[e("label",null,s(c(t)("products_services.modules.resources.proxmox.container_type")),1),H(e("select",{"onUpdate:modelValue":D[16]||(D[16]=U=>_.moduleSettings.proxmoxResources.container_type=U),class:"form-control"},D[30]||(D[30]=[e("option",{value:"lxc"},"LXC",-1),e("option",{value:"qemu"},"VM (QEMU/KVM)",-1)]),512),[[pe,_.moduleSettings.proxmoxResources.container_type]]),e("small",Rd,s(c(t)("products_services.modules.resources.proxmox.container_type_help")),1)])])]),e("div",xd,[e("div",Id,[e("div",Pd,[e("label",null,s(c(t)("products_services.modules.resources.proxmox.storage")),1),H(e("select",{"onUpdate:modelValue":D[17]||(D[17]=U=>_.moduleSettings.proxmoxResources.storage=U),class:se(["form-control",{"is-invalid":$.value.proxmoxResources}])},[e("option",Md,s(d.value?c(t)("common.loading"):c(t)("common.select")),1),(N(!0),L(ae,null,le(p.value,U=>(N(),L("option",{key:U.id,value:U.id},s(U.name),9,Dd))),128))],2),[[pe,_.moduleSettings.proxmoxResources.storage]]),$.value.proxmoxResources?(N(),L("div",Nd,s($.value.proxmoxResources),1)):J("",!0),e("small",Ld,s(c(t)("products_services.modules.resources.proxmox.storage_help")),1)])]),e("div",Ud,[e("div",Vd,[e("label",null,s(c(t)("products_services.modules.resources.proxmox.template")),1),H(e("select",{"onUpdate:modelValue":D[18]||(D[18]=U=>_.moduleSettings.proxmoxResources.template=U),class:se(["form-control",{"is-invalid":$.value.proxmoxResources}])},[e("option",Fd,s(d.value?c(t)("common.loading"):c(t)("common.select")),1),(N(!0),L(ae,null,le(a.value,U=>(N(),L("option",{key:U.id,value:U.id},s(U.name),9,qd))),128))],2),[[pe,_.moduleSettings.proxmoxResources.template]]),e("small",Bd,s(c(t)("products_services.modules.resources.proxmox.template_help")),1)])])]),d.value?(N(),L("div",jd,[D[31]||(D[31]=e("div",{class:"loading-spinner"},[e("span",{class:"spinner-border spinner-border-sm"})],-1)),e("span",Gd,s(c(t)("common.loading")),1)])):J("",!0)])):J("",!0),_.moduleName?(N(),L("div",zd,[e("h3",Hd,s(c(t)("products_services.modules.auto_setup_options")),1),e("div",Wd,[H(e("input",{type:"radio",id:"auto-setup-on-order","onUpdate:modelValue":D[19]||(D[19]=U=>_.autoSetupOnOrder=U),value:!0,class:"form-check-input",onChange:D[20]||(D[20]=()=>{_.autoSetupOnPayment=!1,_.autoSetupOnPendingOrder=!1,_.noAutoSetup=!1})},null,544),[[Ve,_.autoSetupOnOrder]]),e("label",Kd,s(c(t)("products_services.modules.auto_setup_on_order")),1),e("small",Jd,s(c(t)("products_services.modules.auto_setup_on_order_help")),1)]),e("div",Qd,[H(e("input",{type:"radio",id:"auto-setup-on-payment","onUpdate:modelValue":D[21]||(D[21]=U=>_.autoSetupOnPayment=U),value:!0,class:"form-check-input",onChange:D[22]||(D[22]=()=>{_.autoSetupOnOrder=!1,_.autoSetupOnPendingOrder=!1,_.noAutoSetup=!1})},null,544),[[Ve,_.autoSetupOnPayment]]),e("label",Yd,s(c(t)("products_services.modules.auto_setup_on_payment")),1),e("small",Xd,s(c(t)("products_services.modules.auto_setup_on_payment_help")),1)]),e("div",Zd,[H(e("input",{type:"radio",id:"auto-setup-on-pending-order","onUpdate:modelValue":D[23]||(D[23]=U=>_.autoSetupOnPendingOrder=U),value:!0,class:"form-check-input",onChange:D[24]||(D[24]=()=>{_.autoSetupOnOrder=!1,_.autoSetupOnPayment=!1,_.noAutoSetup=!1})},null,544),[[Ve,_.autoSetupOnPendingOrder]]),e("label",ep,s(c(t)("products_services.modules.auto_setup_on_pending_order")),1),e("small",tp,s(c(t)("products_services.modules.auto_setup_on_pending_order_help")),1)]),e("div",sp,[H(e("input",{type:"radio",id:"no-auto-setup","onUpdate:modelValue":D[25]||(D[25]=U=>_.noAutoSetup=U),value:!0,class:"form-check-input",onChange:D[26]||(D[26]=()=>{_.autoSetupOnOrder=!1,_.autoSetupOnPayment=!1,_.autoSetupOnPendingOrder=!1})},null,544),[[Ve,_.noAutoSetup]]),e("label",op,s(c(t)("products_services.modules.no_auto_setup")),1),e("small",np,s(c(t)("products_services.modules.no_auto_setup_help")),1)])])):J("",!0)])]),e("div",ip,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:F},s(c(t)("common.back")),1),e("button",{type:"button",class:"btn btn-primary",onClick:V,disabled:C.value},s(c(t)("common.continue")),9,rp)])]))}}),zt=$e(ap,[["__scopeId","data-v-7a97b439"]]),lp={class:"product-custom-fields-view"},cp={class:"wizard-content"},up={class:"custom-fields-list"},dp={class:"section-header"},pp={class:"section-title"},fp={key:0,class:"empty-state"},vp={class:"empty-state-content"},mp={key:1,class:"custom-fields-table"},hp={class:"custom-fields-header"},gp={class:"field-name"},_p={class:"field-type"},yp={class:"field-required"},bp={class:"field-actions"},$p={class:"field-name"},Sp={class:"field-type"},wp={class:"field-required"},kp={key:0,class:"fas fa-check text-success"},Cp={key:1,class:"fas fa-x text-muted"},Ap={class:"field-actions"},Ep=["onClick"],Op=["onClick"],Tp={key:2,class:"custom-field-form"},Rp={class:"form-title"},xp={class:"form-section"},Ip={class:"form-group"},Pp={for:"field-name"},Mp={key:0,class:"invalid-feedback"},Dp={class:"form-group"},Np={for:"field-type"},Lp=["value"],Up={class:"form-group"},Vp={for:"field-description"},Fp={key:0,class:"form-group"},qp={for:"field-options"},Bp={key:0,class:"invalid-feedback"},jp={class:"form-text text-muted"},Gp={class:"form-group"},zp={for:"field-validation"},Hp={class:"form-text text-muted"},Wp={class:"form-options"},Kp={class:"form-check"},Jp={class:"form-check-label",for:"field-required"},Qp={class:"form-check"},Yp={class:"form-check-label",for:"field-admin-only"},Xp={class:"form-check"},Zp={class:"form-check-label",for:"field-show-on-order"},ef={class:"form-check"},tf={class:"form-check-label",for:"field-show-on-invoice"},sf={class:"form-actions"},of={class:"wizard-actions"},nf=["disabled"],rf=_e({__name:"ProductCustomFieldsView",setup(I){const{t}=we(),w=Te(),i=Me(),u=de();X(()=>i.params.type||"shared_hosting");const v=X(()=>{const p=localStorage.getItem("currentProductData");if(p)try{return JSON.parse(p)}catch(a){return console.error("Erreur lors du parsing des données:",a),{}}return{}}),n=X(()=>{const p=i.params.idOrAction;return p&&p!=="create"?parseInt(p,10):null}),x=X(()=>!!n.value),y=[{id:"type",label:t("products_services.tabs.type"),icon:"tag",route:"create-product"},{id:"details",label:t("products_services.tabs.details"),icon:"info-circle",route:"product-details"},{id:"pricing",label:t("products_services.tabs.pricing"),icon:"money-bill",route:"product-pricing"},{id:"module",label:t("products_services.tabs.module"),icon:"puzzle-piece",route:"product-module"},{id:"custom_fields",label:t("products_services.tabs.custom_fields"),icon:"list-alt",route:"product-custom-fields"},{id:"configurable_options",label:t("products_services.tabs.configurable_options"),icon:"cogs",route:"product-configurable-options"},{id:"upgrades",label:t("products_services.tabs.upgrades"),icon:"arrow-up",route:"product-upgrades"},{id:"freedomain",label:t("products_services.tabs.freedomain"),icon:"globe",route:"product-freedomain"},{id:"cross_sells",label:t("products_services.tabs.cross_sells"),icon:"shopping-cart",route:"product-cross-sells"},{id:"other",label:t("products_services.tabs.other"),icon:"ellipsis-h",route:"product-other"},{id:"links",label:t("products_services.tabs.links"),icon:"link",route:"product-links"}];X(()=>{const p=i.name,a=y.find(o=>o.route===p);return a?a.id:"custom_fields"});const A=z(!1),m=z({}),C=z(!1),$=z(null),_=z({fields:[]}),r=[{value:"text",label:t("products_services.custom_fields.types.text")},{value:"password",label:t("products_services.custom_fields.types.password")},{value:"textarea",label:t("products_services.custom_fields.types.textarea")},{value:"dropdown",label:t("products_services.custom_fields.types.dropdown")},{value:"radio",label:t("products_services.custom_fields.types.radio")},{value:"checkbox",label:t("products_services.custom_fields.types.checkbox")},{value:"date",label:t("products_services.custom_fields.types.date")}],h=z({name:"",type:"text",description:"",required:!1,adminOnly:!1,showOnOrder:!0,showOnInvoice:!0,validation:"",options:""}),S=()=>{h.value={name:"",type:"text",description:"",required:!1,adminOnly:!1,showOnOrder:!0,showOnInvoice:!0,validation:"",options:""},C.value=!1,$.value=null},O=()=>{const p={};if(h.value.name?h.value.name.length<3&&(p.name=t("products_services.custom_fields.errors.name_too_short")):p.name=t("products_services.custom_fields.errors.name_required"),["dropdown","radio"].includes(h.value.type)&&!h.value.options&&(p.options=t("products_services.custom_fields.errors.options_required")),Object.keys(p).length>0){m.value=p;return}if($.value!==null){const a=_.value.fields.findIndex(o=>o.id===$.value);a!==-1&&(_.value.fields[a]={..._.value.fields[a],...h.value},u.addNotification({type:"success",title:t("products_services.custom_fields.success.field_updated_title"),message:t("products_services.custom_fields.success.field_updated_message")}))}else{const a=_.value.fields.length>0?Math.max(..._.value.fields.map(o=>o.id))+1:1;_.value.fields.push({id:a,...h.value}),u.addNotification({type:"success",title:t("products_services.custom_fields.success.field_added_title"),message:t("products_services.custom_fields.success.field_added_message")})}S()},b=p=>{const a=_.value.fields.find(o=>o.id===p);a&&(h.value={...a},$.value=p,C.value=!0)},E=p=>{_.value.fields=_.value.fields.filter(a=>a.id!==p),u.addNotification({type:"success",title:t("products_services.custom_fields.success.field_deleted_title"),message:t("products_services.custom_fields.success.field_deleted_message")})};be(()=>{v.value&&v.value.customFields&&(_.value.fields=v.value.customFields)});const P=()=>{localStorage.setItem("customFieldsData",JSON.stringify(_.value));const p=x.value?n.value:"create";w.push({name:"product-configurable-options",params:{idOrAction:p}})},f=()=>{localStorage.setItem("customFieldsData",JSON.stringify(_.value));const p=x.value?n.value:"create";w.push({name:"product-module",params:{idOrAction:p}})};return(p,a)=>(N(),L("div",lp,[e("div",cp,[e("div",up,[e("div",dp,[e("h3",pp,s(c(t)("products_services.custom_fields.list_title")),1),C.value?J("",!0):(N(),L("button",{key:0,type:"button",class:"btn btn-sm btn-primary",onClick:a[0]||(a[0]=o=>{C.value=!0,$.value=null,S()})},[a[11]||(a[11]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(c(t)("products_services.custom_fields.add_field")),1)]))]),_.value.fields.length===0&&!C.value?(N(),L("div",fp,[e("div",vp,[a[12]||(a[12]=e("i",{class:"fas fa-info-circle"},null,-1)),e("p",null,s(c(t)("products_services.custom_fields.no_fields")),1),e("button",{type:"button",class:"btn btn-primary",onClick:a[1]||(a[1]=o=>{C.value=!0,$.value=null,S()})},s(c(t)("products_services.custom_fields.add_first_field")),1)])])):J("",!0),_.value.fields.length>0&&!C.value?(N(),L("div",mp,[e("div",hp,[e("span",gp,s(c(t)("products_services.custom_fields.field_name")),1),e("span",_p,s(c(t)("products_services.custom_fields.field_type")),1),e("span",yp,s(c(t)("products_services.custom_fields.required")),1),e("span",bp,s(c(t)("common.actions")),1)]),(N(!0),L(ae,null,le(_.value.fields,o=>{var d;return N(),L("div",{key:o.id,class:"custom-field-row"},[e("span",$p,s(o.name),1),e("span",Sp,s(((d=r.find(l=>l.value===o.type))==null?void 0:d.label)||o.type),1),e("span",wp,[o.required?(N(),L("i",kp)):(N(),L("i",Cp))]),e("span",Ap,[e("button",{type:"button",class:"btn btn-sm btn-icon",onClick:l=>b(o.id),title:"Modifier"},a[13]||(a[13]=[e("i",{class:"fas fa-edit"},null,-1)]),8,Ep),e("button",{type:"button",class:"btn btn-sm btn-icon text-danger",onClick:l=>E(o.id),title:"Supprimer"},a[14]||(a[14]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Op)])])}),128))])):J("",!0),C.value?(N(),L("div",Tp,[e("h3",Rp,s($.value!==null?c(t)("products_services.custom_fields.edit_field"):c(t)("products_services.custom_fields.add_field")),1),e("div",xp,[e("div",Ip,[e("label",Pp,s(c(t)("products_services.custom_fields.field_name"))+" *",1),H(e("input",{type:"text",id:"field-name","onUpdate:modelValue":a[2]||(a[2]=o=>h.value.name=o),class:se(["form-control",{"is-invalid":m.value.name}])},null,2),[[ee,h.value.name]]),m.value.name?(N(),L("div",Mp,s(m.value.name),1)):J("",!0)]),e("div",Dp,[e("label",Np,s(c(t)("products_services.custom_fields.field_type")),1),H(e("select",{id:"field-type","onUpdate:modelValue":a[3]||(a[3]=o=>h.value.type=o),class:"form-control"},[(N(),L(ae,null,le(r,o=>e("option",{key:o.value,value:o.value},s(o.label),9,Lp)),64))],512),[[pe,h.value.type]])]),e("div",Up,[e("label",Vp,s(c(t)("products_services.custom_fields.description")),1),H(e("textarea",{id:"field-description","onUpdate:modelValue":a[4]||(a[4]=o=>h.value.description=o),class:"form-control",rows:"3"},null,512),[[ee,h.value.description]])]),["dropdown","radio"].includes(h.value.type)?(N(),L("div",Fp,[e("label",qp,s(c(t)("products_services.custom_fields.options"))+" *",1),H(e("textarea",{id:"field-options","onUpdate:modelValue":a[5]||(a[5]=o=>h.value.options=o),class:se(["form-control",{"is-invalid":m.value.options}]),rows:"3",placeholder:`Option 1
Option 2
Option 3`},null,2),[[ee,h.value.options]]),m.value.options?(N(),L("div",Bp,s(m.value.options),1)):J("",!0),e("small",jp,s(c(t)("products_services.custom_fields.options_help")),1)])):J("",!0),e("div",Gp,[e("label",zp,s(c(t)("products_services.custom_fields.validation")),1),H(e("input",{type:"text",id:"field-validation","onUpdate:modelValue":a[6]||(a[6]=o=>h.value.validation=o),class:"form-control",placeholder:"Ex: numeric|min:1|max:100"},null,512),[[ee,h.value.validation]]),e("small",Hp,s(c(t)("products_services.custom_fields.validation_help")),1)]),e("div",Wp,[e("div",Kp,[H(e("input",{type:"checkbox",id:"field-required","onUpdate:modelValue":a[7]||(a[7]=o=>h.value.required=o),class:"form-check-input"},null,512),[[ye,h.value.required]]),e("label",Jp,s(c(t)("products_services.custom_fields.required_field")),1)]),e("div",Qp,[H(e("input",{type:"checkbox",id:"field-admin-only","onUpdate:modelValue":a[8]||(a[8]=o=>h.value.adminOnly=o),class:"form-check-input"},null,512),[[ye,h.value.adminOnly]]),e("label",Yp,s(c(t)("products_services.custom_fields.admin_only")),1)]),e("div",Xp,[H(e("input",{type:"checkbox",id:"field-show-on-order","onUpdate:modelValue":a[9]||(a[9]=o=>h.value.showOnOrder=o),class:"form-check-input"},null,512),[[ye,h.value.showOnOrder]]),e("label",Zp,s(c(t)("products_services.custom_fields.show_on_order")),1)]),e("div",ef,[H(e("input",{type:"checkbox",id:"field-show-on-invoice","onUpdate:modelValue":a[10]||(a[10]=o=>h.value.showOnInvoice=o),class:"form-check-input"},null,512),[[ye,h.value.showOnInvoice]]),e("label",tf,s(c(t)("products_services.custom_fields.show_on_invoice")),1)])]),e("div",sf,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:S},s(c(t)("common.cancel")),1),e("button",{type:"button",class:"btn btn-primary",onClick:O},s($.value!==null?c(t)("common.update"):c(t)("common.save")),1)])])])):J("",!0)])]),e("div",of,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:f},s(c(t)("common.back")),1),e("button",{type:"button",class:"btn btn-primary",onClick:P,disabled:A.value},s(c(t)("common.continue")),9,nf)])]))}}),Ht=$e(rf,[["__scopeId","data-v-9ed28dec"]]),af={class:"product-configurable-options-view"},lf={class:"wizard-content"},cf={class:"section-header"},uf={class:"section-title"},df={class:"section-description"},pf={key:0,class:"custom-field-form"},ff={class:"form-title"},vf={class:"form-section"},mf={class:"form-row"},hf={class:"form-group col-md-6"},gf={for:"option-name"},_f={key:0,class:"invalid-feedback"},yf={class:"form-group col-md-6"},bf={for:"option-type"},$f=["value"],Sf={class:"form-row"},wf={class:"form-group col-md-6"},kf={for:"option-group"},Cf={value:null},Af=["value"],Ef={class:"form-group col-md-6"},Of={for:"option-description"},Tf={class:"form-text"},Rf={class:"form-check"},xf={class:"form-check-label",for:"option-required"},If={key:0,class:"form-section option-items"},Pf={key:0,class:"invalid-feedback d-block mb-3"},Mf={key:1,class:"option-items-table"},Df={class:"option-items-header"},Nf=["onClick"],Lf={class:"field-actions"},Uf=["onClick"],Vf={class:"option-item-form"},Ff={class:"form-row"},qf={class:"form-group col-md-4"},Bf={for:"item-name"},jf={key:0,class:"invalid-feedback"},Gf={class:"form-group col-md-3"},zf={for:"item-price"},Hf={class:"form-group col-md-3"},Wf={for:"item-setup-fee"},Kf={class:"form-group col-md-2 d-flex align-items-end"},Jf={class:"form-check"},Qf={class:"form-check-label",for:"item-default"},Yf={key:1,class:"form-section"},Xf={class:"form-row"},Zf={class:"form-group col-md-3"},ev={for:"min-quantity"},tv={class:"form-group col-md-3"},sv={for:"max-quantity"},ov={class:"form-group col-md-3"},nv={for:"quantity-price"},iv={class:"form-group col-md-3"},rv={for:"quantity-setup-fee"},av={class:"form-actions"},lv={key:1},cv={key:0,class:"empty-state"},uv={class:"empty-state-content"},dv={key:1,class:"configurable-options-table"},pv={class:"configurable-options-header"},fv={class:"option-name"},vv={key:0,class:"option-description text-muted"},mv={class:"field-actions"},hv=["onClick"],gv=["onClick"],_v={class:"wizard-actions"},yv=_e({__name:"ProductConfigurableOptionsView",setup(I){const{t}=we(),w=Te(),i=Me(),u=de();Fe(),X(()=>i.params.type||"shared_hosting");const v=X(()=>{const g=i.params.idOrAction;return g&&g!=="create"?parseInt(g,10):null}),n=X(()=>!!v.value),x=X(()=>{const g=localStorage.getItem("currentProductData");if(g)try{return JSON.parse(g)}catch(R){console.error("Erreur lors de la récupération des données précédentes:",R)}return{}}),y=[{id:"type",label:t("products_services.tabs.type"),icon:"tag",route:"create-product"},{id:"details",label:t("products_services.tabs.details"),icon:"info-circle",route:"product-details"},{id:"pricing",label:t("products_services.tabs.pricing"),icon:"money-bill",route:"product-pricing"},{id:"module",label:t("products_services.tabs.module"),icon:"puzzle-piece",route:"product-module"},{id:"custom_fields",label:t("products_services.tabs.custom_fields"),icon:"list-alt",route:"product-custom-fields"},{id:"configurable_options",label:t("products_services.tabs.configurable_options"),icon:"cogs",route:"product-configurable-options"},{id:"upgrades",label:t("products_services.tabs.upgrades"),icon:"arrow-up",route:"product-upgrades"},{id:"freedomain",label:t("products_services.tabs.freedomain"),icon:"globe",route:"product-freedomain"},{id:"cross_sells",label:t("products_services.tabs.cross_sells"),icon:"shopping-cart",route:"product-cross-sells"},{id:"other",label:t("products_services.tabs.other"),icon:"ellipsis-h",route:"product-other"},{id:"links",label:t("products_services.tabs.links"),icon:"link",route:"product-links"}];X(()=>{const g=i.name,R=y.find(k=>k.route===g);return R?R.id:"configurable_options"}),z(!1);const A=z({}),m=z(!1),C=z(null),$=z([]);z(!1),z(!1);const _=z({options:[]}),r=[{value:"dropdown",label:t("products_services.configurable_options.types.dropdown")},{value:"radio",label:t("products_services.configurable_options.types.radio")},{value:"checkbox",label:t("products_services.configurable_options.types.checkbox")},{value:"quantity",label:t("products_services.configurable_options.types.quantity")},{value:"text",label:t("products_services.configurable_options.types.text")}],h=z({name:"",type:"dropdown",description:"",required:!0,optionGroup:null,items:[]}),S=z({name:"",price:0,setupFee:0,isDefault:!1}),O=async()=>{try{$.value=[{id:1,name:"Ressources serveur"},{id:2,name:"Licences"},{id:3,name:"Services additionnels"}]}catch(g){console.error("Erreur lors de la récupération des groupes d'options:",g)}},b=()=>{h.value={name:"",type:"dropdown",description:"",required:!0,optionGroup:null,items:[]},S.value={name:"",price:0,setupFee:0,isDefault:!1},m.value=!1,C.value=null},E=()=>{if(!S.value.name){A.value={item:t("products_services.configurable_options.errors.item_name_required")};return}const g=h.value.items.length>0?Math.max(...h.value.items.map(R=>R.id))+1:1;h.value.items.push({id:g,name:S.value.name,price:S.value.price,setupFee:S.value.setupFee,isDefault:S.value.isDefault}),S.value={name:"",price:0,setupFee:0,isDefault:!1},A.value={}},P=g=>{h.value.items=h.value.items.filter(R=>R.id!==g)},f=g=>{h.value.items=h.value.items.map(R=>({...R,isDefault:R.id===g}))},p=()=>{const g={};if(h.value.name?h.value.name.length<3&&(g.name=t("products_services.configurable_options.errors.name_too_short")):g.name=t("products_services.configurable_options.errors.name_required"),["dropdown","radio","checkbox"].includes(h.value.type)&&h.value.items.length===0&&(g.items=t("products_services.configurable_options.errors.items_required")),Object.keys(g).length>0){A.value=g;return}if(C.value!==null){const R=_.value.options.findIndex(k=>k.id===C.value);R!==-1&&(_.value.options[R]={..._.value.options[R],...h.value},u.addNotification({type:"success",title:t("products_services.configurable_options.success.option_updated_title"),message:t("products_services.configurable_options.success.option_updated_message")}))}else{const R=_.value.options.length>0?Math.max(..._.value.options.map(k=>k.id))+1:1;_.value.options.push({id:R,...h.value}),u.addNotification({type:"success",title:t("products_services.configurable_options.success.option_added_title"),message:t("products_services.configurable_options.success.option_added_message")})}b()},a=g=>{const R=_.value.options.find(k=>k.id===g);R&&(h.value=JSON.parse(JSON.stringify(R)),C.value=g,m.value=!0)},o=g=>{_.value.options=_.value.options.filter(R=>R.id!==g),u.addNotification({type:"success",title:t("products_services.configurable_options.success.option_deleted_title"),message:t("products_services.configurable_options.success.option_deleted_message")})},d=()=>{localStorage.setItem("configurableOptionsData",JSON.stringify(_.value));const g=n.value?v.value:"create";w.push({name:"product-upgrades",params:{idOrAction:g}})};be(()=>{O(),x.value&&x.value.configurableOptions&&(_.value.options=x.value.configurableOptions)});const l=()=>{localStorage.setItem("configurableOptionsData",JSON.stringify(_.value));const g=n.value?v.value:"create";w.push({name:"product-custom-fields",params:{idOrAction:g}})};return(g,R)=>(N(),L("div",af,[e("div",lf,[e("div",cf,[e("h3",uf,s(c(t)("products_services.configurable_options.title")),1),m.value?J("",!0):(N(),L("button",{key:0,type:"button",class:"btn btn-primary",onClick:R[0]||(R[0]=k=>m.value=!0)},[R[11]||(R[11]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(c(t)("products_services.configurable_options.add_option")),1)]))]),e("p",df,s(c(t)("products_services.configurable_options.description")),1),m.value?(N(),L("div",pf,[e("h4",ff,s(C.value!==null?c(t)("products_services.configurable_options.edit_option"):c(t)("products_services.configurable_options.new_option")),1),e("div",vf,[e("div",mf,[e("div",hf,[e("label",gf,s(c(t)("products_services.configurable_options.fields.name")),1),H(e("input",{id:"option-name","onUpdate:modelValue":R[1]||(R[1]=k=>h.value.name=k),type:"text",class:se(["form-control",{"is-invalid":A.value.name}])},null,2),[[ee,h.value.name]]),A.value.name?(N(),L("div",_f,s(A.value.name),1)):J("",!0)]),e("div",yf,[e("label",bf,s(c(t)("products_services.configurable_options.fields.type")),1),H(e("select",{id:"option-type","onUpdate:modelValue":R[2]||(R[2]=k=>h.value.type=k),class:"form-control"},[(N(),L(ae,null,le(r,k=>e("option",{key:k.value,value:k.value},s(k.label),9,$f)),64))],512),[[pe,h.value.type]])])]),e("div",Sf,[e("div",wf,[e("label",kf,s(c(t)("products_services.configurable_options.fields.option_group")),1),H(e("select",{id:"option-group","onUpdate:modelValue":R[3]||(R[3]=k=>h.value.optionGroup=k),class:"form-control"},[e("option",Cf,s(c(t)("products_services.configurable_options.no_group")),1),(N(!0),L(ae,null,le($.value,k=>(N(),L("option",{key:k.id,value:k.id},s(k.name),9,Af))),128))],512),[[pe,h.value.optionGroup]])]),e("div",Ef,[e("label",Of,s(c(t)("products_services.configurable_options.fields.description")),1),H(e("input",{id:"option-description","onUpdate:modelValue":R[4]||(R[4]=k=>h.value.description=k),type:"text",class:"form-control"},null,512),[[ee,h.value.description]]),e("div",Tf,s(c(t)("products_services.configurable_options.fields.description_help")),1)])]),e("div",Rf,[H(e("input",{id:"option-required","onUpdate:modelValue":R[5]||(R[5]=k=>h.value.required=k),type:"checkbox",class:"form-check-input"},null,512),[[ye,h.value.required]]),e("label",xf,s(c(t)("products_services.configurable_options.fields.required")),1)])]),["dropdown","radio","checkbox"].includes(h.value.type)?(N(),L("div",If,[e("h5",null,s(c(t)("products_services.configurable_options.option_items")),1),A.value.items?(N(),L("div",Pf,s(A.value.items),1)):J("",!0),h.value.items.length>0?(N(),L("div",Mf,[e("div",Df,[e("div",null,s(c(t)("products_services.configurable_options.fields.item_name")),1),e("div",null,s(c(t)("products_services.configurable_options.fields.price")),1),e("div",null,s(c(t)("products_services.configurable_options.fields.setup_fee")),1),e("div",null,s(c(t)("products_services.configurable_options.fields.default")),1),e("div",null,s(c(t)("common.actions")),1)]),(N(!0),L(ae,null,le(h.value.items,k=>(N(),L("div",{key:k.id,class:"option-item-row"},[e("div",null,s(k.name),1),e("div",null,s(k.price),1),e("div",null,s(k.setupFee),1),e("div",null,[e("button",{class:se(["btn btn-icon",{"text-success":k.isDefault}]),onClick:T=>f(k.id),type:"button"},[e("i",{class:se(["fas",k.isDefault?"fa-check-circle":"fa-circle"])},null,2)],10,Nf)]),e("div",Lf,[e("button",{class:"btn btn-icon text-danger",onClick:T=>P(k.id),type:"button"},R[12]||(R[12]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Uf)])]))),128))])):J("",!0),e("div",Vf,[e("div",Ff,[e("div",qf,[e("label",Bf,s(c(t)("products_services.configurable_options.fields.item_name")),1),H(e("input",{id:"item-name","onUpdate:modelValue":R[6]||(R[6]=k=>S.value.name=k),type:"text",class:se(["form-control",{"is-invalid":A.value.item}])},null,2),[[ee,S.value.name]]),A.value.item?(N(),L("div",jf,s(A.value.item),1)):J("",!0)]),e("div",Gf,[e("label",zf,s(c(t)("products_services.configurable_options.fields.price")),1),H(e("input",{id:"item-price","onUpdate:modelValue":R[7]||(R[7]=k=>S.value.price=k),type:"number",step:"0.01",min:"0",class:"form-control"},null,512),[[ee,S.value.price,void 0,{number:!0}]])]),e("div",Hf,[e("label",Wf,s(c(t)("products_services.configurable_options.fields.setup_fee")),1),H(e("input",{id:"item-setup-fee","onUpdate:modelValue":R[8]||(R[8]=k=>S.value.setupFee=k),type:"number",step:"0.01",min:"0",class:"form-control"},null,512),[[ee,S.value.setupFee,void 0,{number:!0}]])]),e("div",Kf,[e("button",{class:"btn btn-primary btn-sm w-100",onClick:E,type:"button"},[R[13]||(R[13]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(c(t)("common.add")),1)])])]),e("div",Jf,[H(e("input",{id:"item-default","onUpdate:modelValue":R[9]||(R[9]=k=>S.value.isDefault=k),type:"checkbox",class:"form-check-input"},null,512),[[ye,S.value.isDefault]]),e("label",Qf,s(c(t)("products_services.configurable_options.fields.set_as_default")),1)])])])):J("",!0),h.value.type==="quantity"?(N(),L("div",Yf,[e("h5",null,s(c(t)("products_services.configurable_options.quantity_options")),1),e("div",Xf,[e("div",Zf,[e("label",ev,s(c(t)("products_services.configurable_options.fields.min_quantity")),1),R[14]||(R[14]=e("input",{id:"min-quantity",type:"number",min:"0",class:"form-control"},null,-1))]),e("div",tv,[e("label",sv,s(c(t)("products_services.configurable_options.fields.max_quantity")),1),R[15]||(R[15]=e("input",{id:"max-quantity",type:"number",min:"0",class:"form-control"},null,-1))]),e("div",ov,[e("label",nv,s(c(t)("products_services.configurable_options.fields.price_per_unit")),1),R[16]||(R[16]=e("input",{id:"quantity-price",type:"number",step:"0.01",min:"0",class:"form-control"},null,-1))]),e("div",iv,[e("label",rv,s(c(t)("products_services.configurable_options.fields.setup_fee")),1),R[17]||(R[17]=e("input",{id:"quantity-setup-fee",type:"number",step:"0.01",min:"0",class:"form-control"},null,-1))])])])):J("",!0),e("div",av,[e("button",{class:"btn btn-outline-secondary",onClick:b,type:"button"},s(c(t)("common.cancel")),1),e("button",{class:"btn btn-primary",onClick:p,type:"button"},s(C.value!==null?c(t)("common.update"):c(t)("common.add")),1)])])):(N(),L("div",lv,[_.value.options.length===0?(N(),L("div",cv,[e("div",uv,[R[18]||(R[18]=e("i",{class:"fas fa-sliders-h"},null,-1)),e("p",null,s(c(t)("products_services.configurable_options.empty_state")),1),e("button",{class:"btn btn-primary btn-sm",onClick:R[10]||(R[10]=k=>m.value=!0)},s(c(t)("products_services.configurable_options.add_first_option")),1)])])):(N(),L("div",dv,[e("div",pv,[e("div",null,s(c(t)("products_services.configurable_options.fields.name")),1),e("div",null,s(c(t)("products_services.configurable_options.fields.type")),1),e("div",null,s(c(t)("products_services.configurable_options.fields.items")),1),e("div",null,s(c(t)("products_services.configurable_options.fields.required")),1),e("div",null,s(c(t)("common.actions")),1)]),(N(!0),L(ae,null,le(_.value.options,k=>{var T;return N(),L("div",{key:k.id,class:"configurable-option-row"},[e("div",null,[e("div",fv,s(k.name),1),k.description?(N(),L("div",vv,s(k.description),1)):J("",!0)]),e("div",null,s(((T=r.find(V=>V.value===k.type))==null?void 0:T.label)||k.type),1),e("div",null,s(k.items.length),1),e("div",null,[e("i",{class:se(["fas",k.required?"fa-check text-success":"fa-times text-muted"])},null,2)]),e("div",mv,[e("button",{class:"btn btn-icon",onClick:V=>a(k.id),type:"button"},R[19]||(R[19]=[e("i",{class:"fas fa-edit"},null,-1)]),8,hv),e("button",{class:"btn btn-icon text-danger",onClick:V=>o(k.id),type:"button"},R[20]||(R[20]=[e("i",{class:"fas fa-trash"},null,-1)]),8,gv)])])}),128))]))]))]),e("div",_v,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:l},s(c(t)("common.back")),1),e("button",{type:"button",class:"btn btn-primary",onClick:d},s(c(t)("common.continue")),1)])]))}}),Wt=$e(yv,[["__scopeId","data-v-8783b8a0"]]),bv={class:"product-upgrades-view"},$v={class:"wizard-content"},Sv={class:"upgrades-configuration"},wv={class:"section-header"},kv={class:"section-title"},Cv={class:"form-options-container"},Av={class:"form-group"},Ev={class:"form-check"},Ov=["checked"],Tv={for:"downgrade-enabled",class:"form-check-label"},Rv={class:"form-text text-muted"},xv={class:"form-group"},Iv={class:"form-check"},Pv=["checked"],Mv={for:"upgrade-package-quantity",class:"form-check-label"},Dv={class:"form-text text-muted"},Nv={class:"upgrades-selection"},Lv={class:"section-header"},Uv={class:"section-title"},Vv={class:"upgrades-list"},Fv={key:0,class:"loading-indicator"},qv={key:1,class:"empty-state"},Bv={key:2},jv={class:"compatible-products"},Gv={class:"data-table"},zv={class:"text-center"},Hv={class:"text-center"},Wv=["onClick"],Kv=["onClick"],Jv={key:0,class:"selected-upgrades"},Qv={class:"upgrades-badges"},Yv=["onClick"],Xv={class:"wizard-actions"},Zv=["disabled"],em=_e({__name:"ProductUpgradesView",setup(I){const{t}=we(),w=Te(),i=Me(),u=de();Fe();const v=X(()=>i.params.type||"shared_hosting"),n=X(()=>{const a=localStorage.getItem("currentProductData");if(a)try{return JSON.parse(a)}catch(o){return console.error("Erreur lors du parsing des données:",o),{}}return{}}),x=X(()=>{const a=i.params.idOrAction;return a&&a!=="create"?parseInt(a,10):null}),y=X(()=>!!x.value),A=[{id:"type",label:t("products_services.tabs.type"),icon:"tag",route:"create-product"},{id:"details",label:t("products_services.tabs.details"),icon:"info-circle",route:"product-details"},{id:"pricing",label:t("products_services.tabs.pricing"),icon:"money-bill",route:"product-pricing"},{id:"module",label:t("products_services.tabs.module"),icon:"puzzle-piece",route:"product-module"},{id:"custom_fields",label:t("products_services.tabs.custom_fields"),icon:"list-alt",route:"product-custom-fields"},{id:"configurable_options",label:t("products_services.tabs.configurable_options"),icon:"cogs",route:"product-configurable-options"},{id:"upgrades",label:t("products_services.tabs.upgrades"),icon:"arrow-up",route:"product-upgrades"},{id:"freedomain",label:t("products_services.tabs.freedomain"),icon:"globe",route:"product-freedomain"},{id:"cross_sells",label:t("products_services.tabs.cross_sells"),icon:"shopping-cart",route:"product-cross-sells"},{id:"other",label:t("products_services.tabs.other"),icon:"ellipsis-h",route:"product-other"},{id:"links",label:t("products_services.tabs.links"),icon:"link",route:"product-links"}];X(()=>{const a=i.name,o=A.find(d=>d.route===a);return o?o.id:"upgrades"});const m=z(!1),C=z([]),$=z({upgrades:[],downgradeEnabled:!1,upgradePackageQuantity:!1}),_=async()=>{m.value=!0;try{setTimeout(()=>{C.value=[{id:1,name:"Hébergement Basic",type:"shared_hosting"},{id:2,name:"Hébergement Pro",type:"shared_hosting"},{id:3,name:"Hébergement Business",type:"shared_hosting"},{id:4,name:"VPS Standard",type:"vps"},{id:5,name:"VPS Premium",type:"vps"},{id:6,name:"Serveur Dédié",type:"dedicated_server"}],m.value=!1},500)}catch(a){console.error("Erreur lors de la récupération des produits:",a),m.value=!1,u.addNotification({type:"error",title:t("products_services.upgrades.errors.fetch_failed_title"),message:t("products_services.upgrades.errors.fetch_failed_message")})}},r=X(()=>C.value.filter(a=>a.type===v.value)),h=a=>{$.value.upgrades.includes(a)||($.value.upgrades.push(a),u.addNotification({type:"success",title:t("products_services.upgrades.success.upgrade_added_title"),message:t("products_services.upgrades.success.upgrade_added_message")}))},S=a=>{$.value.upgrades=$.value.upgrades.filter(o=>o!==a),u.addNotification({type:"success",title:t("products_services.upgrades.success.upgrade_removed_title"),message:t("products_services.upgrades.success.upgrade_removed_message")})},O=a=>$.value.upgrades.includes(a),b=a=>C.value.find(o=>o.id===a),E=()=>{$.value.downgradeEnabled=!$.value.downgradeEnabled},P=()=>{$.value.upgradePackageQuantity=!$.value.upgradePackageQuantity},f=()=>{localStorage.setItem("upgradesData",JSON.stringify($.value));const a=y.value?x.value:"create";w.push({name:"product-freedomain",params:{idOrAction:a}})},p=()=>{localStorage.setItem("upgradesData",JSON.stringify($.value));const a=y.value?x.value:"create";w.push({name:"product-configurable-options",params:{idOrAction:a}})};return be(()=>{_(),n.value&&n.value.upgrades&&($.value=n.value.upgrades)}),(a,o)=>(N(),L("div",bv,[e("div",$v,[e("div",Sv,[e("div",wv,[e("h3",kv,s(c(t)("products_services.upgrades.configuration_title")),1)]),e("div",Cv,[e("div",Av,[e("div",Ev,[e("input",{type:"checkbox",id:"downgrade-enabled",class:"form-check-input",checked:$.value.downgradeEnabled,onChange:E},null,40,Ov),e("label",Tv,s(c(t)("products_services.upgrades.allow_downgrade")),1),e("small",Rv,s(c(t)("products_services.upgrades.allow_downgrade_help")),1)])]),e("div",xv,[e("div",Iv,[e("input",{type:"checkbox",id:"upgrade-package-quantity",class:"form-check-input",checked:$.value.upgradePackageQuantity,onChange:P},null,40,Pv),e("label",Mv,s(c(t)("products_services.upgrades.upgrade_package_quantity")),1),e("small",Dv,s(c(t)("products_services.upgrades.upgrade_package_quantity_help")),1)])])])]),e("div",Nv,[e("div",Lv,[e("h3",Uv,s(c(t)("products_services.upgrades.products_title")),1)]),e("div",Vv,[m.value?(N(),L("div",Fv,[o[0]||(o[0]=e("div",{class:"spinner"},null,-1)),e("p",null,s(c(t)("common.loading")),1)])):r.value.length===0?(N(),L("div",qv,[e("p",null,s(c(t)("products_services.upgrades.no_compatible_products")),1)])):(N(),L("div",Bv,[e("div",jv,[e("table",Gv,[e("thead",null,[e("tr",null,[e("th",null,s(c(t)("products_services.upgrades.product_name")),1),e("th",zv,s(c(t)("products_services.upgrades.action")),1)])]),e("tbody",null,[(N(!0),L(ae,null,le(r.value,d=>(N(),L("tr",{key:d.id},[e("td",null,s(d.name),1),e("td",Hv,[O(d.id)?(N(),L("button",{key:1,type:"button",class:"btn btn-sm btn-outline-danger",onClick:l=>S(d.id)},s(c(t)("products_services.upgrades.remove")),9,Kv)):(N(),L("button",{key:0,type:"button",class:"btn btn-sm btn-outline-primary",onClick:l=>h(d.id)},s(c(t)("products_services.upgrades.add")),9,Wv))])]))),128))])])])]))]),$.value.upgrades.length>0?(N(),L("div",Jv,[e("h4",null,s(c(t)("products_services.upgrades.selected_upgrades")),1),e("div",Qv,[(N(!0),L(ae,null,le($.value.upgrades,d=>{var l;return N(),L("div",{key:d,class:"upgrade-badge"},[ne(s(((l=b(d))==null?void 0:l.name)||`ID: ${d}`)+" ",1),e("button",{type:"button",class:"badge-remove",onClick:g=>S(d)}," × ",8,Yv)])}),128))])])):J("",!0)])]),e("div",Xv,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:p},s(c(t)("common.back")),1),e("button",{type:"button",class:"btn btn-primary",onClick:f,disabled:m.value},s(c(t)("common.continue")),9,Zv)])]))}}),Kt=$e(em,[["__scopeId","data-v-10d52a29"]]),tm={class:"product-freedomain-view"},sm={class:"wizard-content"},om={class:"freedomain-configuration"},nm={class:"section-header"},im={class:"section-title"},rm={class:"form-options-container"},am={class:"form-group"},lm={class:"form-check"},cm=["checked"],um={for:"freedomain-enabled",class:"form-check-label"},dm={class:"form-text text-muted"},pm={key:0,class:"freedomain-settings"},fm={class:"form-group"},vm={for:"required-period"},mm=["value"],hm={value:"1"},gm={value:"3"},_m={value:"6"},ym={value:"12"},bm={value:"24"},$m={value:"36"},Sm={class:"form-text text-muted"},wm={class:"form-group"},km={class:"form-check"},Cm=["checked"],Am={for:"initial-order-only",class:"form-check-label"},Em={class:"form-text text-muted"},Om={class:"form-group"},Tm={key:0,class:"invalid-feedback d-block mb-3"},Rm={class:"tlds-container"},xm=["onClick"],Im={class:"form-text text-muted"},Pm={key:0,class:"selected-tlds"},Mm={class:"tlds-badges"},Dm=["onClick"],Nm={class:"wizard-actions"},Lm=["disabled"],Um={class:"action-buttons"},Vm=["disabled"],Fm={key:0},qm={key:1},Bm={key:2},jm=["disabled"],Gm=_e({__name:"ProductFreedomainView",setup(I){const{t}=we(),w=Te(),i=Me(),u=de(),v=Fe();X(()=>i.params.type||"shared_hosting");const n=X(()=>{const o=localStorage.getItem("currentProductData");if(o)try{return JSON.parse(o)}catch(d){return console.error("Erreur lors du parsing des données:",d),{}}return{}}),x=X(()=>{const o=i.params.idOrAction;return o&&o!=="create"?parseInt(o,10):null}),y=X(()=>!!x.value),A=[{id:"type",label:t("products_services.tabs.type"),icon:"tag",route:"create-product"},{id:"details",label:t("products_services.tabs.details"),icon:"info-circle",route:"product-details"},{id:"pricing",label:t("products_services.tabs.pricing"),icon:"money-bill",route:"product-pricing"},{id:"module",label:t("products_services.tabs.module"),icon:"puzzle-piece",route:"product-module"},{id:"custom_fields",label:t("products_services.tabs.custom_fields"),icon:"list-alt",route:"product-custom-fields"},{id:"configurable_options",label:t("products_services.tabs.configurable_options"),icon:"cogs",route:"product-configurable-options"},{id:"upgrades",label:t("products_services.tabs.upgrades"),icon:"arrow-up",route:"product-upgrades"},{id:"freedomain",label:t("products_services.tabs.freedomain"),icon:"globe",route:"product-freedomain"},{id:"cross_sells",label:t("products_services.tabs.cross_sells"),icon:"shopping-cart",route:"product-cross-sells"},{id:"other",label:t("products_services.tabs.other"),icon:"ellipsis-h",route:"product-other"},{id:"links",label:t("products_services.tabs.links"),icon:"link",route:"product-links"}];X(()=>{const o=i.name,d=A.find(l=>l.route===o);return d?d.id:"freedomain"}),z(!1);const m=z(!1),C=z(!1),$=z({}),_=z({enabled:!1,tlds:[],requiredPeriod:12,onlyInitialOrder:!0}),r=z([".com",".net",".org",".info",".biz",".fr",".eu",".de",".co.uk",".us"]),h=o=>{_.value.tlds.includes(o)||(_.value.tlds.push(o),u.addNotification({type:"success",title:t("products_services.freedomain.success.tld_added_title"),message:t("products_services.freedomain.success.tld_added_message")}))},S=o=>{_.value.tlds=_.value.tlds.filter(d=>d!==o),u.addNotification({type:"success",title:t("products_services.freedomain.success.tld_removed_title"),message:t("products_services.freedomain.success.tld_removed_message")})},O=o=>_.value.tlds.includes(o),b=()=>{_.value.enabled=!_.value.enabled},E=()=>{_.value.onlyInitialOrder=!_.value.onlyInitialOrder},P=o=>{_.value.requiredPeriod=parseInt(o)},f=async()=>{m.value=!0,$.value={};try{if(_.value.enabled&&_.value.tlds.length===0){$.value.tlds=t("products_services.freedomain.errors.no_tlds_selected"),m.value=!1;return}const o={...n.value,freedomain:_.value};localStorage.setItem("currentProductData",JSON.stringify(o)),await v.createProduct(o),C.value=!0,u.addNotification({type:"success",title:t("products_services.success.product_created_title"),message:t("products_services.success.product_created_message")}),localStorage.removeItem("currentProductData"),setTimeout(()=>{w.push({name:"products"})},1500)}catch(o){console.error("Erreur lors de la création du produit:",o),u.addNotification({type:"error",title:t("products_services.errors.product_creation_failed_title"),message:t("products_services.errors.product_creation_failed_message")})}finally{m.value=!1}},p=()=>{localStorage.setItem("freedomainData",JSON.stringify(_.value));const o=y.value?x.value:"create";w.push({name:"product-cross-sells",params:{idOrAction:o}})},a=()=>{localStorage.setItem("freedomainData",JSON.stringify(_.value));const o=y.value?x.value:"create";w.push({name:"product-upgrades",params:{idOrAction:o}})};return be(()=>{n.value&&n.value.freedomain&&(_.value=n.value.freedomain)}),(o,d)=>(N(),L("div",tm,[e("div",sm,[e("div",om,[e("div",nm,[e("h3",im,s(c(t)("products_services.freedomain.configuration_title")),1)]),e("div",rm,[e("div",am,[e("div",lm,[e("input",{type:"checkbox",id:"freedomain-enabled",class:"form-check-input",checked:_.value.enabled,onChange:b},null,40,cm),e("label",um,s(c(t)("products_services.freedomain.enable_freedomain")),1),e("small",dm,s(c(t)("products_services.freedomain.enable_freedomain_help")),1)])])]),_.value.enabled?(N(),L("div",pm,[e("div",fm,[e("label",vm,s(c(t)("products_services.freedomain.required_period")),1),e("select",{id:"required-period",class:"form-control",value:_.value.requiredPeriod,onChange:d[0]||(d[0]=l=>P(l.target.value))},[e("option",hm,"1 "+s(c(t)("common.month")),1),e("option",gm,"3 "+s(c(t)("common.months")),1),e("option",_m,"6 "+s(c(t)("common.months")),1),e("option",ym,"12 "+s(c(t)("common.months")),1),e("option",bm,"24 "+s(c(t)("common.months")),1),e("option",$m,"36 "+s(c(t)("common.months")),1)],40,mm),e("small",Sm,s(c(t)("products_services.freedomain.required_period_help")),1)]),e("div",wm,[e("div",km,[e("input",{type:"checkbox",id:"initial-order-only",class:"form-check-input",checked:_.value.onlyInitialOrder,onChange:E},null,40,Cm),e("label",Am,s(c(t)("products_services.freedomain.initial_order_only")),1),e("small",Em,s(c(t)("products_services.freedomain.initial_order_only_help")),1)])]),e("div",Om,[e("label",null,s(c(t)("products_services.freedomain.available_tlds")),1),$.value.tlds?(N(),L("div",Tm,s($.value.tlds),1)):J("",!0),e("div",Rm,[(N(!0),L(ae,null,le(r.value,l=>(N(),L("div",{key:l,class:"tld-item"},[e("button",{type:"button",class:se(["tld-button",{selected:O(l)}]),onClick:g=>O(l)?S(l):h(l)},s(l),11,xm)]))),128))]),e("small",Im,s(c(t)("products_services.freedomain.tlds_help")),1)]),_.value.tlds.length>0?(N(),L("div",Pm,[e("h4",null,s(c(t)("products_services.freedomain.selected_tlds")),1),e("div",Mm,[(N(!0),L(ae,null,le(_.value.tlds,l=>(N(),L("div",{key:l,class:"tld-badge"},[ne(s(l)+" ",1),e("button",{type:"button",class:"badge-remove",onClick:g=>S(l)}," × ",8,Dm)]))),128))])])):J("",!0)])):J("",!0)])]),e("div",Nm,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:a,disabled:m.value||C.value},s(c(t)("common.back")),9,Lm),e("div",Um,[e("button",{type:"button",class:"btn btn-success",onClick:f,disabled:m.value||C.value},[C.value?(N(),L("span",Fm,s(c(t)("common.saved")),1)):m.value?(N(),L("span",qm,s(c(t)("common.saving"))+"...",1)):(N(),L("span",Bm,s(c(t)("common.save")),1))],8,Vm),e("button",{type:"button",class:"btn btn-primary",onClick:p,disabled:m.value||C.value},s(c(t)("common.continue")),9,jm)])])]))}}),Jt=$e(Gm,[["__scopeId","data-v-068709f2"]]),zm={class:"product-cross-sells-view"},Hm={class:"wizard-content"},Wm={class:"cross-sells-configuration"},Km={class:"section-header"},Jm={class:"section-title"},Qm={class:"form-options-container"},Ym={class:"form-group"},Xm={class:"form-check"},Zm=["checked"],eh={for:"show-on-checkout",class:"form-check-label"},th={class:"form-text text-muted"},sh={class:"form-group"},oh={for:"discount-percent"},nh={class:"input-group"},ih=["value"],rh={class:"form-text text-muted"},ah={class:"cross-sells-search"},lh={class:"section-header"},ch={class:"section-title"},uh={class:"search-container"},dh={class:"search-form"},ph={class:"form-group"},fh={for:"search-query"},vh={class:"search-input-group"},mh=["placeholder"],hh={key:0,class:"search-loading"},gh={key:1,class:"search-no-results"},_h={key:2,class:"search-results"},yh={class:"data-table"},bh={class:"text-center"},$h={class:"text-center"},Sh=["onClick"],wh={class:"cross-sells-selected"},kh={class:"section-header"},Ch={class:"section-title"},Ah={key:0,class:"loading-indicator"},Eh={key:1,class:"empty-state"},Oh={key:2,class:"selected-products"},Th={class:"data-table"},Rh={class:"text-center"},xh={class:"text-center"},Ih=["onClick"],Ph={class:"wizard-actions"},Mh=["disabled"],Dh={class:"action-buttons"},Nh=["disabled"],Lh={key:0},Uh={key:1},Vh=["disabled"],Fh=_e({__name:"ProductCrossSellsView",setup(I){const{t}=we(),w=Te(),i=Me(),u=de();Fe(),X(()=>i.params.type||"shared_hosting");const v=X(()=>{const d=localStorage.getItem("currentProductData");if(d)try{return JSON.parse(d)}catch(l){return console.error("Erreur lors du parsing des données:",l),{}}return{}}),n=X(()=>{const d=i.params.idOrAction;return d&&d!=="create"?parseInt(d,10):null}),x=X(()=>!!n.value),y=[{id:"type",label:t("products_services.tabs.type"),icon:"tag",route:"create-product"},{id:"details",label:t("products_services.tabs.details"),icon:"info-circle",route:"product-details"},{id:"pricing",label:t("products_services.tabs.pricing"),icon:"money-bill",route:"product-pricing"},{id:"module",label:t("products_services.tabs.module"),icon:"puzzle-piece",route:"product-module"},{id:"custom_fields",label:t("products_services.tabs.custom_fields"),icon:"list-alt",route:"product-custom-fields"},{id:"configurable_options",label:t("products_services.tabs.configurable_options"),icon:"cogs",route:"product-configurable-options"},{id:"upgrades",label:t("products_services.tabs.upgrades"),icon:"arrow-up",route:"product-upgrades"},{id:"freedomain",label:t("products_services.tabs.freedomain"),icon:"globe",route:"product-freedomain"},{id:"cross_sells",label:t("products_services.tabs.cross_sells"),icon:"shopping-cart",route:"product-cross-sells"},{id:"other",label:t("products_services.tabs.other"),icon:"ellipsis-h",route:"product-other"},{id:"links",label:t("products_services.tabs.links"),icon:"link",route:"product-links"}];X(()=>{const d=i.name,l=y.find(g=>g.route===d);return l?l.id:"cross_sells"});const A=z(!1),m=z([]),C=z({crossSells:[],showOnCheckout:!0,discountPercent:0}),$=z(""),_=z([]),r=z(!1),h=async()=>{A.value=!0;try{setTimeout(()=>{m.value=[{id:1,name:"Hébergement Basic",type:"shared_hosting",price:49.99},{id:2,name:"Hébergement Pro",type:"shared_hosting",price:99.99},{id:3,name:"Hébergement Business",type:"shared_hosting",price:149.99},{id:4,name:"VPS Standard",type:"vps",price:199.99},{id:5,name:"VPS Premium",type:"vps",price:299.99},{id:6,name:"Serveur Dédié",type:"dedicated_server",price:499.99},{id:7,name:"SSL Standard",type:"ssl",price:29.99},{id:8,name:"SSL Wildcard",type:"ssl",price:79.99},{id:9,name:"Protection DDoS",type:"security",price:59.99},{id:10,name:"Sauvegarde Journalière",type:"backup",price:19.99}],A.value=!1},500)}catch(d){console.error("Erreur lors de la récupération des produits:",d),A.value=!1,u.addNotification({type:"error",title:t("products_services.cross_sells.errors.fetch_failed_title"),message:t("products_services.cross_sells.errors.fetch_failed_message")})}},S=()=>{if(!$.value.trim()){_.value=[];return}r.value=!0;const d=$.value.toLowerCase();_.value=m.value.filter(l=>l.name.toLowerCase().includes(d)&&!C.value.crossSells.includes(l.id)&&l.id!==(v.value.id||0)),r.value=!1},O=d=>{C.value.crossSells.includes(d)||(C.value.crossSells.push(d),u.addNotification({type:"success",title:t("products_services.cross_sells.success.product_added_title"),message:t("products_services.cross_sells.success.product_added_message")}),$.value="",_.value=[])},b=d=>{C.value.crossSells=C.value.crossSells.filter(l=>l!==d),u.addNotification({type:"success",title:t("products_services.cross_sells.success.product_removed_title"),message:t("products_services.cross_sells.success.product_removed_message")})},E=d=>m.value.find(l=>l.id===d),P=d=>{C.value.discountPercent=parseInt(d)||0},f=()=>{C.value.showOnCheckout=!C.value.showOnCheckout},p=()=>{localStorage.setItem("crossSellsData",JSON.stringify(C.value));const d=x.value?n.value:"create";w.push({name:"product-other",params:{idOrAction:d}})},a=()=>{localStorage.setItem("crossSellsData",JSON.stringify(C.value));const d=x.value?n.value:"create";w.push({name:"product-freedomain",params:{idOrAction:d}})},o=()=>{u.addNotification({type:"success",title:t("common.success_title"),message:t("common.success_message")})};return be(()=>{h(),v.value&&v.value.crossSells&&(C.value=v.value.crossSells)}),(d,l)=>(N(),L("div",zm,[e("div",Hm,[e("div",Wm,[e("div",Km,[e("h3",Jm,s(c(t)("products_services.cross_sells.configuration_title")),1)]),e("div",Qm,[e("div",Ym,[e("div",Xm,[e("input",{type:"checkbox",id:"show-on-checkout",class:"form-check-input",checked:C.value.showOnCheckout,onChange:f},null,40,Zm),e("label",eh,s(c(t)("products_services.cross_sells.show_on_checkout")),1),e("small",th,s(c(t)("products_services.cross_sells.show_on_checkout_help")),1)])]),e("div",sh,[e("label",oh,s(c(t)("products_services.cross_sells.discount_percent")),1),e("div",nh,[e("input",{type:"number",id:"discount-percent",class:"form-control",min:"0",max:"100",value:C.value.discountPercent,onInput:l[0]||(l[0]=g=>P(g.target.value))},null,40,ih),l[2]||(l[2]=e("div",{class:"input-group-append"},[e("span",{class:"input-group-text"},"%")],-1))]),e("small",rh,s(c(t)("products_services.cross_sells.discount_percent_help")),1)])])]),e("div",ah,[e("div",lh,[e("h3",ch,s(c(t)("products_services.cross_sells.search_title")),1)]),e("div",uh,[e("div",dh,[e("div",ph,[e("label",fh,s(c(t)("products_services.cross_sells.search_products")),1),e("div",vh,[H(e("input",{type:"text",id:"search-query",class:"form-control","onUpdate:modelValue":l[1]||(l[1]=g=>$.value=g),onInput:S,placeholder:c(t)("products_services.cross_sells.search_placeholder")},null,40,mh),[[ee,$.value]]),e("button",{type:"button",class:"btn btn-primary",onClick:S},s(c(t)("common.search")),1)])])]),r.value?(N(),L("div",hh,[l[3]||(l[3]=e("div",{class:"spinner"},null,-1)),e("p",null,s(c(t)("common.searching"))+"...",1)])):$.value&&_.value.length===0?(N(),L("div",gh,[e("p",null,s(c(t)("products_services.cross_sells.no_search_results")),1)])):_.value.length>0?(N(),L("div",_h,[e("table",yh,[e("thead",null,[e("tr",null,[e("th",null,s(c(t)("products_services.cross_sells.product_name")),1),e("th",null,s(c(t)("products_services.cross_sells.product_type")),1),e("th",null,s(c(t)("products_services.cross_sells.product_price")),1),e("th",bh,s(c(t)("products_services.cross_sells.action")),1)])]),e("tbody",null,[(N(!0),L(ae,null,le(_.value,g=>(N(),L("tr",{key:g.id},[e("td",null,s(g.name),1),e("td",null,s(g.type),1),e("td",null,s(g.price)+" €",1),e("td",$h,[e("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:R=>O(g.id)},s(c(t)("products_services.cross_sells.add")),9,Sh)])]))),128))])])])):J("",!0)])]),e("div",wh,[e("div",kh,[e("h3",Ch,s(c(t)("products_services.cross_sells.selected_products")),1)]),A.value?(N(),L("div",Ah,[l[4]||(l[4]=e("div",{class:"spinner"},null,-1)),e("p",null,s(c(t)("common.loading"))+"...",1)])):C.value.crossSells.length===0?(N(),L("div",Eh,[e("p",null,s(c(t)("products_services.cross_sells.no_products_selected")),1)])):(N(),L("div",Oh,[e("table",Th,[e("thead",null,[e("tr",null,[e("th",null,s(c(t)("products_services.cross_sells.product_name")),1),e("th",null,s(c(t)("products_services.cross_sells.product_type")),1),e("th",null,s(c(t)("products_services.cross_sells.product_price")),1),e("th",Rh,s(c(t)("products_services.cross_sells.action")),1)])]),e("tbody",null,[(N(!0),L(ae,null,le(C.value.crossSells,g=>{var R,k,T;return N(),L("tr",{key:g},[e("td",null,s(((R=E(g))==null?void 0:R.name)||`ID: ${g}`),1),e("td",null,s(((k=E(g))==null?void 0:k.type)||"-"),1),e("td",null,s(((T=E(g))==null?void 0:T.price)||0)+" €",1),e("td",xh,[e("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:V=>b(g)},s(c(t)("products_services.cross_sells.remove")),9,Ih)])])}),128))])])]))])]),e("div",Ph,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:a,disabled:A.value},s(c(t)("common.back")),9,Mh),e("div",Dh,[e("button",{type:"button",class:"btn btn-success",onClick:o,disabled:A.value},[A.value?(N(),L("span",Lh,s(c(t)("common.saving"))+"...",1)):(N(),L("span",Uh,s(c(t)("common.save")),1))],8,Nh),e("button",{type:"button",class:"btn btn-primary",onClick:p,disabled:A.value},s(c(t)("common.continue")),9,Vh)])])]))}}),Qt=$e(Fh,[["__scopeId","data-v-f121f749"]]),qh={class:"product-other-view"},Bh={class:"wizard-content"},jh={class:"other-options-configuration"},Gh={class:"section-header"},zh={class:"section-title"},Hh={class:"form-options-container"},Wh={class:"form-row"},Kh={class:"form-group form-group-checkbox"},Jh={class:"form-check"},Qh=["checked"],Yh={for:"require-domain",class:"form-check-label"},Xh={class:"form-text text-muted"},Zh={class:"form-group form-group-checkbox"},eg={class:"form-check"},tg=["checked"],sg={for:"auto-setup",class:"form-check-label"},og={class:"form-text text-muted"},ng={class:"form-row"},ig={class:"form-group form-group-checkbox"},rg={class:"form-check"},ag=["checked"],lg={for:"stock-control",class:"form-check-label"},cg={class:"form-text text-muted"},ug={key:0,class:"form-group"},dg={for:"stock-quantity"},pg=["value"],fg={class:"form-text text-muted"},vg={class:"form-row"},mg={class:"form-group form-group-checkbox"},hg={class:"form-check"},gg=["checked"],_g={for:"hidden",class:"form-check-label"},yg={class:"form-text text-muted"},bg={class:"form-group form-group-checkbox"},$g={class:"form-check"},Sg=["checked"],wg={for:"featured",class:"form-check-label"},kg={class:"form-text text-muted"},Cg={class:"form-row"},Ag={class:"form-group"},Eg={for:"welcome-email"},Og=["value"],Tg=["value"],Rg={class:"form-text text-muted"},xg={class:"form-row"},Ig={class:"form-group"},Pg={for:"notes"},Mg=["placeholder"],Dg={class:"form-text text-muted"},Ng={class:"wizard-actions"},Lg=["disabled"],Ug={class:"action-buttons"},Vg=["disabled"],Fg={key:0},qg={key:1},Bg=["disabled"],jg=_e({__name:"ProductOtherView",setup(I){const{t}=we(),w=Te(),i=Me();de(),X(()=>i.params.type||"shared_hosting");const u=X(()=>{const f=localStorage.getItem("currentProductData");if(f)try{return JSON.parse(f)}catch(p){return console.error("Erreur lors du parsing des données:",p),{}}return{}}),v=X(()=>{const f=i.params.idOrAction;return f&&f!=="create"?parseInt(f,10):null}),n=X(()=>!!v.value),x=[{id:"type",label:t("products_services.tabs.type"),icon:"tag",route:"create-product"},{id:"details",label:t("products_services.tabs.details"),icon:"info-circle",route:"product-details"},{id:"pricing",label:t("products_services.tabs.pricing"),icon:"money-bill",route:"product-pricing"},{id:"module",label:t("products_services.tabs.module"),icon:"puzzle-piece",route:"product-module"},{id:"custom_fields",label:t("products_services.tabs.custom_fields"),icon:"list-alt",route:"product-custom-fields"},{id:"configurable_options",label:t("products_services.tabs.configurable_options"),icon:"cogs",route:"product-configurable-options"},{id:"upgrades",label:t("products_services.tabs.upgrades"),icon:"arrow-up",route:"product-upgrades"},{id:"freedomain",label:t("products_services.tabs.freedomain"),icon:"globe",route:"product-freedomain"},{id:"cross_sells",label:t("products_services.tabs.cross_sells"),icon:"shopping-cart",route:"product-cross-sells"},{id:"other",label:t("products_services.tabs.other"),icon:"ellipsis-h",route:"product-other"},{id:"links",label:t("products_services.tabs.links"),icon:"link",route:"product-links"}];X(()=>{const f=i.name,p=x.find(a=>a.route===f);return p?p.id:"other"});const y=z({requireDomain:!1,autoSetup:!0,stockControl:!1,stockQuantity:0,hidden:!1,featured:!1,welcomeEmail:0,notes:""}),A=z([{id:0,name:t("products_services.other.welcome_email_none")},{id:1,name:t("products_services.other.welcome_email_product")},{id:2,name:t("products_services.other.welcome_email_general")},{id:3,name:t("products_services.other.welcome_email_both")}]),m=f=>{y.value.stockQuantity=parseInt(f)||0},C=f=>{y.value.welcomeEmail=parseInt(f)},$=()=>{y.value.stockControl=!y.value.stockControl,y.value.stockControl||(y.value.stockQuantity=0)},_=()=>{y.value.requireDomain=!y.value.requireDomain},r=()=>{y.value.autoSetup=!y.value.autoSetup},h=()=>{y.value.hidden=!y.value.hidden},S=()=>{y.value.featured=!y.value.featured},O=()=>{localStorage.setItem("otherData",JSON.stringify(y.value));const f=n.value?v.value:"create";w.push({name:"product-links",params:{idOrAction:f}})},b=()=>{localStorage.setItem("otherData",JSON.stringify(y.value));const f=n.value?v.value:"create";w.push({name:"product-cross-sells",params:{idOrAction:f}})},E=()=>{};be(()=>{u.value&&u.value.otherOptions&&(y.value={...y.value,...u.value.otherOptions})});const P=z(!1);return(f,p)=>(N(),L("div",qh,[e("div",Bh,[e("div",jh,[e("div",Gh,[e("h3",zh,s(c(t)("products_services.other.configuration_title")),1)]),e("div",Hh,[e("div",Wh,[e("div",Kh,[e("div",Jh,[e("input",{type:"checkbox",id:"require-domain",class:"form-check-input",checked:y.value.requireDomain,onChange:_},null,40,Qh),e("label",Yh,s(c(t)("products_services.other.require_domain")),1)]),e("small",Xh,s(c(t)("products_services.other.require_domain_help")),1)]),e("div",Zh,[e("div",eg,[e("input",{type:"checkbox",id:"auto-setup",class:"form-check-input",checked:y.value.autoSetup,onChange:r},null,40,tg),e("label",sg,s(c(t)("products_services.other.auto_setup")),1)]),e("small",og,s(c(t)("products_services.other.auto_setup_help")),1)])]),e("div",ng,[e("div",ig,[e("div",rg,[e("input",{type:"checkbox",id:"stock-control",class:"form-check-input",checked:y.value.stockControl,onChange:$},null,40,ag),e("label",lg,s(c(t)("products_services.other.stock_control")),1)]),e("small",cg,s(c(t)("products_services.other.stock_control_help")),1)]),y.value.stockControl?(N(),L("div",ug,[e("label",dg,s(c(t)("products_services.other.stock_quantity")),1),e("input",{type:"number",id:"stock-quantity",class:"form-control",min:"0",value:y.value.stockQuantity,onInput:p[0]||(p[0]=a=>m(a.target.value))},null,40,pg),e("small",fg,s(c(t)("products_services.other.stock_quantity_help")),1)])):J("",!0)]),e("div",vg,[e("div",mg,[e("div",hg,[e("input",{type:"checkbox",id:"hidden",class:"form-check-input",checked:y.value.hidden,onChange:h},null,40,gg),e("label",_g,s(c(t)("products_services.other.hidden")),1)]),e("small",yg,s(c(t)("products_services.other.hidden_help")),1)]),e("div",bg,[e("div",$g,[e("input",{type:"checkbox",id:"featured",class:"form-check-input",checked:y.value.featured,onChange:S},null,40,Sg),e("label",wg,s(c(t)("products_services.other.featured")),1)]),e("small",kg,s(c(t)("products_services.other.featured_help")),1)])]),e("div",Cg,[e("div",Ag,[e("label",Eg,s(c(t)("products_services.other.welcome_email")),1),e("select",{id:"welcome-email",class:"form-control",value:y.value.welcomeEmail,onChange:p[1]||(p[1]=a=>C(a.target.value))},[(N(!0),L(ae,null,le(A.value,a=>(N(),L("option",{key:a.id,value:a.id},s(a.name),9,Tg))),128))],40,Og),e("small",Rg,s(c(t)("products_services.other.welcome_email_help")),1)])]),e("div",xg,[e("div",Ig,[e("label",Pg,s(c(t)("products_services.other.notes")),1),H(e("textarea",{id:"notes",class:"form-control",rows:"4","onUpdate:modelValue":p[2]||(p[2]=a=>y.value.notes=a),placeholder:c(t)("products_services.other.notes_placeholder")},null,8,Mg),[[ee,y.value.notes]]),e("small",Dg,s(c(t)("products_services.other.notes_help")),1)])])])])]),e("div",Ng,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:b,disabled:P.value},s(c(t)("common.back")),9,Lg),e("div",Ug,[e("button",{type:"button",class:"btn btn-success",onClick:E,disabled:P.value},[P.value?(N(),L("span",Fg,s(c(t)("common.saving"))+"...",1)):(N(),L("span",qg,s(c(t)("common.save")),1))],8,Vg),e("button",{type:"button",class:"btn btn-primary",onClick:O,disabled:P.value},s(c(t)("common.continue")),9,Bg)])])]))}}),Yt=$e(jg,[["__scopeId","data-v-262f7e6b"]]),Gg={class:"product-links-view"},zg={class:"wizard-content"},Hg={class:"direct-links-section"},Wg={class:"section-header"},Kg={class:"section-title"},Jg={class:"form-options-container"},Qg={class:"form-group"},Yg={for:"cart-link"},Xg={class:"input-group"},Zg=["value","placeholder"],e_={class:"form-group"},t_={for:"cart-link-template"},s_={class:"input-group"},o_=["value","placeholder"],n_={class:"form-group"},i_={for:"cart-link-domain"},r_={class:"input-group"},a_=["value","placeholder"],l_={class:"form-group"},c_={for:"group-link"},u_={class:"input-group"},d_=["value","placeholder"],p_={class:"product-links-section"},f_={class:"section-header"},v_={class:"section-title"},m_={class:"product-links-table"},h_={class:"data-table"},g_={class:"text-center visits-column"},__={class:"text-center actions-column"},y_=["value","onInput","placeholder"],b_={class:"text-center visits-column"},$_={class:"text-center actions-column"},S_=["onClick","disabled"],w_={class:"wizard-actions"},k_=["disabled"],C_={class:"action-buttons"},A_=["disabled"],E_={key:0},O_={key:1},T_=_e({__name:"ProductLinksView",setup(I){const{t}=we(),w=Te(),i=Me(),u=de();Fe(),X(()=>i.params.type||"shared_hosting");const v=X(()=>{const O=localStorage.getItem("currentProductData");if(O)try{return JSON.parse(O)}catch(b){return console.error("Erreur lors du parsing des données:",b),{}}return{}}),n=X(()=>{const O=i.params.idOrAction;return O&&O!=="create"?parseInt(O,10):null}),x=X(()=>!!n.value),y=[{id:"type",label:t("products_services.tabs.type"),icon:"tag",route:"create-product"},{id:"details",label:t("products_services.tabs.details"),icon:"info-circle",route:"product-details"},{id:"pricing",label:t("products_services.tabs.pricing"),icon:"money-bill",route:"product-pricing"},{id:"module",label:t("products_services.tabs.module"),icon:"puzzle-piece",route:"product-module"},{id:"custom_fields",label:t("products_services.tabs.custom_fields"),icon:"list-alt",route:"product-custom-fields"},{id:"configurable_options",label:t("products_services.tabs.configurable_options"),icon:"cogs",route:"product-configurable-options"},{id:"upgrades",label:t("products_services.tabs.upgrades"),icon:"arrow-up",route:"product-upgrades"},{id:"freedomain",label:t("products_services.tabs.freedomain"),icon:"globe",route:"product-freedomain"},{id:"cross_sells",label:t("products_services.tabs.cross_sells"),icon:"shopping-cart",route:"product-cross-sells"},{id:"other",label:t("products_services.tabs.other"),icon:"ellipsis-h",route:"product-other"},{id:"links",label:t("products_services.tabs.links"),icon:"link",route:"product-links"}];X(()=>{const O=i.name,b=y.find(E=>E.route===O);return b?b.id:"links"});const A=z({directLinks:{cartLink:"",cartLinkWithTemplate:"",cartLinkWithDomain:"",groupLink:""},productLinks:[]});z(!1);const m=z(!1),C=(O,b)=>{A.value.directLinks[O]=b},$=()=>{A.value.productLinks.push({url:"",visits:0})},_=(O,b)=>{A.value.productLinks[O].url=b},r=O=>{A.value.productLinks.splice(O,1),u.addNotification({type:"success",title:t("products_services.links.success.link_removed_title"),message:t("products_services.links.success.link_removed_message")})},h=async()=>{try{m.value=!0,localStorage.setItem("linksData",JSON.stringify(A.value)),u.showNotification({title:t("products_services.success.save"),message:x.value?t("products_services.success.update_message"):t("products_services.success.create_message"),type:"success"}),w.push({name:"products"})}catch(O){console.error("Erreur lors de l'enregistrement du produit:",O),u.showNotification({title:t("products_services.errors.save"),message:t("products_services.errors.save_message"),type:"error"})}finally{m.value=!1}},S=()=>{localStorage.setItem("linksData",JSON.stringify(A.value));const O=x.value?n.value:"create";w.push({name:"product-other",params:{idOrAction:O}})};return be(()=>{v.value&&v.value.links&&(A.value=v.value.links),A.value.productLinks.length===0&&$()}),(O,b)=>(N(),L("div",Gg,[e("div",zg,[e("div",Hg,[e("div",Wg,[e("h3",Kg,s(c(t)("products_services.links.direct_links_title")),1)]),e("div",Jg,[e("div",Qg,[e("label",Yg,s(c(t)("products_services.links.direct_cart_link")),1),e("div",Xg,[e("input",{type:"text",id:"cart-link",class:"form-control",value:A.value.directLinks.cartLink,onInput:b[0]||(b[0]=E=>C("cartLink",E.target.value)),placeholder:c(t)("products_services.links.direct_cart_link_placeholder")},null,40,Zg),b[4]||(b[4]=e("div",{class:"input-group-append"},[e("button",{type:"button",class:"btn btn-outline-secondary"},[e("i",{class:"fas fa-copy"})])],-1))])]),e("div",e_,[e("label",t_,s(c(t)("products_services.links.direct_cart_link_template")),1),e("div",s_,[e("input",{type:"text",id:"cart-link-template",class:"form-control",value:A.value.directLinks.cartLinkWithTemplate,onInput:b[1]||(b[1]=E=>C("cartLinkWithTemplate",E.target.value)),placeholder:c(t)("products_services.links.direct_cart_link_template_placeholder")},null,40,o_),b[5]||(b[5]=e("div",{class:"input-group-append"},[e("button",{type:"button",class:"btn btn-outline-secondary"},[e("i",{class:"fas fa-copy"})])],-1))])]),e("div",n_,[e("label",i_,s(c(t)("products_services.links.direct_cart_link_domain")),1),e("div",r_,[e("input",{type:"text",id:"cart-link-domain",class:"form-control",value:A.value.directLinks.cartLinkWithDomain,onInput:b[2]||(b[2]=E=>C("cartLinkWithDomain",E.target.value)),placeholder:c(t)("products_services.links.direct_cart_link_domain_placeholder")},null,40,a_),b[6]||(b[6]=e("div",{class:"input-group-append"},[e("button",{type:"button",class:"btn btn-outline-secondary"},[e("i",{class:"fas fa-copy"})])],-1))])]),e("div",l_,[e("label",c_,s(c(t)("products_services.links.group_cart_link")),1),e("div",u_,[e("input",{type:"text",id:"group-link",class:"form-control",value:A.value.directLinks.groupLink,onInput:b[3]||(b[3]=E=>C("groupLink",E.target.value)),placeholder:c(t)("products_services.links.group_cart_link_placeholder")},null,40,d_),b[7]||(b[7]=e("div",{class:"input-group-append"},[e("button",{type:"button",class:"btn btn-outline-secondary"},[e("i",{class:"fas fa-copy"})])],-1))])])])]),e("div",p_,[e("div",f_,[e("h3",v_,s(c(t)("products_services.links.product_links_title")),1),e("button",{type:"button",class:"btn btn-sm btn-outline-primary add-link-btn",onClick:$},[b[8]||(b[8]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(c(t)("products_services.links.add_link")),1)])]),e("div",m_,[e("table",h_,[e("thead",null,[e("tr",null,[e("th",null,s(c(t)("products_services.links.url")),1),e("th",g_,s(c(t)("products_services.links.visits")),1),e("th",__,s(c(t)("products_services.links.actions")),1)])]),e("tbody",null,[(N(!0),L(ae,null,le(A.value.productLinks,(E,P)=>(N(),L("tr",{key:P},[e("td",null,[e("input",{type:"text",class:"form-control",value:E.url,onInput:f=>_(P,f.target.value),placeholder:c(t)("products_services.links.url_placeholder")},null,40,y_)]),e("td",b_,s(E.visits),1),e("td",$_,[e("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:f=>r(P),disabled:A.value.productLinks.length===1},b[9]||(b[9]=[e("i",{class:"fas fa-trash-alt"},null,-1)]),8,S_)])]))),128))])])])])]),e("div",w_,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:S,disabled:m.value},s(c(t)("common.back")),9,k_),e("div",C_,[e("button",{type:"button",class:"btn btn-success",onClick:h,disabled:m.value},[m.value?(N(),L("span",E_,s(c(t)("common.saving"))+"...",1)):(N(),L("span",O_,s(c(t)("common.save")),1))],8,A_)])])]))}}),Xt=$e(T_,[["__scopeId","data-v-7c9a6e6e"]]),R_=Pe("invoices",{state:()=>({invoices:[],currentInvoice:null,loading:!1,error:null}),getters:{getInvoiceById:I=>t=>I.invoices.find(w=>w.id===t)||null,getInvoicesByStatus:I=>t=>t==="all"?I.invoices:I.invoices.filter(w=>w.status===t)},actions:{async fetchInvoices(){var I,t;this.loading=!0,this.error=null;try{const w=await me.get("/api/v1/invoices");this.invoices=w.data.invoices}catch(w){console.error("Erreur lors du chargement des factures:",w),this.error=((t=(I=w.response)==null?void 0:I.data)==null?void 0:t.message)||"Erreur lors du chargement des factures",de().addNotification({title:"Erreur",message:this.error,type:"error"})}finally{this.loading=!1}},async fetchInvoice(I){var t,w;this.loading=!0,this.error=null;try{const i=await me.get(`/api/v1/invoices/${I}`);return this.currentInvoice=i.data.invoice,i.data.invoice}catch(i){return console.error(`Erreur lors du chargement de la facture ${I}:`,i),this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||`Erreur lors du chargement de la facture ${I}`,de().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async createInvoice(I){var t,w;this.loading=!0,this.error=null;try{const i=await me.post("/api/v1/invoices",I);return this.invoices.unshift(i.data.invoice),de().addNotification({title:"Succès",message:"Facture créée avec succès",type:"success"}),i.data.invoice}catch(i){return console.error("Erreur lors de la création de la facture:",i),this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||"Erreur lors de la création de la facture",de().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async updateInvoice(I){var t,w;this.loading=!0,this.error=null;try{const i=await me.put(`/api/v1/invoices/${I.id}`,I),u=this.invoices.findIndex(n=>n.id===I.id);return u!==-1&&(this.invoices[u]=i.data.invoice),de().addNotification({title:"Succès",message:"Facture mise à jour avec succès",type:"success"}),i.data.invoice}catch(i){return console.error(`Erreur lors de la mise à jour de la facture ${I.id}:`,i),this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||`Erreur lors de la mise à jour de la facture ${I.id}`,de().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async deleteInvoice(I){var t,w;this.loading=!0,this.error=null;try{return await me.delete(`/api/v1/invoices/${I}`),this.invoices=this.invoices.filter(u=>u.id!==I),de().addNotification({title:"Succès",message:"Facture supprimée avec succès",type:"success"}),!0}catch(i){return console.error(`Erreur lors de la suppression de la facture ${I}:`,i),this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||`Erreur lors de la suppression de la facture ${I}`,de().addNotification({title:"Erreur",message:this.error,type:"error"}),!1}finally{this.loading=!1}},async markAsPaid(I){var t,w;this.loading=!0,this.error=null;try{const i=await me.put(`/api/v1/invoices/${I}`,{status:"paid",paid_at:new Date().toISOString()}),u=this.invoices.findIndex(n=>n.id===I);return u!==-1&&(this.invoices[u]=i.data.invoice),de().addNotification({title:"Succès",message:"Facture marquée comme payée",type:"success"}),i.data.invoice}catch(i){return console.error(`Erreur lors du marquage de la facture ${I} comme payée:`,i),this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||`Erreur lors du marquage de la facture ${I} comme payée`,de().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}}}}),x_={key:0,class:"modal-wrapper"},I_={class:"modal-container"},P_={class:"modal-header"},M_={class:"modal-body"},D_={class:"form-group"},N_={for:"product_id"},L_=["disabled"],U_={value:""},V_=["value"],F_={class:"form-group"},q_={for:"amount"},B_=["disabled"],j_={class:"form-group"},G_={for:"due_date"},z_=["disabled"],H_={key:0,class:"form-group"},W_={for:"status"},K_=["disabled"],J_={value:"pending"},Q_={value:"paid"},Y_={value:"overdue"},X_={value:"cancelled"},Z_={key:1,class:"form-group"},ey={key:2,class:"form-group"},ty={class:"form-actions"},sy=["disabled"],oy={key:0},ny={key:1},iy=["disabled"],ry=_e({__name:"InvoiceModal",props:{show:{type:Boolean,default:!1},mode:{type:String,default:"add",validator:I=>["add","edit","view"].includes(I)},invoice:{type:Object,default:()=>({})}},emits:["close","submit"],setup(I,{emit:t}){const w=I,i=t,{t:u}=we(),v=z([]),n=z(!1),x=z({product_id:"",amount:0,due_date:new Date().toISOString().split("T")[0],status:"pending"}),y=X(()=>w.mode==="add"),A=X(()=>w.mode==="edit"),m=X(()=>w.mode==="view"),C=X(()=>y.value?u("invoices.modal.add_title"):A.value?u("invoices.modal.edit_title"):u("invoices.modal.view_title")),$=async()=>{try{const O=await me.get("/api/v1/services");v.value=O.data.services}catch(O){console.error("Erreur lors du chargement des services:",O)}},_=()=>{y.value?x.value={product_id:"",amount:0,due_date:new Date().toISOString().split("T")[0],status:"pending"}:x.value={product_id:w.invoice.product_id||"",amount:w.invoice.amount||0,due_date:w.invoice.due_date?new Date(w.invoice.due_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],status:w.invoice.status||"pending"}},r=O=>{if(!O)return"";const b=new Date(O);return new Intl.DateTimeFormat("fr-FR").format(b)},h=()=>{i("submit",{...x.value})},S=()=>{i("close")};return Ne(()=>w.show,O=>{O&&_()}),Ne(()=>w.invoice,()=>{w.show&&_()},{deep:!0}),be(()=>{$()}),(O,b)=>I.show?(N(),L("div",x_,[e("div",{class:"modal-backdrop",onClick:S}),e("div",I_,[e("div",P_,[e("h3",null,s(C.value),1),e("button",{class:"close-btn",onClick:S},b[4]||(b[4]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",M_,[e("form",{onSubmit:Se(h,["prevent"])},[e("div",D_,[e("label",N_,s(O.$t("invoices.columns.service")),1),H(e("select",{id:"product_id","onUpdate:modelValue":b[0]||(b[0]=E=>x.value.product_id=E),class:"form-select",disabled:m.value||n.value,required:""},[e("option",U_,s(O.$t("common.select")),1),(N(!0),L(ae,null,le(v.value,E=>(N(),L("option",{key:E.id,value:E.id},s(E.name),9,V_))),128))],8,L_),[[pe,x.value.product_id]])]),e("div",F_,[e("label",q_,s(O.$t("invoices.columns.amount")),1),H(e("input",{type:"number",id:"amount","onUpdate:modelValue":b[1]||(b[1]=E=>x.value.amount=E),class:"form-control",disabled:m.value||n.value,step:"0.01",min:"0",required:""},null,8,B_),[[ee,x.value.amount]])]),e("div",j_,[e("label",G_,s(O.$t("invoices.columns.due_date")),1),H(e("input",{type:"date",id:"due_date","onUpdate:modelValue":b[2]||(b[2]=E=>x.value.due_date=E),class:"form-control",disabled:m.value||n.value,required:""},null,8,z_),[[ee,x.value.due_date]])]),y.value?J("",!0):(N(),L("div",H_,[e("label",W_,s(O.$t("invoices.columns.status")),1),H(e("select",{id:"status","onUpdate:modelValue":b[3]||(b[3]=E=>x.value.status=E),class:"form-select",disabled:m.value||n.value},[e("option",J_,s(O.$t("invoices.status.pending")),1),e("option",Q_,s(O.$t("invoices.status.paid")),1),e("option",Y_,s(O.$t("invoices.status.overdue")),1),e("option",X_,s(O.$t("invoices.status.cancelled")),1)],8,K_),[[pe,x.value.status]])])),m.value&&I.invoice.paid_at?(N(),L("div",Z_,[e("label",null,s(O.$t("invoices.columns.paid_date")),1),e("p",null,s(r(I.invoice.paid_at)),1)])):J("",!0),m.value?(N(),L("div",ey,[e("label",null,s(O.$t("invoices.columns.created_at")),1),e("p",null,s(r(I.invoice.created_at)),1)])):J("",!0),e("div",ty,[m.value?J("",!0):(N(),L("button",{key:0,type:"submit",class:"btn btn-primary",disabled:n.value},[n.value?(N(),L("span",oy,[b[5]||(b[5]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),ne(" "+s(O.$t("common.loading")),1)])):(N(),L("span",ny,s(O.$t("common.save")),1))],8,sy)),e("button",{type:"button",class:"btn btn-secondary",onClick:S,disabled:n.value},s(m.value?O.$t("common.close"):O.$t("common.cancel")),9,iy)])],32)])])])):J("",!0)}}),ay=$e(ry,[["__scopeId","data-v-9561cfec"]]),ly={class:"invoices-view view-container"},cy={class:"header-box"},uy={class:"page-title"},dy={class:"page-description"},py={class:"filter-box"},fy={class:"filter-grid"},vy={class:"filter-group"},my={class:"filter-label"},hy={class:"filter-input-wrapper"},gy=["placeholder"],_y={class:"filter-group"},yy={class:"filter-label"},by={class:"filter-input-wrapper"},$y=["value"],Sy={class:"filter-group"},wy={class:"filter-label"},ky={class:"filter-input-wrapper"},Cy={value:"all"},Ay={value:"this_month"},Ey={value:"last_month"},Oy={value:"this_year"},Ty={class:"filter-group"},Ry={class:"filter-input-wrapper"},xy={class:"table-box"},Iy={key:0,class:"invoices-table"},Py={class:"actions-cell"},My=["onClick"],Dy=["onClick"],Ny=["onClick"],Ly={key:1,class:"loading-container"},Uy={key:2,class:"empty-state"},Vy={class:"modal-box"},Zt=_e({__name:"InvoicesView",setup(I){const{t}=we(),w=R_(),i=z(!1),u=z("create"),v=z(null),n=z("all"),x=z(""),y=z("all"),A=X(()=>w.loading),m=X(()=>[{value:"all",label:t("invoices.filters.all")},{value:"paid",label:t("invoices.filters.paid")},{value:"unpaid",label:t("invoices.filters.unpaid")},{value:"overdue",label:t("invoices.filters.overdue")},{value:"cancelled",label:t("invoices.filters.cancelled")}]),C=X(()=>{let d=w.invoices;if(n.value!=="all"&&(d=d.filter(l=>l.status===n.value)),x.value.trim()){const l=x.value.toLowerCase();d=d.filter(g=>String(g.id).includes(l)||g.client_name&&g.client_name.toLowerCase().includes(l)||g.service_name&&g.service_name.toLowerCase().includes(l))}if(y.value!=="all"){const l=new Date,g=l.getMonth(),R=l.getFullYear(),k=g-1;switch(y.value){case"this_month":d=d.filter(T=>new Date(T.date).getMonth()===g&&new Date(T.date).getFullYear()===R);break;case"last_month":d=d.filter(T=>new Date(T.date).getMonth()===k&&new Date(T.date).getFullYear()===R);break;case"this_year":d=d.filter(T=>new Date(T.date).getFullYear()===R);break}}return d}),$=d=>d==="all"?w.invoices.length:w.invoices.filter(l=>l.status===d).length,_=d=>d?new Date(d).toLocaleDateString("fr-FR"):"",r=d=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(d),h=d=>({paid:t("invoices.statuses.paid"),unpaid:t("invoices.statuses.unpaid"),overdue:t("invoices.statuses.overdue"),cancelled:t("invoices.statuses.cancelled")})[d]||d,S=()=>{v.value=null,u.value="create",i.value=!0},O=d=>{v.value=d,u.value="edit",i.value=!0},b=d=>{v.value=d,u.value="view",i.value=!0},E=()=>{i.value=!1},P=()=>{w.fetchInvoices()},f=()=>{w.fetchInvoices()},p=()=>{w.fetchInvoices()},a=async d=>{v.value=d,u.value="pay",i.value=!0},o=()=>{};return be(async()=>{console.log("InvoicesView - Chargement des données"),await w.fetchInvoices()}),(d,l)=>(N(),L("div",ly,[e("div",cy,[e("div",null,[e("h1",uy,s(d.$t("invoices.title")),1),e("span",dy,s(d.$t("invoices.description")),1)]),e("button",{class:"btn btn-primary",onClick:S},[l[3]||(l[3]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(d.$t("invoices.actions.add")),1)])]),e("div",py,[e("div",fy,[e("div",vy,[e("label",my,s(d.$t("invoices.filters.search")),1),e("div",hy,[l[4]||(l[4]=e("i",{class:"fas fa-search"},null,-1)),H(e("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=g=>x.value=g),class:"filter-input",placeholder:d.$t("invoices.search.placeholder")},null,8,gy),[[ee,x.value]])])]),e("div",_y,[e("label",yy,s(d.$t("invoices.filters.status")),1),e("div",by,[l[5]||(l[5]=e("i",{class:"fas fa-file-invoice-dollar"},null,-1)),H(e("select",{"onUpdate:modelValue":l[1]||(l[1]=g=>n.value=g),class:"filter-input"},[(N(!0),L(ae,null,le(m.value,g=>(N(),L("option",{key:g.value,value:g.value},s(g.label)+" ("+s($(g.value))+") ",9,$y))),128))],512),[[pe,n.value]])])]),e("div",Sy,[e("label",wy,s(d.$t("invoices.filters.date_range")),1),e("div",ky,[l[6]||(l[6]=e("i",{class:"fas fa-calendar"},null,-1)),H(e("select",{"onUpdate:modelValue":l[2]||(l[2]=g=>y.value=g),class:"filter-input"},[e("option",Cy,s(d.$t("invoices.filters.all_time")),1),e("option",Ay,s(d.$t("invoices.filters.this_month")),1),e("option",Ey,s(d.$t("invoices.filters.last_month")),1),e("option",Oy,s(d.$t("invoices.filters.this_year")),1)],512),[[pe,y.value]])])]),e("div",Ty,[l[8]||(l[8]=e("label",{class:"filter-label"}," ",-1)),e("div",Ry,[e("button",{onClick:o,class:"btn btn-gradient filter-button"},[l[7]||(l[7]=e("i",{class:"fas fa-filter"},null,-1)),ne(" "+s(d.$t("invoices.filters.apply")),1)])])])])]),e("div",xy,[!A.value&&C.value.length>0?(N(),L("table",Iy,[e("thead",null,[e("tr",null,[e("th",null,s(d.$t("invoices.table.id")),1),e("th",null,s(d.$t("invoices.table.client")),1),e("th",null,s(d.$t("invoices.table.service")),1),e("th",null,s(d.$t("invoices.table.date")),1),e("th",null,s(d.$t("invoices.table.dueDate")),1),e("th",null,s(d.$t("invoices.table.amount")),1),e("th",null,s(d.$t("invoices.table.status")),1),e("th",null,s(d.$t("invoices.table.actions")),1)])]),e("tbody",null,[(N(!0),L(ae,null,le(C.value,g=>(N(),L("tr",{key:g.id},[e("td",null,s(g.id),1),e("td",null,s(g.client_name),1),e("td",null,s(g.service_name),1),e("td",null,s(_(g.date)),1),e("td",null,s(g.due_date?_(g.due_date):"-"),1),e("td",null,s(r(g.amount)),1),e("td",null,[e("span",{class:se(["status-badge",g.status])},s(h(g.status)),3)]),e("td",Py,[e("button",{class:"action-btn view-btn",onClick:R=>b(g.id),title:"Voir"},l[9]||(l[9]=[e("i",{class:"fas fa-eye"},null,-1)]),8,My),e("button",{class:"action-btn edit-btn",onClick:R=>O(g.id),title:"Modifier"},l[10]||(l[10]=[e("i",{class:"fas fa-edit"},null,-1)]),8,Dy),g.status!=="paid"?(N(),L("button",{key:0,class:"action-btn pay-btn",onClick:R=>a(g.id),title:"Payer"},l[11]||(l[11]=[e("i",{class:"fas fa-credit-card"},null,-1)]),8,Ny)):J("",!0)])]))),128))])])):A.value?(N(),L("div",Ly,[l[12]||(l[12]=e("div",{class:"spinner"},null,-1)),e("p",null,s(d.$t("common.loading")),1)])):(N(),L("div",Uy,[l[13]||(l[13]=e("i",{class:"fas fa-file-invoice-dollar empty-icon"},null,-1)),e("h3",null,s(d.$t("invoices.empty.title")),1),e("p",null,s(d.$t("invoices.empty.message")),1),e("button",{class:"btn btn-primary",onClick:S},s(d.$t("invoices.actions.add")),1)]))]),(N(),We(ws,{to:"body"},[i.value?(N(),L("div",{key:0,class:"modal-backdrop",onClick:Se(E,["self"])},[e("div",Vy,[Ce(ay,{"invoice-id":v.value,mode:u.value,onClose:E,onCreated:P,onUpdated:f,onPaid:p,onEdit:O},null,8,["invoice-id","mode"])])])):J("",!0)]))]))}}),Fy=Pe("payments",{state:()=>({payments:[],currentPayment:null,loading:!1,error:null}),getters:{getPaymentById:I=>t=>I.payments.find(w=>w.id===t)||null,getPaymentsByStatus:I=>t=>t==="all"?I.payments:I.payments.filter(w=>w.status===t)},actions:{async fetchPayments(){var I,t;this.loading=!0,this.error=null;try{const w=await me.get("/api/v1/payments");this.payments=w.data.payments}catch(w){console.error("Erreur lors du chargement des paiements:",w),this.error=((t=(I=w.response)==null?void 0:I.data)==null?void 0:t.message)||"Erreur lors du chargement des paiements",de().addNotification({title:"Erreur",message:this.error,type:"error"})}finally{this.loading=!1}},async fetchPayment(I){var t,w;this.loading=!0,this.error=null;try{const i=await me.get(`/api/v1/payments/${I}`);return this.currentPayment=i.data.payment,i.data.payment}catch(i){return console.error(`Erreur lors du chargement du paiement ${I}:`,i),this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||`Erreur lors du chargement du paiement ${I}`,de().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async createPayment(I){var t,w;this.loading=!0,this.error=null;try{const i=await me.post("/api/v1/payments",I);return this.payments.unshift(i.data.payment),de().addNotification({title:"Succès",message:"Paiement créé avec succès",type:"success"}),i.data.payment}catch(i){return console.error("Erreur lors de la création du paiement:",i),this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||"Erreur lors de la création du paiement",de().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async updatePayment(I){var t,w;this.loading=!0,this.error=null;try{const i=await me.put(`/api/v1/payments/${I.id}`,I),u=this.payments.findIndex(n=>n.id===I.id);return u!==-1&&(this.payments[u]=i.data.payment),de().addNotification({title:"Succès",message:"Paiement mis à jour avec succès",type:"success"}),i.data.payment}catch(i){return console.error(`Erreur lors de la mise à jour du paiement ${I.id}:`,i),this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||`Erreur lors de la mise à jour du paiement ${I.id}`,de().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async deletePayment(I){var t,w;this.loading=!0,this.error=null;try{return await me.delete(`/api/v1/payments/${I}`),this.payments=this.payments.filter(u=>u.id!==I),de().addNotification({title:"Succès",message:"Paiement supprimé avec succès",type:"success"}),!0}catch(i){return console.error(`Erreur lors de la suppression du paiement ${I}:`,i),this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||`Erreur lors de la suppression du paiement ${I}`,de().addNotification({title:"Erreur",message:this.error,type:"error"}),!1}finally{this.loading=!1}},async processRefund(I,t){var w,i;this.loading=!0,this.error=null;try{const u=await me.post(`/api/v1/payments/${I}/refund`,{reason:t}),v=this.payments.findIndex(x=>x.id===I);return v!==-1&&(this.payments[v]=u.data.payment),de().addNotification({title:"Succès",message:"Remboursement traité avec succès",type:"success"}),u.data.payment}catch(u){return console.error(`Erreur lors du remboursement du paiement ${I}:`,u),this.error=((i=(w=u.response)==null?void 0:w.data)==null?void 0:i.message)||`Erreur lors du remboursement du paiement ${I}`,de().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}}}}),qy={key:0,class:"modal-wrapper"},By={class:"modal-container"},jy={class:"modal-header"},Gy={class:"modal-body"},zy={class:"form-group"},Hy={for:"invoice_id"},Wy=["disabled"],Ky={value:""},Jy=["value"],Qy={class:"form-group"},Yy={for:"amount"},Xy=["disabled"],Zy={class:"form-group"},e1={for:"payment_date"},t1=["disabled"],s1={class:"form-group"},o1={for:"payment_method"},n1=["disabled"],i1={value:"card"},r1={value:"bank_transfer"},a1={value:"paypal"},l1={value:"cash"},c1={value:"check"},u1={class:"form-group"},d1={for:"transaction_id"},p1=["disabled"],f1={class:"form-text text-muted"},v1={key:0,class:"form-group"},m1={for:"status"},h1=["disabled"],g1={value:"completed"},_1={value:"pending"},y1={value:"failed"},b1={value:"refunded"},$1={class:"form-group"},S1={for:"notes"},w1=["disabled"],k1={key:1,class:"form-group"},C1={class:"form-actions"},A1=["disabled"],E1={key:0},O1={key:1},T1=["disabled"],R1=_e({__name:"PaymentModal",props:{show:{type:Boolean,default:!1},mode:{type:String,default:"add",validator:I=>["add","edit","view"].includes(I)},payment:{type:Object,default:()=>({})}},emits:["close","submit"],setup(I,{emit:t}){const w=I,i=t,{t:u}=we(),v=z([]),n=z(!1),x=z({invoice_id:"",amount:0,payment_date:new Date().toISOString().split("T")[0],payment_method:"card",transaction_id:"",status:"completed",notes:""}),y=X(()=>w.mode==="add"),A=X(()=>w.mode==="edit"),m=X(()=>w.mode==="view"),C=X(()=>y.value?u("payments.modal.add_title"):A.value?u("payments.modal.edit_title"):u("payments.modal.view_title")),$=async()=>{try{const b=await me.get("/api/v1/invoices");v.value=b.data.invoices.filter(E=>E.status==="pending")}catch(b){console.error("Erreur lors du chargement des factures:",b)}},_=()=>{y.value?x.value={invoice_id:"",amount:0,payment_date:new Date().toISOString().split("T")[0],payment_method:"card",transaction_id:"",status:"completed",notes:""}:x.value={invoice_id:w.payment.invoice_id||"",amount:w.payment.amount||0,payment_date:w.payment.payment_date?new Date(w.payment.payment_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],payment_method:w.payment.payment_method||"card",transaction_id:w.payment.transaction_id||"",status:w.payment.status||"completed",notes:w.payment.notes||""}},r=b=>{if(!b)return"";const E=new Date(b);return new Intl.DateTimeFormat("fr-FR").format(E)},h=b=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(b),S=()=>{i("submit",{...x.value})},O=()=>{i("close")};return Ne(()=>w.show,b=>{b&&_()}),Ne(()=>w.payment,()=>{w.show&&_()},{deep:!0}),be(()=>{$()}),(b,E)=>I.show?(N(),L("div",qy,[e("div",{class:"modal-backdrop",onClick:O}),e("div",By,[e("div",jy,[e("h3",null,s(C.value),1),e("button",{class:"close-btn",onClick:O},E[7]||(E[7]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",Gy,[e("form",{onSubmit:Se(S,["prevent"])},[e("div",zy,[e("label",Hy,s(b.$t("payments.columns.invoice")),1),H(e("select",{id:"invoice_id","onUpdate:modelValue":E[0]||(E[0]=P=>x.value.invoice_id=P),class:"form-select",disabled:m.value||n.value,required:""},[e("option",Ky,s(b.$t("common.select")),1),(N(!0),L(ae,null,le(v.value,P=>(N(),L("option",{key:P.id,value:P.id},s(P.id)+" - "+s(P.client_name)+" ("+s(h(P.amount))+") ",9,Jy))),128))],8,Wy),[[pe,x.value.invoice_id]])]),e("div",Qy,[e("label",Yy,s(b.$t("payments.columns.amount")),1),H(e("input",{type:"number",id:"amount","onUpdate:modelValue":E[1]||(E[1]=P=>x.value.amount=P),class:"form-control",disabled:m.value||n.value,step:"0.01",min:"0",required:""},null,8,Xy),[[ee,x.value.amount]])]),e("div",Zy,[e("label",e1,s(b.$t("payments.columns.date")),1),H(e("input",{type:"date",id:"payment_date","onUpdate:modelValue":E[2]||(E[2]=P=>x.value.payment_date=P),class:"form-control",disabled:m.value||n.value,required:""},null,8,t1),[[ee,x.value.payment_date]])]),e("div",s1,[e("label",o1,s(b.$t("payments.columns.method")),1),H(e("select",{id:"payment_method","onUpdate:modelValue":E[3]||(E[3]=P=>x.value.payment_method=P),class:"form-select",disabled:m.value||n.value,required:""},[e("option",i1,s(b.$t("payments.methods.card")),1),e("option",r1,s(b.$t("payments.methods.bank_transfer")),1),e("option",a1,s(b.$t("payments.methods.paypal")),1),e("option",l1,s(b.$t("payments.methods.cash")),1),e("option",c1,s(b.$t("payments.methods.check")),1)],8,n1),[[pe,x.value.payment_method]])]),e("div",u1,[e("label",d1,s(b.$t("payments.columns.transaction_id")),1),H(e("input",{type:"text",id:"transaction_id","onUpdate:modelValue":E[4]||(E[4]=P=>x.value.transaction_id=P),class:"form-control",disabled:m.value||n.value},null,8,p1),[[ee,x.value.transaction_id]]),e("small",f1,s(b.$t("payments.fields.transaction_id_help")),1)]),y.value?J("",!0):(N(),L("div",v1,[e("label",m1,s(b.$t("payments.columns.status")),1),H(e("select",{id:"status","onUpdate:modelValue":E[5]||(E[5]=P=>x.value.status=P),class:"form-select",disabled:m.value||n.value},[e("option",g1,s(b.$t("payments.status.completed")),1),e("option",_1,s(b.$t("payments.status.pending")),1),e("option",y1,s(b.$t("payments.status.failed")),1),e("option",b1,s(b.$t("payments.status.refunded")),1)],8,h1),[[pe,x.value.status]])])),e("div",$1,[e("label",S1,s(b.$t("payments.columns.notes")),1),H(e("textarea",{id:"notes","onUpdate:modelValue":E[6]||(E[6]=P=>x.value.notes=P),class:"form-control",disabled:m.value||n.value,rows:"3"},null,8,w1),[[ee,x.value.notes]])]),m.value?(N(),L("div",k1,[e("label",null,s(b.$t("payments.columns.created_at")),1),e("p",null,s(r(I.payment.created_at)),1)])):J("",!0),e("div",C1,[m.value?J("",!0):(N(),L("button",{key:0,type:"submit",class:"btn btn-primary",disabled:n.value},[n.value?(N(),L("span",E1,[E[8]||(E[8]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),ne(" "+s(b.$t("common.loading")),1)])):(N(),L("span",O1,s(b.$t("common.save")),1))],8,A1)),e("button",{type:"button",class:"btn btn-secondary",onClick:O,disabled:n.value},s(m.value?b.$t("common.close"):b.$t("common.cancel")),9,T1)])],32)])])])):J("",!0)}}),x1=$e(R1,[["__scopeId","data-v-baa74c3d"]]),I1={class:"payments-view view-container"},P1={class:"header-box"},M1={class:"page-title"},D1={class:"page-description"},N1={class:"filter-box"},L1={class:"filter-grid"},U1={class:"filter-group"},V1={class:"filter-label"},F1={class:"filter-input-wrapper"},q1=["placeholder"],B1={class:"filter-group"},j1={class:"filter-label"},G1={class:"filter-input-wrapper"},z1=["value"],H1={class:"filter-group"},W1={class:"filter-label"},K1={class:"filter-input-wrapper"},J1={value:""},Q1={value:"card"},Y1={value:"bank_transfer"},X1={value:"paypal"},Z1={class:"filter-group"},eb={class:"filter-input-wrapper"},tb={class:"table-box"},sb={key:0,class:"payments-table"},ob={class:"actions-cell"},nb=["onClick"],ib=["onClick"],rb=["onClick"],ab={key:1,class:"loading-container"},lb={key:2,class:"empty-state"},cb={class:"modal-box"},es=_e({__name:"PaymentsView",setup(I){const{t}=we(),w=Fy(),i=z(!1),u=z("create"),v=z(null),n=z("all"),x=z(""),y=z(""),A=X(()=>w.loading),m=X(()=>[{value:"all",label:t("payments.filters.all")},{value:"completed",label:t("payments.filters.completed")},{value:"pending",label:t("payments.filters.pending")},{value:"refunded",label:t("payments.filters.refunded")},{value:"failed",label:t("payments.filters.failed")}]),C=X(()=>{let l=w.payments;if(n.value!=="all"&&(l=l.filter(g=>g.status===n.value)),y.value&&(l=l.filter(g=>g.method===y.value)),x.value.trim()){const g=x.value.toLowerCase();l=l.filter(R=>String(R.id).includes(g)||R.client_name&&R.client_name.toLowerCase().includes(g)||String(R.invoice_id).includes(g))}return l}),$=l=>l==="all"?w.payments.length:w.payments.filter(g=>g.status===l).length,_=l=>l?new Date(l).toLocaleDateString("fr-FR"):"",r=l=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(l),h=l=>({card:t("payments.methods.card"),bank_transfer:t("payments.methods.bankTransfer"),paypal:t("payments.methods.paypal"),cash:t("payments.methods.cash")})[l]||l,S=l=>({completed:t("payments.statuses.completed"),pending:t("payments.statuses.pending"),refunded:t("payments.statuses.refunded"),failed:t("payments.statuses.failed")})[l]||l,O=()=>{v.value=null,u.value="create",i.value=!0},b=l=>{v.value=l,u.value="edit",i.value=!0},E=l=>{v.value=l,u.value="view",i.value=!0},P=l=>{v.value=l,u.value="refund",i.value=!0},f=()=>{i.value=!1},p=()=>{w.fetchPayments()},a=()=>{w.fetchPayments()},o=()=>{w.fetchPayments()},d=()=>{};return be(async()=>{console.log("PaymentsView - Chargement des données"),await w.fetchPayments()}),(l,g)=>(N(),L("div",I1,[e("div",P1,[e("div",null,[e("h1",M1,s(l.$t("payments.title")),1),e("span",D1,s(l.$t("payments.description")),1)]),e("button",{class:"btn btn-primary",onClick:O},[g[3]||(g[3]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(l.$t("payments.actions.add")),1)])]),e("div",N1,[e("div",L1,[e("div",U1,[e("label",V1,s(l.$t("payments.filters.search")),1),e("div",F1,[g[4]||(g[4]=e("i",{class:"fas fa-search"},null,-1)),H(e("input",{type:"text","onUpdate:modelValue":g[0]||(g[0]=R=>x.value=R),class:"filter-input",placeholder:l.$t("payments.search.placeholder")},null,8,q1),[[ee,x.value]])])]),e("div",B1,[e("label",j1,s(l.$t("payments.filters.status")),1),e("div",G1,[g[5]||(g[5]=e("i",{class:"fas fa-money-bill-wave"},null,-1)),H(e("select",{"onUpdate:modelValue":g[1]||(g[1]=R=>n.value=R),class:"filter-input"},[(N(!0),L(ae,null,le(m.value,R=>(N(),L("option",{key:R.value,value:R.value},s(R.label)+" ("+s($(R.value))+") ",9,z1))),128))],512),[[pe,n.value]])])]),e("div",H1,[e("label",W1,s(l.$t("payments.filters.payment_method")),1),e("div",K1,[g[6]||(g[6]=e("i",{class:"fas fa-credit-card"},null,-1)),H(e("select",{"onUpdate:modelValue":g[2]||(g[2]=R=>y.value=R),class:"filter-input"},[e("option",J1,s(l.$t("payments.filters.all_methods")),1),e("option",Q1,s(l.$t("payments.methods.card")),1),e("option",Y1,s(l.$t("payments.methods.bank_transfer")),1),e("option",X1,s(l.$t("payments.methods.paypal")),1)],512),[[pe,y.value]])])]),e("div",Z1,[g[8]||(g[8]=e("label",{class:"filter-label"}," ",-1)),e("div",eb,[e("button",{onClick:d,class:"btn btn-gradient filter-button"},[g[7]||(g[7]=e("i",{class:"fas fa-filter"},null,-1)),ne(" "+s(l.$t("payments.filters.apply")),1)])])])])]),e("div",tb,[!A.value&&C.value.length>0?(N(),L("table",sb,[e("thead",null,[e("tr",null,[e("th",null,s(l.$t("payments.table.id")),1),e("th",null,s(l.$t("payments.table.client")),1),e("th",null,s(l.$t("payments.table.invoice")),1),e("th",null,s(l.$t("payments.table.date")),1),e("th",null,s(l.$t("payments.table.amount")),1),e("th",null,s(l.$t("payments.table.method")),1),e("th",null,s(l.$t("payments.table.status")),1),e("th",null,s(l.$t("payments.table.actions")),1)])]),e("tbody",null,[(N(!0),L(ae,null,le(C.value,R=>(N(),L("tr",{key:R.id},[e("td",null,s(R.id),1),e("td",null,s(R.client_name),1),e("td",null,s(R.invoice_id),1),e("td",null,s(_(R.date)),1),e("td",null,s(r(R.amount)),1),e("td",null,s(h(R.method)),1),e("td",null,[e("span",{class:se(["status-badge",R.status])},s(S(R.status)),3)]),e("td",ob,[e("button",{class:"action-btn view-btn",onClick:k=>E(R.id),title:"Voir"},g[9]||(g[9]=[e("i",{class:"fas fa-eye"},null,-1)]),8,nb),e("button",{class:"action-btn edit-btn",onClick:k=>b(R.id),title:"Modifier"},g[10]||(g[10]=[e("i",{class:"fas fa-edit"},null,-1)]),8,ib),R.status==="completed"?(N(),L("button",{key:0,class:"action-btn refund-btn",onClick:k=>P(R.id),title:"Rembourser"},g[11]||(g[11]=[e("i",{class:"fas fa-undo"},null,-1)]),8,rb)):J("",!0)])]))),128))])])):A.value?(N(),L("div",ab,[g[12]||(g[12]=e("div",{class:"spinner"},null,-1)),e("p",null,s(l.$t("common.loading")),1)])):(N(),L("div",lb,[g[13]||(g[13]=e("i",{class:"fas fa-money-bill-wave empty-icon"},null,-1)),e("h3",null,s(l.$t("payments.empty.title")),1),e("p",null,s(l.$t("payments.empty.message")),1),e("button",{class:"btn btn-primary",onClick:O},s(l.$t("payments.actions.add")),1)]))]),i.value?(N(),L("div",{key:0,class:"modal-backdrop",onClick:Se(f,["self"])},[e("div",cb,[Ce(x1,{"payment-id":v.value,mode:u.value,onClose:f,onCreated:p,onUpdated:a,onRefunded:o,onEdit:b},null,8,["payment-id","mode"])])])):J("",!0)]))}}),ts=Pe("subscriptions",{state:()=>({subscriptions:[],currentSubscription:null,loading:!1,error:null}),getters:{getSubscriptionById:I=>t=>I.subscriptions.find(w=>w.id===t)||null,getSubscriptionsByStatus:I=>t=>t==="all"?I.subscriptions:I.subscriptions.filter(w=>w.status===t),getActiveSubscriptions:I=>I.subscriptions.filter(t=>t.status==="active"),getExpiringSoonSubscriptions:I=>{const t=new Date,w=new Date;return w.setDate(t.getDate()+30),I.subscriptions.filter(i=>{if(i.status!=="active"||!i.renewal_date)return!1;const u=new Date(i.renewal_date);return u>=t&&u<=w})}},actions:{async fetchSubscriptions(){var I,t;this.loading=!0,this.error=null;try{const w=await me.get("/api/v1/subscriptions");w.data&&w.data.subscriptions?this.subscriptions=w.data.subscriptions:this.subscriptions=[]}catch(w){this.error=((t=(I=w.response)==null?void 0:I.data)==null?void 0:t.message)||"Erreur lors de la récupération des abonnements",de().addNotification(this.error,"error")}finally{this.loading=!1}},async fetchSubscription(I){var t,w;this.loading=!0,this.error=null;try{const i=await me.get(`/api/v1/subscriptions/${I}`);if(i.data&&i.data.subscription){this.currentSubscription=i.data.subscription;const u=this.subscriptions.findIndex(v=>v.id===I);u!==-1&&(this.subscriptions[u]=i.data.subscription)}}catch(i){this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||`Erreur lors de la récupération de l'abonnement #${I}`,de().addNotification(this.error,"error")}finally{this.loading=!1}},async createSubscription(I){var t,w;this.loading=!0,this.error=null;try{const i=await me.post("/api/v1/subscriptions",I);if(i.data&&i.data.subscription)return this.subscriptions.push(i.data.subscription),de().addNotification("Abonnement créé avec succès","success"),i.data.subscription}catch(i){return this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||"Erreur lors de la création de l'abonnement",de().addNotification(this.error,"error"),null}finally{this.loading=!1}},async updateSubscription(I){var t,w;if(!I.id)return this.error="ID d'abonnement manquant",de().addNotification(this.error,"error"),null;this.loading=!0,this.error=null;try{const i=await me.put(`/api/v1/subscriptions/${I.id}`,I);if(i.data&&i.data.subscription){const u=this.subscriptions.findIndex(v=>v.id===I.id);return u!==-1&&(this.subscriptions[u]=i.data.subscription),this.currentSubscription&&this.currentSubscription.id===I.id&&(this.currentSubscription=i.data.subscription),de().addNotification("Abonnement mis à jour avec succès","success"),i.data.subscription}}catch(i){return this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||"Erreur lors de la mise à jour de l'abonnement",de().addNotification(this.error,"error"),null}finally{this.loading=!1}},async cancelSubscription(I,t=""){var w,i;this.loading=!0,this.error=null;try{const u=await me.post(`/api/v1/subscriptions/${I}/cancel`,{reason:t});if(u.data&&u.data.subscription){const v=this.subscriptions.findIndex(n=>n.id===I);return v!==-1&&(this.subscriptions[v]=u.data.subscription),this.currentSubscription&&this.currentSubscription.id===I&&(this.currentSubscription=u.data.subscription),de().addNotification("Abonnement annulé avec succès","success"),u.data.subscription}}catch(u){return this.error=((i=(w=u.response)==null?void 0:w.data)==null?void 0:i.message)||"Erreur lors de l'annulation de l'abonnement",de().addNotification(this.error,"error"),null}finally{this.loading=!1}},async renewSubscription(I){var t,w;this.loading=!0,this.error=null;try{const i=await me.post(`/api/v1/subscriptions/${I}/renew`);if(i.data&&i.data.subscription){const u=this.subscriptions.findIndex(v=>v.id===I);return u!==-1&&(this.subscriptions[u]=i.data.subscription),this.currentSubscription&&this.currentSubscription.id===I&&(this.currentSubscription=i.data.subscription),de().addNotification("Abonnement renouvelé avec succès","success"),i.data.subscription}}catch(i){return this.error=((w=(t=i.response)==null?void 0:t.data)==null?void 0:w.message)||"Erreur lors du renouvellement de l'abonnement",de().addNotification(this.error,"error"),null}finally{this.loading=!1}}}}),ub={class:"modal-container"},db={class:"modal-header"},pb={class:"modal-body"},fb={class:"form-group"},vb=["disabled"],mb=["value"],hb={class:"form-group"},gb=["value"],_b={class:"form-group"},yb={class:"form-group"},bb={class:"form-group"},$b={class:"form-group"},Sb={class:"form-group"},wb={class:"form-group form-check"},kb={class:"form-group"},Cb={class:"form-actions"},Ab={type:"submit",class:"btn btn-primary"},Eb={key:1,class:"subscription-details"},Ob={class:"detail-row"},Tb={class:"detail-value"},Rb={class:"detail-row"},xb={class:"detail-value"},Ib={class:"detail-row"},Pb={class:"detail-value"},Mb={class:"detail-row"},Db={class:"detail-value"},Nb={class:"detail-row"},Lb={class:"detail-value"},Ub={class:"detail-row"},Vb={class:"detail-value"},Fb={class:"detail-row"},qb={class:"detail-value"},Bb={class:"detail-row"},jb={class:"detail-value"},Gb={class:"detail-row"},zb={class:"detail-value"},Hb={class:"detail-row"},Wb={class:"detail-value"},Kb={class:"detail-row"},Jb={class:"detail-value"},Qb={key:0,class:"detail-row"},Yb={class:"detail-value"},Xb={class:"form-actions"},Zb={key:0,class:"confirmation-modal"},e0={class:"confirmation-content"},t0={class:"form-group"},s0={class:"confirmation-actions"},o0=_e({__name:"SubscriptionModal",props:{subscriptionId:{type:Number,default:null},mode:{type:String,default:"create",validator:I=>["create","edit","view"].includes(I)}},emits:["close","created","updated","cancelled","renewed"],setup(I,{emit:t}){const w=I,i=t,u=ts(),v=ze(),n=Fe(),x=z({id:null,client_id:"",product_id:"",start_date:new Date().toISOString().split("T")[0],end_date:"",price:0,billing_cycle:"monthly",status:"active",auto_renew:!0,notes:""}),y=z(!1),A=z(""),m=X(()=>w.mode==="edit"),C=X(()=>w.mode==="view"),$=X(()=>v.clients),_=X(()=>n.products),r=X(()=>u.currentSubscription||{}),h=o=>o?new Date(o).toLocaleDateString("fr-FR"):"",S=o=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(o),O=o=>({monthly:"Mensuel",quarterly:"Trimestriel",semi_annual:"Semestriel",annual:"Annuel"})[o]||o,b=o=>({active:"Actif",pending:"En attente",cancelled:"Annulé",expired:"Expiré"})[o]||o,E=async()=>{if(w.subscriptionId&&(await u.fetchSubscription(w.subscriptionId),u.currentSubscription)){const o=u.currentSubscription;x.value={id:o.id,client_id:o.client_id,product_id:o.product_id,start_date:o.start_date.split("T")[0],end_date:o.end_date?o.end_date.split("T")[0]:"",price:o.price,billing_cycle:o.billing_cycle,status:o.status,auto_renew:o.auto_renew,notes:o.notes||""}}},P=async()=>{if(m.value&&x.value.id){const o=await u.updateSubscription(x.value);o&&(i("updated",o),i("close"))}else{const o=await u.createSubscription(x.value);o&&(i("created",o),i("close"))}},f=async()=>{if(w.subscriptionId&&A.value.trim()){const o=await u.cancelSubscription(w.subscriptionId,A.value);o&&(i("cancelled",o),y.value=!1,i("close"))}},p=async()=>{if(w.subscriptionId){const o=await u.renewSubscription(w.subscriptionId);o&&(i("renewed",o),i("close"))}},a=()=>{i("close"),i("edit",w.subscriptionId)};return be(async()=>{v.clients.length||await v.fetchClients(),n.products.length||await n.fetchProducts(),w.mode!=="create"&&await E()}),Ne(()=>w.subscriptionId,async o=>{o&&(m.value||C.value)&&await E()}),(o,d)=>(N(),L("div",ub,[e("div",db,[e("h3",null,s(m.value?"Modifier l'abonnement":C.value?"Détails de l'abonnement":"Nouvel abonnement"),1),e("button",{class:"close-btn",onClick:d[0]||(d[0]=l=>o.$emit("close"))},"×")]),e("div",pb,[C.value?J("",!0):(N(),L("form",{key:0,onSubmit:Se(P,["prevent"])},[e("div",fb,[d[16]||(d[16]=e("label",{for:"client"},"Client",-1)),H(e("select",{id:"client","onUpdate:modelValue":d[1]||(d[1]=l=>x.value.client_id=l),class:"form-control",disabled:m.value,required:""},[d[15]||(d[15]=e("option",{value:""},"Sélectionner un client",-1)),(N(!0),L(ae,null,le($.value,l=>(N(),L("option",{key:l.id,value:l.id},s(l.firstname)+" "+s(l.lastname)+" ("+s(l.email)+") ",9,mb))),128))],8,vb),[[pe,x.value.client_id]])]),e("div",hb,[d[18]||(d[18]=e("label",{for:"product"},"Produit",-1)),H(e("select",{id:"product","onUpdate:modelValue":d[2]||(d[2]=l=>x.value.product_id=l),class:"form-control",required:""},[d[17]||(d[17]=e("option",{value:""},"Sélectionner un produit",-1)),(N(!0),L(ae,null,le(_.value,l=>(N(),L("option",{key:l.id,value:l.id},s(l.name),9,gb))),128))],512),[[pe,x.value.product_id]])]),e("div",_b,[d[19]||(d[19]=e("label",{for:"start_date"},"Date de début",-1)),H(e("input",{type:"date",id:"start_date","onUpdate:modelValue":d[3]||(d[3]=l=>x.value.start_date=l),class:"form-control",required:""},null,512),[[ee,x.value.start_date]])]),e("div",yb,[d[20]||(d[20]=e("label",{for:"end_date"},"Date de fin (optionnel)",-1)),H(e("input",{type:"date",id:"end_date","onUpdate:modelValue":d[4]||(d[4]=l=>x.value.end_date=l),class:"form-control"},null,512),[[ee,x.value.end_date]])]),e("div",bb,[d[21]||(d[21]=e("label",{for:"price"},"Prix",-1)),H(e("input",{type:"number",id:"price","onUpdate:modelValue":d[5]||(d[5]=l=>x.value.price=l),class:"form-control",step:"0.01",min:"0",required:""},null,512),[[ee,x.value.price]])]),e("div",$b,[d[23]||(d[23]=e("label",{for:"billing_cycle"},"Cycle de facturation",-1)),H(e("select",{id:"billing_cycle","onUpdate:modelValue":d[6]||(d[6]=l=>x.value.billing_cycle=l),class:"form-control",required:""},d[22]||(d[22]=[e("option",{value:"monthly"},"Mensuel",-1),e("option",{value:"quarterly"},"Trimestriel",-1),e("option",{value:"semi_annual"},"Semestriel",-1),e("option",{value:"annual"},"Annuel",-1)]),512),[[pe,x.value.billing_cycle]])]),e("div",Sb,[d[25]||(d[25]=e("label",{for:"status"},"Statut",-1)),H(e("select",{id:"status","onUpdate:modelValue":d[7]||(d[7]=l=>x.value.status=l),class:"form-control",required:""},d[24]||(d[24]=[e("option",{value:"active"},"Actif",-1),e("option",{value:"pending"},"En attente",-1),e("option",{value:"cancelled"},"Annulé",-1),e("option",{value:"expired"},"Expiré",-1)]),512),[[pe,x.value.status]])]),e("div",wb,[H(e("input",{type:"checkbox",id:"auto_renew","onUpdate:modelValue":d[8]||(d[8]=l=>x.value.auto_renew=l),class:"form-check-input"},null,512),[[ye,x.value.auto_renew]]),d[26]||(d[26]=e("label",{class:"form-check-label",for:"auto_renew"},"Renouvellement automatique",-1))]),e("div",kb,[d[27]||(d[27]=e("label",{for:"notes"},"Notes",-1)),H(e("textarea",{id:"notes","onUpdate:modelValue":d[9]||(d[9]=l=>x.value.notes=l),class:"form-control",rows:"3"},null,512),[[ee,x.value.notes]])]),e("div",Cb,[e("button",{type:"button",class:"btn btn-secondary",onClick:d[10]||(d[10]=l=>o.$emit("close"))},"Annuler"),e("button",Ab,s(m.value?"Mettre à jour":"Créer"),1)])],32)),C.value?(N(),L("div",Eb,[e("div",Ob,[d[28]||(d[28]=e("div",{class:"detail-label"},"Client:",-1)),e("div",Tb,s(r.value.client_name),1)]),e("div",Rb,[d[29]||(d[29]=e("div",{class:"detail-label"},"Produit:",-1)),e("div",xb,s(r.value.product_name),1)]),e("div",Ib,[d[30]||(d[30]=e("div",{class:"detail-label"},"Date de début:",-1)),e("div",Pb,s(h(r.value.start_date)),1)]),e("div",Mb,[d[31]||(d[31]=e("div",{class:"detail-label"},"Date de fin:",-1)),e("div",Db,s(r.value.end_date?h(r.value.end_date):"N/A"),1)]),e("div",Nb,[d[32]||(d[32]=e("div",{class:"detail-label"},"Date de renouvellement:",-1)),e("div",Lb,s(r.value.renewal_date?h(r.value.renewal_date):"N/A"),1)]),e("div",Ub,[d[33]||(d[33]=e("div",{class:"detail-label"},"Prix:",-1)),e("div",Vb,s(S(r.value.price)),1)]),e("div",Fb,[d[34]||(d[34]=e("div",{class:"detail-label"},"Cycle de facturation:",-1)),e("div",qb,s(O(r.value.billing_cycle)),1)]),e("div",Bb,[d[35]||(d[35]=e("div",{class:"detail-label"},"Statut:",-1)),e("div",jb,[e("span",{class:se("status-badge "+r.value.status)},s(b(r.value.status)),3)])]),e("div",Gb,[d[36]||(d[36]=e("div",{class:"detail-label"},"Renouvellement automatique:",-1)),e("div",zb,s(r.value.auto_renew?"Oui":"Non"),1)]),e("div",Hb,[d[37]||(d[37]=e("div",{class:"detail-label"},"Notes:",-1)),e("div",Wb,s(r.value.notes||"Aucune note"),1)]),e("div",Kb,[d[38]||(d[38]=e("div",{class:"detail-label"},"Créé le:",-1)),e("div",Jb,s(h(r.value.created_at)),1)]),r.value.updated_at?(N(),L("div",Qb,[d[39]||(d[39]=e("div",{class:"detail-label"},"Mis à jour le:",-1)),e("div",Yb,s(h(r.value.updated_at)),1)])):J("",!0),e("div",Xb,[e("button",{type:"button",class:"btn btn-secondary",onClick:d[11]||(d[11]=l=>o.$emit("close"))},"Fermer"),r.value.status==="active"?(N(),L("button",{key:0,type:"button",class:"btn btn-danger",onClick:d[12]||(d[12]=l=>y.value=!0)}," Annuler l'abonnement ")):J("",!0),r.value.status!=="active"?(N(),L("button",{key:1,type:"button",class:"btn btn-success",onClick:p}," Renouveler ")):J("",!0),e("button",{type:"button",class:"btn btn-primary",onClick:a}," Modifier ")])])):J("",!0)]),y.value?(N(),L("div",Zb,[e("div",e0,[d[41]||(d[41]=e("h4",null,"Confirmer l'annulation",-1)),d[42]||(d[42]=e("p",null,"Êtes-vous sûr de vouloir annuler cet abonnement ?",-1)),e("div",t0,[d[40]||(d[40]=e("label",{for:"cancel_reason"},"Raison de l'annulation",-1)),H(e("textarea",{id:"cancel_reason","onUpdate:modelValue":d[13]||(d[13]=l=>A.value=l),class:"form-control",rows:"3",required:""},null,512),[[ee,A.value]])]),e("div",s0,[e("button",{type:"button",class:"btn btn-secondary",onClick:d[14]||(d[14]=l=>y.value=!1)},"Non"),e("button",{type:"button",class:"btn btn-danger",onClick:f},"Oui, annuler")])])])):J("",!0)]))}}),n0=$e(o0,[["__scopeId","data-v-2f387adc"]]),i0={class:"subscriptions-view view-container"},r0={class:"header-box"},a0={class:"page-title"},l0={class:"page-description"},c0={class:"filter-box"},u0={class:"filter-grid"},d0={class:"filter-group"},p0={class:"filter-label"},f0={class:"filter-input-wrapper"},v0=["placeholder"],m0={class:"filter-group"},h0={class:"filter-label"},g0={class:"filter-input-wrapper"},_0=["value"],y0={class:"filter-group"},b0={class:"filter-label"},$0={class:"filter-input-wrapper"},S0={value:""},w0={value:"monthly"},k0={value:"quarterly"},C0={value:"semi_annual"},A0={value:"annual"},E0={class:"filter-group"},O0={class:"filter-input-wrapper"},T0={class:"table-box"},R0={key:0,class:"subscriptions-table"},x0={class:"actions-cell"},I0=["onClick"],P0=["onClick"],M0=["onClick"],D0=["onClick"],N0={key:1,class:"loading-container"},L0={key:2,class:"empty-state"},U0={class:"modal-box"},ss=_e({__name:"SubscriptionsView",setup(I){const{t}=we(),w=ts(),i=z(!1),u=z("create"),v=z(null),n=z("all"),x=z(""),y=z(""),A=X(()=>w.loading),m=X(()=>[{value:"all",label:t("subscriptions.filters.all")},{value:"active",label:t("subscriptions.filters.active")},{value:"pending",label:t("subscriptions.filters.pending")},{value:"cancelled",label:t("subscriptions.filters.cancelled")},{value:"expired",label:t("subscriptions.filters.expired")}]),C=X(()=>{let R=w.subscriptions;if(n.value!=="all"&&(R=R.filter(k=>k.status===n.value)),x.value.trim()){const k=x.value.toLowerCase();R=R.filter(T=>String(T.id).includes(k)||T.client_name&&T.client_name.toLowerCase().includes(k)||T.product_name&&T.product_name.toLowerCase().includes(k))}return y.value&&(R=R.filter(k=>k.billing_cycle===y.value)),R}),$=R=>R==="all"?w.subscriptions.length:w.subscriptions.filter(k=>k.status===R).length,_=R=>R?new Date(R).toLocaleDateString("fr-FR"):"",r=R=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(R),h=R=>({monthly:t("subscriptions.billingCycles.monthly"),quarterly:t("subscriptions.billingCycles.quarterly"),semi_annual:t("subscriptions.billingCycles.semiAnnual"),annual:t("subscriptions.billingCycles.annual")})[R]||R,S=R=>({active:t("subscriptions.statuses.active"),pending:t("subscriptions.statuses.pending"),cancelled:t("subscriptions.statuses.cancelled"),expired:t("subscriptions.statuses.expired")})[R]||R,O=()=>{v.value=null,u.value="create",i.value=!0},b=R=>{v.value=R,u.value="edit",i.value=!0},E=R=>{v.value=R,u.value="view",i.value=!0},P=R=>{v.value=R,u.value="view",i.value=!0},f=()=>{i.value=!1},p=()=>{w.fetchSubscriptions()},a=()=>{w.fetchSubscriptions()},o=()=>{w.fetchSubscriptions()},d=async R=>{await w.renewSubscription(R),w.fetchSubscriptions()},l=()=>{w.fetchSubscriptions()},g=()=>{};return be(async()=>{await w.fetchSubscriptions()}),(R,k)=>(N(),L("div",i0,[e("div",r0,[e("div",null,[e("h1",a0,s(R.$t("subscriptions.title")),1),e("span",l0,s(R.$t("subscriptions.description")),1)]),e("button",{class:"btn btn-primary",onClick:O},[k[3]||(k[3]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(R.$t("subscriptions.actions.add")),1)])]),e("div",c0,[e("div",u0,[e("div",d0,[e("label",p0,s(R.$t("subscriptions.filters.search")),1),e("div",f0,[k[4]||(k[4]=e("i",{class:"fas fa-search"},null,-1)),H(e("input",{type:"text","onUpdate:modelValue":k[0]||(k[0]=T=>x.value=T),class:"filter-input",placeholder:R.$t("subscriptions.search.placeholder")},null,8,v0),[[ee,x.value]])])]),e("div",m0,[e("label",h0,s(R.$t("subscriptions.filters.status")),1),e("div",g0,[k[5]||(k[5]=e("i",{class:"fas fa-sync-alt"},null,-1)),H(e("select",{"onUpdate:modelValue":k[1]||(k[1]=T=>n.value=T),class:"filter-input"},[(N(!0),L(ae,null,le(m.value,T=>(N(),L("option",{key:T.value,value:T.value},s(T.label)+" ("+s($(T.value))+") ",9,_0))),128))],512),[[pe,n.value]])])]),e("div",y0,[e("label",b0,s(R.$t("subscriptions.filters.billing_cycle")),1),e("div",$0,[k[6]||(k[6]=e("i",{class:"fas fa-calendar-alt"},null,-1)),H(e("select",{"onUpdate:modelValue":k[2]||(k[2]=T=>y.value=T),class:"filter-input"},[e("option",S0,s(R.$t("subscriptions.filters.all_cycles")),1),e("option",w0,s(R.$t("subscriptions.billingCycles.monthly")),1),e("option",k0,s(R.$t("subscriptions.billingCycles.quarterly")),1),e("option",C0,s(R.$t("subscriptions.billingCycles.semiAnnual")),1),e("option",A0,s(R.$t("subscriptions.billingCycles.annual")),1)],512),[[pe,y.value]])])]),e("div",E0,[k[8]||(k[8]=e("label",{class:"filter-label"}," ",-1)),e("div",O0,[e("button",{onClick:g,class:"btn btn-gradient filter-button"},[k[7]||(k[7]=e("i",{class:"fas fa-filter"},null,-1)),ne(" "+s(R.$t("subscriptions.filters.apply")),1)])])])])]),e("div",T0,[!A.value&&C.value.length>0?(N(),L("table",R0,[e("thead",null,[e("tr",null,[e("th",null,s(R.$t("subscriptions.table.id")),1),e("th",null,s(R.$t("subscriptions.table.client")),1),e("th",null,s(R.$t("subscriptions.table.product")),1),e("th",null,s(R.$t("subscriptions.table.startDate")),1),e("th",null,s(R.$t("subscriptions.table.renewalDate")),1),e("th",null,s(R.$t("subscriptions.table.price")),1),e("th",null,s(R.$t("subscriptions.table.billingCycle")),1),e("th",null,s(R.$t("subscriptions.table.status")),1),e("th",null,s(R.$t("subscriptions.table.actions")),1)])]),e("tbody",null,[(N(!0),L(ae,null,le(C.value,T=>(N(),L("tr",{key:T.id},[e("td",null,s(T.id),1),e("td",null,s(T.client_name),1),e("td",null,s(T.product_name),1),e("td",null,s(_(T.start_date)),1),e("td",null,s(T.renewal_date?_(T.renewal_date):"-"),1),e("td",null,s(r(T.price)),1),e("td",null,s(h(T.billing_cycle)),1),e("td",null,[e("span",{class:se(["status-badge",T.status])},s(S(T.status)),3)]),e("td",x0,[e("button",{class:"action-btn view-btn",onClick:V=>E(T.id),title:"Voir"},k[9]||(k[9]=[e("i",{class:"fas fa-eye"},null,-1)]),8,I0),e("button",{class:"action-btn edit-btn",onClick:V=>b(T.id),title:"Modifier"},k[10]||(k[10]=[e("i",{class:"fas fa-edit"},null,-1)]),8,P0),T.status==="active"?(N(),L("button",{key:0,class:"action-btn cancel-btn",onClick:V=>P(T.id),title:"Annuler"},k[11]||(k[11]=[e("i",{class:"fas fa-ban"},null,-1)]),8,M0)):J("",!0),T.status!=="active"?(N(),L("button",{key:1,class:"action-btn renew-btn",onClick:V=>d(T.id),title:"Renouveler"},k[12]||(k[12]=[e("i",{class:"fas fa-sync"},null,-1)]),8,D0)):J("",!0)])]))),128))])])):A.value?(N(),L("div",N0,[k[13]||(k[13]=e("div",{class:"spinner"},null,-1)),e("p",null,s(R.$t("common.loading")),1)])):(N(),L("div",L0,[k[14]||(k[14]=e("i",{class:"fas fa-calendar-alt empty-icon"},null,-1)),e("h3",null,s(R.$t("subscriptions.empty.title")),1),e("p",null,s(R.$t("subscriptions.empty.message")),1),e("button",{class:"btn btn-primary",onClick:O},s(R.$t("subscriptions.actions.add")),1)]))]),i.value?(N(),L("div",{key:0,class:"modal-backdrop",onClick:Se(f,["self"])},[e("div",U0,[Ce(n0,{"subscription-id":v.value,mode:u.value,onClose:f,onCreated:p,onUpdated:a,onCancelled:o,onRenewed:l,onEdit:b},null,8,["subscription-id","mode"])])])):J("",!0)]))}}),os=Pe("tickets",()=>{const I=z([]),t=z(!1),w=z(null),i=X(()=>I.value),u=X(()=>I.value.filter(h=>h.status==="open")),v=X(()=>I.value.filter(h=>h.priority==="urgent")),n=X(()=>I.value.filter(h=>!h.assignedTo));return{tickets:I,loading:t,error:w,allTickets:i,openTickets:u,urgentTickets:v,unassignedTickets:n,fetchTickets:async()=>{try{t.value=!0;const h=await me.get("/api/v1/tickets");return I.value=h.data.tickets,h.data.tickets}catch(h){throw w.value=h,h}finally{t.value=!1}},getTicket:async h=>{try{return t.value=!0,(await me.get(`/api/v1/tickets/${h}`)).data.ticket}catch(S){throw w.value=S,S}finally{t.value=!1}},createTicket:async h=>{try{t.value=!0;const S=await me.post("/api/v1/tickets",h);return I.value.push(S.data.ticket),S.data.ticket}catch(S){throw w.value=S,S}finally{t.value=!1}},updateTicket:async h=>{try{t.value=!0;const S=await me.put(`/api/v1/tickets/${h.id}`,h),O=I.value.findIndex(b=>b.id===h.id);return O!==-1&&(I.value[O]=S.data.ticket),S.data.ticket}catch(S){throw w.value=S,S}finally{t.value=!1}},deleteTicket:async h=>{try{t.value=!0,await me.delete(`/api/v1/tickets/${h}`),I.value=I.value.filter(S=>S.id!==h)}catch(S){throw w.value=S,S}finally{t.value=!1}},addReply:async(h,S)=>{try{return t.value=!0,(await me.post(`/api/v1/tickets/${h}/replies`,S)).data.ticket}catch(O){throw w.value=O,O}finally{t.value=!1}},closeTicket:async h=>{try{t.value=!0;const S=await me.post(`/api/v1/tickets/${h}/close`),O=I.value.findIndex(b=>b.id===h);return O!==-1&&(I.value[O]=S.data.ticket),S.data.ticket}catch(S){throw w.value=S,S}finally{t.value=!1}},reopenTicket:async h=>{try{t.value=!0;const S=await me.post(`/api/v1/tickets/${h}/reopen`),O=I.value.findIndex(b=>b.id===h);return O!==-1&&(I.value[O]=S.data.ticket),S.data.ticket}catch(S){throw w.value=S,S}finally{t.value=!1}}}}),V0={class:"modal-container"},F0={class:"modal-header"},q0={class:"modal-body"},B0={key:0,class:"ticket-details"},j0={class:"ticket-header"},G0={class:"ticket-id"},z0={class:"ticket-subject"},H0={class:"ticket-meta"},W0={class:"ticket-client"},K0={class:"ticket-date"},J0={class:"ticket-messages"},Q0={key:0},Y0={class:"message-header"},X0={class:"author"},Z0={class:"date"},e$={class:"message-content"},t$={key:1,class:"no-messages"},s$={class:"reply-form"},o$=["placeholder"],n$={class:"form-actions"},i$=["disabled"],r$={class:"form-group"},a$=["disabled"],l$={value:""},c$=["value"],u$={class:"form-group"},d$={class:"form-row"},p$={class:"form-group"},f$={value:"low"},v$={value:"medium"},m$={value:"high"},h$={value:"urgent"},g$={key:0,class:"form-group"},_$={value:"open"},y$={value:"pending"},b$={value:"resolved"},$$={value:"closed"},S$={key:0,class:"form-group"},w$={class:"form-actions"},k$=["disabled"],C$={key:0,class:"fas fa-spinner fa-spin"},A$={__name:"TicketModal",props:{ticket:{type:Object,required:!0},mode:{type:String,default:"create",validator:I=>["create","edit","view"].includes(I)}},emits:["close","created","updated"],setup(I,{emit:t}){const w=I,i=t,{t:u}=we(),v=os(),n=ze(),x=Ge(),y=de(),A=z({...w.ticket}),m=z(!1),C=z(""),$=X(()=>n.clients),_=X(()=>w.mode==="create"?u("tickets.modal.add_title"):w.mode==="edit"?u("tickets.modal.edit_title"):u("tickets.modal.view_title")),r=X(()=>w.mode==="create"?u("tickets.actions.create"):u("tickets.actions.update"));function h(P){if(!P)return"-";const f=new Date(P);return new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(f)}function S(P){return{low:u("tickets.priority.low"),medium:u("tickets.priority.medium"),high:u("tickets.priority.high"),urgent:u("tickets.priority.urgent")}[P]||P}function O(P){return{open:u("tickets.status.open"),pending:u("tickets.status.pending"),closed:u("tickets.status.closed"),resolved:u("tickets.status.resolved")}[P]||P}async function b(){try{m.value=!0,w.mode==="create"?(await v.createTicket(A.value),y.showNotification("success",u("tickets.success.create")),i("created")):(await v.updateTicket(A.value),y.showNotification("success",u("tickets.success.update")),i("updated"))}catch(P){console.error("Error submitting ticket:",P),y.showNotification("error",w.mode==="create"?u("tickets.errors.create"):u("tickets.errors.update"))}finally{m.value=!1}}async function E(){if(C.value.trim())try{m.value=!0,await v.addReply(w.ticket.id,{message:C.value,user_id:x.currentUser.id,user_type:"admin"}),C.value="";const P=await v.getTicket(w.ticket.id);Object.assign(w.ticket,P),y.showNotification("success",u("tickets.success.reply"))}catch(P){console.error("Error submitting reply:",P),y.showNotification("error",u("tickets.errors.reply"))}finally{m.value=!1}}return be(()=>{(w.mode==="create"||w.mode==="edit")&&(A.value={...w.ticket})}),(P,f)=>(N(),L("div",{class:"modal-overlay",onClick:f[8]||(f[8]=Se(p=>P.$emit("close"),["self"]))},[e("div",V0,[e("div",F0,[e("h2",null,s(_.value),1),e("button",{class:"close-btn",onClick:f[0]||(f[0]=p=>P.$emit("close"))},f[9]||(f[9]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",q0,[I.mode==="view"?(N(),L("div",B0,[e("div",j0,[e("div",G0,"#"+s(I.ticket.id),1),e("div",z0,s(I.ticket.subject),1),e("div",H0,[e("span",W0,[f[10]||(f[10]=e("i",{class:"fas fa-user"},null,-1)),ne(" "+s(I.ticket.client_name),1)]),e("span",K0,[f[11]||(f[11]=e("i",{class:"fas fa-calendar-alt"},null,-1)),ne(" "+s(h(I.ticket.created_at)),1)]),e("span",{class:se(["ticket-priority",`priority-${I.ticket.priority}`])},[f[12]||(f[12]=e("i",{class:"fas fa-flag"},null,-1)),ne(" "+s(S(I.ticket.priority)),1)],2),e("span",{class:se(["ticket-status",`status-${I.ticket.status}`])},[f[13]||(f[13]=e("i",{class:"fas fa-circle"},null,-1)),ne(" "+s(O(I.ticket.status)),1)],2)])]),e("div",J0,[I.ticket.replies&&I.ticket.replies.length>0?(N(),L("div",Q0,[(N(!0),L(ae,null,le(I.ticket.replies,p=>(N(),L("div",{key:p.id,class:se(["message",p.user_type])},[e("div",Y0,[e("span",X0,s(p.author_name),1),e("span",Z0,s(h(p.created_at)),1)]),e("div",e$,s(p.message),1)],2))),128))])):(N(),L("div",t$,s(P.$t("tickets.noMessages")),1))]),e("div",s$,[e("h3",null,s(P.$t("tickets.addReply")),1),H(e("textarea",{"onUpdate:modelValue":f[1]||(f[1]=p=>C.value=p),placeholder:P.$t("tickets.replyPlaceholder"),rows:"4",class:"form-control"},null,8,o$),[[ee,C.value]]),e("div",n$,[e("button",{class:"btn btn-primary",onClick:E,disabled:!C.value.trim()||m.value},[f[14]||(f[14]=e("i",{class:"fas fa-paper-plane"},null,-1)),ne(" "+s(P.$t("tickets.sendReply")),1)],8,i$)])])])):(N(),L("form",{key:1,onSubmit:Se(b,["prevent"]),class:"ticket-form"},[e("div",r$,[e("label",null,[ne(s(P.$t("tickets.fields.client"))+" ",1),f[15]||(f[15]=e("span",{class:"required"},"*",-1))]),H(e("select",{"onUpdate:modelValue":f[2]||(f[2]=p=>A.value.client_id=p),class:"form-control",required:"",disabled:I.mode==="edit"},[e("option",l$,s(P.$t("tickets.selectClient")),1),(N(!0),L(ae,null,le($.value,p=>(N(),L("option",{key:p.id,value:p.id},s(p.name),9,c$))),128))],8,a$),[[pe,A.value.client_id]])]),e("div",u$,[e("label",null,[ne(s(P.$t("tickets.fields.subject"))+" ",1),f[16]||(f[16]=e("span",{class:"required"},"*",-1))]),H(e("input",{type:"text","onUpdate:modelValue":f[3]||(f[3]=p=>A.value.subject=p),class:"form-control",required:""},null,512),[[ee,A.value.subject]])]),e("div",d$,[e("div",p$,[e("label",null,s(P.$t("tickets.fields.priority")),1),H(e("select",{"onUpdate:modelValue":f[4]||(f[4]=p=>A.value.priority=p),class:"form-control"},[e("option",f$,s(P.$t("tickets.priority.low")),1),e("option",v$,s(P.$t("tickets.priority.medium")),1),e("option",m$,s(P.$t("tickets.priority.high")),1),e("option",h$,s(P.$t("tickets.priority.urgent")),1)],512),[[pe,A.value.priority]])]),I.mode==="edit"?(N(),L("div",g$,[e("label",null,s(P.$t("tickets.fields.status")),1),H(e("select",{"onUpdate:modelValue":f[5]||(f[5]=p=>A.value.status=p),class:"form-control"},[e("option",_$,s(P.$t("tickets.status.open")),1),e("option",y$,s(P.$t("tickets.status.pending")),1),e("option",b$,s(P.$t("tickets.status.resolved")),1),e("option",$$,s(P.$t("tickets.status.closed")),1)],512),[[pe,A.value.status]])])):J("",!0)]),I.mode==="create"?(N(),L("div",S$,[e("label",null,[ne(s(P.$t("tickets.fields.message"))+" ",1),f[17]||(f[17]=e("span",{class:"required"},"*",-1))]),H(e("textarea",{"onUpdate:modelValue":f[6]||(f[6]=p=>A.value.message=p),class:"form-control",rows:"5",required:""},null,512),[[ee,A.value.message]])])):J("",!0),e("div",w$,[e("button",{type:"button",class:"btn btn-secondary",onClick:f[7]||(f[7]=p=>P.$emit("close"))},s(P.$t("common.cancel")),1),e("button",{type:"submit",class:"btn btn-primary",disabled:m.value},[m.value?(N(),L("i",C$)):J("",!0),ne(" "+s(r.value),1)],8,k$)])],32))])])]))}},E$=$e(A$,[["__scopeId","data-v-56d6b34a"]]),O$={class:"modal-header"},T$={class:"modal-body"},R$={class:"modal-footer"},x$=_e({__name:"Modal",props:{show:{type:Boolean,default:!0},title:{},size:{default:"md"}},emits:["close"],setup(I,{emit:t}){const w=t,i=u=>{u.target===u.currentTarget&&w("close")};return(u,v)=>(N(),We(Rt,{name:"modal"},{default:Ee(()=>[u.show?(N(),L("div",{key:0,class:"modal-backdrop",onClick:i},[e("div",{class:se(["modal-container",`modal-${u.size}`])},[e("div",O$,[e("h3",null,s(u.title),1),e("button",{class:"close-btn",onClick:v[0]||(v[0]=n=>w("close"))},v[2]||(v[2]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",T$,[at(u.$slots,"default",{},void 0,!0)]),e("div",R$,[at(u.$slots,"footer",{},()=>[e("button",{class:"btn btn-secondary",onClick:v[1]||(v[1]=n=>w("close"))}," Fermer ")],!0)])],2)])):J("",!0)]),_:3}))}}),I$=$e(x$,[["__scopeId","data-v-704938b9"]]),P$={class:"tickets-view view-container"},M$={class:"header-box"},D$={class:"page-title"},N$={class:"page-description"},L$={class:"filter-box"},U$={class:"filter-grid"},V$={class:"filter-group"},F$={class:"filter-label"},q$={class:"filter-input-wrapper"},B$=["placeholder"],j$={class:"filter-group"},G$={class:"filter-label"},z$={class:"filter-input-wrapper"},H$=["value"],W$={class:"filter-group"},K$={class:"filter-label"},J$={class:"filter-input-wrapper"},Q$={value:""},Y$={value:"low"},X$={value:"medium"},Z$={value:"high"},eS={value:"urgent"},tS={class:"filter-group"},sS={class:"filter-input-wrapper"},oS={class:"table-box"},nS={key:0,class:"tickets-table"},iS={class:"subject-cell"},rS={class:"actions-cell"},aS=["onClick"],lS=["onClick"],cS=["onClick"],uS=["onClick"],dS=["onClick"],pS={key:1,class:"empty-state"},fS={key:2,class:"loading-container"},ns=_e({__name:"TicketsView",setup(I){const{t}=we(),w=os(),i=ze(),u=de(),v=z(!0),n=z([]),x=z(""),y=z("all"),A=z(""),m=z(!1),C=z("create"),$=z(null),_=z(!1),r=z(null),h=[{value:"all",label:t("tickets.filters.all")},{value:"open",label:t("tickets.filters.open")},{value:"pending",label:t("tickets.filters.pending")},{value:"closed",label:t("tickets.filters.closed")},{value:"resolved",label:t("tickets.filters.resolved")}],S=X(()=>{let U=[...n.value];if(y.value!=="all"&&(U=U.filter(B=>B.status===y.value)),x.value){const B=x.value.toLowerCase();U=U.filter(Q=>Q.subject.toLowerCase().includes(B)||Q.client_name.toLowerCase().includes(B)||Q.id.toString().includes(B))}return A.value&&(U=U.filter(B=>B.priority===A.value)),U}),O=U=>U==="all"?n.value.length:n.value.filter(B=>B.status===U).length,b=U=>{if(!U)return"-";const B=new Date(U);return new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(B)},E=U=>`priority-${U}`,P=U=>`status-${U}`,f=U=>t(`tickets.priority.${U}`),p=U=>t(`tickets.status.${U}`),a=async()=>{v.value=!0;try{const U=await w.fetchTickets();n.value=U}catch(U){console.error("Error fetching tickets:",U),u.addNotification({title:t("common.error"),message:t("tickets.errors.fetch"),type:"error"})}finally{v.value=!1}},o=()=>{$.value=null,C.value="create",m.value=!0},d=U=>{$.value=U,C.value="view",m.value=!0},l=U=>{$.value=U,C.value="edit",m.value=!0},g=()=>{m.value=!1,$.value=null},R=()=>{a(),g(),u.addNotification({title:t("common.success"),message:t("tickets.success.create"),type:"success"})},k=()=>{a(),g(),u.addNotification({title:t("common.success"),message:t("tickets.success.update"),type:"success"})},T=U=>{r.value=U,_.value=!0},V=async()=>{if(r.value)try{await w.deleteTicket(r.value.id),u.addNotification({title:t("common.success"),message:t("tickets.success.delete"),type:"success"}),a()}catch(U){console.error("Error deleting ticket:",U),u.addNotification({title:t("common.error"),message:t("tickets.errors.delete"),type:"error"})}finally{_.value=!1,r.value=null}},F=async U=>{try{await w.closeTicket(U.id),u.addNotification({title:t("common.success"),message:t("tickets.success.close"),type:"success"}),a()}catch(B){console.error("Error closing ticket:",B),u.addNotification({title:t("common.error"),message:t("tickets.errors.close"),type:"error"})}},M=async U=>{try{await w.reopenTicket(U.id),u.addNotification({title:t("common.success"),message:t("tickets.success.reopen"),type:"success"}),a()}catch(B){console.error("Error reopening ticket:",B),u.addNotification({title:t("common.error"),message:t("tickets.errors.reopen"),type:"error"})}},D=()=>{};return be(async()=>{try{await i.fetchClients(),await a()}catch(U){console.error("Error initializing tickets view:",U)}}),(U,B)=>(N(),L("div",P$,[e("div",M$,[e("div",null,[e("h1",D$,s(U.$t("tickets.title")),1),e("span",N$,s(U.$t("tickets.description")),1)]),e("button",{class:"btn btn-primary",onClick:o},[B[4]||(B[4]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(U.$t("tickets.actions.add")),1)])]),e("div",L$,[e("div",U$,[e("div",V$,[e("label",F$,s(U.$t("tickets.filters.search")),1),e("div",q$,[B[5]||(B[5]=e("i",{class:"fas fa-search"},null,-1)),H(e("input",{type:"text","onUpdate:modelValue":B[0]||(B[0]=Q=>x.value=Q),class:"filter-input",placeholder:U.$t("tickets.search.placeholder")},null,8,B$),[[ee,x.value]])])]),e("div",j$,[e("label",G$,s(U.$t("tickets.filters.status")),1),e("div",z$,[B[6]||(B[6]=e("i",{class:"fas fa-ticket-alt"},null,-1)),H(e("select",{"onUpdate:modelValue":B[1]||(B[1]=Q=>y.value=Q),class:"filter-input"},[(N(),L(ae,null,le(h,Q=>e("option",{key:Q.value,value:Q.value},s(Q.label)+" ("+s(O(Q.value))+") ",9,H$)),64))],512),[[pe,y.value]])])]),e("div",W$,[e("label",K$,s(U.$t("tickets.filters.priority")),1),e("div",J$,[B[7]||(B[7]=e("i",{class:"fas fa-flag"},null,-1)),H(e("select",{"onUpdate:modelValue":B[2]||(B[2]=Q=>A.value=Q),class:"filter-input"},[e("option",Q$,s(U.$t("tickets.priority.all")),1),e("option",Y$,s(U.$t("tickets.priority.low")),1),e("option",X$,s(U.$t("tickets.priority.medium")),1),e("option",Z$,s(U.$t("tickets.priority.high")),1),e("option",eS,s(U.$t("tickets.priority.urgent")),1)],512),[[pe,A.value]])])]),e("div",tS,[B[9]||(B[9]=e("label",{class:"filter-label"}," ",-1)),e("div",sS,[e("button",{onClick:D,class:"btn btn-gradient filter-button"},[B[8]||(B[8]=e("i",{class:"fas fa-filter"},null,-1)),ne(" "+s(U.$t("tickets.filters.apply")),1)])])])])]),e("div",oS,[!v.value&&S.value.length>0?(N(),L("table",nS,[e("thead",null,[e("tr",null,[e("th",null,s(U.$t("tickets.table.id")),1),e("th",null,s(U.$t("tickets.table.subject")),1),e("th",null,s(U.$t("tickets.table.client")),1),e("th",null,s(U.$t("tickets.table.priority")),1),e("th",null,s(U.$t("tickets.table.status")),1),e("th",null,s(U.$t("tickets.table.lastReply")),1),e("th",null,s(U.$t("tickets.table.createdAt")),1),e("th",null,s(U.$t("tickets.table.actions")),1)])]),e("tbody",null,[(N(!0),L(ae,null,le(S.value,Q=>(N(),L("tr",{key:Q.id},[e("td",null,"#"+s(Q.id),1),e("td",iS,s(Q.subject),1),e("td",null,s(Q.client_name),1),e("td",null,[e("span",{class:se(["priority-badge",E(Q.priority)])},s(f(Q.priority)),3)]),e("td",null,[e("span",{class:se(["status-badge",P(Q.status)])},s(p(Q.status)),3)]),e("td",null,s(b(Q.last_reply)),1),e("td",null,s(b(Q.created_at)),1),e("td",rS,[e("button",{class:"btn btn-sm btn-info",onClick:te=>d(Q)},B[10]||(B[10]=[e("i",{class:"fas fa-eye"},null,-1)]),8,aS),e("button",{class:"btn btn-sm btn-primary",onClick:te=>l(Q)},B[11]||(B[11]=[e("i",{class:"fas fa-edit"},null,-1)]),8,lS),Q.status==="closed"||Q.status==="resolved"?(N(),L("button",{key:0,class:"btn btn-sm btn-success",onClick:te=>M(Q)},B[12]||(B[12]=[e("i",{class:"fas fa-redo"},null,-1)]),8,cS)):(N(),L("button",{key:1,class:"btn btn-sm btn-warning",onClick:te=>F(Q)},B[13]||(B[13]=[e("i",{class:"fas fa-check"},null,-1)]),8,uS)),e("button",{class:"btn btn-sm btn-danger",onClick:te=>T(Q)},B[14]||(B[14]=[e("i",{class:"fas fa-trash"},null,-1)]),8,dS)])]))),128))])])):!v.value&&S.value.length===0?(N(),L("div",pS,[B[16]||(B[16]=e("i",{class:"fas fa-ticket-alt empty-icon"},null,-1)),e("h3",null,s(U.$t("tickets.empty.message")),1),e("p",null,s(U.$t("tickets.empty.description")),1),e("button",{class:"btn btn-primary",onClick:o},[B[15]||(B[15]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(U.$t("tickets.actions.add")),1)])])):(N(),L("div",fS,[B[17]||(B[17]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),e("p",null,s(U.$t("common.loading")),1)]))]),m.value?(N(),We(E$,{key:0,ticket:$.value,mode:C.value,onClose:g,onCreated:R,onUpdated:k,class:"modal-box"},null,8,["ticket","mode"])):J("",!0),_.value?(N(),We(I$,{key:1,title:U.$t("tickets.confirm.delete.title"),class:"modal-box"},{footer:Ee(()=>[e("button",{class:"btn btn-danger",onClick:V},s(U.$t("common.confirm")),1),e("button",{class:"btn btn-secondary",onClick:B[3]||(B[3]=Q=>_.value=!1)},s(U.$t("common.cancel")),1)]),default:Ee(()=>[e("p",null,s(U.$t("tickets.confirm.delete.message")),1)]),_:1},8,["title"])):J("",!0)]))}}),vS={class:"settings-view view-container"},mS={class:"header-box"},hS={class:"page-description"},gS={key:0,class:"loading-state"},_S={class:"loading-state-text"},yS={key:1,class:"settings-grid"},bS=["onClick"],$S={class:"settings-box-header"},SS={class:"settings-box-icon"},wS={class:"settings-box-title"},kS={key:0,class:"settings-box-badge"},CS={class:"settings-box-description"},AS={class:"settings-box-actions"},ES={class:"btn btn-secondary"},OS=_e({__name:"SettingsView",setup(I){const{t}=we(),w=Te(),i=de(),u=z(!0),v=X(()=>[{id:"general",title:t("settings.general.title"),description:t("settings.general.description"),icon:"fas fa-cog",route:"/settings/general"},{id:"notifications",title:t("settings.notifications.title"),description:t("settings.notifications.description"),icon:"fas fa-bell",route:"/settings/notifications"},{id:"security",title:t("settings.security.title"),description:t("settings.security.description"),icon:"fas fa-shield-alt",route:"/settings/security"},{id:"billing",title:t("settings.billing.title"),description:t("settings.billing.description"),icon:"fas fa-file-invoice-dollar",route:"/settings/billing"},{id:"servers",title:t("settings.servers.title"),description:t("settings.servers.description"),icon:"fas fa-server",route:"/settings/servers"},{id:"integrations",title:t("settings.integrations.title"),description:t("settings.integrations.description"),icon:"fas fa-plug",badge:"API",route:"/settings/integrations"},{id:"license",title:t("settings.license.title"),description:t("settings.license.description"),icon:"fas fa-key",route:"/settings/license"}]),n=x=>{w.push(x)};return be(async()=>{try{setTimeout(()=>{u.value=!1},500)}catch(x){console.error("Error loading settings:",x),i.notificationError(t("common.errorLoading"))}}),(x,y)=>(N(),L("div",vS,[e("div",mS,[e("div",null,[e("h1",null,s(c(t)("settings.title")),1),e("div",hS,s(c(t)("settings.description")),1)])]),u.value?(N(),L("div",gS,[y[0]||(y[0]=e("div",{class:"loading-state-icon"},[e("i",{class:"fas fa-spinner fa-spin"})],-1)),e("div",_S,s(c(t)("common.loading")),1)])):(N(),L("div",yS,[(N(!0),L(ae,null,le(v.value,(A,m)=>(N(),L("div",{key:m,class:"settings-box",onClick:C=>n(A.route)},[e("div",$S,[e("div",SS,[e("i",{class:se(A.icon)},null,2)]),e("div",null,[e("h3",wS,[ne(s(A.title)+" ",1),A.badge?(N(),L("span",kS,s(A.badge),1)):J("",!0)])])]),e("p",CS,s(A.description),1),e("div",AS,[e("button",ES,[y[1]||(y[1]=e("i",{class:"fas fa-cog"},null,-1)),ne(" "+s(c(t)("common.configure")),1)])])],8,bS))),128))]))]))}}),is=$e(OS,[["__scopeId","data-v-f8f315c1"]]),TS={class:"view-container"},RS={class:"header-box"},xS={class:"page-description"},IS={class:"settings-section"},PS={key:0,class:"loading-state"},MS={class:"loading-state-text"},DS={class:"server-list-container"},NS={class:"header-box"},LS={class:"header-actions"},US={class:"table-box"},VS={class:"table"},FS={key:0},qS={key:0},BS={colspan:"6",class:"text-center"},jS=["onClick"],GS={class:"status-container"},zS={class:"action-buttons"},HS=["onClick"],WS=["onClick"],KS=["onClick"],JS={key:1},QS={key:1,class:"server-details-container mt-4"},YS={class:"header-box"},XS={key:0,class:"loading-state-text ml-2"},ZS={class:"server-stats-grid table-box"},ew={class:"server-stat-card"},tw={class:"stat-header"},sw={class:"stat-content"},ow={key:0,class:"loading-spinner"},nw={key:1},iw={class:"stat-value"},rw={key:0,class:"stat-details"},aw={key:1,class:"stat-details"},lw={class:"server-stat-card"},cw={class:"stat-header"},uw={class:"stat-content"},dw={key:0,class:"loading-spinner"},pw={key:1},fw={class:"stat-value"},vw={class:"progress"},mw={class:"server-stat-card"},hw={class:"stat-header"},gw={class:"stat-content"},_w={key:0,class:"loading-spinner"},yw={key:1},bw={class:"stat-value"},$w={class:"progress"},Sw={key:0,class:"stat-details"},ww={class:"server-stat-card"},kw={class:"stat-header"},Cw={class:"stat-content"},Aw={key:0,class:"loading-spinner"},Ew={key:1},Ow={class:"stat-value"},Tw={class:"progress"},Rw={key:0,class:"stat-details"},xw={class:"server-stat-card"},Iw={class:"stat-header"},Pw={class:"stat-content"},Mw={key:0,class:"loading-spinner"},Dw={key:1,class:"stat-value"},Nw={class:"server-stat-card"},Lw={class:"stat-header"},Uw={class:"stat-content"},Vw={class:"stat-details"},Fw={key:0},qw={key:0,class:"last-updated"},Bw={key:0,class:"modal",tabindex:"-1",role:"dialog",style:{display:"block"}},jw={class:"modal-content"},Gw={class:"modal-header"},zw={class:"modal-title"},Hw={class:"modal-body"},Ww={class:"form-group"},Kw={for:"serverName"},Jw={class:"form-group"},Qw={for:"serverType"},Yw={class:"form-group"},Xw={for:"serverHostname"},Zw={class:"form-group"},ek={for:"serverIp"},tk={class:"form-group"},sk={for:"serverPort"},ok={class:"form-group"},nk={for:"serverUsername"},ik={class:"form-group"},rk={for:"serverPassword"},ak=["required"],lk={key:0,class:"form-text text-muted"},ck={key:0,class:"form-group"},uk={for:"serverApiToken"},dk={key:0,class:"form-text text-muted"},pk={class:"form-group"},fk={for:"serverNameservers"},vk={class:"form-text text-muted"},mk={class:"form-group"},hk={for:"serverMaxAccounts"},gk={class:"form-text text-muted"},_k={class:"form-check"},yk={class:"form-check-label",for:"serverSecure"},bk={class:"form-check"},$k={class:"form-check-label",for:"serverActive"},Sk={class:"form-group mt-3"},wk={key:0,class:"form-text text-muted"},kk={class:"modal-footer justify-content-between"},Ck=["disabled"],Ak={key:0,class:"spinner-border spinner-border-sm",role:"status"},Ek=["disabled"],Ok={key:0,class:"spinner-border spinner-border-sm",role:"status"},Tk={key:1,class:"modal",tabindex:"-1",role:"dialog",style:{display:"block"}},Rk={class:"modal-content"},xk={class:"modal-header"},Ik={class:"modal-title"},Pk={class:"modal-body"},Mk={class:"modal-footer"},rs=_e({__name:"ServersView",setup(I){const{t}=we({messages:{fr:{"settings.servers":{title:"Gestion des Serveurs",description:"Gérez vos serveurs et leurs configurations",add:"Ajouter un Serveur",edit:"Modifier le Serveur",delete:"Supprimer le Serveur",name:"Nom",type:"Type",hostname:"Nom d'hôte",ip:"Adresse IP",port:"Port",username:"Nom d'utilisateur",password:"Mot de passe",passwordHint:"Laissez vide si vous ne souhaitez pas modifier le mot de passe",apiToken:"Token API",apiTokenHint:"Laissez vide si vous ne souhaitez pas modifier le token API",secure:"Connexion sécurisée (SSL/TLS)",active:"Actif",maxAccounts:"Nombre maximum de comptes",nameservers:"Serveurs de noms (un par ligne)",status:"Statut",online:"En ligne",offline:"Hors ligne",inactive:"Inactif",load:"Charge CPU",memory:"Mémoire",disk:"Disque",uptime:"Temps de fonctionnement",info:"Informations",used:"Utilisé",total:"Total",free:"Libre",lastCheck:"Dernière vérification",lastRefresh:"Dernière actualisation",refresh:"Actualiser",refreshing:"Actualisation en cours...",refreshSuccess:"Statistiques actualisées avec succès",refreshError:"Erreur lors de l'actualisation des statistiques",testConnection:"Tester la connexion",testConnectionSuccess:"Connexion réussie",testConnectionError:"Erreur de connexion",confirmDelete:"Êtes-vous sûr de vouloir supprimer ce serveur ?",deleteSuccess:"Serveur supprimé avec succès",deleteError:"Erreur lors de la suppression du serveur",saveSuccess:"Serveur enregistré avec succès",saveError:"Erreur lors de l'enregistrement du serveur",details:"Détails du serveur",requiredField:"Ce champ est requis",cancel:"Annuler",save:"Enregistrer",confirm:"Confirmer",cpuLoad:"Charge CPU",last_updated:"Dernière mise à jour",apiTokenInputHint:"Entrez le token API"}}}}),w=St(),i=de(),u=z(!0),v=z(!1),n=z(!1),x=z([]),y=z(!1),A=z(!1),m=z({id:null,name:"",hostname:"",type:"cPanel",username:"",password:"",port:2087,secure:!0,active:!0,api_token:"",ip:"",maxAccounts:0,nameservers:""}),C=z(null),$=z({loadingStats:!1}),_=async()=>{u.value=!0;try{x.value=await w.fetchServers()}catch(M){console.error("Error fetching servers:",M),i.error(t("common.errorFetching"))}finally{u.value=!1}},r=(M=null)=>{M?(m.value={id:M.id,name:M.name,hostname:M.hostname,type:M.type||"cPanel",username:M.username,password:"",port:M.port||2087,secure:M.secure!==void 0?M.secure:!0,active:M.active!==void 0?M.active:!0,api_token:"",ip:M.ip||"",maxAccounts:M.maxAccounts||0,nameservers:M.nameservers||""},console.log("Serveur à éditer:",M),console.log("Type de serveur:",M.type),console.log("Statut actif:",M.active),console.log("Statut secure:",M.secure)):m.value={id:null,name:"",hostname:"",type:"cPanel",username:"",password:"",port:2087,secure:!0,active:!0,api_token:"",ip:"",maxAccounts:0,nameservers:""},y.value=!0},h=()=>{y.value=!1},S=async()=>{v.value=!0;try{m.value.id?(await w.updateServer(m.value),i.success(t("settings.servers.saveSuccess"))):(await w.createServer(m.value),i.success(t("settings.servers.saveSuccess"))),h(),_()}catch(M){console.error("Error saving server:",M),i.error(t("settings.servers.saveError"))}finally{v.value=!1}},O=M=>{C.value=M,A.value=!0},b=()=>{C.value=null,A.value=!1},E=async()=>{try{await w.deleteServer(C.value.id),i.success(t("settings.servers.deleteSuccess")),b(),_()}catch(M){console.error("Error deleting server:",M),i.error(t("settings.servers.deleteError"))}},P=async M=>{n.value=!0;try{(await w.testServerConnection(M.id)).success?i.success(t("settings.servers.testSuccess")):i.error(t("settings.servers.testError"))}catch(D){console.error("Error testing server connection:",D),i.error(t("settings.servers.testError"))}finally{n.value=!1}},f=async()=>{n.value=!0;try{(await w.testServerConnection(null,m.value)).success?i.success(t("settings.servers.testSuccess")):i.error(t("settings.servers.testError"))}catch(M){console.error("Error testing new server connection:",M),i.error(t("settings.servers.testError"))}finally{n.value=!1}},p=()=>m.value.name!==""&&m.value.hostname!==""&&m.value.username!==""&&m.value.password!==""&&m.value.ip!=="",a=M=>({"status-active":M,"status-inactive":!M}),o=M=>({"server-type-badge-cpanel":M==="cPanel","server-type-badge-proxmox":M==="Proxmox","server-type-badge-virtualizor":M==="Virtualizor"}),d=M=>({"status-online":M==="online","status-offline":M==="offline"}),l=M=>M<33?"bg-success":M<66?"bg-warning":"bg-danger",g=M=>{$.value&&$.value.id===M.id?$.value=null:$.value=M},R=async M=>{if(!(!M||!M.id)){M.loadingStats=!0;try{const D=await w.getServerStats(M.id);D.data&&D.data.success&&(M.stats=D.data.data,M.status=D.data.data.status,M.lastUpdated=new Date().toLocaleString())}catch(D){console.error("Erreur lors de la récupération des statistiques du serveur:",D),i.error(t("settings.servers.stats_error"))}finally{M.loadingStats=!1}}},k=M=>new Date(M).toLocaleString(),T=M=>{if(M===0)return"0 B";const D=1024,U=["B","KB","MB","GB","TB","PB"],B=Math.floor(Math.log(M)/Math.log(D));return parseFloat((M/Math.pow(D,B)).toFixed(2))+" "+U[B]},V=M=>{if(!M)return"0 secondes";const D=Math.floor(M/86400),U=Math.floor(M%86400/3600),B=Math.floor(M%3600/60);let Q="";return D>0&&(Q+=`${D} jour${D>1?"s":""} `),(U>0||D>0)&&(Q+=`${U} heure${U>1?"s":""} `),Q+=`${B} minute${B>1?"s":""}`,Q},F=()=>{switch(m.value.type){case"cPanel":m.value.port=2087;break;case"Proxmox":m.value.port=8006;break;case"Virtualizor":m.value.port=4085;break;default:m.value.port=2087}};return be(()=>{_()}),(M,D)=>{var U;return N(),L("div",TS,[e("div",RS,[e("div",null,[e("h1",null,s(c(t)("settings.servers.title")),1),e("div",xS,s(c(t)("settings.servers.description")),1)])]),e("div",IS,[u.value?(N(),L("div",PS,[D[17]||(D[17]=e("div",{class:"loading-state-icon"},[e("i",{class:"fas fa-spinner fa-spin"})],-1)),e("div",MS,s(c(t)("common.loading")),1)])):J("",!0),e("div",DS,[e("div",NS,[e("div",LS,[e("button",{onClick:D[0]||(D[0]=B=>r()),class:"btn btn-primary"},[D[18]||(D[18]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(c(t)("settings.servers.add")),1)])])]),e("div",US,[e("table",VS,[e("thead",null,[e("tr",null,[e("th",null,s(c(t)("settings.servers.name")),1),e("th",null,s(c(t)("settings.servers.hostname")),1),e("th",null,s(c(t)("settings.servers.type")),1),e("th",null,s(c(t)("settings.servers.ip")),1),e("th",null,s(c(t)("settings.servers.status")),1),e("th",null,s(c(t)("common.actions")),1)])]),u.value?(N(),L("tbody",JS,D[22]||(D[22]=[e("tr",null,[e("td",{colspan:"6",class:"text-center"},[e("div",{class:"loading-spinner"})])],-1)]))):(N(),L("tbody",FS,[x.value.length===0?(N(),L("tr",qS,[e("td",BS,s(c(t)("settings.servers.noServers")),1)])):J("",!0),(N(!0),L(ae,null,le(x.value,B=>(N(),L("tr",{key:B.id,onClick:Q=>g(B),class:se(["server-row",{selected:$.value&&$.value.id===B.id}])},[e("td",null,s(B.name),1),e("td",null,s(B.hostname),1),e("td",null,[e("span",{class:se(["server-type-badge",o(B.type)])},s(B.type),3)]),e("td",null,s(B.ip),1),e("td",null,[e("div",GS,[e("span",{class:se(["status-badge",a(B.active)])},s(B.active?c(t)("common.active"):c(t)("common.inactive")),3),B.active&&B.status?(N(),L("span",{key:0,class:se(["status-badge ml-2",d(B.status)])},s(B.status==="online"?c(t)("settings.servers.online"):c(t)("settings.servers.offline")),3)):J("",!0)])]),e("td",null,[e("div",zS,[e("button",{onClick:Se(Q=>P(B),["stop"]),class:"btn btn-sm btn-info mr-1",title:"Test Connection"},D[19]||(D[19]=[e("i",{class:"fas fa-plug"},null,-1)]),8,HS),e("button",{onClick:Se(Q=>r(B),["stop"]),class:"btn btn-sm btn-primary mr-1",title:"Edit"},D[20]||(D[20]=[e("i",{class:"fas fa-edit"},null,-1)]),8,WS),e("button",{onClick:Se(Q=>O(B),["stop"]),class:"btn btn-sm btn-danger",title:"Delete"},D[21]||(D[21]=[e("i",{class:"fas fa-trash"},null,-1)]),8,KS)])])],10,jS))),128))]))])])]),$.value&&$.value.id?(N(),L("div",QS,[e("div",YS,[e("h3",null,s(c(t)("settings.servers.details"))+": "+s($.value.name),1),e("button",{onClick:D[1]||(D[1]=B=>R($.value)),class:"btn btn-sm btn-outline-primary"},[D[23]||(D[23]=e("i",{class:"fas fa-sync-alt"},null,-1)),ne(" "+s(c(t)("settings.servers.refresh")),1)]),$.value.loadingStats?(N(),L("div",XS,s(c(t)("settings.servers.refreshing")),1)):J("",!0)]),e("div",ZS,[e("div",ew,[e("div",tw,[D[24]||(D[24]=e("i",{class:"fas fa-info-circle"},null,-1)),ne(" "+s(c(t)("settings.servers.status")),1)]),e("div",sw,[$.value.loadingStats?(N(),L("div",ow)):(N(),L("div",nw,[e("div",iw,[e("span",{class:se(d($.value.status))},s($.value.status==="online"?c(t)("settings.servers.online"):c(t)("settings.servers.offline")),3)]),$.value.lastRefresh?(N(),L("div",rw,s(c(t)("settings.servers.lastRefresh"))+": "+s($.value.lastRefresh),1)):J("",!0),$.value.last_check?(N(),L("div",aw,s(c(t)("settings.servers.lastCheck"))+": "+s(k($.value.last_check)),1)):J("",!0)]))])]),e("div",lw,[e("div",cw,[D[25]||(D[25]=e("i",{class:"fas fa-microchip"},null,-1)),ne(" "+s(c(t)("settings.servers.load")),1)]),e("div",uw,[$.value.loadingStats?(N(),L("div",dw)):(N(),L("div",pw,[e("div",fw,s($.value.server_load||0)+"%",1),e("div",vw,[e("div",{class:se(["progress-bar",l($.value.server_load)]),style:ft({width:`${$.value.server_load||0}%`})},null,6)])]))])]),e("div",mw,[e("div",hw,[D[26]||(D[26]=e("i",{class:"fas fa-memory"},null,-1)),ne(" "+s(c(t)("settings.servers.memory")),1)]),e("div",gw,[$.value.loadingStats?(N(),L("div",_w)):(N(),L("div",yw,[e("div",bw,s($.value.memory&&$.value.memory.percent?$.value.memory.percent+"%":"0%"),1),e("div",$w,[e("div",{class:se(["progress-bar",l($.value.memory?$.value.memory.percent:0)]),style:ft({width:`${$.value.memory?$.value.memory.percent:0}%`})},null,6)]),$.value.memory?(N(),L("div",Sw,s(T($.value.memory.used||0))+" / "+s(T($.value.memory.total||0)),1)):J("",!0)]))])]),e("div",ww,[e("div",kw,[D[27]||(D[27]=e("i",{class:"fas fa-hdd"},null,-1)),ne(" "+s(c(t)("settings.servers.disk")),1)]),e("div",Cw,[$.value.loadingStats?(N(),L("div",Aw)):(N(),L("div",Ew,[e("div",Ow,s($.value.disk&&$.value.disk.percent?$.value.disk.percent+"%":"0%"),1),e("div",Tw,[e("div",{class:se(["progress-bar",l($.value.disk?$.value.disk.percent:0)]),style:ft({width:`${$.value.disk?$.value.disk.percent:0}%`})},null,6)]),$.value.disk?(N(),L("div",Rw,s(T($.value.disk.used||0))+" / "+s(T($.value.disk.total||0)),1)):J("",!0)]))])]),e("div",xw,[e("div",Iw,[D[28]||(D[28]=e("i",{class:"fas fa-clock"},null,-1)),ne(" "+s(c(t)("settings.servers.uptime")),1)]),e("div",Pw,[$.value.loadingStats?(N(),L("div",Mw)):(N(),L("div",Dw,s(V($.value.uptime||0)),1))])]),e("div",Nw,[e("div",Lw,[D[29]||(D[29]=e("i",{class:"fas fa-info-circle"},null,-1)),ne(" "+s(c(t)("settings.servers.info")),1)]),e("div",Uw,[e("div",Vw,[e("div",null,s(c(t)("settings.servers.port"))+": "+s($.value.port),1),e("div",null,s(c(t)("settings.servers.secure"))+": "+s($.value.secure?c(t)("common.yes"):c(t)("common.no")),1),$.value.maxAccounts?(N(),L("div",Fw,s(c(t)("settings.servers.maxAccounts"))+": "+s($.value.maxAccounts),1)):J("",!0)])])])]),$.value.lastUpdated?(N(),L("div",qw,s(c(t)("settings.servers.last_updated"))+": "+s($.value.lastUpdated),1)):J("",!0)])):J("",!0)]),y.value?(N(),L("div",Bw,[e("div",{class:"modal-dialog",role:"document",onClick:D[15]||(D[15]=Se(()=>{},["stop"]))},[e("div",jw,[e("div",Gw,[e("h5",zw,s(m.value.id?c(t)("settings.servers.edit"):c(t)("settings.servers.add")),1),e("button",{type:"button",class:"close",onClick:h},D[30]||(D[30]=[e("span",{"aria-hidden":"true"},"×",-1)]))]),e("div",Hw,[e("form",{onSubmit:Se(S,["prevent"])},[e("div",Ww,[e("label",Kw,s(c(t)("settings.servers.name")),1),H(e("input",{type:"text",class:"form-control",id:"serverName","onUpdate:modelValue":D[2]||(D[2]=B=>m.value.name=B),required:""},null,512),[[ee,m.value.name]])]),e("div",Jw,[e("label",Qw,s(c(t)("settings.servers.type")),1),H(e("select",{id:"serverType","onUpdate:modelValue":D[3]||(D[3]=B=>m.value.type=B),class:"form-control",required:"",onChange:F},D[31]||(D[31]=[e("option",{value:"cPanel"},"cPanel",-1),e("option",{value:"Proxmox"},"Proxmox",-1),e("option",{value:"Virtualizor"},"Virtualizor",-1)]),544),[[pe,m.value.type]])]),e("div",Yw,[e("label",Xw,s(c(t)("settings.servers.hostname")),1),H(e("input",{type:"text",class:"form-control",id:"serverHostname","onUpdate:modelValue":D[4]||(D[4]=B=>m.value.hostname=B),required:""},null,512),[[ee,m.value.hostname]])]),e("div",Zw,[e("label",ek,s(c(t)("settings.servers.ip")),1),H(e("input",{type:"text",class:"form-control",id:"serverIp","onUpdate:modelValue":D[5]||(D[5]=B=>m.value.ip=B),required:""},null,512),[[ee,m.value.ip]])]),e("div",tk,[e("label",sk,s(c(t)("settings.servers.port")),1),H(e("input",{type:"number",class:"form-control",id:"serverPort","onUpdate:modelValue":D[6]||(D[6]=B=>m.value.port=B)},null,512),[[ee,m.value.port]])]),e("div",ok,[e("label",nk,s(c(t)("settings.servers.username")),1),H(e("input",{type:"text",class:"form-control",id:"serverUsername","onUpdate:modelValue":D[7]||(D[7]=B=>m.value.username=B),required:""},null,512),[[ee,m.value.username]])]),e("div",ik,[e("label",rk,s(c(t)("settings.servers.password")),1),H(e("input",{type:"password",class:"form-control",id:"serverPassword","onUpdate:modelValue":D[8]||(D[8]=B=>m.value.password=B),required:!m.value.id},null,8,ak),[[ee,m.value.password]]),m.value.id?(N(),L("small",lk,s(c(t)("settings.servers.passwordHint")),1)):J("",!0)]),m.value.type==="cPanel"?(N(),L("div",ck,[e("label",uk,s(c(t)("settings.servers.apiToken")),1),H(e("input",{type:"password",class:"form-control",id:"serverApiToken","onUpdate:modelValue":D[9]||(D[9]=B=>m.value.api_token=B)},null,512),[[ee,m.value.api_token]]),m.value.id?(N(),L("small",dk,s(c(t)("settings.servers.apiTokenInputHint")),1)):J("",!0)])):J("",!0),e("div",pk,[e("label",fk,s(c(t)("settings.servers.nameservers")),1),H(e("textarea",{class:"form-control",id:"serverNameservers","onUpdate:modelValue":D[10]||(D[10]=B=>m.value.nameservers=B),placeholder:`ns1.example.com
ns2.example.com`,rows:"3"},null,512),[[ee,m.value.nameservers]]),e("small",vk,s(c(t)("settings.servers.nameserversHint")),1)]),e("div",mk,[e("label",hk,s(c(t)("settings.servers.maxAccounts")),1),H(e("input",{type:"number",class:"form-control",id:"serverMaxAccounts","onUpdate:modelValue":D[11]||(D[11]=B=>m.value.maxAccounts=B),min:"0"},null,512),[[ee,m.value.maxAccounts]]),e("small",gk,s(c(t)("settings.servers.maxAccountsHint")),1)]),e("div",_k,[H(e("input",{type:"checkbox",class:"form-check-input",id:"serverSecure","onUpdate:modelValue":D[12]||(D[12]=B=>m.value.secure=B)},null,512),[[ye,m.value.secure]]),e("label",yk,s(c(t)("settings.servers.secure")),1)]),e("div",bk,[H(e("input",{type:"checkbox",class:"form-check-input",id:"serverActive","onUpdate:modelValue":D[13]||(D[13]=B=>m.value.active=B)},null,512),[[ye,m.value.active]]),e("label",$k,s(c(t)("settings.servers.active")),1)]),e("div",Sk,[p()?J("",!0):(N(),L("small",wk,s(c(t)("settings.servers.fillRequiredFields")),1))]),e("div",kk,[e("div",null,[e("button",{type:"button",class:"btn btn-secondary",onClick:h},s(c(t)("common.cancel")),1)]),e("div",null,[e("button",{type:"button",class:"btn btn-info me-2",onClick:D[14]||(D[14]=B=>m.value.id?P(m.value):f()),disabled:n.value||!p()},[n.value?(N(),L("span",Ak)):J("",!0),ne(" "+s(c(t)("settings.servers.testConnection")),1)],8,Ck),e("button",{type:"submit",class:"btn btn-primary",disabled:v.value},[v.value?(N(),L("span",Ok)):J("",!0),ne(" "+s(c(t)("common.save")),1)],8,Ek)])])],32)])])])])):J("",!0),A.value?(N(),L("div",Tk,[e("div",{class:"modal-dialog",role:"document",onClick:D[16]||(D[16]=Se(()=>{},["stop"]))},[e("div",Rk,[e("div",xk,[e("h5",Ik,s(c(t)("common.confirmDelete")),1),e("button",{type:"button",class:"close",onClick:b},D[32]||(D[32]=[e("span",{"aria-hidden":"true"},"×",-1)]))]),e("div",Pk,[e("p",null,s(c(t)("settings.servers.deleteConfirm",{name:(U=C.value)==null?void 0:U.name})),1)]),e("div",Mk,[e("button",{type:"button",class:"btn btn-secondary",onClick:b},s(c(t)("common.cancel")),1),e("button",{type:"button",class:"btn btn-danger",onClick:E},s(c(t)("common.delete")),1)])])])])):J("",!0)])}}}),Dk=Pe("license",()=>{const I=z(null),t=z(!1),w=z(null),i=de();return{licenseInfo:I,loading:t,error:w,fetchLicenseInfo:async()=>{var n,x;t.value=!0,w.value=null;try{const y=await he.get("/api/v1/license");return I.value=y.data.data,y.data.data}catch(y){return console.error("Erreur lors de la récupération des infos de licence:",y),w.value=((x=(n=y.response)==null?void 0:n.data)==null?void 0:x.message)||"Erreur lors de la récupération des informations de licence",null}finally{t.value=!1}},updateLicense:async n=>{var x,y;t.value=!0,w.value=null;try{const A=await he.put("/api/v1/license",{license_key:n});return I.value=A.data.data,i.showNotification({title:"Licence mise à jour",message:A.data.message||"La licence a été mise à jour avec succès",type:A.data.success?"success":"error"}),A.data}catch(A){return console.error("Erreur lors de la mise à jour de la licence:",A),w.value=((y=(x=A.response)==null?void 0:x.data)==null?void 0:y.message)||"Erreur lors de la mise à jour de la licence",i.showNotification({title:"Erreur",message:w.value,type:"error"}),null}finally{t.value=!1}}}}),Je=Pe("settings",()=>{const I=z({general:{siteName:"",siteUrl:"",adminEmail:"",defaultLanguage:"fr",timezone:"Europe/Paris",dateFormat:"DD/MM/YYYY",timeFormat:"24h",currency:"EUR",maintenanceMode:!1,maintenanceMessage:""},security:{twoFactorAuth:!1,sessionTimeout:30,passwordPolicy:{minLength:8,requireNumbers:!0,requireSymbols:!0,requireUppercase:!0},ipWhitelist:[],apiKeys:[]},billing:{vatRate:20,defaultPaymentTerms:30,paymentMethods:{stripe:{enabled:!1,testMode:!0,publishableKey:"",secretKey:""},paypal:{enabled:!1,testMode:!0,clientId:"",clientSecret:""}},invoicePrefix:"INV-",autoReminders:!0,reminderDays:[7,3,1]},notifications:{enableEmailNotifications:!1,smtpHost:"",smtpPort:587,smtpSecurity:"tls",smtpUsername:"",smtpPassword:"",emailFrom:"",emailFromName:"",notificationTypes:[]},integrations:{smtp:{host:"",port:587,username:"",password:"",encryption:"tls"},webhooks:[]}}),t=z(!1),w=z(null);X(()=>I.value);const i=X(()=>I.value.general),u=X(()=>I.value.security),v=X(()=>I.value.billing),n=X(()=>I.value.notifications);X(()=>I.value.integrations);const x=async()=>{try{t.value=!0;const T=await he.get("/api/v1/settings/general");return I.value.general=T.data,T.data}catch(T){throw w.value=T,T}finally{t.value=!1}},y=async T=>{try{t.value=!0;const V=await he.post("/api/v1/settings/general",T);return I.value.general=V.data,V.data}catch(V){throw w.value=V,V}finally{t.value=!1}},A=async()=>{try{t.value=!0;const T=await he.get("/api/v1/settings/security");return I.value.security=T.data,T.data}catch(T){throw w.value=T,T}finally{t.value=!1}},m=async T=>{try{t.value=!0;const V=await he.post("/api/v1/settings/security",T);return I.value.security=V.data,V.data}catch(V){throw w.value=V,V}finally{t.value=!1}},C=async()=>{try{t.value=!0;const T=await he.get("/api/v1/settings/billing");return I.value.billing=T.data,T.data}catch(T){throw w.value=T,T}finally{t.value=!1}},$=async T=>{try{t.value=!0;const V=await he.post("/api/v1/settings/billing",T);return I.value.billing=V.data,V.data}catch(V){throw w.value=V,V}finally{t.value=!1}},_=async()=>{try{t.value=!0;const T=await he.get("/api/v1/settings/notifications");return I.value.notifications=T.data,T.data}catch(T){throw w.value=T,T}finally{t.value=!1}},r=async T=>{try{t.value=!0;const V=await he.post("/api/v1/settings/notifications",T);return I.value.notifications=V.data,V.data}catch(V){throw w.value=V,V}finally{t.value=!1}},h=async()=>{try{t.value=!0;const T=await he.get("/api/v1/settings/integration");return I.value.integrations=T.data,T.data}catch(T){throw w.value=T,T}finally{t.value=!1}},S=async T=>{try{t.value=!0;const V=await he.post("/api/v1/settings/integration",T);return I.value.integrations=V.data,V.data}catch(V){throw w.value=V,V}finally{t.value=!1}},O=async()=>{try{return t.value=!0,(await he.post("/api/v1/settings/integrations/smtp/test")).data}catch(T){throw w.value=T,T}finally{t.value=!1}},b=async()=>{try{return t.value=!0,(await he.post("/api/v1/settings/notifications/test-email")).data}catch(T){throw w.value=T,T}finally{t.value=!1}},E=async()=>{try{t.value=!0;const T=await he.post("/api/v1/settings/security/api-keys");return I.value.security.apiKeys.push(T.data),T.data}catch(T){throw w.value=T,T}finally{t.value=!1}},P=async T=>{try{t.value=!0,await he.delete(`/api/v1/settings/security/api-keys/${T}`),I.value.security.apiKeys=I.value.security.apiKeys.filter(V=>V.id!==T)}catch(V){throw w.value=V,V}finally{t.value=!1}},f=async T=>{},p=async T=>{};return{settings:I,loading:t,generalSettings:i,securitySettings:u,billingSettings:v,notificationSettings:n,fetchGeneralSettings:x,updateGeneralSettings:y,fetchSecuritySettings:A,updateSecuritySettings:m,fetchBillingSettings:C,updateBillingSettings:$,fetchNotificationSettings:_,updateNotificationSettings:r,fetchIntegrationSettings:h,updateIntegrationSettings:S,testSmtpConnection:O,testEmailNotification:b,generateApiKey:E,deleteApiKey:P,saveWebhook:async T=>{try{t.value=!0;let V;return T.id?V=await he.put(`/api/v1/settings/webhooks/${T.id}`,T):V=await he.post("/api/v1/settings/webhooks",T),V.data.success?(f("Webhook sauvegardé avec succès"),V.data.webhook):null}catch(V){throw console.error("Erreur lors de la sauvegarde du webhook:",V),p(),V}finally{t.value=!1}},deleteWebhook:async T=>{try{return t.value=!0,(await he.delete(`/api/v1/settings/webhooks/${T}`)).data.success?(f("Webhook supprimé avec succès"),!0):!1}catch(V){throw console.error("Erreur lors de la suppression du webhook:",V),p(),V}finally{t.value=!1}},toggleWebhookStatus:async(T,V)=>{try{return t.value=!0,(await he.patch(`/api/v1/settings/webhooks/${T}/status`,{active:V})).data.success?(f(`Webhook ${V?"activé":"désactivé"} avec succès`),!0):!1}catch(F){throw console.error("Erreur lors du changement de statut du webhook:",F),p(),F}finally{t.value=!1}},fetchLicenseInfo:async()=>{try{t.value=!0;const T=await he.get("/api/v1/settings/license");return T.data.success?T.data.license:{valid:!1,message:T.data.message||"Erreur lors de la récupération des informations de licence"}}catch(T){throw console.error("Erreur lors de la récupération des informations de licence:",T),p(),T}finally{t.value=!1}},activateLicense:async T=>{try{t.value=!0;const V=await he.post("/api/v1/settings/license/activate",{licenseKey:T});return V.data.success?(f("Licence activée avec succès"),V.data.license):{valid:!1,message:V.data.message||"Erreur lors de l'activation de la licence"}}catch(V){throw console.error("Erreur lors de l'activation de la licence:",V),p(),V}finally{t.value=!1}},checkLicenseStatus:async()=>{try{t.value=!0;const T=await he.get("/api/v1/settings/license/check");return T.data.success?(f("Statut de la licence vérifié avec succès"),T.data.license):{valid:!1,message:T.data.message||"Erreur lors de la vérification du statut de la licence"}}catch(T){throw console.error("Erreur lors de la vérification du statut de la licence:",T),p(),T}finally{t.value=!1}},handleSettingsUpdate:T=>{T.type==="general"?I.value.general={...I.value.general,...T.data}:T.type==="security"?I.value.security={...I.value.security,...T.data}:T.type==="billing"?I.value.billing={...I.value.billing,...T.data}:T.type==="notifications"?I.value.notifications={...I.value.notifications,...T.data}:T.type==="integration"&&(I.value.integrations={...I.value.integrations,...T.data})}}}),Nk={class:"view-container"},Lk={class:"header-box"},Uk={class:"page-description"},Vk={class:"settings-section"},Fk={key:0,class:"loading-state"},qk={class:"loading-state-text"},Bk={class:"form-group"},jk={class:"form-label"},Gk={class:"form-group"},zk={class:"form-label"},Hk={class:"form-group"},Wk={class:"form-label"},Kk={class:"form-row"},Jk={class:"form-group"},Qk={class:"form-label"},Yk={class:"form-group"},Xk={class:"form-label"},Zk={class:"form-row"},eC={class:"form-group"},tC={class:"form-label"},sC={class:"form-group"},oC={class:"form-label"},nC={class:"form-group"},iC={class:"form-label"},rC={class:"form-group"},aC={class:"form-check"},lC={class:"form-check-label",for:"maintenanceMode"},cC={key:0,class:"form-group"},uC={class:"form-label"},dC={class:"form-actions"},pC=["disabled"],fC={key:0,class:"fas fa-spinner fa-spin"},as=_e({__name:"GeneralView",setup(I){const{t}=we(),w=Je(),i=de(),u=z(!0),v=z(!1),n=je({siteName:"",siteUrl:"",adminEmail:"",defaultLanguage:"fr",timezone:"Europe/Paris",dateFormat:"DD/MM/YYYY",timeFormat:"24h",currency:"EUR",maintenanceMode:!1,maintenanceMessage:""}),x=async()=>{try{u.value=!0;const A=await w.fetchGeneralSettings();Object.assign(n,A)}catch(A){console.error("Erreur lors du chargement des paramètres:",A),i.notificationError(t("settings.loadError"))}finally{u.value=!1}},y=async()=>{try{v.value=!0,await w.updateGeneralSettings(n),i.success(t("settings.saveSuccess"))}catch(A){console.error("Erreur lors de la sauvegarde des paramètres généraux:",A),i.notificationError(t("settings.saveError"))}finally{v.value=!1}};return be(async()=>{await x()}),(A,m)=>(N(),L("div",Nk,[e("div",Lk,[e("div",null,[e("h1",null,s(c(t)("settings.general.title")),1),e("div",Uk,s(c(t)("settings.general.description")),1)])]),e("div",Vk,[u.value?(N(),L("div",Fk,[m[10]||(m[10]=e("div",{class:"loading-state-icon"},[e("i",{class:"fas fa-spinner fa-spin"})],-1)),e("div",qk,s(c(t)("common.loading")),1)])):(N(),L("form",{key:1,onSubmit:Se(y,["prevent"]),class:"table-box"},[e("div",Bk,[e("label",jk,s(c(t)("settings.general.siteName")),1),H(e("input",{type:"text",class:"form-control","onUpdate:modelValue":m[0]||(m[0]=C=>n.siteName=C),required:""},null,512),[[ee,n.siteName]])]),e("div",Gk,[e("label",zk,s(c(t)("settings.general.siteUrl")),1),H(e("input",{type:"url",class:"form-control","onUpdate:modelValue":m[1]||(m[1]=C=>n.siteUrl=C),required:""},null,512),[[ee,n.siteUrl]])]),e("div",Hk,[e("label",Wk,s(c(t)("settings.general.adminEmail")),1),H(e("input",{type:"email",class:"form-control","onUpdate:modelValue":m[2]||(m[2]=C=>n.adminEmail=C),required:""},null,512),[[ee,n.adminEmail]])]),e("div",Kk,[e("div",Jk,[e("label",Qk,s(c(t)("settings.general.language")),1),H(e("select",{class:"form-control","onUpdate:modelValue":m[3]||(m[3]=C=>n.defaultLanguage=C)},m[11]||(m[11]=[e("option",{value:"fr"},"Français",-1),e("option",{value:"en"},"English",-1),e("option",{value:"es"},"Español",-1)]),512),[[pe,n.defaultLanguage]])]),e("div",Yk,[e("label",Xk,s(c(t)("settings.general.timezone")),1),H(e("select",{class:"form-control","onUpdate:modelValue":m[4]||(m[4]=C=>n.timezone=C)},m[12]||(m[12]=[e("option",{value:"Europe/Paris"},"Europe/Paris",-1),e("option",{value:"UTC"},"UTC",-1),e("option",{value:"America/New_York"},"America/New_York",-1)]),512),[[pe,n.timezone]])])]),e("div",Zk,[e("div",eC,[e("label",tC,s(c(t)("settings.general.dateFormat")),1),H(e("select",{class:"form-control","onUpdate:modelValue":m[5]||(m[5]=C=>n.dateFormat=C)},m[13]||(m[13]=[e("option",{value:"DD/MM/YYYY"},"DD/MM/YYYY",-1),e("option",{value:"MM/DD/YYYY"},"MM/DD/YYYY",-1),e("option",{value:"YYYY-MM-DD"},"YYYY-MM-DD",-1)]),512),[[pe,n.dateFormat]])]),e("div",sC,[e("label",oC,s(c(t)("settings.general.timeFormat")),1),H(e("select",{class:"form-control","onUpdate:modelValue":m[6]||(m[6]=C=>n.timeFormat=C)},m[14]||(m[14]=[e("option",{value:"24h"},"24h",-1),e("option",{value:"12h"},"12h",-1)]),512),[[pe,n.timeFormat]])]),e("div",nC,[e("label",iC,s(c(t)("settings.general.currency")),1),H(e("select",{class:"form-control","onUpdate:modelValue":m[7]||(m[7]=C=>n.currency=C)},m[15]||(m[15]=[e("option",{value:"EUR"},"EUR (€)",-1),e("option",{value:"USD"},"USD ($)",-1),e("option",{value:"GBP"},"GBP (£)",-1)]),512),[[pe,n.currency]])])]),e("div",rC,[e("div",aC,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":m[8]||(m[8]=C=>n.maintenanceMode=C),id:"maintenanceMode"},null,512),[[ye,n.maintenanceMode]]),e("label",lC,s(c(t)("settings.general.maintenanceMode")),1)])]),n.maintenanceMode?(N(),L("div",cC,[e("label",uC,s(c(t)("settings.general.maintenanceMessage")),1),H(e("textarea",{class:"form-control","onUpdate:modelValue":m[9]||(m[9]=C=>n.maintenanceMessage=C),rows:"3"},null,512),[[ee,n.maintenanceMessage]])])):J("",!0),e("div",dC,[e("button",{type:"submit",class:"btn btn-primary",disabled:v.value},[v.value?(N(),L("i",fC)):J("",!0),ne(" "+s(c(t)("common.save")),1)],8,pC)])],32))])]))}}),vC={class:"view-container"},mC={class:"header-box"},hC={class:"page-description"},gC={class:"settings-section"},_C={key:0,class:"loading-state"},yC={class:"loading-state-text"},bC={class:"settings-group"},$C={class:"form-group"},SC={class:"form-check"},wC={class:"form-check-label",for:"enableTwoFactor"},kC={class:"form-help"},CC={class:"form-group"},AC={class:"form-label"},EC={value:"15"},OC={value:"30"},TC={value:"60"},RC={value:"120"},xC={value:"240"},IC={value:"480"},PC={value:"720"},MC={value:"1440"},DC={class:"form-group"},NC={class:"form-label"},LC={class:"form-group"},UC={class:"form-label"},VC={value:"5"},FC={value:"15"},qC={value:"30"},BC={value:"60"},jC={value:"120"},GC={class:"settings-group"},zC={class:"form-group"},HC={class:"form-label"},WC={class:"form-group"},KC={class:"form-check"},JC={class:"form-check-label",for:"requireUppercase"},QC={class:"form-group"},YC={class:"form-check"},XC={class:"form-check-label",for:"requireNumber"},ZC={class:"form-group"},e2={class:"form-check"},t2={class:"form-check-label",for:"requireSpecialChar"},s2={class:"form-group"},o2={class:"form-label"},n2={value:"0"},i2={value:"30"},r2={value:"60"},a2={value:"90"},l2={value:"180"},c2={value:"365"},u2={class:"settings-group"},d2={class:"form-group"},p2={class:"form-check"},f2={class:"form-check-label",for:"enableApiAccess"},v2={key:0,class:"form-group"},m2={class:"form-label"},h2={value:"1"},g2={value:"7"},_2={value:"30"},y2={value:"90"},b2={value:"365"},$2={value:"0"},S2={class:"form-actions"},w2=["disabled"],k2={key:0,class:"fas fa-spinner fa-spin"},C2=_e({__name:"SecurityView",setup(I){const{t}=we(),w=Je(),i=de(),u=z(!0),v=z(!1),n=je({enableTwoFactor:!1,sessionTimeout:"60",maxLoginAttempts:5,lockoutTime:"15",minPasswordLength:8,requireUppercase:!0,requireNumber:!0,requireSpecialChar:!1,passwordExpiryDays:"90",enableApiAccess:!0,apiTokenExpiry:"30"}),x=async()=>{try{u.value=!0;const A=await w.fetchSecuritySettings();Object.assign(n,A)}catch(A){console.error("Erreur lors du chargement des paramètres de sécurité:",A),i.notificationError(t("settings.loadError"))}finally{u.value=!1}},y=async()=>{try{v.value=!0,await w.updateSecuritySettings(n),i.success(t("settings.saveSuccess"))}catch(A){console.error("Erreur lors de la sauvegarde des paramètres de sécurité:",A),i.notificationError(t("settings.saveError"))}finally{v.value=!1}};return be(async()=>{await x()}),(A,m)=>(N(),L("div",vC,[e("div",mC,[e("div",null,[e("h1",null,s(c(t)("settings.security.title")),1),e("div",hC,s(c(t)("settings.security.description")),1)])]),e("div",gC,[u.value?(N(),L("div",_C,[m[11]||(m[11]=e("div",{class:"loading-state-icon"},[e("i",{class:"fas fa-spinner fa-spin"})],-1)),e("div",yC,s(c(t)("common.loading")),1)])):(N(),L("form",{key:1,onSubmit:Se(y,["prevent"]),class:"table-box"},[e("div",bC,[e("h3",null,s(c(t)("settings.security.authentication")),1),e("div",$C,[e("div",SC,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":m[0]||(m[0]=C=>n.enableTwoFactor=C),id:"enableTwoFactor"},null,512),[[ye,n.enableTwoFactor]]),e("label",wC,s(c(t)("settings.security.enableTwoFactor")),1)]),e("div",kC,s(c(t)("settings.security.twoFactorHelp")),1)]),e("div",CC,[e("label",AC,s(c(t)("settings.security.sessionTimeout")),1),H(e("select",{class:"form-control","onUpdate:modelValue":m[1]||(m[1]=C=>n.sessionTimeout=C)},[e("option",EC,"15 "+s(c(t)("common.minutes")),1),e("option",OC,"30 "+s(c(t)("common.minutes")),1),e("option",TC,"1 "+s(c(t)("common.hour")),1),e("option",RC,"2 "+s(c(t)("common.hours")),1),e("option",xC,"4 "+s(c(t)("common.hours")),1),e("option",IC,"8 "+s(c(t)("common.hours")),1),e("option",PC,"12 "+s(c(t)("common.hours")),1),e("option",MC,"24 "+s(c(t)("common.hours")),1)],512),[[pe,n.sessionTimeout]])]),e("div",DC,[e("label",NC,s(c(t)("settings.security.maxLoginAttempts")),1),H(e("input",{type:"number",class:"form-control","onUpdate:modelValue":m[2]||(m[2]=C=>n.maxLoginAttempts=C),min:"1",max:"10"},null,512),[[ee,n.maxLoginAttempts]])]),e("div",LC,[e("label",UC,s(c(t)("settings.security.lockoutTime")),1),H(e("select",{class:"form-control","onUpdate:modelValue":m[3]||(m[3]=C=>n.lockoutTime=C)},[e("option",VC,"5 "+s(c(t)("common.minutes")),1),e("option",FC,"15 "+s(c(t)("common.minutes")),1),e("option",qC,"30 "+s(c(t)("common.minutes")),1),e("option",BC,"1 "+s(c(t)("common.hour")),1),e("option",jC,"2 "+s(c(t)("common.hours")),1)],512),[[pe,n.lockoutTime]])])]),e("div",GC,[e("h3",null,s(c(t)("settings.security.passwords")),1),e("div",zC,[e("label",HC,s(c(t)("settings.security.minPasswordLength")),1),H(e("input",{type:"number",class:"form-control","onUpdate:modelValue":m[4]||(m[4]=C=>n.minPasswordLength=C),min:"8",max:"32"},null,512),[[ee,n.minPasswordLength]])]),e("div",WC,[e("div",KC,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":m[5]||(m[5]=C=>n.requireUppercase=C),id:"requireUppercase"},null,512),[[ye,n.requireUppercase]]),e("label",JC,s(c(t)("settings.security.requireUppercase")),1)])]),e("div",QC,[e("div",YC,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":m[6]||(m[6]=C=>n.requireNumber=C),id:"requireNumber"},null,512),[[ye,n.requireNumber]]),e("label",XC,s(c(t)("settings.security.requireNumber")),1)])]),e("div",ZC,[e("div",e2,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":m[7]||(m[7]=C=>n.requireSpecialChar=C),id:"requireSpecialChar"},null,512),[[ye,n.requireSpecialChar]]),e("label",t2,s(c(t)("settings.security.requireSpecialChar")),1)])]),e("div",s2,[e("label",o2,s(c(t)("settings.security.passwordExpiryDays")),1),H(e("select",{class:"form-control","onUpdate:modelValue":m[8]||(m[8]=C=>n.passwordExpiryDays=C)},[e("option",n2,s(c(t)("settings.security.never")),1),e("option",i2,"30 "+s(c(t)("common.days")),1),e("option",r2,"60 "+s(c(t)("common.days")),1),e("option",a2,"90 "+s(c(t)("common.days")),1),e("option",l2,"180 "+s(c(t)("common.days")),1),e("option",c2,"365 "+s(c(t)("common.days")),1)],512),[[pe,n.passwordExpiryDays]])])]),e("div",u2,[e("h3",null,s(c(t)("settings.security.api")),1),e("div",d2,[e("div",p2,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":m[9]||(m[9]=C=>n.enableApiAccess=C),id:"enableApiAccess"},null,512),[[ye,n.enableApiAccess]]),e("label",f2,s(c(t)("settings.security.enableApiAccess")),1)])]),n.enableApiAccess?(N(),L("div",v2,[e("label",m2,s(c(t)("settings.security.apiTokenExpiry")),1),H(e("select",{class:"form-control","onUpdate:modelValue":m[10]||(m[10]=C=>n.apiTokenExpiry=C)},[e("option",h2,"1 "+s(c(t)("common.day")),1),e("option",g2,"7 "+s(c(t)("common.days")),1),e("option",_2,"30 "+s(c(t)("common.days")),1),e("option",y2,"90 "+s(c(t)("common.days")),1),e("option",b2,"365 "+s(c(t)("common.days")),1),e("option",$2,s(c(t)("settings.security.never")),1)],512),[[pe,n.apiTokenExpiry]])])):J("",!0)]),e("div",S2,[e("button",{type:"submit",class:"btn btn-primary",disabled:v.value},[v.value?(N(),L("i",k2)):J("",!0),ne(" "+s(c(t)("common.save")),1)],8,w2)])],32))])]))}}),ls=$e(C2,[["__scopeId","data-v-c95d2d66"]]),A2={class:"view-container"},E2={class:"header-box"},O2={class:"page-description"},T2={class:"settings-section"},R2={key:0,class:"loading-state"},x2={class:"loading-state-text"},I2={class:"settings-group"},P2={class:"form-group"},M2={class:"form-check"},D2={class:"form-check-label",for:"enableEmailNotifications"},N2={key:0},L2={class:"form-group"},U2={class:"form-label"},V2={class:"form-row"},F2={class:"form-group"},q2={class:"form-label"},B2={class:"form-group"},j2={class:"form-label"},G2={value:"none"},z2={class:"form-group"},H2={class:"form-label"},W2={class:"form-group"},K2={class:"form-label"},J2={class:"form-group"},Q2={class:"form-label"},Y2={class:"form-group"},X2={class:"form-label"},Z2={class:"form-actions-inline"},eA=["disabled"],tA={key:0,class:"fas fa-spinner fa-spin"},sA={class:"settings-group"},oA={class:"notification-types"},nA={class:"notification-type-header"},iA={class:"form-check"},rA=["onUpdate:modelValue","id"],aA=["for"],lA={key:0,class:"notification-type-channels"},cA={class:"form-check"},uA=["onUpdate:modelValue","id","disabled"],dA=["for"],pA={class:"form-check"},fA=["onUpdate:modelValue","id"],vA=["for"],mA={class:"form-actions"},hA=["disabled"],gA={key:0,class:"fas fa-spinner fa-spin"},_A=_e({__name:"NotificationsView",setup(I){const{t}=we(),w=Je(),i=de(),u=z(!0),v=z(!1),n=z(!1),x=z({enableEmailNotifications:!1,smtpHost:"",smtpPort:587,smtpSecurity:"tls",smtpUsername:"",smtpPassword:"",emailFrom:"",emailFromName:""}),y=je([{id:"new_client",name:t("settings.notifications.types.newClient"),enabled:!0,email:!0,inApp:!0},{id:"new_invoice",name:t("settings.notifications.types.newInvoice"),enabled:!0,email:!0,inApp:!0},{id:"payment_received",name:t("settings.notifications.types.paymentReceived"),enabled:!0,email:!0,inApp:!0},{id:"invoice_reminder",name:t("settings.notifications.types.invoiceReminder"),enabled:!0,email:!0,inApp:!1},{id:"new_ticket",name:t("settings.notifications.types.newTicket"),enabled:!0,email:!0,inApp:!0},{id:"ticket_reply",name:t("settings.notifications.types.ticketReply"),enabled:!0,email:!0,inApp:!0},{id:"service_expiry",name:t("settings.notifications.types.serviceExpiry"),enabled:!0,email:!0,inApp:!0},{id:"system_alert",name:t("settings.notifications.types.systemAlert"),enabled:!0,email:!0,inApp:!0}]),A=async()=>{try{u.value=!0;const $=await w.fetchNotificationSettings();$.settings&&(x.value=$.settings),$.types&&$.types.forEach(_=>{const r=y.find(h=>h.id===_.id);r&&(r.enabled=_.enabled,r.email=_.email,r.inApp=_.inApp)})}catch($){console.error("Erreur lors du chargement des paramètres de notifications:",$),i.notificationError(t("settings.loadError"))}finally{u.value=!1}},m=async()=>{try{v.value=!0;const $={settings:x.value,types:y};await w.updateNotificationSettings($),i.success(t("settings.saveSuccess"))}catch($){console.error("Erreur lors de la sauvegarde des paramètres de notifications:",$),i.notificationError(t("settings.saveError"))}finally{v.value=!1}},C=async()=>{try{n.value=!0,await w.testEmailNotification(),i.success(t("settings.notifications.testSuccess"))}catch($){console.error("Erreur lors du test de connexion email:",$),i.notificationError(t("settings.notifications.testError"))}finally{n.value=!1}};return be(async()=>{await A()}),($,_)=>(N(),L("div",A2,[e("div",E2,[e("div",null,[e("h1",null,s(c(t)("settings.notifications.title")),1),e("div",O2,s(c(t)("settings.notifications.description")),1)])]),e("div",T2,[u.value?(N(),L("div",R2,[_[8]||(_[8]=e("div",{class:"loading-state-icon"},[e("i",{class:"fas fa-spinner fa-spin"})],-1)),e("div",x2,s(c(t)("common.loading")),1)])):(N(),L("form",{key:1,onSubmit:Se(m,["prevent"]),class:"table-box"},[e("div",I2,[e("h3",null,s(c(t)("settings.notifications.email")),1),e("div",P2,[e("div",M2,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":_[0]||(_[0]=r=>x.value.enableEmailNotifications=r),id:"enableEmailNotifications"},null,512),[[ye,x.value.enableEmailNotifications]]),e("label",D2,s(c(t)("settings.notifications.enableEmailNotifications")),1)])]),x.value.enableEmailNotifications?(N(),L("div",N2,[e("div",L2,[e("label",U2,s(c(t)("settings.notifications.smtpHost")),1),H(e("input",{type:"text",class:"form-control","onUpdate:modelValue":_[1]||(_[1]=r=>x.value.smtpHost=r),required:""},null,512),[[ee,x.value.smtpHost]])]),e("div",V2,[e("div",F2,[e("label",q2,s(c(t)("settings.notifications.smtpPort")),1),H(e("input",{type:"number",class:"form-control","onUpdate:modelValue":_[2]||(_[2]=r=>x.value.smtpPort=r),required:""},null,512),[[ee,x.value.smtpPort]])]),e("div",B2,[e("label",j2,s(c(t)("settings.notifications.smtpSecurity")),1),H(e("select",{class:"form-control","onUpdate:modelValue":_[3]||(_[3]=r=>x.value.smtpSecurity=r)},[e("option",G2,s(c(t)("settings.notifications.none")),1),_[9]||(_[9]=e("option",{value:"ssl"},"SSL",-1)),_[10]||(_[10]=e("option",{value:"tls"},"TLS",-1))],512),[[pe,x.value.smtpSecurity]])])]),e("div",z2,[e("label",H2,s(c(t)("settings.notifications.smtpUsername")),1),H(e("input",{type:"text",class:"form-control","onUpdate:modelValue":_[4]||(_[4]=r=>x.value.smtpUsername=r)},null,512),[[ee,x.value.smtpUsername]])]),e("div",W2,[e("label",K2,s(c(t)("settings.notifications.smtpPassword")),1),H(e("input",{type:"password",class:"form-control","onUpdate:modelValue":_[5]||(_[5]=r=>x.value.smtpPassword=r)},null,512),[[ee,x.value.smtpPassword]])]),e("div",J2,[e("label",Q2,s(c(t)("settings.notifications.emailFrom")),1),H(e("input",{type:"email",class:"form-control","onUpdate:modelValue":_[6]||(_[6]=r=>x.value.emailFrom=r),required:""},null,512),[[ee,x.value.emailFrom]])]),e("div",Y2,[e("label",X2,s(c(t)("settings.notifications.emailFromName")),1),H(e("input",{type:"text",class:"form-control","onUpdate:modelValue":_[7]||(_[7]=r=>x.value.emailFromName=r),required:""},null,512),[[ee,x.value.emailFromName]])]),e("div",Z2,[e("button",{type:"button",class:"btn btn-secondary",onClick:C,disabled:n.value},[n.value?(N(),L("i",tA)):J("",!0),ne(" "+s(c(t)("settings.notifications.testConnection")),1)],8,eA)])])):J("",!0)]),e("div",sA,[e("h3",null,s(c(t)("settings.notifications.notificationTypes")),1),e("div",oA,[(N(!0),L(ae,null,le(y,r=>(N(),L("div",{key:r.id,class:"notification-type"},[e("div",nA,[e("div",iA,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":h=>r.enabled=h,id:`notification-${r.id}`},null,8,rA),[[ye,r.enabled]]),e("label",{class:"form-check-label",for:`notification-${r.id}`},s(r.name),9,aA)])]),r.enabled?(N(),L("div",lA,[e("div",cA,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":h=>r.email=h,id:`notification-${r.id}-email`,disabled:!x.value.enableEmailNotifications},null,8,uA),[[ye,r.email]]),e("label",{class:"form-check-label",for:`notification-${r.id}-email`},s(c(t)("settings.notifications.email")),9,dA)]),e("div",pA,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":h=>r.inApp=h,id:`notification-${r.id}-inApp`},null,8,fA),[[ye,r.inApp]]),e("label",{class:"form-check-label",for:`notification-${r.id}-inApp`},s(c(t)("settings.notifications.inApp")),9,vA)])])):J("",!0)]))),128))])]),e("div",mA,[e("button",{type:"submit",class:"btn btn-primary",disabled:v.value},[v.value?(N(),L("i",gA)):J("",!0),ne(" "+s(c(t)("common.save")),1)],8,hA)])],32))])]))}}),cs=$e(_A,[["__scopeId","data-v-21f0bd14"]]),yA={class:"view-container"},bA={class:"header-box"},$A={class:"page-description"},SA={class:"settings-section"},wA={key:0,class:"loading-state"},kA={class:"loading-state-text"},CA={class:"settings-group"},AA={class:"form-group"},EA={class:"form-label"},OA={class:"form-group"},TA={class:"form-label"},RA={class:"form-group"},xA={class:"form-label"},IA={class:"form-group"},PA={class:"form-check"},MA={class:"form-check-label",for:"autoSendInvoices"},DA={class:"form-group"},NA={class:"form-check"},LA={class:"form-check-label",for:"autoSendReceipts"},UA={class:"settings-group"},VA={class:"form-group"},FA={class:"form-check"},qA={class:"form-check-label",for:"enableTaxes"},BA={key:0},jA={class:"form-group"},GA={class:"form-label"},zA={class:"form-group"},HA={class:"form-label"},WA={class:"input-group"},KA={class:"form-group"},JA={class:"form-check"},QA={class:"form-check-label",for:"taxNumberRequired"},YA={class:"settings-group"},XA={class:"payment-methods"},ZA={class:"payment-method-header"},eE={class:"form-check"},tE=["onUpdate:modelValue","id"],sE=["for"],oE={key:0,class:"payment-method-settings"},nE={key:0,class:"payment-method-fields"},iE={class:"form-group"},rE={class:"form-label"},aE=["onUpdate:modelValue"],lE={class:"form-group"},cE={class:"form-label"},uE=["onUpdate:modelValue"],dE={key:1,class:"payment-method-fields"},pE={class:"form-group"},fE={class:"form-label"},vE=["onUpdate:modelValue"],mE={class:"form-group"},hE={class:"form-label"},gE=["onUpdate:modelValue"],_E={class:"form-group"},yE={class:"form-check"},bE=["onUpdate:modelValue"],$E={class:"form-check-label",for:"paypal-sandbox"},SE={key:2,class:"payment-method-fields"},wE={class:"form-group"},kE={class:"form-label"},CE=["onUpdate:modelValue"],AE={class:"form-actions"},EE=["disabled"],OE={key:0,class:"fas fa-spinner fa-spin"},TE=_e({__name:"BillingView",setup(I){const{t}=we(),w=Je(),i=de(),u=z(!0),v=z(!1),n=z({invoicePrefix:"INV-",nextInvoiceNumber:1,defaultDueDays:15,autoSendInvoices:!0,autoSendReceipts:!0,enableTaxes:!0,defaultTaxName:"TVA",defaultTaxRate:20,taxNumberRequired:!1}),x=je([{id:"stripe",name:"Stripe",enabled:!1,config:{publicKey:"",secretKey:""}},{id:"paypal",name:"PayPal",enabled:!1,config:{clientId:"",clientSecret:"",sandbox:!0}},{id:"bank",name:t("settings.billing.bankTransfer"),enabled:!0,config:{details:""}},{id:"cash",name:t("settings.billing.cash"),enabled:!0,config:{}}]),y=async()=>{try{u.value=!0;const m=await w.fetchBillingSettings();m.general&&(n.value=m.general),m.paymentMethods&&m.paymentMethods.forEach(C=>{const $=x.find(_=>_.id===C.id);$&&($.enabled=C.enabled,C.config&&($.config={...$.config,...C.config}))})}catch(m){console.error("Erreur lors du chargement des paramètres de facturation:",m),i.notificationError(t("settings.loadError"))}finally{u.value=!1}},A=async()=>{try{v.value=!0;const m={general:n.value,paymentMethods:x};await w.updateBillingSettings(m),i.success(t("settings.saveSuccess"))}catch(m){console.error("Erreur lors de la sauvegarde des paramètres de facturation:",m),i.notificationError(t("settings.saveError"))}finally{v.value=!1}};return be(async()=>{await y()}),(m,C)=>(N(),L("div",yA,[e("div",bA,[e("div",null,[e("h1",null,s(c(t)("settings.billing.title")),1),e("div",$A,s(c(t)("settings.billing.description")),1)])]),e("div",SA,[u.value?(N(),L("div",wA,[C[9]||(C[9]=e("div",{class:"loading-state-icon"},[e("i",{class:"fas fa-spinner fa-spin"})],-1)),e("div",kA,s(c(t)("common.loading")),1)])):(N(),L("form",{key:1,onSubmit:Se(A,["prevent"]),class:"table-box"},[e("div",CA,[e("h3",null,s(c(t)("settings.billing.general")),1),e("div",AA,[e("label",EA,s(c(t)("settings.billing.invoicePrefix")),1),H(e("input",{type:"text",class:"form-control","onUpdate:modelValue":C[0]||(C[0]=$=>n.value.invoicePrefix=$),placeholder:"INV-"},null,512),[[ee,n.value.invoicePrefix]])]),e("div",OA,[e("label",TA,s(c(t)("settings.billing.nextInvoiceNumber")),1),H(e("input",{type:"number",class:"form-control","onUpdate:modelValue":C[1]||(C[1]=$=>n.value.nextInvoiceNumber=$),min:"1"},null,512),[[ee,n.value.nextInvoiceNumber]])]),e("div",RA,[e("label",xA,s(c(t)("settings.billing.defaultDueDays")),1),H(e("input",{type:"number",class:"form-control","onUpdate:modelValue":C[2]||(C[2]=$=>n.value.defaultDueDays=$),min:"0"},null,512),[[ee,n.value.defaultDueDays]])]),e("div",IA,[e("div",PA,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":C[3]||(C[3]=$=>n.value.autoSendInvoices=$),id:"autoSendInvoices"},null,512),[[ye,n.value.autoSendInvoices]]),e("label",MA,s(c(t)("settings.billing.autoSendInvoices")),1)])]),e("div",DA,[e("div",NA,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":C[4]||(C[4]=$=>n.value.autoSendReceipts=$),id:"autoSendReceipts"},null,512),[[ye,n.value.autoSendReceipts]]),e("label",LA,s(c(t)("settings.billing.autoSendReceipts")),1)])])]),e("div",UA,[e("h3",null,s(c(t)("settings.billing.taxes")),1),e("div",VA,[e("div",FA,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":C[5]||(C[5]=$=>n.value.enableTaxes=$),id:"enableTaxes"},null,512),[[ye,n.value.enableTaxes]]),e("label",qA,s(c(t)("settings.billing.enableTaxes")),1)])]),n.value.enableTaxes?(N(),L("div",BA,[e("div",jA,[e("label",GA,s(c(t)("settings.billing.defaultTaxName")),1),H(e("input",{type:"text",class:"form-control","onUpdate:modelValue":C[6]||(C[6]=$=>n.value.defaultTaxName=$),placeholder:"TVA"},null,512),[[ee,n.value.defaultTaxName]])]),e("div",zA,[e("label",HA,s(c(t)("settings.billing.defaultTaxRate")),1),e("div",WA,[H(e("input",{type:"number",class:"form-control","onUpdate:modelValue":C[7]||(C[7]=$=>n.value.defaultTaxRate=$),min:"0",step:"0.01"},null,512),[[ee,n.value.defaultTaxRate]]),C[10]||(C[10]=e("div",{class:"input-group-append"},[e("span",{class:"input-group-text"},"%")],-1))])]),e("div",KA,[e("div",JA,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":C[8]||(C[8]=$=>n.value.taxNumberRequired=$),id:"taxNumberRequired"},null,512),[[ye,n.value.taxNumberRequired]]),e("label",QA,s(c(t)("settings.billing.taxNumberRequired")),1)])])])):J("",!0)]),e("div",YA,[e("h3",null,s(c(t)("settings.billing.paymentMethods")),1),e("div",XA,[(N(!0),L(ae,null,le(x,$=>(N(),L("div",{key:$.id,class:"payment-method"},[e("div",ZA,[e("div",eE,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":_=>$.enabled=_,id:`payment-${$.id}`},null,8,tE),[[ye,$.enabled]]),e("label",{class:"form-check-label",for:`payment-${$.id}`},s($.name),9,sE)])]),$.enabled?(N(),L("div",oE,[$.id==="stripe"?(N(),L("div",nE,[e("div",iE,[e("label",rE,s(c(t)("settings.billing.stripePublicKey")),1),H(e("input",{type:"text",class:"form-control","onUpdate:modelValue":_=>$.config.publicKey=_},null,8,aE),[[ee,$.config.publicKey]])]),e("div",lE,[e("label",cE,s(c(t)("settings.billing.stripeSecretKey")),1),H(e("input",{type:"password",class:"form-control","onUpdate:modelValue":_=>$.config.secretKey=_},null,8,uE),[[ee,$.config.secretKey]])])])):J("",!0),$.id==="paypal"?(N(),L("div",dE,[e("div",pE,[e("label",fE,s(c(t)("settings.billing.paypalClientId")),1),H(e("input",{type:"text",class:"form-control","onUpdate:modelValue":_=>$.config.clientId=_},null,8,vE),[[ee,$.config.clientId]])]),e("div",mE,[e("label",hE,s(c(t)("settings.billing.paypalClientSecret")),1),H(e("input",{type:"password",class:"form-control","onUpdate:modelValue":_=>$.config.clientSecret=_},null,8,gE),[[ee,$.config.clientSecret]])]),e("div",_E,[e("div",yE,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":_=>$.config.sandbox=_,id:"paypal-sandbox"},null,8,bE),[[ye,$.config.sandbox]]),e("label",$E,s(c(t)("settings.billing.paypalSandbox")),1)])])])):J("",!0),$.id==="bank"?(N(),L("div",SE,[e("div",wE,[e("label",kE,s(c(t)("settings.billing.bankDetails")),1),H(e("textarea",{class:"form-control","onUpdate:modelValue":_=>$.config.details=_,rows:"4"},null,8,CE),[[ee,$.config.details]])])])):J("",!0)])):J("",!0)]))),128))])]),e("div",AE,[e("button",{type:"submit",class:"btn btn-primary",disabled:v.value},[v.value?(N(),L("i",OE)):J("",!0),ne(" "+s(c(t)("common.save")),1)],8,EE)])],32))])]))}}),us=$e(TE,[["__scopeId","data-v-f61b0c3e"]]),RE={class:"view-container"},xE={class:"header-box"},IE={class:"page-description"},PE={class:"settings-section"},ME={key:0,class:"loading-state"},DE={class:"loading-state-text"},NE={key:1},LE={class:"settings-group table-box"},UE={class:"settings-group-description"},VE={class:"api-keys-section"},FE={class:"api-keys-header"},qE=["disabled"],BE={key:0,class:"fas fa-spinner fa-spin"},jE={key:1,class:"fas fa-plus"},GE={key:0,class:"new-api-key"},zE={class:"alert alert-success"},HE={class:"alert-header"},WE={class:"alert-content"},KE={class:"api-key-display"},JE={class:"api-keys-table"},QE={key:0},YE=["onClick"],XE={key:1,class:"no-keys"},ZE={class:"settings-group table-box"},eO={class:"settings-group-description"},tO={class:"webhooks-section"},sO={class:"webhooks-header"},oO={class:"webhooks-table"},nO={key:0},iO={class:"webhook-url"},rO={class:"webhook-events"},aO={class:"action-buttons"},lO=["onClick"],cO=["onClick"],uO=["onClick"],dO={key:1,class:"no-webhooks"},pO={key:0,class:"modal-overlay"},fO={class:"modal-container"},vO={class:"modal-header"},mO={class:"modal-body"},hO={class:"form-group"},gO={class:"form-label"},_O={class:"form-group"},yO={class:"form-label"},bO={class:"form-group"},$O={class:"form-label"},SO={class:"webhook-events-selection"},wO=["id","value"],kO=["for"],CO={class:"form-group"},AO={class:"form-check"},EO={class:"form-check-label",for:"webhook-active"},OO={class:"form-group"},TO={class:"form-check"},RO={class:"form-check-label",for:"webhook-test"},xO={class:"modal-actions"},IO=["disabled"],PO={key:0,class:"fas fa-spinner fa-spin"},MO=_e({__name:"IntegrationsView",setup(I){const{t}=we(),w=Je(),i=de(),u=z(!0),v=z([]),n=z([]),x=z(null),y=z(!1),A=z(!1),m=z(!1),C=je({id:null,name:"",url:"",events:[],active:!0,sendTest:!1}),$=[{id:"client.created",name:t("settings.integrations.events.clientCreated")},{id:"client.updated",name:t("settings.integrations.events.clientUpdated")},{id:"invoice.created",name:t("settings.integrations.events.invoiceCreated")},{id:"invoice.paid",name:t("settings.integrations.events.invoicePaid")},{id:"payment.received",name:t("settings.integrations.events.paymentReceived")},{id:"ticket.created",name:t("settings.integrations.events.ticketCreated")},{id:"ticket.replied",name:t("settings.integrations.events.ticketReplied")},{id:"ticket.closed",name:t("settings.integrations.events.ticketClosed")},{id:"service.created",name:t("settings.integrations.events.serviceCreated")},{id:"service.updated",name:t("settings.integrations.events.serviceUpdated")},{id:"service.expired",name:t("settings.integrations.events.serviceExpired")}],_=async()=>{try{u.value=!0;const a=await w.fetchIntegrationSettings();a.apiKeys&&(v.value=a.apiKeys),a.webhooks&&(n.value=a.webhooks)}catch(a){console.error("Erreur lors du chargement des paramètres d'intégration:",a),i.notificationError(t("settings.loadError"))}finally{u.value=!1}},r=async()=>{try{y.value=!0;const a=await w.generateApiKey();x.value=a,a&&a.id&&v.value.push(a),i.success(t("settings.integrations.keyGeneratedSuccess"))}catch(a){console.error("Erreur lors de la génération de la clé API:",a),i.notificationError(t("settings.integrations.keyGenerationError"))}finally{y.value=!1}},h=async a=>{if(confirm(t("settings.integrations.confirmDeleteKey")))try{await w.deleteApiKey(a),v.value=v.value.filter(o=>o.id!==a),i.success(t("settings.integrations.keyDeletedSuccess"))}catch(o){console.error("Erreur lors de la suppression de la clé API:",o),i.notificationError(t("settings.integrations.keyDeletionError"))}},S=a=>{navigator.clipboard.writeText(a).then(()=>{i.success(t("settings.integrations.keyCopiedSuccess"))}).catch(()=>{i.notificationError(t("settings.integrations.keyCopyError"))})},O=a=>{C.id=a.id,C.name=a.name,C.url=a.url,C.events=[...a.events],C.active=a.active,C.sendTest=!1,A.value=!0},b=()=>{A.value=!1,setTimeout(()=>{C.id=null,C.name="",C.url="",C.events=[],C.active=!0,C.sendTest=!1},300)},E=async()=>{try{m.value=!0;const a={id:C.id,name:C.name,url:C.url,events:C.events,active:C.active,sendTest:C.sendTest},o=await w.saveWebhook(a);if(C.id){const d=n.value.findIndex(l=>l.id===C.id);d!==-1&&(n.value[d]=o)}else n.value.push(o);i.success(t("settings.integrations.webhookSavedSuccess")),b()}catch(a){console.error("Erreur lors de la sauvegarde du webhook:",a),i.notificationError(t("settings.integrations.webhookSaveError"))}finally{m.value=!1}},P=async a=>{if(confirm(t("settings.integrations.confirmDeleteWebhook")))try{await w.deleteWebhook(a),n.value=n.value.filter(o=>o.id!==a),i.success(t("settings.integrations.webhookDeletedSuccess"))}catch(o){console.error("Erreur lors de la suppression du webhook:",o),i.notificationError(t("settings.integrations.webhookDeletionError"))}},f=async a=>{try{const o=n.value.find(l=>l.id===a);if(!o)return;const d=!o.active;await w.toggleWebhookStatus(a,d),o.active=d,i.success(t(d?"settings.integrations.webhookActivatedSuccess":"settings.integrations.webhookDeactivatedSuccess"))}catch(o){console.error("Erreur lors du changement de statut du webhook:",o),i.notificationError(t("settings.integrations.webhookStatusError"))}},p=a=>{try{const o=new Date(a);return format(o,"dd MMM yyyy HH:mm",{locale:fr})}catch{return a}};return be(async()=>{await _()}),(a,o)=>(N(),L("div",RE,[e("div",xE,[e("div",null,[e("h1",null,s(c(t)("settings.integrations.title")),1),e("div",IE,s(c(t)("settings.integrations.description")),1)])]),e("div",PE,[u.value?(N(),L("div",ME,[o[7]||(o[7]=e("div",{class:"loading-state-icon"},[e("i",{class:"fas fa-spinner fa-spin"})],-1)),e("div",DE,s(c(t)("common.loading")),1)])):(N(),L("div",NE,[e("div",LE,[e("h3",null,s(c(t)("settings.integrations.apiKeys")),1),e("p",UE,s(c(t)("settings.integrations.apiKeysDescription")),1),e("div",VE,[e("div",FE,[e("button",{class:"btn btn-primary",onClick:r,disabled:y.value},[y.value?(N(),L("i",BE)):(N(),L("i",jE)),ne(" "+s(c(t)("settings.integrations.generateKey")),1)],8,qE)]),x.value?(N(),L("div",GE,[e("div",zE,[e("div",HE,[o[8]||(o[8]=e("i",{class:"fas fa-check-circle"},null,-1)),ne(" "+s(c(t)("settings.integrations.newKeyGenerated")),1)]),e("div",WE,[e("p",null,s(c(t)("settings.integrations.copyKeyWarning")),1),e("div",KE,[e("code",null,s(x.value.token),1),e("button",{class:"btn btn-icon",onClick:o[0]||(o[0]=d=>S(x.value.token)),title:"Copier"},o[9]||(o[9]=[e("i",{class:"fas fa-copy"},null,-1)]))])])])])):J("",!0),e("div",JE,[v.value.length>0?(N(),L("table",QE,[e("thead",null,[e("tr",null,[e("th",null,s(c(t)("settings.integrations.keyName")),1),e("th",null,s(c(t)("settings.integrations.createdAt")),1),e("th",null,s(c(t)("settings.integrations.lastUsed")),1),e("th",null,s(c(t)("settings.integrations.expiresAt")),1),e("th",null,s(c(t)("common.actions")),1)])]),e("tbody",null,[(N(!0),L(ae,null,le(v.value,d=>(N(),L("tr",{key:d.id},[e("td",null,s(d.name),1),e("td",null,s(p(d.createdAt)),1),e("td",null,s(d.lastUsed?p(d.lastUsed):c(t)("common.never")),1),e("td",null,s(d.expiresAt?p(d.expiresAt):c(t)("common.never")),1),e("td",null,[e("button",{class:"btn btn-icon btn-danger",onClick:l=>h(d.id),title:"Supprimer"},o[10]||(o[10]=[e("i",{class:"fas fa-trash"},null,-1)]),8,YE)])]))),128))])])):(N(),L("div",XE,s(c(t)("settings.integrations.noKeysFound")),1))])])]),e("div",ZE,[e("h3",null,s(c(t)("settings.integrations.webhooks")),1),e("p",eO,s(c(t)("settings.integrations.webhooksDescription")),1),e("div",tO,[e("div",sO,[e("button",{class:"btn btn-primary",onClick:o[1]||(o[1]=d=>A.value=!0)},[o[11]||(o[11]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(c(t)("settings.integrations.addWebhook")),1)])]),e("div",oO,[n.value.length>0?(N(),L("table",nO,[e("thead",null,[e("tr",null,[e("th",null,s(c(t)("settings.integrations.webhookName")),1),e("th",null,s(c(t)("settings.integrations.webhookUrl")),1),e("th",null,s(c(t)("settings.integrations.webhookEvents")),1),e("th",null,s(c(t)("settings.integrations.webhookStatus")),1),e("th",null,s(c(t)("common.actions")),1)])]),e("tbody",null,[(N(!0),L(ae,null,le(n.value,d=>(N(),L("tr",{key:d.id},[e("td",null,s(d.name),1),e("td",iO,s(d.url),1),e("td",null,[e("div",rO,[(N(!0),L(ae,null,le(d.events,l=>(N(),L("span",{key:l,class:"webhook-event-badge"},s(l),1))),128))])]),e("td",null,[e("span",{class:se(["status-badge",d.active?"status-active":"status-inactive"])},s(d.active?c(t)("common.active"):c(t)("common.inactive")),3)]),e("td",null,[e("div",aO,[e("button",{class:"btn btn-icon",onClick:l=>O(d),title:"Modifier"},o[12]||(o[12]=[e("i",{class:"fas fa-edit"},null,-1)]),8,lO),e("button",{class:"btn btn-icon",onClick:l=>f(d.id),title:"Activer/Désactiver"},[e("i",{class:se(d.active?"fas fa-toggle-on":"fas fa-toggle-off")},null,2)],8,cO),e("button",{class:"btn btn-icon btn-danger",onClick:l=>P(d.id),title:"Supprimer"},o[13]||(o[13]=[e("i",{class:"fas fa-trash"},null,-1)]),8,uO)])])]))),128))])])):(N(),L("div",dO,s(c(t)("settings.integrations.noWebhooksFound")),1))])])])]))]),A.value?(N(),L("div",pO,[e("div",fO,[e("div",vO,[e("h3",null,s(C.id?c(t)("settings.integrations.editWebhook"):c(t)("settings.integrations.addWebhook")),1),e("button",{class:"btn-close",onClick:b},o[14]||(o[14]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",mO,[e("form",{onSubmit:Se(E,["prevent"])},[e("div",hO,[e("label",gO,s(c(t)("settings.integrations.webhookName")),1),H(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[2]||(o[2]=d=>C.name=d),required:""},null,512),[[ee,C.name]])]),e("div",_O,[e("label",yO,s(c(t)("settings.integrations.webhookUrl")),1),H(e("input",{type:"url",class:"form-control","onUpdate:modelValue":o[3]||(o[3]=d=>C.url=d),required:""},null,512),[[ee,C.url]])]),e("div",bO,[e("label",$O,s(c(t)("settings.integrations.webhookEvents")),1),e("div",SO,[(N(),L(ae,null,le($,d=>e("div",{key:d.id,class:"webhook-event-checkbox"},[H(e("input",{type:"checkbox",id:`event-${d.id}`,value:d.id,"onUpdate:modelValue":o[4]||(o[4]=l=>C.events=l)},null,8,wO),[[ye,C.events]]),e("label",{for:`event-${d.id}`},s(d.name),9,kO)])),64))])]),e("div",CO,[e("div",AO,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":o[5]||(o[5]=d=>C.active=d),id:"webhook-active"},null,512),[[ye,C.active]]),e("label",EO,s(c(t)("settings.integrations.webhookActive")),1)])]),e("div",OO,[e("div",TO,[H(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":o[6]||(o[6]=d=>C.sendTest=d),id:"webhook-test"},null,512),[[ye,C.sendTest]]),e("label",RO,s(c(t)("settings.integrations.sendTestEvent")),1)])]),e("div",xO,[e("button",{type:"button",class:"btn btn-secondary",onClick:b},s(c(t)("common.cancel")),1),e("button",{type:"submit",class:"btn btn-primary",disabled:m.value},[m.value?(N(),L("i",PO)):J("",!0),ne(" "+s(c(t)("common.save")),1)],8,IO)])],32)])])])):J("",!0)]))}}),ds=$e(MO,[["__scopeId","data-v-bec10989"]]),DO={lessThanXSeconds:{one:"moins d’une seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins d’une minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus d’un an",other:"plus de {{count}} ans"},almostXYears:{one:"presqu’un an",other:"presque {{count}} ans"}},NO=(I,t,w)=>{let i;const u=DO[I];return typeof u=="string"?i=u:t===1?i=u.one:i=u.other.replace("{{count}}",String(t)),w!=null&&w.addSuffix?w.comparison&&w.comparison>0?"dans "+i:"il y a "+i:i},LO={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},UO={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},VO={full:"{{date}} 'à' {{time}}",long:"{{date}} 'à' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},FO={date:vt({formats:LO,defaultWidth:"full"}),time:vt({formats:UO,defaultWidth:"full"}),dateTime:vt({formats:VO,defaultWidth:"full"})},qO={lastWeek:"eeee 'dernier à' p",yesterday:"'hier à' p",today:"'aujourd’hui à' p",tomorrow:"'demain à' p'",nextWeek:"eeee 'prochain à' p",other:"P"},BO=(I,t,w,i)=>qO[I],jO={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jésus-Christ","après Jésus-Christ"]},GO={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2ème trim.","3ème trim.","4ème trim."],wide:["1er trimestre","2ème trimestre","3ème trimestre","4ème trimestre"]},zO={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],wide:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]},HO={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},WO={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"après-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de l’après-midi",evening:"du soir",night:"du matin"}},KO=(I,t)=>{const w=Number(I),i=t==null?void 0:t.unit;if(w===0)return"0";const u=["year","week","hour","minute","second"];let v;return w===1?v=i&&u.includes(i)?"ère":"er":v="ème",w+v},JO=["MMM","MMMM"],QO={preprocessor:(I,t)=>I.getDate()===1||!t.some(i=>i.isToken&&JO.includes(i.value))?t:t.map(i=>i.isToken&&i.value==="do"?{isToken:!0,value:"d"}:i),ordinalNumber:KO,era:Ye({values:jO,defaultWidth:"wide"}),quarter:Ye({values:GO,defaultWidth:"wide",argumentCallback:I=>I-1}),month:Ye({values:zO,defaultWidth:"wide"}),day:Ye({values:HO,defaultWidth:"wide"}),dayPeriod:Ye({values:WO,defaultWidth:"wide"})},YO=/^(\d+)(ième|ère|ème|er|e)?/i,XO=/\d+/i,ZO={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jésus-Christ|après Jésus-Christ)/i},eT={any:[/^av/i,/^ap/i]},tT={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|ème|e)? trim\.?/i,wide:/^[1234](er|ème|e)? trimestre/i},sT={any:[/1/i,/2/i,/3/i,/4/i]},oT={narrow:/^[jfmasond]/i,abbreviated:/^(janv|févr|mars|avr|mai|juin|juill|juil|août|sept|oct|nov|déc)\.?/i,wide:/^(janvier|février|mars|avril|mai|juin|juillet|août|septembre|octobre|novembre|décembre)/i},nT={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},iT={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},rT={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},aT={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'après[-\s]midi|du soir|de la nuit)/i},lT={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},cT={ordinalNumber:Is({matchPattern:YO,parsePattern:XO,valueCallback:I=>parseInt(I)}),era:Xe({matchPatterns:ZO,defaultMatchWidth:"wide",parsePatterns:eT,defaultParseWidth:"any"}),quarter:Xe({matchPatterns:tT,defaultMatchWidth:"wide",parsePatterns:sT,defaultParseWidth:"any",valueCallback:I=>I+1}),month:Xe({matchPatterns:oT,defaultMatchWidth:"wide",parsePatterns:nT,defaultParseWidth:"any"}),day:Xe({matchPatterns:iT,defaultMatchWidth:"wide",parsePatterns:rT,defaultParseWidth:"any"}),dayPeriod:Xe({matchPatterns:aT,defaultMatchWidth:"any",parsePatterns:lT,defaultParseWidth:"any"})},Ke={code:"fr",formatDistance:NO,formatLong:FO,formatRelative:BO,localize:QO,match:cT,options:{weekStartsOn:1,firstWeekContainsDate:4}},uT={class:"view-container"},dT={class:"header-box"},pT={class:"page-description"},fT={class:"settings-section"},vT={key:0,class:"loading-state"},mT={class:"loading-state-text"},hT={key:1,class:"license-container"},gT={class:"settings-group"},_T={key:0,class:"license-info"},yT={class:"license-status valid"},bT={class:"license-details"},$T={class:"license-detail"},ST={class:"detail-label"},wT={class:"detail-value"},kT={class:"license-detail"},CT={class:"detail-label"},AT={class:"detail-value"},ET={class:"license-detail"},OT={class:"detail-label"},TT={class:"detail-value"},RT={class:"license-detail"},xT={class:"detail-label"},IT={class:"detail-value"},PT={class:"plan-badge"},MT={class:"license-detail"},DT={class:"detail-label"},NT={class:"detail-value"},LT={class:"license-detail"},UT={class:"detail-label"},VT={class:"detail-value"},FT={key:1,class:"license-info"},qT={class:"license-status invalid"},BT={class:"license-message"},jT={class:"license-actions"},GT=["disabled"],zT={key:0,class:"fas fa-spinner fa-spin"},HT={key:1,class:"fas fa-sync-alt"},WT={key:0,class:"settings-group"},KT={class:"license-features"},JT={class:"feature-icon"},QT={class:"feature-details"},YT={class:"feature-name"},XT={class:"feature-description"},ZT={key:0,class:"modal-overlay"},eR={class:"modal-container"},tR={class:"modal-header"},sR={class:"modal-body"},oR={class:"form-group"},nR={class:"form-label"},iR={class:"form-text"},rR={class:"modal-actions"},aR=["disabled"],lR={key:0,class:"fas fa-spinner fa-spin"},cR=_e({__name:"LicenseView",setup(I){const{t}=we(),w=Je(),i=de(),u=z(!0),v=z({valid:!1,key:"",registeredTo:"",email:"",plan:"",expiresAt:null,supportUntil:null,message:""}),n=z(""),x=z(!1),y=z(!1),A=z(!1),m=X(()=>[{name:t("settings.license.features.multipleUsers"),description:t("settings.license.features.multipleUsersDesc"),enabled:!0},{name:t("settings.license.features.api"),description:t("settings.license.features.apiDesc"),enabled:!0},{name:t("settings.license.features.whiteLabel"),description:t("settings.license.features.whiteLabelDesc"),enabled:v.value.plan==="Professional"||v.value.plan==="Enterprise"},{name:t("settings.license.features.multipleServers"),description:t("settings.license.features.multipleServersDesc"),enabled:v.value.plan==="Professional"||v.value.plan==="Enterprise"},{name:t("settings.license.features.advancedReporting"),description:t("settings.license.features.advancedReportingDesc"),enabled:v.value.plan==="Enterprise"},{name:t("settings.license.features.prioritySupport"),description:t("settings.license.features.prioritySupportDesc"),enabled:v.value.plan==="Enterprise"}]),C=async()=>{try{u.value=!0;const O=await w.fetchLicenseInfo();O&&(v.value=O)}catch(O){console.error("Erreur lors du chargement des informations de licence:",O),i.notificationError(t("settings.loadError"))}finally{u.value=!1}},$=async()=>{try{y.value=!0;const O=await w.activateLicense(n.value);O&&(v.value=O,i.success(t("settings.license.activationSuccess")),r())}catch(O){console.error("Erreur lors de l'activation de la licence:",O),i.notificationError(t("settings.license.activationError"))}finally{y.value=!1}},_=async()=>{try{A.value=!0;const O=await w.checkLicenseStatus();O&&(v.value=O,i.success(t("settings.license.checkSuccess")))}catch(O){console.error("Erreur lors de la vérification de la licence:",O),i.notificationError(t("settings.license.checkError"))}finally{A.value=!1}},r=()=>{x.value=!1,setTimeout(()=>{n.value=""},300)},h=O=>{if(!O)return"";const b=O.split("-");return b.length<2?O:b[0]+"-XXXX-XXXX-"+b[b.length-1]},S=O=>{try{const b=new Date(O);return et(b,"dd MMM yyyy",{locale:Ke})}catch{return O}};return be(async()=>{await C()}),(O,b)=>(N(),L("div",uT,[e("div",dT,[e("div",null,[e("h1",null,s(c(t)("settings.license.title")),1),e("div",pT,s(c(t)("settings.license.description")),1)])]),e("div",fT,[u.value?(N(),L("div",vT,[b[2]||(b[2]=e("div",{class:"loading-state-icon"},[e("i",{class:"fas fa-spinner fa-spin"})],-1)),e("div",mT,s(c(t)("common.loading")),1)])):(N(),L("div",hT,[e("div",gT,[e("h3",null,s(c(t)("settings.license.information")),1),v.value.valid?(N(),L("div",_T,[e("div",yT,[b[3]||(b[3]=e("i",{class:"fas fa-check-circle"},null,-1)),ne(" "+s(c(t)("settings.license.valid")),1)]),e("div",bT,[e("div",$T,[e("div",ST,s(c(t)("settings.license.licenseKey")),1),e("div",wT,s(h(v.value.key)),1)]),e("div",kT,[e("div",CT,s(c(t)("settings.license.registeredTo")),1),e("div",AT,s(v.value.registeredTo),1)]),e("div",ET,[e("div",OT,s(c(t)("settings.license.email")),1),e("div",TT,s(v.value.email),1)]),e("div",RT,[e("div",xT,s(c(t)("settings.license.plan")),1),e("div",IT,[e("span",PT,s(v.value.plan),1)])]),e("div",MT,[e("div",DT,s(c(t)("settings.license.expiresAt")),1),e("div",NT,s(v.value.expiresAt?S(v.value.expiresAt):c(t)("common.never")),1)]),e("div",LT,[e("div",UT,s(c(t)("settings.license.supportUntil")),1),e("div",VT,s(v.value.supportUntil?S(v.value.supportUntil):c(t)("common.never")),1)])])])):(N(),L("div",FT,[e("div",qT,[b[4]||(b[4]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),ne(" "+s(c(t)("settings.license.invalid")),1)]),e("div",BT,s(v.value.message||c(t)("settings.license.noLicense")),1)])),e("div",jT,[e("button",{class:"btn btn-primary",onClick:b[0]||(b[0]=E=>x.value=!0)},s(v.value.valid?c(t)("settings.license.update"):c(t)("settings.license.activate")),1),v.value.valid?(N(),L("button",{key:0,class:"btn btn-secondary",onClick:_,disabled:A.value},[A.value?(N(),L("i",zT)):(N(),L("i",HT)),ne(" "+s(c(t)("settings.license.check")),1)],8,GT)):J("",!0)])]),v.value.valid?(N(),L("div",WT,[e("h3",null,s(c(t)("settings.license.features")),1),e("div",KT,[(N(!0),L(ae,null,le(m.value,(E,P)=>(N(),L("div",{key:P,class:"license-feature"},[e("div",JT,[e("i",{class:se(E.enabled?"fas fa-check enabled":"fas fa-times disabled")},null,2)]),e("div",QT,[e("div",YT,s(E.name),1),e("div",XT,s(E.description),1)])]))),128))])])):J("",!0)]))]),x.value?(N(),L("div",ZT,[e("div",eR,[e("div",tR,[e("h3",null,s(v.value.valid?c(t)("settings.license.updateLicense"):c(t)("settings.license.activateLicense")),1),e("button",{class:"btn-close",onClick:r},b[5]||(b[5]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",sR,[e("form",{onSubmit:Se($,["prevent"])},[e("div",oR,[e("label",nR,s(c(t)("settings.license.licenseKey")),1),H(e("input",{type:"text",class:"form-control","onUpdate:modelValue":b[1]||(b[1]=E=>n.value=E),required:"",placeholder:"XXXX-XXXX-XXXX-XXXX"},null,512),[[ee,n.value]]),e("div",iR,s(c(t)("settings.license.licenseKeyHelp")),1)]),e("div",rR,[e("button",{type:"button",class:"btn btn-secondary",onClick:r},s(c(t)("common.cancel")),1),e("button",{type:"submit",class:"btn btn-primary",disabled:y.value},[y.value?(N(),L("i",lR)):J("",!0),ne(" "+s(c(t)("common.save")),1)],8,aR)])],32)])])])):J("",!0)]))}}),ps=$e(cR,[["__scopeId","data-v-65979ead"]]),uR={class:"view-container license-invalid-container"},dR={class:"license-form-container"},pR={class:"license-form"},fR={class:"form-group"},vR={key:0,class:"error-message"},mR={key:1,class:"success-message"},hR={class:"form-actions"},gR=["disabled"],_R={key:0,class:"fas fa-spinner fa-spin"},yR=_e({__name:"InvalidLicenseView",setup(I){const t=Dk(),w=Te(),i=z(""),u=z(!1),v=z(null),n=z(null),x=async()=>{if(!i.value){v.value="Veuillez entrer une clé de licence";return}u.value=!0,v.value=null,n.value=null;try{const y=await t.updateLicense(i.value);y&&y.success?(n.value="Licence activée avec succès ! Redirection vers le panneau d'administration...",setTimeout(()=>{w.push("/dashboard")},2e3)):v.value=(y==null?void 0:y.message)||"Erreur lors de la mise à jour de la licence"}catch(y){v.value=y.message||"Une erreur est survenue"}finally{u.value=!1}};return(y,A)=>(N(),L("div",uR,[A[6]||(A[6]=ks('<div class="header-box" data-v-3d82f170><h1 class="page-title" data-v-3d82f170>Licence Invalide</h1><p class="page-description" data-v-3d82f170> Votre licence TechCMS est invalide ou a expiré. Veuillez entrer une clé de licence valide pour continuer. </p></div><div class="alert-box alert-warning" data-v-3d82f170><i class="fas fa-exclamation-triangle" data-v-3d82f170></i><div data-v-3d82f170><h3 data-v-3d82f170>Attention</h3><p data-v-3d82f170>L&#39;accès au panneau d&#39;administration est limité jusqu&#39;à ce qu&#39;une licence valide soit fournie.</p></div></div>',2)),e("div",dR,[e("div",pR,[A[3]||(A[3]=e("h3",null,"Activer votre licence",-1)),A[4]||(A[4]=e("div",{class:"license-format-hint"},[e("i",{class:"fas fa-info-circle"}),e("span",null,"Format: XXXX-XXXX-XXXX-XXXX")],-1)),e("form",{onSubmit:Se(x,["prevent"])},[e("div",fR,[A[1]||(A[1]=e("label",{for:"licenseKey"},"Clé de Licence",-1)),H(e("input",{type:"text",id:"licenseKey","onUpdate:modelValue":A[0]||(A[0]=m=>i.value=m),placeholder:"Entrez votre clé de licence",class:"form-control",required:""},null,512),[[ee,i.value]])]),v.value?(N(),L("div",vR,s(v.value),1)):J("",!0),n.value?(N(),L("div",mR,[A[2]||(A[2]=e("i",{class:"fas fa-check-circle"},null,-1)),ne(" "+s(n.value),1)])):J("",!0),e("div",hR,[e("button",{type:"submit",class:"btn btn-primary",disabled:u.value},[u.value?(N(),L("i",_R)):J("",!0),ne(" "+s(u.value?"Activation...":"Activer la licence"),1)],8,gR)])],32)]),A[5]||(A[5]=e("div",{class:"license-help"},[e("h3",null,"Besoin d'aide ?"),e("p",null,"Si vous avez perdu votre clé de licence ou si vous rencontrez des problèmes, veuillez contacter notre support :"),e("a",{href:"mailto:support@tech-cms.com",class:"support-link"},[e("i",{class:"fas fa-envelope"}),ne(" support@tech-cms.com ")])],-1))])]))}}),fs=$e(yR,[["__scopeId","data-v-3d82f170"]]),bR={class:"view-container not-found-container"},$R={class:"not-found-content"},SR={class:"not-found-message"},wR={class:"action-buttons"},kR=_e({__name:"NotFoundView",setup(I){const t=Te(),w=()=>{t.go(-1)};return(i,u)=>{const v=He("router-link");return N(),L("div",bR,[u[5]||(u[5]=e("div",{class:"header-box"},[e("h1",{class:"page-title"},"404 - Page Non Trouvée"),e("p",{class:"page-description"}," La page que vous recherchez n'existe pas ou a été déplacée. ")],-1)),e("div",$R,[u[4]||(u[4]=e("div",{class:"not-found-illustration"},[e("i",{class:"fas fa-search fa-4x"}),e("div",{class:"error-code"},"404")],-1)),e("div",SR,[u[2]||(u[2]=e("div",{class:"alert-box alert-info"},[e("i",{class:"fas fa-info-circle"}),e("div",null,[e("h3",null,"Que s'est-il passé ?"),e("p",null,"L'URL que vous avez saisie n'a pas été trouvée sur ce serveur.")])],-1)),u[3]||(u[3]=e("div",{class:"suggestions"},[e("h3",null,"Suggestions :"),e("ul",null,[e("li",null,"Vérifiez que l'URL est correctement saisie"),e("li",null,"Retournez à la page précédente"),e("li",null,"Accédez au tableau de bord")])],-1)),e("div",wR,[e("button",{onClick:w,class:"btn btn-secondary"},u[0]||(u[0]=[e("i",{class:"fas fa-arrow-left"},null,-1),ne(" Retour ")])),Ce(v,{to:"/dashboard",class:"btn btn-primary"},{default:Ee(()=>u[1]||(u[1]=[e("i",{class:"fas fa-home"},null,-1),ne(" Tableau de bord ")])),_:1})])])])])}}}),vs=$e(kR,[["__scopeId","data-v-b95a8a1f"]]),CR={class:"datatable"},AR={class:"datatable-inner"},ER=["onClick"],OR={key:0,class:"fas fa-sort"},TR={key:0,class:"loading-row"},RR=["colspan"],xR={key:1,class:"empty-row"},IR=["colspan"],PR=["onClick"],MR=["innerHTML"],DR=_e({__name:"DataTable",props:{columns:{},data:{},loading:{type:Boolean,default:!1},sortBy:{default:""},sortDesc:{type:Boolean,default:!1}},emits:["sort","row-click"],setup(I,{emit:t}){const w=I,i=t,u=X(()=>w.sortBy?[...w.data].sort((n,x)=>{const y=n[w.sortBy],A=x[w.sortBy];return w.sortDesc?y>A?-1:y<A?1:0:y<A?-1:y>A?1:0}):w.data),v=n=>{if(!n.sortable)return;const x=w.sortBy===n.key?!w.sortDesc:!1;i("sort",n.key,x)};return(n,x)=>(N(),L("div",CR,[e("div",AR,[e("table",null,[e("thead",null,[e("tr",null,[(N(!0),L(ae,null,le(n.columns,y=>(N(),L("th",{key:y.key,class:se({sortable:y.sortable,sorted:n.sortBy===y.key,"sort-desc":n.sortDesc&&n.sortBy===y.key}),onClick:A=>v(y)},[ne(s(y.label)+" ",1),y.sortable?(N(),L("i",OR)):J("",!0)],10,ER))),128))])]),e("tbody",null,[n.loading?(N(),L("tr",TR,[e("td",{colspan:n.columns.length},x[0]||(x[0]=[e("div",{class:"loading-spinner"},[e("i",{class:"fas fa-spinner fa-spin"}),ne(" Chargement... ")],-1)]),8,RR)])):u.value.length===0?(N(),L("tr",xR,[e("td",{colspan:n.columns.length}," Aucune donnée disponible ",8,IR)])):(N(!0),L(ae,{key:2},le(u.value,(y,A)=>(N(),L("tr",{key:A,onClick:m=>i("row-click",y)},[(N(!0),L(ae,null,le(n.columns,m=>(N(),L("td",{key:m.key},[m.formatter?(N(),L("span",{key:0,innerHTML:m.formatter(y[m.key],y)},null,8,MR)):(N(),L(ae,{key:1},[ne(s(y[m.key]),1)],64))]))),128))],8,PR))),128))])])])]))}}),NR=$e(DR,[["__scopeId","data-v-d2e71f6a"]]),LR={class:"notifications-view"},UR={class:"page-header"},VR={class:"header-actions"},FR=["disabled"],qR=["disabled"],BR={class:"statistics-cards"},jR={class:"stat-card"},GR={class:"stat-content"},zR={class:"stat-value"},HR={class:"stat-label"},WR={class:"stat-card"},KR={class:"stat-content"},JR={class:"stat-value"},QR={class:"stat-label"},YR={class:"stat-card"},XR={class:"stat-content"},ZR={class:"stat-value"},ex={class:"stat-label"},tx={class:"filters"},sx={class:"status-filters"},ox=["onClick"],nx={class:"type-filters"},ix={class:"type-selector"},rx={class:"type-chips"},ax=["onClick"],lx={class:"search-bar"},cx=["placeholder"],ux=_e({__name:"NotificationsView",setup(I){const{t}=we(),w=de();Ge();const i=z([]),u=z(!0),v=z("all"),n=z(""),x=z([]),y=[{value:"ticket",label:t("notifications.types.ticket")},{value:"invoice",label:t("notifications.types.invoice")},{value:"payment",label:t("notifications.types.payment")},{value:"client",label:t("notifications.types.client")},{value:"system",label:t("notifications.types.system")}],A=[{key:"type",label:t("notifications.columns.type"),sortable:!0,formatter:O=>({ticket:t("notifications.types.ticket"),invoice:t("notifications.types.invoice"),payment:t("notifications.types.payment"),client:t("notifications.types.client"),system:t("notifications.types.system")})[O]||O},{key:"title",label:t("notifications.columns.title"),sortable:!0},{key:"message",label:t("notifications.columns.message"),sortable:!1},{key:"createdAt",label:t("notifications.columns.date"),sortable:!0,formatter:O=>new Date(O).toLocaleString()},{key:"status",label:t("notifications.columns.status"),sortable:!0,formatter:O=>({unread:t("notifications.status.unread"),read:t("notifications.status.read")})[O]||O}],m=X(()=>{let O=[...i.value];if(v.value!=="all"&&(O=O.filter(b=>b.status===v.value)),x.value.length>0&&(O=O.filter(b=>x.value.includes(b.type))),n.value){const b=n.value.toLowerCase();O=O.filter(E=>E.title.toLowerCase().includes(b)||E.message.toLowerCase().includes(b))}return O}),C=X(()=>({total:i.value.length,unread:i.value.filter(O=>O.status==="unread").length,today:i.value.filter(O=>{const b=new Date;return new Date(O.createdAt).toDateString()===b.toDateString()}).length})),$=async()=>{try{u.value=!0;const O=await w.fetchNotifications();i.value=O}catch(O){console.error("Erreur lors du chargement des notifications:",O)}finally{u.value=!1}},_=async O=>{try{await w.markAsRead(O.id);const b=i.value.findIndex(E=>E.id===O.id);b!==-1&&(i.value[b].status="read")}catch(b){console.error("Erreur lors du marquage de la notification:",b)}},r=async()=>{try{u.value=!0,await w.markAllAsRead(),i.value=i.value.map(O=>({...O,status:"read"}))}catch(O){console.error("Erreur lors du marquage des notifications:",O)}finally{u.value=!1}},h=async O=>{try{await w.deleteNotification(O.id),i.value=i.value.filter(b=>b.id!==O.id)}catch(b){console.error("Erreur lors de la suppression de la notification:",b)}},S=async()=>{try{u.value=!0,await w.clearAll(),i.value=[]}catch(O){console.error("Erreur lors de la suppression des notifications:",O)}finally{u.value=!1}};return be(()=>{$()}),(O,b)=>(N(),L("div",LR,[e("div",UR,[e("h1",null,s(c(t)("notifications.title")),1),e("div",VR,[e("button",{class:"btn btn-outline",onClick:r,disabled:!C.value.unread},[b[1]||(b[1]=e("i",{class:"fas fa-check-double"},null,-1)),ne(" "+s(c(t)("notifications.markAllAsRead")),1)],8,FR),e("button",{class:"btn btn-danger",onClick:S,disabled:!i.value.length},[b[2]||(b[2]=e("i",{class:"fas fa-trash"},null,-1)),ne(" "+s(c(t)("notifications.clearAll")),1)],8,qR)])]),e("div",BR,[e("div",jR,[b[3]||(b[3]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-bell"})],-1)),e("div",GR,[e("div",zR,s(C.value.total),1),e("div",HR,s(c(t)("notifications.stats.total")),1)])]),e("div",WR,[b[4]||(b[4]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-envelope"})],-1)),e("div",KR,[e("div",JR,s(C.value.unread),1),e("div",QR,s(c(t)("notifications.stats.unread")),1)])]),e("div",YR,[b[5]||(b[5]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-calendar-day"})],-1)),e("div",XR,[e("div",ZR,s(C.value.today),1),e("div",ex,s(c(t)("notifications.stats.today")),1)])])]),e("div",tx,[e("div",sx,[(N(),L(ae,null,le(["all","unread","read"],E=>e("button",{key:E,class:se(["btn",[v.value===E?"btn-primary":"btn-outline",`status-${E}`]]),onClick:P=>v.value=E},s(c(t)(`notifications.status.${E}`)),11,ox)),64))]),e("div",nx,[e("div",ix,[e("label",null,s(c(t)("notifications.filterByType"))+":",1),e("div",rx,[(N(),L(ae,null,le(y,E=>e("div",{key:E.value,class:se(["type-chip",{active:x.value.includes(E.value)}]),onClick:P=>x.value.includes(E.value)?x.value=x.value.filter(f=>f!==E.value):x.value.push(E.value)},s(E.label),11,ax)),64))])])]),e("div",lx,[H(e("input",{type:"text",placeholder:c(t)("notifications.search"),"onUpdate:modelValue":b[0]||(b[0]=E=>n.value=E)},null,8,cx),[[ee,n.value]]),b[6]||(b[6]=e("i",{class:"fas fa-search"},null,-1))])]),Ce(NR,{columns:A,data:m.value,loading:u.value,actions:[{icon:"fas fa-check",label:c(t)("notifications.markAsRead"),show:E=>E.status==="unread",action:_},{icon:"fas fa-trash",label:c(t)("notifications.delete"),action:h}]},null,8,["data","loading","actions"])]))}}),ms=$e(ux,[["__scopeId","data-v-c2d7fe1d"]]),dx={id:"servicesList",class:"view-container"},px={class:"header-box"},fx={class:"page-title"},vx={class:"page-description"},mx={class:"filter-box"},hx={class:"filter-grid"},gx={class:"filter-group"},_x={class:"filter-label"},yx={class:"filter-input-wrapper"},bx=["placeholder"],$x={class:"filter-group"},Sx={class:"filter-label"},wx={class:"filter-input-wrapper"},kx={value:""},Cx={value:"pending"},Ax={value:"active"},Ex={value:"suspended"},Ox={value:"cancelled"},Tx={value:"terminated"},Rx={value:"fraud"},xx={class:"filter-group"},Ix={class:"filter-label"},Px={class:"filter-input-wrapper"},Mx={value:""},Dx=["value"],Nx={class:"filter-group"},Lx={class:"filter-label"},Ux={class:"filter-input-wrapper"},Vx={value:""},Fx=["value"],qx={key:0,class:"loading-state box"},Bx={key:1,class:"empty-state box"},jx={class:"empty-title"},Gx={class:"empty-description"},zx={key:2,class:"table-box"},Hx={key:0,class:"data-table"},Wx=["onClick"],Kx={class:"actions"},Jx={class:"action-buttons"},Qx=["onClick","title"],Yx=["onClick","title"],Xx=["onClick","title"],Zx={key:3,class:"pagination"},e3=["disabled"],t3=["onClick"],s3=["disabled"],o3={key:4,class:"modal show",style:{display:"flex","align-items":"center","justify-content":"center"}},n3={class:"modal-content",style:{position:"fixed","z-index":"1052","max-height":"80vh","backdrop-filter":"none","-webkit-backdrop-filter":"none"}},i3={class:"modal-header"},r3={class:"modal-body"},a3={class:"warning"},l3={class:"modal-footer"},c3=["disabled"],u3=["disabled"],d3={key:0},p3={key:1},f3=_e({__name:"ServicesView",setup(I){const t=st(),w=ze(),i=Fe(),u=Te(),{t:v}=we(),n=z(""),x=z(""),y=z(""),A=z(""),m=z("id"),C=z("DESC"),$=z(!1),_=z(null),r=z(!1),h=X(()=>t.services),S=X(()=>t.loading);X(()=>t.stats);const O=X(()=>t.currentPage),b=X(()=>t.total),E=X(()=>t.perPage),P=X(()=>Math.ceil(b.value/E.value)),f=X(()=>w.clients),p=X(()=>i.products),a=X(()=>{const D=[];if(P.value<=5)for(let B=1;B<=P.value;B++)D.push(B);else if(O.value<=3){for(let B=1;B<=4;B++)D.push(B);D.push("..."),D.push(P.value)}else if(O.value>=P.value-2){D.push(1),D.push("...");for(let B=P.value-3;B<=P.value;B++)D.push(B)}else{D.push(1),D.push("...");for(let B=O.value-1;B<=O.value+1;B++)D.push(B);D.push("..."),D.push(P.value)}return D}),o=D=>{try{return et(new Date(D),"dd/MM/yyyy",{locale:Ke})}catch{return D}},d=D=>D===void 0?"-":new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(D),l=async()=>{try{await t.fetchServiceStats();const D={};n.value&&(D.search=n.value),x.value&&(D.status=x.value),y.value&&(D.client_id=y.value),A.value&&(D.product_id=A.value),D.sort_by=m.value,D.sort_dir=C.value,await t.fetchServices(O.value,D),await w.fetchClients(),await i.fetchProducts()}catch(D){console.error("Erreur lors du chargement des données:",D)}},g=D=>{typeof D!="string"&&(D<1||D>P.value||D===O.value||l())},R=D=>{m.value===D?C.value=C.value==="ASC"?"DESC":"ASC":(m.value=D,C.value="DESC"),l()},k=()=>{u.push({name:"create-service"})},T=D=>{D!==void 0&&u.push({name:"service-details",params:{id:D.toString()}})},V=D=>{D!==void 0&&u.push({name:"edit-service",params:{id:D.toString()}})},F=D=>{console.log(`[ServicesView] deleteServicePrompt appelé avec id: ${D}`),D!==void 0&&(_.value=D,$.value=!0,console.log(`[ServicesView] Modal de suppression affichée pour le service ${D}`))},M=async()=>{if(console.log(`[ServicesView] confirmDelete appelé pour le service ${_.value}`),!!_.value)try{console.log(`[ServicesView] Appel de servicesStore.deleteService pour le service ${_.value}`),r.value=!0,await t.deleteService(_.value),console.log(`[ServicesView] Service ${_.value} supprimé avec succès`),$.value=!1,_.value=null,l()}catch(D){console.error(`[ServicesView] Erreur lors de la suppression du service ${_.value}:`,D)}finally{r.value=!1}};return Ne([n,x,y,A],()=>{l()}),be(()=>{l()}),(D,U)=>(N(),L("div",dx,[e("div",px,[e("div",null,[e("h1",fx,s(c(v)("services.title")),1),e("span",vx,s(c(v)("services.description")),1)]),e("button",{class:"btn btn-gradient",onClick:k},[U[12]||(U[12]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(c(v)("services.add_new")),1)])]),e("div",mx,[e("div",hx,[e("div",gx,[e("label",_x,s(c(v)("services.filters.search")),1),e("div",yx,[U[13]||(U[13]=e("i",{class:"fas fa-search"},null,-1)),H(e("input",{type:"text","onUpdate:modelValue":U[0]||(U[0]=B=>n.value=B),class:"filter-input",placeholder:c(v)("services.filters.search_placeholder")},null,8,bx),[[ee,n.value]])])]),e("div",$x,[e("label",Sx,s(c(v)("services.filters.status")),1),e("div",wx,[U[14]||(U[14]=e("i",{class:"fas fa-tag"},null,-1)),H(e("select",{"onUpdate:modelValue":U[1]||(U[1]=B=>x.value=B),class:"filter-input"},[e("option",kx,s(c(v)("services.status.all")),1),e("option",Cx,s(c(v)("services.status.pending")),1),e("option",Ax,s(c(v)("services.status.active")),1),e("option",Ex,s(c(v)("services.status.suspended")),1),e("option",Ox,s(c(v)("services.status.cancelled")),1),e("option",Tx,s(c(v)("services.status.terminated")),1),e("option",Rx,s(c(v)("services.status.fraud")),1)],512),[[pe,x.value]])])]),e("div",xx,[e("label",Ix,s(c(v)("services.filters.client")),1),e("div",Px,[U[15]||(U[15]=e("i",{class:"fas fa-user"},null,-1)),H(e("select",{"onUpdate:modelValue":U[2]||(U[2]=B=>y.value=B),class:"filter-input"},[e("option",Mx,s(c(v)("services.filters.all_clients")),1),(N(!0),L(ae,null,le(f.value,B=>(N(),L("option",{key:(B==null?void 0:B.id)||"",value:(B==null?void 0:B.id)||""},s((B==null?void 0:B.firstname)||"")+" "+s((B==null?void 0:B.lastname)||""),9,Dx))),128))],512),[[pe,y.value]])])]),e("div",Nx,[e("label",Lx,s(c(v)("services.filters.product")),1),e("div",Ux,[U[16]||(U[16]=e("i",{class:"fas fa-box"},null,-1)),H(e("select",{"onUpdate:modelValue":U[3]||(U[3]=B=>A.value=B),class:"filter-input"},[e("option",Vx,s(c(v)("services.filters.all_products")),1),(N(!0),L(ae,null,le(p.value,B=>(N(),L("option",{key:(B==null?void 0:B.id)||"",value:(B==null?void 0:B.id)||""},s((B==null?void 0:B.name)||""),9,Fx))),128))],512),[[pe,A.value]])])])])]),S.value?(N(),L("div",qx,[U[17]||(U[17]=e("div",{class:"spinner"},null,-1)),e("p",null,s(c(v)("common.loading")),1)])):h.value.length===0?(N(),L("div",Bx,[U[18]||(U[18]=e("div",{class:"empty-icon"},[e("i",{class:"fas fa-server"})],-1)),e("h3",jx,s(c(v)("services.empty.title")),1),e("p",Gx,s(c(v)("services.empty.message")),1),e("button",{class:"btn btn-primary",onClick:k},s(c(v)("services.add_new")),1)])):(N(),L("div",zx,[!S.value&&h.value.length>0?(N(),L("table",Hx,[e("thead",null,[e("tr",null,[e("th",{onClick:U[4]||(U[4]=B=>R("id")),class:se(["sortable",{active:m.value==="id"}])},[U[19]||(U[19]=ne(" ID ")),m.value==="id"?(N(),L("i",{key:0,class:se(C.value==="ASC"?"fas fa-sort-up":"fas fa-sort-down")},null,2)):J("",!0)],2),e("th",null,s(c(v)("services.table.client")),1),e("th",null,s(c(v)("services.table.product")),1),e("th",null,s(c(v)("services.table.domain")),1),e("th",{onClick:U[5]||(U[5]=B=>R("status")),class:se(["sortable",{active:m.value==="status"}])},[ne(s(c(v)("services.table.status"))+" ",1),m.value==="status"?(N(),L("i",{key:0,class:se(C.value==="ASC"?"fas fa-sort-up":"fas fa-sort-down")},null,2)):J("",!0)],2),e("th",{onClick:U[6]||(U[6]=B=>R("next_due_date")),class:se(["sortable",{active:m.value==="next_due_date"}])},[ne(s(c(v)("services.table.next_due_date"))+" ",1),m.value==="next_due_date"?(N(),L("i",{key:0,class:se(C.value==="ASC"?"fas fa-sort-up":"fas fa-sort-down")},null,2)):J("",!0)],2),e("th",null,s(c(v)("services.table.recurring_amount")),1),e("th",null,s(c(v)("services.table.actions")),1)])]),e("tbody",null,[(N(!0),L(ae,null,le(h.value,B=>(N(),L("tr",{key:B.id,onClick:Q=>T(B.id)},[e("td",null,"#"+s(B.id),1),e("td",null,s(B.client_name),1),e("td",null,s(B.product_name),1),e("td",null,s(B.domain||"-"),1),e("td",null,[e("span",{class:se(["status-badge","status-"+B.status])},s(c(v)(`services.status.${B.status}`)),3)]),e("td",null,s(B.next_due_date?o(B.next_due_date):"-"),1),e("td",null,s(d(B.recurring_amount)),1),e("td",Kx,[e("div",Jx,[e("button",{class:"btn-icon",onClick:Se(Q=>T(B.id),["stop"]),title:c(v)("services.actions.view")},U[20]||(U[20]=[e("i",{class:"fas fa-eye"},null,-1)]),8,Qx),e("button",{class:"btn-icon",onClick:Se(Q=>V(B.id),["stop"]),title:c(v)("services.actions.edit")},U[21]||(U[21]=[e("i",{class:"fas fa-edit"},null,-1)]),8,Yx),e("button",{class:"btn-icon",onClick:Se(Q=>F(B.id),["stop"]),title:c(v)("services.actions.delete")},U[22]||(U[22]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Xx)])])],8,Wx))),128))])])):J("",!0)])),P.value>1?(N(),L("div",Zx,[e("button",{class:"pagination-btn",disabled:O.value===1,onClick:U[7]||(U[7]=B=>g(O.value-1))},U[23]||(U[23]=[e("i",{class:"fas fa-chevron-left"},null,-1)]),8,e3),(N(!0),L(ae,null,le(a.value,B=>(N(),L("button",{key:B,class:se(["pagination-btn",{active:B===O.value}]),onClick:Q=>g(B)},s(B),11,t3))),128)),e("button",{class:"pagination-btn",disabled:O.value===P.value,onClick:U[8]||(U[8]=B=>g(O.value+1))},U[24]||(U[24]=[e("i",{class:"fas fa-chevron-right"},null,-1)]),8,s3)])):J("",!0),$.value?(N(),L("div",o3,[e("div",{class:"modal-backdrop",onClick:U[9]||(U[9]=B=>$.value=!1)}),e("div",n3,[e("div",i3,[e("h3",null,s(c(v)("services.delete_modal.title")),1),e("button",{class:"close-btn",onClick:U[10]||(U[10]=B=>$.value=!1)},U[25]||(U[25]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",r3,[e("p",null,s(c(v)("services.delete_modal.confirmation")),1),e("p",a3,s(c(v)("services.delete_modal.warning")),1)]),e("div",l3,[e("button",{class:"btn btn-secondary",onClick:U[11]||(U[11]=B=>$.value=!1),disabled:r.value},s(c(v)("common.cancel")),9,c3),e("button",{class:"btn btn-danger",onClick:M,disabled:r.value},[r.value?(N(),L("span",d3,[U[26]||(U[26]=e("span",{class:"spinner-border spinner-border-sm mr-2"},null,-1)),ne(" "+s(c(v)("common.deleting"))+"... ",1)])):(N(),L("span",p3,s(c(v)("common.delete")),1))],8,u3)])])])):J("",!0)]))}}),hs=$e(f3,[["__scopeId","data-v-d7536592"]]),v3={id:"serviceForm",class:"view-container"},m3={class:"header-box"},h3={class:"page-title"},g3={class:"page-description"},_3={class:"content-box"},y3={class:"form-section"},b3={class:"section-title"},$3={class:"form-group"},S3={for:"client_id"},w3={class:"select-wrapper"},k3=["disabled"],C3={value:""},A3=["value"],E3={key:0,class:"error-message"},O3={class:"form-group"},T3={for:"product_id"},R3={class:"select-wrapper"},x3=["disabled"],I3={value:""},P3=["value"],M3={key:0,class:"error-message"},D3={class:"form-section"},N3={class:"section-title"},L3={class:"form-group"},U3={for:"domain"},V3={class:"input-wrapper"},F3=["placeholder","disabled"],q3={key:0,class:"error-message"},B3={class:"form-row"},j3={class:"form-group flex-1"},G3={for:"username"},z3={class:"input-wrapper"},H3=["placeholder","disabled"],W3={key:0,class:"error-message"},K3={class:"form-group flex-1"},J3={for:"password"},Q3={class:"input-wrapper password-input"},Y3=["type","placeholder","disabled"],X3={key:0,class:"error-message"},Z3={class:"form-group"},e4={for:"server_id"},t4={class:"select-wrapper"},s4=["disabled"],o4={value:""},n4=["value"],i4={key:0,class:"error-message"},r4={class:"form-group"},a4={for:"status"},l4={class:"select-wrapper"},c4=["disabled"],u4={value:"pending"},d4={value:"active"},p4={value:"suspended"},f4={value:"cancelled"},v4={value:"terminated"},m4={value:"fraud"},h4={key:0,class:"error-message"},g4={class:"form-section"},_4={class:"section-title"},y4={class:"form-row"},b4={class:"form-group flex-1"},$4={for:"billing_cycle"},S4={class:"select-wrapper"},w4=["disabled"],k4={value:"monthly"},C4={value:"quarterly"},A4={value:"semi_annually"},E4={value:"annually"},O4={value:"biennially"},T4={value:"triennially"},R4={key:0,class:"error-message"},x4={class:"form-group flex-1"},I4={for:"next_due_date"},P4={class:"input-wrapper with-button"},M4=["disabled"],D4=["disabled"],N4={key:0,class:"error-message"},L4={class:"form-row"},U4={class:"form-group flex-1"},V4={for:"recurring_amount"},F4={class:"input-wrapper"},q4=["placeholder","disabled"],B4={key:0,class:"error-message"},j4={class:"form-group flex-1"},G4={for:"setup_fee"},z4={class:"input-wrapper"},H4=["placeholder","disabled"],W4={key:0,class:"error-message"},K4={class:"form-section"},J4={class:"section-title"},Q4={class:"form-group"},Y4={for:"notes"},X4=["placeholder","disabled"],Z4={key:0,class:"error-message"},eI={key:0,class:"form-section"},tI={class:"section-title"},sI={class:"config-entries"},oI={class:"form-row"},nI={class:"form-group flex-1"},iI={class:"input-wrapper"},rI=["onUpdate:modelValue","disabled","onInput"],aI={class:"form-group flex-2"},lI={class:"input-wrapper"},cI=["onUpdate:modelValue","disabled"],uI={class:"form-group flex-0"},dI={class:"invisible"},pI=["onClick","disabled"],fI=["disabled"],vI={class:"form-actions"},mI=["disabled"],hI=["disabled"],gI={key:0,class:"fas fa-spinner fa-spin"},_I=_e({__name:"ServiceFormView",setup(I){const t=st(),w=ze(),i=Fe(),u=St(),v=de(),n=Te(),x=Me(),{t:y}=we(),A=z(!1),m=z(!1),C=je({}),$=je({}),_=X(()=>{const R=x.params.id;return R?parseInt(R.toString()):null}),r=X(()=>_.value!==null),S=je({...{client_id:"",product_id:"",status:"pending",domain:"",server_id:"",username:"",password:"",next_due_date:"",billing_cycle:"monthly",recurring_amount:0,setup_fee:0,notes:"",configuration:{}}}),O=X(()=>w.clients),b=X(()=>i.products),E=X(()=>u.servers),P=()=>{n.push({name:"services"})},f=async()=>{A.value=!0;try{if(await Promise.all([w.fetchClients(),i.fetchProducts(),u.fetchServers()]),r.value&&_.value){const R=await t.fetchServiceById(_.value);Object.keys(S).forEach(k=>{k in R&&(S[k]=R[k])}),R.configuration&&(S.configuration={...R.configuration},Object.keys(R.configuration).forEach(k=>{$[k]=k}))}}catch(R){console.error("Erreur lors du chargement des données:",R),v.showNotification({title:y("common.error"),message:y("services.form.error_loading"),type:"error"})}finally{A.value=!1}},p=()=>(Object.keys(C).forEach(R=>delete C[R]),S.client_id||(C.client_id=y("services.form.errors.client_required")),S.product_id||(C.product_id=y("services.form.errors.product_required")),S.status||(C.status=y("services.form.errors.status_required")),S.next_due_date&&!/^\d{4}-\d{2}-\d{2}$/.test(S.next_due_date)&&(C.next_due_date=y("services.form.errors.invalid_date")),S.recurring_amount&&S.recurring_amount<0&&(C.recurring_amount=y("services.form.errors.negative_amount")),S.setup_fee&&S.setup_fee<0&&(C.setup_fee=y("services.form.errors.negative_fee")),Object.keys(C).length===0),a=async()=>{if(p()){A.value=!0;try{const R={client_id:parseInt(S.client_id),product_id:parseInt(S.product_id),status:S.status,domain:S.domain,server_id:S.server_id?parseInt(S.server_id):void 0,username:S.username,password:S.password,next_due_date:S.next_due_date,billing_cycle:S.billing_cycle,recurring_amount:S.recurring_amount,setup_fee:S.setup_fee,notes:S.notes,configuration:S.configuration};r.value&&_.value?(await t.updateService(_.value,R),v.showNotification({title:y("services.form.success_update_title"),message:y("services.form.success_update_message"),type:"success"})):(await t.createService(R),v.showNotification({title:y("services.form.success_create_title"),message:y("services.form.success_create_message"),type:"success"})),n.push({name:"services"})}catch(R){console.error("Erreur lors de la soumission du formulaire:",R),v.showNotification({title:y("common.error"),message:y("services.form.error_submit"),type:"error"})}finally{A.value=!1}}},o=()=>{const R=`config_${Date.now()}`;S.configuration[R]="",$[R]=""},d=R=>{delete S.configuration[R],delete $[R]},l=R=>{const k=$[R];k&&k!==R&&(S.configuration[k]=S.configuration[R],delete S.configuration[R],delete $[R],$[k]=k)};function g(){const R=new Date;let k=new Date(R);switch(S.billing_cycle){case"monthly":k.setMonth(R.getMonth()+1);break;case"quarterly":k.setMonth(R.getMonth()+3);break;case"semi_annually":k.setMonth(R.getMonth()+6);break;case"annually":k.setFullYear(R.getFullYear()+1);break;case"biennially":k.setFullYear(R.getFullYear()+2);break;case"triennially":k.setFullYear(R.getFullYear()+3);break;default:k.setMonth(R.getMonth()+1)}const T=k.getFullYear(),V=String(k.getMonth()+1).padStart(2,"0"),F=String(k.getDate()).padStart(2,"0");S.next_due_date=`${T}-${V}-${F}`}return be(()=>{f(),!r.value&&!S.next_due_date&&g()}),(R,k)=>(N(),L("div",v3,[e("div",m3,[e("div",null,[e("h1",h3,s(r.value?c(y)("services.edit.title"):c(y)("services.create.title")),1),e("span",g3,s(r.value?c(y)("services.edit.description"):c(y)("services.create.description")),1)]),e("button",{class:"btn btn-outline",onClick:P},[k[13]||(k[13]=e("i",{class:"fas fa-arrow-left"},null,-1)),ne(" "+s(c(y)("common.back")),1)])]),e("div",_3,[e("form",{onSubmit:Se(a,["prevent"]),class:"form-container"},[e("div",y3,[e("h3",b3,s(c(y)("services.form.section.client_product")),1),e("div",$3,[e("label",S3,[ne(s(c(y)("services.form.client"))+" ",1),k[14]||(k[14]=e("span",{class:"required"},"*",-1))]),e("div",w3,[k[15]||(k[15]=e("i",{class:"fas fa-user"},null,-1)),H(e("select",{id:"client_id","onUpdate:modelValue":k[0]||(k[0]=T=>S.client_id=T),class:"form-control",disabled:A.value||r.value,required:""},[e("option",C3,s(c(y)("services.form.select_client")),1),(N(!0),L(ae,null,le(O.value,T=>(N(),L("option",{key:T.id,value:T.id},s(T.firstname)+" "+s(T.lastname)+" ("+s(T.email)+") ",9,A3))),128))],8,k3),[[pe,S.client_id]])]),C.client_id?(N(),L("span",E3,s(C.client_id),1)):J("",!0)]),e("div",O3,[e("label",T3,[ne(s(c(y)("services.form.product"))+" ",1),k[16]||(k[16]=e("span",{class:"required"},"*",-1))]),e("div",R3,[k[17]||(k[17]=e("i",{class:"fas fa-box"},null,-1)),H(e("select",{id:"product_id","onUpdate:modelValue":k[1]||(k[1]=T=>S.product_id=T),class:"form-control",disabled:A.value||r.value,required:""},[e("option",I3,s(c(y)("services.form.select_product")),1),(N(!0),L(ae,null,le(b.value,T=>(N(),L("option",{key:T.id,value:T.id},s(T.name),9,P3))),128))],8,x3),[[pe,S.product_id]])]),C.product_id?(N(),L("span",M3,s(C.product_id),1)):J("",!0)])]),e("div",D3,[e("h3",N3,s(c(y)("services.form.section.details")),1),e("div",L3,[e("label",U3,s(c(y)("services.form.domain")),1),e("div",V3,[k[18]||(k[18]=e("i",{class:"fas fa-globe"},null,-1)),H(e("input",{type:"text",id:"domain","onUpdate:modelValue":k[2]||(k[2]=T=>S.domain=T),class:"form-control",placeholder:c(y)("services.form.domain_placeholder"),disabled:A.value},null,8,F3),[[ee,S.domain]])]),C.domain?(N(),L("span",q3,s(C.domain),1)):J("",!0)]),e("div",B3,[e("div",j3,[e("label",G3,s(c(y)("services.form.username")),1),e("div",z3,[k[19]||(k[19]=e("i",{class:"fas fa-user-tag"},null,-1)),H(e("input",{type:"text",id:"username","onUpdate:modelValue":k[3]||(k[3]=T=>S.username=T),class:"form-control",placeholder:c(y)("services.form.username_placeholder"),disabled:A.value},null,8,H3),[[ee,S.username]])]),C.username?(N(),L("span",W3,s(C.username),1)):J("",!0)]),e("div",K3,[e("label",J3,s(c(y)("services.form.password")),1),e("div",Q3,[k[20]||(k[20]=e("i",{class:"fas fa-lock"},null,-1)),H(e("input",{type:m.value?"text":"password",id:"password","onUpdate:modelValue":k[4]||(k[4]=T=>S.password=T),class:"form-control",placeholder:c(y)("services.form.password_placeholder"),disabled:A.value},null,8,Y3),[[Ot,S.password]]),e("button",{type:"button",class:"password-toggle",onClick:k[5]||(k[5]=T=>m.value=!m.value)},[e("i",{class:se(m.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])]),C.password?(N(),L("span",X3,s(C.password),1)):J("",!0)])]),e("div",Z3,[e("label",e4,s(c(y)("services.form.server")),1),e("div",t4,[k[21]||(k[21]=e("i",{class:"fas fa-server"},null,-1)),H(e("select",{id:"server_id","onUpdate:modelValue":k[6]||(k[6]=T=>S.server_id=T),class:"form-control",disabled:A.value},[e("option",o4,s(c(y)("services.form.select_server")),1),(N(!0),L(ae,null,le(E.value,T=>(N(),L("option",{key:T.id,value:T.id},s(T.name)+" ("+s(T.hostname)+") ",9,n4))),128))],8,s4),[[pe,S.server_id]])]),C.server_id?(N(),L("span",i4,s(C.server_id),1)):J("",!0)]),e("div",r4,[e("label",a4,[ne(s(c(y)("services.form.status"))+" ",1),k[22]||(k[22]=e("span",{class:"required"},"*",-1))]),e("div",l4,[k[23]||(k[23]=e("i",{class:"fas fa-tag"},null,-1)),H(e("select",{id:"status","onUpdate:modelValue":k[7]||(k[7]=T=>S.status=T),class:"form-control",disabled:A.value,required:""},[e("option",u4,s(c(y)("services.status.pending")),1),e("option",d4,s(c(y)("services.status.active")),1),e("option",p4,s(c(y)("services.status.suspended")),1),e("option",f4,s(c(y)("services.status.cancelled")),1),e("option",v4,s(c(y)("services.status.terminated")),1),e("option",m4,s(c(y)("services.status.fraud")),1)],8,c4),[[pe,S.status]])]),C.status?(N(),L("span",h4,s(C.status),1)):J("",!0)])]),e("div",g4,[e("h3",_4,s(c(y)("services.form.section.billing")),1),e("div",y4,[e("div",b4,[e("label",$4,s(c(y)("services.form.billing_cycle")),1),e("div",S4,[k[24]||(k[24]=e("i",{class:"fas fa-sync"},null,-1)),H(e("select",{id:"billing_cycle","onUpdate:modelValue":k[8]||(k[8]=T=>S.billing_cycle=T),class:"form-control",disabled:A.value,onChange:g},[e("option",k4,s(c(y)("services.billing_cycles.monthly")),1),e("option",C4,s(c(y)("services.billing_cycles.quarterly")),1),e("option",A4,s(c(y)("services.billing_cycles.semi_annually")),1),e("option",E4,s(c(y)("services.billing_cycles.annually")),1),e("option",O4,s(c(y)("services.billing_cycles.biennially")),1),e("option",T4,s(c(y)("services.billing_cycles.triennially")),1)],40,w4),[[pe,S.billing_cycle]])]),C.billing_cycle?(N(),L("span",R4,s(C.billing_cycle),1)):J("",!0)]),e("div",x4,[e("label",I4,s(c(y)("services.form.next_due_date")),1),e("div",P4,[k[26]||(k[26]=e("i",{class:"fas fa-calendar"},null,-1)),H(e("input",{type:"date",id:"next_due_date","onUpdate:modelValue":k[9]||(k[9]=T=>S.next_due_date=T),class:"form-control",disabled:A.value},null,8,M4),[[ee,S.next_due_date]]),e("button",{type:"button",class:"btn btn-icon",title:"Recalculer la date d'échéance",onClick:g,disabled:A.value},k[25]||(k[25]=[e("i",{class:"fas fa-calculator"},null,-1)]),8,D4)]),C.next_due_date?(N(),L("span",N4,s(C.next_due_date),1)):J("",!0)])]),e("div",L4,[e("div",U4,[e("label",V4,s(c(y)("services.form.recurring_amount")),1),e("div",F4,[k[27]||(k[27]=e("i",{class:"fas fa-euro-sign"},null,-1)),H(e("input",{type:"number",id:"recurring_amount","onUpdate:modelValue":k[10]||(k[10]=T=>S.recurring_amount=T),step:"0.01",min:"0",class:"form-control",placeholder:c(y)("services.form.amount_placeholder"),disabled:A.value},null,8,q4),[[ee,S.recurring_amount,void 0,{number:!0}]])]),C.recurring_amount?(N(),L("span",B4,s(C.recurring_amount),1)):J("",!0)]),e("div",j4,[e("label",G4,s(c(y)("services.form.setup_fee")),1),e("div",z4,[k[28]||(k[28]=e("i",{class:"fas fa-euro-sign"},null,-1)),H(e("input",{type:"number",id:"setup_fee","onUpdate:modelValue":k[11]||(k[11]=T=>S.setup_fee=T),step:"0.01",min:"0",class:"form-control",placeholder:c(y)("services.form.fee_placeholder"),disabled:A.value},null,8,H4),[[ee,S.setup_fee,void 0,{number:!0}]])]),C.setup_fee?(N(),L("span",W4,s(C.setup_fee),1)):J("",!0)])])]),e("div",K4,[e("h3",J4,s(c(y)("services.form.section.notes")),1),e("div",Q4,[e("label",Y4,s(c(y)("services.form.notes")),1),H(e("textarea",{id:"notes","onUpdate:modelValue":k[12]||(k[12]=T=>S.notes=T),class:"form-control textarea",placeholder:c(y)("services.form.notes_placeholder"),disabled:A.value,rows:"4"},null,8,X4),[[ee,S.notes]]),C.notes?(N(),L("span",Z4,s(C.notes),1)):J("",!0)])]),Object.keys(S.configuration||{}).length>0||r.value?(N(),L("div",eI,[e("h3",tI,s(c(y)("services.form.section.configurations")),1),e("div",sI,[(N(!0),L(ae,null,le(S.configuration,(T,V)=>(N(),L("div",{key:V,class:"config-entry"},[e("div",oI,[e("div",nI,[e("label",null,s(c(y)("services.form.config_name")),1),e("div",iI,[k[29]||(k[29]=e("i",{class:"fas fa-key"},null,-1)),H(e("input",{type:"text","onUpdate:modelValue":F=>$[V]=F,class:"form-control",disabled:A.value,onInput:F=>l(V)},null,40,rI),[[ee,$[V]]])])]),e("div",aI,[e("label",null,s(c(y)("services.form.config_value")),1),e("div",lI,[k[30]||(k[30]=e("i",{class:"fas fa-cog"},null,-1)),H(e("input",{type:"text","onUpdate:modelValue":F=>S.configuration[V]=F,class:"form-control",disabled:A.value},null,8,cI),[[ee,S.configuration[V]]])])]),e("div",uI,[e("label",dI,s(c(y)("services.form.action")),1),e("button",{type:"button",class:"btn btn-danger",onClick:F=>d(V),disabled:A.value},k[31]||(k[31]=[e("i",{class:"fas fa-trash"},null,-1)]),8,pI)])])]))),128))]),e("button",{type:"button",class:"btn btn-outline-secondary mt-3",onClick:o,disabled:A.value},[k[32]||(k[32]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(c(y)("services.form.add_config")),1)],8,fI)])):J("",!0),e("div",vI,[e("button",{type:"button",class:"btn btn-secondary",onClick:P,disabled:A.value},s(c(y)("common.cancel")),9,mI),e("button",{type:"submit",class:"btn btn-primary",disabled:A.value},[A.value?(N(),L("i",gI)):J("",!0),ne(" "+s(r.value?c(y)("common.update"):c(y)("common.create")),1)],8,hI)])],32)])]))}}),_t=$e(_I,[["__scopeId","data-v-90c431d7"]]),yI={id:"serviceDetail",class:"view-container"},bI={class:"header-box"},$I={class:"page-title"},SI={class:"page-description"},wI={class:"action-buttons"},kI={key:0,class:"loading-container"},CI={key:1,class:"error-container"},AI={key:2,class:"service-detail-container box"},EI={class:"service-header"},OI={class:"service-basic-info"},TI={class:"service-id"},RI={key:0,class:"service-domain"},xI={class:"service-status"},II={key:0,class:"status-actions"},PI=["onClick"],MI={class:"detail-grid"},DI={class:"detail-card"},NI={class:"card-header"},LI={class:"card-content"},UI={class:"info-item"},VI={class:"info-label"},FI={class:"info-value"},qI={class:"info-item"},BI={class:"info-label"},jI={class:"info-value"},GI={class:"card-actions"},zI={class:"detail-card"},HI={class:"card-header"},WI={class:"card-content"},KI={class:"info-item"},JI={class:"info-label"},QI={class:"info-value"},YI={class:"card-actions"},XI={class:"detail-card"},ZI={class:"card-header"},eP={class:"card-content"},tP={key:0},sP={class:"info-item"},oP={class:"info-label"},nP={class:"info-value"},iP={class:"card-actions"},rP={key:1,class:"empty-info"},aP={class:"detail-card"},lP={class:"card-header"},cP={class:"card-content"},uP={class:"info-item"},dP={class:"info-label"},pP={class:"info-value"},fP={class:"info-item"},vP={class:"info-label"},mP={class:"info-value"},hP={class:"info-item"},gP={class:"info-label"},_P={class:"info-value"},yP={class:"info-item"},bP={class:"info-label"},$P={class:"info-value"},SP={class:"detail-card"},wP={class:"card-header"},kP={class:"card-content"},CP={class:"info-item"},AP={class:"info-label"},EP={class:"info-value"},OP={key:0,class:"info-item"},TP={class:"info-label"},RP={class:"info-value"},xP={key:1,class:"info-item"},IP={class:"info-label"},PP={class:"info-value"},MP={key:2,class:"info-item"},DP={class:"info-label"},NP={class:"info-value"},LP={class:"detail-card"},UP={class:"card-header"},VP={class:"card-content"},FP={key:0},qP={key:0,class:"info-item"},BP={class:"info-label"},jP={class:"info-value"},GP={key:1,class:"info-item"},zP={class:"info-label"},HP={class:"info-value password-field"},WP={key:0},KP={key:1},JP={key:1,class:"empty-info"},QP={key:0,class:"detail-card"},YP={class:"card-header"},XP={class:"card-content"},ZP={class:"info-label"},eM={class:"info-value"},tM={key:1,class:"detail-card"},sM={class:"card-header"},oM={class:"card-content"},nM={class:"notes-content"},iM={key:3,class:"modal show",style:{display:"flex","align-items":"center","justify-content":"center"}},rM={class:"modal-content",style:{position:"fixed","z-index":"1052","max-height":"80vh","backdrop-filter":"none","-webkit-backdrop-filter":"none"}},aM={class:"modal-header"},lM={class:"modal-body"},cM={class:"form-group"},uM={for:"status-notes"},dM=["placeholder"],pM={class:"modal-footer"},fM=["disabled"],vM={key:0,class:"fas fa-spinner fa-spin"},mM=_e({__name:"ServiceDetailView",setup(I){const t=st(),w=de(),i=Te(),u=Me(),{t:v}=we(),n=z(!1),x=z(""),y=z(!1),A=z(!1),m=z(""),C=z(""),$=z(!1),_=X(()=>{const F=u.params.id;return F?parseInt(F.toString()):null}),r=X(()=>t.currentService),h=X(()=>{if(!r.value)return[];switch(r.value.status){case"pending":return["activate","cancel","terminate"];case"active":return["suspend","cancel","terminate"];case"suspended":return["activate","cancel","terminate"];case"cancelled":return["activate","terminate"];default:return[]}}),S=F=>{try{return et(new Date(F),"dd/MM/yyyy",{locale:Ke})}catch{return F}},O=F=>{try{return et(new Date(F),"dd/MM/yyyy HH:mm",{locale:Ke})}catch{return F}},b=F=>F===void 0?"-":new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(F),E=F=>v(F?`services.billing_cycles.${F}`:"services.details.not_set"),P=F=>{switch(F){case"activate":return"fas fa-check-circle";case"suspend":return"fas fa-pause-circle";case"cancel":return"fas fa-times-circle";case"terminate":return"fas fa-trash-alt";default:return"fas fa-cog"}},f=F=>{switch(F){case"activate":return"btn-success";case"suspend":return"btn-warning";case"cancel":return"btn-danger-light";case"terminate":return"btn-danger";default:return"btn-secondary"}},p=F=>{switch(F){case"activate":return"btn-success";case"suspend":return"btn-warning";case"cancel":return"btn-danger";case"terminate":return"btn-danger";default:return"btn-secondary"}},a=async()=>{if(_.value){n.value=!0,x.value="";try{await t.fetchServiceById(_.value)}catch(F){console.error("Erreur lors de la récupération du service:",F),x.value=v("services.details.error_loading")}finally{n.value=!1}}},o=()=>{i.push({name:"services"})},d=()=>{_.value&&i.push({name:"edit-service",params:{id:_.value.toString()}})},l=F=>{i.push({name:"client-details",params:{id:F.toString()}})},g=F=>{i.push({name:"product-details",params:{id:F.toString()}})},R=F=>{i.push({name:"server-details",params:{id:F.toString()}})},k=F=>{console.log(`[ServiceDetailView] showStatusChangeModal appelé avec action: ${F}`),m.value=F,C.value="",A.value=!0,console.log(`[ServiceDetailView] Modal de changement de statut affichée pour l'action ${F}`)},T=()=>{console.log("[ServiceDetailView] closeStatusModal appelé"),A.value=!1,m.value="",C.value=""},V=async()=>{if(console.log(`[ServiceDetailView] confirmStatusChange appelé pour l'action ${m.value}`),!!_.value){$.value=!0;try{let F="";switch(m.value){case"activate":F="active";break;case"suspend":F="suspended";break;case"cancel":F="cancelled";break;case"terminate":F="terminated";break;default:throw new Error(v("services.status_change.invalid_action"))}console.log(`[ServiceDetailView] Appel de servicesStore.changeServiceStatus pour le service ${_.value} avec le nouveau statut ${F}`),await t.changeServiceStatus(_.value,F,C.value),console.log(`[ServiceDetailView] Statut du service ${_.value} changé avec succès en ${F}`),w.showNotification({title:v("services.status_change.success_title"),message:v(`services.status_change.${m.value}_success`),type:"success"}),T()}catch(F){console.error("Erreur lors du changement de statut:",F),w.showNotification({title:v("common.error"),message:v("services.status_change.error"),type:"error"})}finally{$.value=!1}}};return be(()=>{a()}),(F,M)=>(N(),L("div",yI,[e("div",bI,[e("div",null,[e("h1",$I,s(c(v)("services.details.title")),1),e("span",SI,s(c(v)("services.details.description")),1)]),e("div",wI,[e("button",{class:"btn btn-outline",onClick:o},[M[5]||(M[5]=e("i",{class:"fas fa-arrow-left"},null,-1)),ne(" "+s(c(v)("common.back")),1)]),e("button",{class:"btn btn-outline",onClick:d},[M[6]||(M[6]=e("i",{class:"fas fa-edit"},null,-1)),ne(" "+s(c(v)("common.edit")),1)])])]),n.value?(N(),L("div",kI,[M[7]||(M[7]=e("div",{class:"spinner"},null,-1)),e("p",null,s(c(v)("common.loading")),1)])):x.value?(N(),L("div",CI,[M[8]||(M[8]=e("div",{class:"error-icon"},[e("i",{class:"fas fa-exclamation-triangle"})],-1)),e("h3",null,s(c(v)("common.error_occurred")),1),e("p",null,s(x.value),1),e("button",{class:"btn btn-primary",onClick:a},s(c(v)("common.retry")),1)])):r.value?(N(),L("div",AI,[e("div",EI,[e("div",OI,[e("h2",null,[ne(s(r.value.product_name||c(v)("services.details.unknown_product"))+" ",1),e("span",TI,"#"+s(r.value.id),1)]),r.value.domain?(N(),L("p",RI,s(r.value.domain),1)):J("",!0)]),e("div",xI,[e("span",{class:se(["status-badge","status-"+r.value.status])},s(c(v)(`services.status.${r.value.status}`)),3),r.value.status!=="terminated"?(N(),L("div",II,[(N(!0),L(ae,null,le(h.value,D=>(N(),L("button",{class:se(["btn btn-sm",f(D)]),key:D,onClick:U=>k(D)},[e("i",{class:se(P(D))},null,2),ne(" "+s(c(v)(`services.actions.${D}`)),1)],10,PI))),128))])):J("",!0)])]),e("div",MI,[e("div",DI,[e("div",NI,[e("h3",null,[M[9]||(M[9]=e("i",{class:"fas fa-user"},null,-1)),ne(" "+s(c(v)("services.details.client")),1)])]),e("div",LI,[e("div",UI,[e("div",VI,s(c(v)("services.details.client_name")),1),e("div",FI,s(r.value.client_name||c(v)("services.details.unknown")),1)]),e("div",qI,[e("div",BI,s(c(v)("services.details.client_email")),1),e("div",jI,s(r.value.client_email||c(v)("services.details.unknown")),1)]),e("div",GI,[e("button",{class:"btn btn-sm btn-outline",onClick:M[0]||(M[0]=D=>l(r.value.client_id))},s(c(v)("services.details.view_client")),1)])])]),e("div",zI,[e("div",HI,[e("h3",null,[M[10]||(M[10]=e("i",{class:"fas fa-box"},null,-1)),ne(" "+s(c(v)("services.details.product")),1)])]),e("div",WI,[e("div",KI,[e("div",JI,s(c(v)("services.details.product_name")),1),e("div",QI,s(r.value.product_name||c(v)("services.details.unknown")),1)]),e("div",YI,[e("button",{class:"btn btn-sm btn-outline",onClick:M[1]||(M[1]=D=>g(r.value.product_id))},s(c(v)("services.details.view_product")),1)])])]),e("div",XI,[e("div",ZI,[e("h3",null,[M[11]||(M[11]=e("i",{class:"fas fa-server"},null,-1)),ne(" "+s(c(v)("services.details.server")),1)])]),e("div",eP,[r.value.server_id?(N(),L("div",tP,[e("div",sP,[e("div",oP,s(c(v)("services.details.server_name")),1),e("div",nP,s(r.value.server_name||c(v)("services.details.unknown")),1)]),e("div",iP,[e("button",{class:"btn btn-sm btn-outline",onClick:M[2]||(M[2]=D=>R(r.value.server_id))},s(c(v)("services.details.view_server")),1)])])):(N(),L("div",rP,s(c(v)("services.details.no_server")),1))])]),e("div",aP,[e("div",lP,[e("h3",null,[M[12]||(M[12]=e("i",{class:"fas fa-file-invoice-dollar"},null,-1)),ne(" "+s(c(v)("services.details.billing")),1)])]),e("div",cP,[e("div",uP,[e("div",dP,s(c(v)("services.details.billing_cycle")),1),e("div",pP,s(E(r.value.billing_cycle)),1)]),e("div",fP,[e("div",vP,s(c(v)("services.details.next_due_date")),1),e("div",mP,s(r.value.next_due_date?S(r.value.next_due_date):c(v)("services.details.not_set")),1)]),e("div",hP,[e("div",gP,s(c(v)("services.details.recurring_amount")),1),e("div",_P,s(b(r.value.recurring_amount)),1)]),e("div",yP,[e("div",bP,s(c(v)("services.details.setup_fee")),1),e("div",$P,s(b(r.value.setup_fee)),1)])])]),e("div",SP,[e("div",wP,[e("h3",null,[M[13]||(M[13]=e("i",{class:"fas fa-calendar-alt"},null,-1)),ne(" "+s(c(v)("services.details.important_dates")),1)])]),e("div",kP,[e("div",CP,[e("div",AP,s(c(v)("services.details.created_at")),1),e("div",EP,s(r.value.created_at?O(r.value.created_at):c(v)("services.details.unknown")),1)]),r.value.status==="suspended"&&r.value.suspension_date?(N(),L("div",OP,[e("div",TP,s(c(v)("services.details.suspension_date")),1),e("div",RP,s(O(r.value.suspension_date)),1)])):J("",!0),r.value.status==="cancelled"&&r.value.cancellation_date?(N(),L("div",xP,[e("div",IP,s(c(v)("services.details.cancellation_date")),1),e("div",PP,s(O(r.value.cancellation_date)),1)])):J("",!0),r.value.status==="terminated"&&r.value.termination_date?(N(),L("div",MP,[e("div",DP,s(c(v)("services.details.termination_date")),1),e("div",NP,s(O(r.value.termination_date)),1)])):J("",!0)])]),e("div",LP,[e("div",UP,[e("h3",null,[M[14]||(M[14]=e("i",{class:"fas fa-key"},null,-1)),ne(" "+s(c(v)("services.details.login_details")),1)])]),e("div",VP,[r.value.username||r.value.password?(N(),L("div",FP,[r.value.username?(N(),L("div",qP,[e("div",BP,s(c(v)("services.details.username")),1),e("div",jP,s(r.value.username),1)])):J("",!0),r.value.password?(N(),L("div",GP,[e("div",zP,s(c(v)("services.details.password")),1),e("div",HP,[y.value?(N(),L("span",WP,s(r.value.password),1)):(N(),L("span",KP,"••••••••")),e("button",{class:"btn-icon",onClick:M[3]||(M[3]=D=>y.value=!y.value)},[e("i",{class:se(y.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])])])):J("",!0)])):(N(),L("div",JP,s(c(v)("services.details.no_login_details")),1))])]),r.value.configuration&&Object.keys(r.value.configuration).length>0?(N(),L("div",QP,[e("div",YP,[e("h3",null,[M[15]||(M[15]=e("i",{class:"fas fa-cogs"},null,-1)),ne(" "+s(c(v)("services.details.configuration")),1)])]),e("div",XP,[(N(!0),L(ae,null,le(r.value.configuration,(D,U)=>(N(),L("div",{class:"info-item",key:U},[e("div",ZP,s(U),1),e("div",eM,s(D),1)]))),128))])])):J("",!0),r.value.notes?(N(),L("div",tM,[e("div",sM,[e("h3",null,[M[16]||(M[16]=e("i",{class:"fas fa-sticky-note"},null,-1)),ne(" "+s(c(v)("services.details.notes")),1)])]),e("div",oM,[e("div",nM,s(r.value.notes),1)])])):J("",!0)])])):J("",!0),A.value?(N(),L("div",iM,[e("div",{class:"modal-backdrop",onClick:T}),e("div",rM,[e("div",aM,[e("h3",null,s(c(v)(`services.status_change.${m.value}_title`)),1),e("button",{class:"close-btn",onClick:T},M[17]||(M[17]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",lM,[e("p",null,s(c(v)(`services.status_change.${m.value}_confirmation`)),1),e("div",cM,[e("label",uM,s(c(v)("services.status_change.notes")),1),H(e("textarea",{id:"status-notes","onUpdate:modelValue":M[4]||(M[4]=D=>C.value=D),class:"form-control",placeholder:c(v)("services.status_change.notes_placeholder"),rows:"3"},null,8,dM),[[ee,C.value]])])]),e("div",pM,[e("button",{class:"btn btn-secondary",onClick:T},s(c(v)("common.cancel")),1),e("button",{class:se(["btn",p(m.value)]),onClick:V,disabled:$.value},[$.value?(N(),L("i",vM)):(N(),L("i",{key:1,class:se(P(m.value))},null,2)),ne(" "+s(c(v)(`services.actions.${m.value}`)),1)],10,fM)])])])):J("",!0)]))}}),gs=$e(mM,[["__scopeId","data-v-a8e3412d"]]),hM={id:"clientForm",class:"view-container"},gM={class:"header-box"},_M={class:"page-title"},yM={class:"page-description"},bM={class:"action-buttons"},$M={class:"form-container box"},SM={class:"form-section"},wM={class:"section-title"},kM={class:"form-grid"},CM={class:"form-group"},AM={for:"firstname",class:"form-label"},EM=["placeholder"],OM={key:0,class:"form-error"},TM={class:"form-group"},RM={for:"lastname",class:"form-label"},xM=["placeholder"],IM={key:0,class:"form-error"},PM={class:"form-group"},MM={for:"email",class:"form-label"},DM=["placeholder"],NM={key:0,class:"form-error"},LM={class:"form-group"},UM={for:"phone",class:"form-label"},VM=["placeholder"],FM={key:0,class:"form-error"},qM={class:"form-group"},BM={for:"company",class:"form-label"},jM=["placeholder"],GM={key:0,class:"form-error"},zM={class:"form-group"},HM={for:"status",class:"form-label"},WM={value:"active"},KM={value:"inactive"},JM={value:"pending"},QM={key:0,class:"form-error"},YM={class:"form-section"},XM={class:"section-title"},ZM={class:"form-grid"},eD={class:"form-group"},tD={for:"password",class:"form-label"},sD={key:0,class:"optional-text"},oD=["placeholder","required"],nD={key:0,class:"form-error"},iD={key:1,class:"form-text text-muted"},rD={class:"form-section"},aD={class:"section-title"},lD={class:"form-grid"},cD={class:"form-group"},uD={for:"address",class:"form-label"},dD=["placeholder"],pD={key:0,class:"form-error"},fD={class:"form-group"},vD={for:"postal_code",class:"form-label"},mD=["placeholder"],hD={key:0,class:"form-error"},gD={class:"form-group"},_D={for:"city",class:"form-label"},yD=["placeholder"],bD={key:0,class:"form-error"},$D={class:"form-group"},SD={for:"country",class:"form-label"},wD=["placeholder"],kD={key:0,class:"form-error"},CD={class:"form-actions"},AD=["disabled"],ED={key:0},OD={key:1},TD=_e({__name:"ClientFormView",setup(I){const t=Me(),w=Te(),{t:i}=we(),u=ze(),v=z({firstname:"",lastname:"",email:"",password:"",phone:"",company:"",address:"",postal_code:"",city:"",country:"",status:"active"}),n=z({firstname:"",lastname:"",email:"",password:"",phone:"",company:"",address:"",postal_code:"",city:"",country:"",status:""}),x=z(!1),y=X(()=>t.params.id?parseInt(t.params.id):null),A=X(()=>!!y.value),m=async()=>{if(!(!A.value||y.value===null))try{u.clients.length===0&&(console.log("Chargement de la liste des clients..."),await u.fetchClients()),console.log("Récupération du client avec ID:",y.value);const r=y.value,h=await u.getClient(r);if(console.log("Client récupéré:",h),h)console.log("Préremplissage du formulaire avec les données du client"),v.value={...v.value,firstname:h.firstname||"",lastname:h.lastname||"",email:h.email||"",password:"",phone:h.phone||"",company:h.company||"",address:h.address||"",postal_code:h.postal_code||"",city:h.city||"",country:h.country||"",status:h.status||"active"},console.log("Formulaire mis à jour:",v.value);else{console.error("Aucun client retourné par getClient");const S=u.clients.find(O=>O.id===y.value);S&&(console.log("Client trouvé dans le store:",S),v.value={...v.value,firstname:S.firstname||"",lastname:S.lastname||"",email:S.email||"",password:"",phone:S.phone||"",company:S.company||"",address:S.address||"",postal_code:S.postal_code||"",city:S.city||"",country:S.country||"",status:S.status||"active"})}}catch(r){console.error("Erreur lors de la récupération du client:",r)}},C=()=>{let r=!0;return n.value={firstname:"",lastname:"",email:"",password:"",phone:"",company:"",address:"",postal_code:"",city:"",country:"",status:""},v.value.firstname||(n.value.firstname=i("clients.validation.firstname_required"),r=!1),v.value.lastname||(n.value.lastname=i("clients.validation.lastname_required"),r=!1),v.value.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v.value.email)||(n.value.email=i("clients.validation.email_invalid"),r=!1):(n.value.email=i("clients.validation.email_required"),r=!1),!A.value&&!v.value.password&&(n.value.password=i("clients.validation.password_required"),r=!1),r},$=async()=>{if(C()){x.value=!0;try{if(A.value&&y.value!==null)await u.updateClient(y.value,v.value),w.push({name:"client-details",params:{id:y.value.toString()}});else{const r=await u.createClient(v.value);console.log("Nouveau client créé:",r),r&&r.id?(console.log("Redirection vers la page de détails du client:",r.id),w.push({name:"client-details",params:{id:r.id.toString()}})):(console.error("Impossible de rediriger: ID du client non disponible"),w.push({name:"clients"}))}}catch(r){console.error("Erreur lors de la soumission du formulaire:",r)}finally{x.value=!1}}},_=()=>{w.push({name:"clients"})};return be(m),(r,h)=>(N(),L("div",hM,[e("div",gM,[e("div",null,[e("h1",_M,s(A.value?c(i)("clients.edit.title"):c(i)("clients.add.title")),1),e("span",yM,s(A.value?c(i)("clients.edit.description"):c(i)("clients.add.description")),1)]),e("div",bM,[e("button",{class:"btn btn-outline",onClick:_},[h[11]||(h[11]=e("i",{class:"fas fa-arrow-left"},null,-1)),ne(" "+s(c(i)("common.back")),1)])])]),e("div",$M,[e("form",{onSubmit:Se($,["prevent"])},[e("div",SM,[e("h2",wM,s(c(i)("clients.form.personal_info")),1),e("div",kM,[e("div",CM,[e("label",AM,s(c(i)("clients.form.firstname")),1),H(e("input",{id:"firstname","onUpdate:modelValue":h[0]||(h[0]=S=>v.value.firstname=S),type:"text",class:"form-control",placeholder:c(i)("clients.form.firstname_placeholder"),required:""},null,8,EM),[[ee,v.value.firstname]]),n.value.firstname?(N(),L("div",OM,s(n.value.firstname),1)):J("",!0)]),e("div",TM,[e("label",RM,s(c(i)("clients.form.lastname")),1),H(e("input",{id:"lastname","onUpdate:modelValue":h[1]||(h[1]=S=>v.value.lastname=S),type:"text",class:"form-control",placeholder:c(i)("clients.form.lastname_placeholder"),required:""},null,8,xM),[[ee,v.value.lastname]]),n.value.lastname?(N(),L("div",IM,s(n.value.lastname),1)):J("",!0)]),e("div",PM,[e("label",MM,s(c(i)("clients.form.email")),1),H(e("input",{id:"email","onUpdate:modelValue":h[2]||(h[2]=S=>v.value.email=S),type:"email",class:"form-control",placeholder:c(i)("clients.form.email_placeholder"),required:""},null,8,DM),[[ee,v.value.email]]),n.value.email?(N(),L("div",NM,s(n.value.email),1)):J("",!0)]),e("div",LM,[e("label",UM,s(c(i)("clients.form.phone")),1),H(e("input",{id:"phone","onUpdate:modelValue":h[3]||(h[3]=S=>v.value.phone=S),type:"tel",class:"form-control",placeholder:c(i)("clients.form.phone_placeholder")},null,8,VM),[[ee,v.value.phone]]),n.value.phone?(N(),L("div",FM,s(n.value.phone),1)):J("",!0)]),e("div",qM,[e("label",BM,s(c(i)("clients.form.company")),1),H(e("input",{id:"company","onUpdate:modelValue":h[4]||(h[4]=S=>v.value.company=S),type:"text",class:"form-control",placeholder:c(i)("clients.form.company_placeholder")},null,8,jM),[[ee,v.value.company]]),n.value.company?(N(),L("div",GM,s(n.value.company),1)):J("",!0)]),e("div",zM,[e("label",HM,s(c(i)("clients.form.status")),1),H(e("select",{id:"status","onUpdate:modelValue":h[5]||(h[5]=S=>v.value.status=S),class:"form-control"},[e("option",WM,s(c(i)("clients.status.active")),1),e("option",KM,s(c(i)("clients.status.inactive")),1),e("option",JM,s(c(i)("clients.status.pending")),1)],512),[[pe,v.value.status]]),n.value.status?(N(),L("div",QM,s(n.value.status),1)):J("",!0)])])]),e("div",YM,[e("h2",XM,s(c(i)("clients.form.password")),1),e("div",ZM,[e("div",eD,[e("label",tD,[ne(s(c(i)("clients.form.password"))+" ",1),A.value?(N(),L("span",sD,s(c(i)("clients.form.password_optional")),1)):J("",!0)]),H(e("input",{id:"password","onUpdate:modelValue":h[6]||(h[6]=S=>v.value.password=S),type:"password",class:"form-control",placeholder:c(i)("clients.form.password_placeholder"),required:!A.value},null,8,oD),[[ee,v.value.password]]),n.value.password?(N(),L("div",nD,s(n.value.password),1)):J("",!0),A.value?(N(),L("small",iD,s(c(i)("clients.form.password_leave_empty")),1)):J("",!0)])])]),e("div",rD,[e("h2",aD,s(c(i)("clients.form.address_title")),1),e("div",lD,[e("div",cD,[e("label",uD,s(c(i)("clients.form.address")),1),H(e("input",{id:"address","onUpdate:modelValue":h[7]||(h[7]=S=>v.value.address=S),type:"text",class:"form-control",placeholder:c(i)("clients.form.address_placeholder")},null,8,dD),[[ee,v.value.address]]),n.value.address?(N(),L("div",pD,s(n.value.address),1)):J("",!0)]),e("div",fD,[e("label",vD,s(c(i)("clients.form.postal_code")),1),H(e("input",{id:"postal_code","onUpdate:modelValue":h[8]||(h[8]=S=>v.value.postal_code=S),type:"text",class:"form-control",placeholder:c(i)("clients.form.postal_code_placeholder")},null,8,mD),[[ee,v.value.postal_code]]),n.value.postal_code?(N(),L("div",hD,s(n.value.postal_code),1)):J("",!0)]),e("div",gD,[e("label",_D,s(c(i)("clients.form.city")),1),H(e("input",{id:"city","onUpdate:modelValue":h[9]||(h[9]=S=>v.value.city=S),type:"text",class:"form-control",placeholder:c(i)("clients.form.city_placeholder")},null,8,yD),[[ee,v.value.city]]),n.value.city?(N(),L("div",bD,s(n.value.city),1)):J("",!0)]),e("div",$D,[e("label",SD,s(c(i)("clients.form.country")),1),H(e("input",{id:"country","onUpdate:modelValue":h[10]||(h[10]=S=>v.value.country=S),type:"text",class:"form-control",placeholder:c(i)("clients.form.country_placeholder")},null,8,wD),[[ee,v.value.country]]),n.value.country?(N(),L("div",kD,s(n.value.country),1)):J("",!0)])])]),e("div",CD,[e("button",{type:"button",class:"btn btn-secondary",onClick:_},s(c(i)("common.cancel")),1),e("button",{type:"submit",class:"btn btn-primary",disabled:x.value},[x.value?(N(),L("span",ED,[h[12]||(h[12]=e("span",{class:"spinner-border spinner-border-sm mr-2"},null,-1)),ne(" "+s(c(i)("common.saving")),1)])):(N(),L("span",OD,s(A.value?c(i)("common.save"):c(i)("common.create")),1))],8,AD)])],32)])]))}}),yt=$e(TD,[["__scopeId","data-v-875e2c7e"]]),RD={id:"clientDetail",class:"view-container"},xD={class:"header-box"},ID={class:"page-title"},PD={class:"page-description"},MD={class:"action-buttons"},DD={key:0,class:"loading-container"},ND={key:1,class:"error-container"},LD={key:2,class:"client-detail-container box"},UD={class:"client-header"},VD={class:"client-basic-info"},FD={class:"client-avatar-container"},qD=["src"],BD={class:"client-title"},jD={class:"client-id"},GD={class:"client-status"},zD={class:"client-actions"},HD={class:"tabs-container"},WD={class:"tabs-header"},KD=["onClick"],JD={key:0,class:"tab-content"},QD={class:"detail-section"},YD={class:"section-title"},XD={class:"detail-grid"},ZD={class:"detail-item"},e8={class:"detail-label"},t8={class:"detail-value"},s8={class:"detail-item"},o8={class:"detail-label"},n8={class:"detail-value"},i8={class:"detail-item"},r8={class:"detail-label"},a8={class:"detail-value"},l8={class:"detail-item"},c8={class:"detail-label"},u8={class:"detail-value"},d8={class:"detail-item"},p8={class:"detail-label"},f8={class:"detail-value"},v8={class:"detail-item"},m8={class:"detail-label"},h8={class:"detail-value"},g8={class:"detail-section"},_8={class:"section-title"},y8={class:"detail-grid"},b8={class:"detail-item"},$8={class:"detail-label"},S8={class:"detail-value"},w8={class:"detail-item"},k8={class:"detail-label"},C8={class:"detail-value"},A8={class:"detail-item"},E8={class:"detail-label"},O8={class:"detail-value"},T8={class:"detail-item"},R8={class:"detail-label"},x8={class:"detail-value"},I8={key:1,class:"tab-content"},P8={class:"services-header"},M8={class:"section-title"},D8={key:0,class:"empty-state-small"},N8={key:1,class:"services-list"},L8=["onClick"],U8={class:"service-card-header"},V8={class:"service-card-body"},F8={key:0,class:"service-domain"},q8={class:"service-details"},B8={class:"service-detail-item"},j8={class:"detail-label"},G8={class:"detail-value"},z8={class:"service-detail-item"},H8={class:"detail-label"},W8={class:"detail-value"},K8={key:2,class:"tab-content"},J8={class:"section-title"},Q8={class:"empty-state-small"},Y8={key:3,class:"modal show",style:{display:"flex","align-items":"center","justify-content":"center"}},X8={class:"modal-content",style:{position:"fixed","z-index":"1052","max-height":"80vh","backdrop-filter":"none","-webkit-backdrop-filter":"none"}},Z8={class:"modal-header"},eN={class:"modal-body"},tN={class:"warning"},sN={class:"modal-footer"},oN=["disabled"],nN=["disabled"],iN={key:0},rN={key:1},aN=_e({__name:"ClientDetailView",setup(I){const t=Me(),w=Te(),{t:i}=we(),u=ze(),v=st(),n=z(null),x=z([]),y=z(!0),A=z(""),m=z("info"),C=z(!1),$=z(!1),_=[{id:"info",name:i("clients.details.tab_info"),icon:"fas fa-user"},{id:"services",name:i("clients.details.tab_services"),icon:"fas fa-server"},{id:"invoices",name:i("clients.details.tab_invoices"),icon:"fas fa-file-invoice"}],r=async()=>{y.value=!0,A.value="";try{u.clients.length===0&&(console.log("Chargement de la liste des clients..."),await u.fetchClients());const a=parseInt(t.params.id);if(n.value=await u.getClient(a),console.log("Client récupéré dans ClientDetailView:",n.value),!n.value){console.log("Recherche du client dans le store...");const o=u.clients.find(d=>d.id===a);o?(console.log("Client trouvé dans le store:",o),n.value=o):(console.error("Client non trouvé dans le store"),A.value=i("clients.details.not_found"))}try{console.log("Récupération des services du client...");const o=await v.fetchClientServices(a);console.log("Services du client récupérés:",o),o&&Array.isArray(o.data)?x.value=o.data:o&&o.data?x.value=Array.isArray(o.data)?o.data:[o.data]:(console.log("Aucun service trouvé pour ce client"),x.value=[])}catch(o){console.error("Erreur lors de la récupération des services du client:",o),x.value=[]}}catch(a){console.error("Erreur lors de la récupération du client:",a),A.value=i("clients.details.error_loading")}finally{y.value=!1}},h=a=>{try{return et(new Date(a),"dd/MM/yyyy",{locale:Ke})}catch{return a}},S=a=>a===void 0?"-":new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(a),O=()=>{w.push({name:"clients"})},b=()=>{w.push({name:"edit-client",params:{id:t.params.id}})},E=()=>{C.value=!0},P=async()=>{if(n.value)try{$.value=!0,await u.deleteClient(n.value.id),w.push({name:"clients"})}catch(a){console.error("Erreur lors de la suppression du client:",a),A.value=i("clients.details.error_deleting")}finally{$.value=!1,C.value=!1}},f=a=>{w.push({name:"service-details",params:{id:a.toString()}})},p=()=>{w.push({name:"create-service",query:{client_id:n.value?n.value.id.toString():""}})};return be(r),(a,o)=>(N(),L("div",RD,[e("div",xD,[e("div",null,[e("h1",ID,s(c(i)("clients.details.title")),1),e("span",PD,s(c(i)("clients.details.description")),1)]),e("div",MD,[e("button",{class:"btn btn-outline",onClick:O},[o[3]||(o[3]=e("i",{class:"fas fa-arrow-left"},null,-1)),ne(" "+s(c(i)("common.back")),1)]),e("button",{class:"btn btn-outline",onClick:b},[o[4]||(o[4]=e("i",{class:"fas fa-edit"},null,-1)),ne(" "+s(c(i)("common.edit")),1)])])]),y.value?(N(),L("div",DD,[o[5]||(o[5]=e("div",{class:"spinner"},null,-1)),e("p",null,s(c(i)("common.loading")),1)])):A.value?(N(),L("div",ND,[o[6]||(o[6]=e("div",{class:"error-icon"},[e("i",{class:"fas fa-exclamation-triangle"})],-1)),e("h3",null,s(c(i)("common.error_occurred")),1),e("p",null,s(A.value),1),e("button",{class:"btn btn-primary",onClick:r},s(c(i)("common.retry")),1)])):n.value?(N(),L("div",LD,[e("div",UD,[e("div",VD,[e("div",FD,[e("img",{src:`https://www.gravatar.com/avatar/${c(Ps)(n.value.email.toLowerCase())}?s=80&d=mp`,alt:"Avatar",class:"client-avatar"},null,8,qD)]),e("div",BD,[e("h2",null,s(n.value.firstname)+" "+s(n.value.lastname),1),e("span",jD,"#"+s(n.value.id),1),e("div",GD,[e("span",{class:se(`status-badge status-${n.value.status}`)},s(c(i)(`clients.status.${n.value.status}`)),3)])])]),e("div",zD,[e("button",{class:"btn btn-outline-danger",onClick:E},[o[7]||(o[7]=e("i",{class:"fas fa-trash"},null,-1)),ne(" "+s(c(i)("clients.actions.delete")),1)])])]),e("div",HD,[e("div",WD,[(N(),L(ae,null,le(_,d=>e("button",{key:d.id,class:se(["tab-button",{active:m.value===d.id}]),onClick:l=>m.value=d.id},[e("i",{class:se(d.icon)},null,2),ne(" "+s(d.name),1)],10,KD)),64))]),m.value==="info"?(N(),L("div",JD,[e("div",QD,[e("h3",YD,s(c(i)("clients.details.personal_info")),1),e("div",XD,[e("div",ZD,[e("span",e8,s(c(i)("clients.form.firstname")),1),e("span",t8,s(n.value.firstname),1)]),e("div",s8,[e("span",o8,s(c(i)("clients.form.lastname")),1),e("span",n8,s(n.value.lastname),1)]),e("div",i8,[e("span",r8,s(c(i)("clients.form.email")),1),e("span",a8,s(n.value.email),1)]),e("div",l8,[e("span",c8,s(c(i)("clients.form.phone")),1),e("span",u8,s(n.value.phone||"-"),1)]),e("div",d8,[e("span",p8,s(c(i)("clients.form.company")),1),e("span",f8,s(n.value.company||"-"),1)]),e("div",v8,[e("span",m8,s(c(i)("clients.form.status")),1),e("span",h8,[e("span",{class:se(`status-badge status-${n.value.status}`)},s(c(i)(`clients.status.${n.value.status}`)),3)])])])]),e("div",g8,[e("h3",_8,s(c(i)("clients.details.address")),1),e("div",y8,[e("div",b8,[e("span",$8,s(c(i)("clients.form.address")),1),e("span",S8,s(n.value.address||"-"),1)]),e("div",w8,[e("span",k8,s(c(i)("clients.form.city")),1),e("span",C8,s(n.value.city||"-"),1)]),e("div",A8,[e("span",E8,s(c(i)("clients.form.postal_code")),1),e("span",O8,s(n.value.postal_code||"-"),1)]),e("div",T8,[e("span",R8,s(c(i)("clients.form.country")),1),e("span",x8,s(n.value.country||"-"),1)])])])])):m.value==="services"?(N(),L("div",I8,[e("div",P8,[e("h3",M8,s(c(i)("clients.details.services")),1),e("button",{class:"btn btn-sm btn-gradient",onClick:p},[o[8]||(o[8]=e("i",{class:"fas fa-plus"},null,-1)),ne(" "+s(c(i)("services.add_new")),1)])]),x.value.length===0?(N(),L("div",D8,[o[9]||(o[9]=e("i",{class:"fas fa-server"},null,-1)),e("p",null,s(c(i)("clients.details.no_services")),1)])):(N(),L("div",N8,[(N(!0),L(ae,null,le(x.value,d=>(N(),L("div",{key:d.id,class:"service-card",onClick:l=>f(d.id)},[e("div",U8,[e("h4",null,s(d.product_name||c(i)("services.details.unknown_product")),1),e("span",{class:se(`status-badge status-${d.status}`)},s(c(i)(`services.status.${d.status}`)),3)]),e("div",V8,[d.domain?(N(),L("div",F8,[o[10]||(o[10]=e("i",{class:"fas fa-globe"},null,-1)),e("span",null,s(d.domain),1)])):J("",!0),e("div",q8,[e("div",B8,[e("span",j8,s(c(i)("services.table.next_due_date")),1),e("span",G8,s(d.next_due_date?h(d.next_due_date):"-"),1)]),e("div",z8,[e("span",H8,s(c(i)("services.table.recurring_amount")),1),e("span",W8,s(S(d.recurring_amount)),1)])])])],8,L8))),128))]))])):m.value==="invoices"?(N(),L("div",K8,[e("h3",J8,s(c(i)("clients.details.invoices")),1),e("div",Q8,[o[11]||(o[11]=e("i",{class:"fas fa-file-invoice"},null,-1)),e("p",null,s(c(i)("clients.details.no_invoices")),1)])])):J("",!0)])])):J("",!0),C.value?(N(),L("div",Y8,[e("div",{class:"modal-backdrop",onClick:o[0]||(o[0]=d=>C.value=!1)}),e("div",X8,[e("div",Z8,[e("h3",null,s(c(i)("clients.delete_modal.title")),1),e("button",{class:"close-btn",onClick:o[1]||(o[1]=d=>C.value=!1)},o[12]||(o[12]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",eN,[e("p",null,s(c(i)("clients.delete_modal.confirmation")),1),e("p",tN,s(c(i)("clients.delete_modal.warning")),1)]),e("div",sN,[e("button",{class:"btn btn-secondary",onClick:o[2]||(o[2]=d=>C.value=!1),disabled:$.value},s(c(i)("common.cancel")),9,oN),e("button",{class:"btn btn-danger",onClick:P,disabled:$.value},[$.value?(N(),L("span",iN,[o[13]||(o[13]=e("span",{class:"spinner-border spinner-border-sm mr-2"},null,-1)),ne(" "+s(c(i)("common.deleting"))+"... ",1)])):(N(),L("span",rN,s(c(i)("common.delete")),1))],8,nN)])])])):J("",!0)]))}}),_s=$e(aN,[["__scopeId","data-v-1cfe66cf"]]);console.log("[ROUTER] Importation des composants:");console.log("- DashboardView:",!!Mt);console.log("- LoginView:",!!Dt);console.log("- ClientsView:",!!qt);console.log("- ProductsView:",!!Bt);console.log("- CreateProductView:",!!rt);console.log("- InvoicesView:",!!Zt);console.log("- PaymentsView:",!!es);console.log("- SubscriptionsView:",!!ss);console.log("- TicketsView:",!!ns);console.log("- SettingsView:",!!is);console.log("- ServersView:",!!rs);console.log("- GeneralView:",!!as);console.log("- SecurityView:",!!ls);console.log("- LicenseView:",!!ps);console.log("- InvalidLicenseView:",!!fs);console.log("- NotFoundView:",!!vs);console.log("- NotificationsView:",!!ms);console.log("- NotificationsSettingsView:",!!cs);console.log("- BillingView:",!!us);console.log("- IntegrationsView:",!!ds);console.log("- ProductDetailsView:",!!jt);console.log("- ProductPricingView:",!!Gt);console.log("- ProductModuleView:",!!zt);console.log("- ProductCustomFieldsView:",!!Ht);console.log("- ProductConfigurableOptionsView:",!!Wt);console.log("- ProductUpgradesView:",!!Kt);console.log("- ProductFreedomainView:",!!Jt);console.log("- ProductCrossSellsView:",!!Qt);console.log("- ProductOtherView:",!!Yt);console.log("- ProductLinksView:",!!Xt);console.log("- ServicesView:",!!hs);console.log("- ServiceFormView:",!!_t);console.log("- ServiceDetailView:",!!gs);console.log("- ClientFormView:",!!yt);console.log("- ClientDetailView:",!!_s);const lN="/admin",tt=Cs({history:As(lN),routes:[{path:"/",redirect:"/dashboard"},{path:"/login",name:"login",component:Dt,meta:{public:!0,onlyWhenLoggedOut:!0,requiresAuth:!1}},{path:"/dashboard",name:"dashboard",component:Mt,meta:{public:!1,requiresAuth:!0}},{path:"/clients",name:"clients",component:qt,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/clients/create",name:"create-client",component:yt,meta:{requiresAuth:!0}},{path:"/clients/:id/edit",name:"edit-client",component:yt,meta:{requiresAuth:!0}},{path:"/clients/:id",name:"client-details",component:_s,meta:{requiresAuth:!0}},{path:"/products",name:"products",component:Bt,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/products/create",name:"create-product",component:rt,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/products/:idOrAction",component:rt,props:!0,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1},children:[{path:"",name:"product-details",component:jt,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"type",name:"product-type",component:rt,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"pricing",name:"product-pricing",component:Gt,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"module",name:"product-module",component:zt,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"custom-fields",name:"product-custom-fields",component:Ht,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"configurable-options",name:"product-configurable-options",component:Wt,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"upgrades",name:"product-upgrades",component:Kt,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"freedomain",name:"product-freedomain",component:Jt,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"cross-sells",name:"product-cross-sells",component:Qt,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"other",name:"product-other",component:Yt,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"links",name:"product-links",component:Xt,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}}]},{path:"/invoices",name:"invoices",component:Zt,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/payments",name:"payments",component:es,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/subscriptions",name:"subscriptions",component:ss,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/tickets",name:"tickets",component:ns,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/settings",name:"settings",component:is,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/settings/servers",name:"settings-servers",component:rs,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/settings/general",name:"settings-general",component:as,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/settings/security",name:"settings-security",component:ls,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/settings/notifications",name:"settings-notifications",component:cs,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/settings/billing",name:"settings-billing",component:us,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/settings/integrations",name:"settings-integrations",component:ds,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/settings/license",name:"settings-license",component:ps,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/license",name:"invalid-license",component:fs,meta:{public:!0,requiresAuth:!1,onlyWhenLoggedOut:!1}},{path:"/notifications",name:"notifications",component:ms,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/services",name:"services",component:hs,meta:{requiresAuth:!0}},{path:"/services/create",name:"create-service",component:_t,meta:{requiresAuth:!0}},{path:"/services/:id/edit",name:"edit-service",component:_t,meta:{requiresAuth:!0}},{path:"/services/:id",name:"service-details",component:gs,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",name:"not-found",component:vs,meta:{public:!0,requiresAuth:!1,onlyWhenLoggedOut:!1}},{path:"/products/create",redirect:I=>"/products/create"},{path:"/products/:id/edit",redirect:I=>`/products/${I.params.id}`},{path:"/products/details/:type",redirect:I=>"/products/create"},{path:"/products/pricing/:type",redirect:I=>"/products/create/pricing"},{path:"/products/module/:type",redirect:I=>"/products/create/module"},{path:"/products/custom-fields/:type",redirect:I=>"/products/create/custom-fields"},{path:"/products/configurable-options/:type",redirect:I=>"/products/create/configurable-options"},{path:"/products/upgrades/:type",redirect:I=>"/products/create/upgrades"},{path:"/products/freedomain/:type",redirect:I=>"/products/create/freedomain"},{path:"/products/cross-sells/:type",redirect:I=>"/products/create/cross-sells"},{path:"/products/other/:type",redirect:I=>"/products/create/other"},{path:"/products/links/:type",redirect:I=>"/products/create/links"}]});tt.beforeEach(async(I,t,w)=>{const i=Ge();if(console.log("[ROUTER] Navigation de",t.path,"vers",I.path,"Route:",I.name),i.initialized||(console.log("[ROUTER] Initialisation du store d'authentification"),await i.init()),I.meta.requiresAuth&&(console.log("[ROUTER] Route protégée, vérification auth:",i.isAuthenticated),!i.isAuthenticated))try{if(console.log("[ROUTER] Vérification de l'authentification avec le serveur"),!await i.checkAuth())return console.log("[ROUTER] Redirection vers login - Authentification requise"),w({name:"login",query:{redirect:I.fullPath}});console.log("[ROUTER] Authentification confirmée par le serveur")}catch(u){return console.error("[ROUTER] Erreur lors de la vérification de l'authentification:",u),w({name:"login",query:{redirect:I.fullPath}})}if(I.meta.onlyWhenLoggedOut&&i.isAuthenticated)return console.log("[ROUTER] Redirection vers dashboard - Déjà authentifié"),w({name:"dashboard"});if(I.matched.length===0)return console.log("[ROUTER] Route non trouvée, redirection vers dashboard"),w({name:"dashboard"});console.log("[ROUTER] Navigation autorisée vers",I.path),w()});console.log("[AXIOS] Configuration de l'instance Axios");const he=me.create({baseURL:"",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},withCredentials:!0});he.interceptors.request.use(I=>{var t;return console.log("[AXIOS] Requête sortante:",(t=I.method)==null?void 0:t.toUpperCase(),I.url),I.url&&(I.url=I.url.replace(/([^:]\/)\/+/g,"$1")),I},I=>(console.error("[AXIOS] Erreur de requête:",I),Promise.reject(I)));let ht=!1;he.interceptors.response.use(I=>(console.log("[AXIOS] Réponse reçue:",I.status,I.config.url),I),async I=>{var w,i,u,v,n;console.error("[AXIOS] Erreur de réponse:",(w=I.response)==null?void 0:w.status,I.config.url);const t=Ge();return((i=I.response)==null?void 0:i.status)===401&&(console.log("[AXIOS] Erreur 401 détectée",I.config.url),!((u=I.config.url)!=null&&u.includes("/auth/check"))&&!((v=I.config.url)!=null&&v.includes("/auth/login"))&&!((n=I.config.url)!=null&&n.includes("/auth/logout"))&&!ht&&(console.log("[AXIOS] Déconnexion requise"),ht=!0,await t.logout(),ht=!1,tt.push("/login"))),Promise.reject(I)});console.log("[AUTH STORE] Initialisation du store d'authentification");const Ge=Pe("auth",{persist:{key:"auth-state",paths:["initialized"],storage:sessionStorage},state:()=>({user:null,loading:!1,error:null,initialized:!1}),getters:{isAuthenticated:I=>!!I.user,userFullName:I=>I.user?`${I.user.firstName} ${I.user.lastName}`:""},actions:{async init(){var I;if(this.initialized){console.log("[AUTH STORE] Déjà initialisé");return}console.log("[AUTH STORE] Initialisation...");try{const t=await he.get("/api/v1/auth/check");(I=t.data)!=null&&I.user&&(console.log("[AUTH STORE] Utilisateur authentifié:",t.data.user),this.user=t.data.user)}catch{console.log("[AUTH STORE] Non authentifié"),this.user=null}finally{this.initialized=!0}},async login(I,t,w=!1){var i;console.log("[AUTH STORE] Tentative de connexion pour:",I);try{this.loading=!0,this.error=null;const u=await he.post("/api/v1/auth/login",{email:I,password:t,remember:w});if(!((i=u.data)!=null&&i.user))throw new Error("Réponse invalide du serveur");return this.user=u.data.user,tt.push("/dashboard"),!0}catch(u){return console.error("[AUTH STORE] Erreur de connexion:",u),this.error=u.message,!1}finally{this.loading=!1}},async logout(){if(!this.user){console.log("[AUTH STORE] Utilisateur déjà déconnecté");return}try{console.log("[AUTH STORE] Tentative de déconnexion"),await he.post("/api/v1/auth/logout")}catch(I){console.error("[AUTH STORE] Erreur lors de la déconnexion:",I)}finally{this.user=null,this.initialized=!1,tt.push("/login")}},async checkAuth(){var I;try{console.log("[AUTH STORE] Vérification de l'authentification");const t=await he.get("/api/v1/auth/check");return(I=t.data)!=null&&I.user?(console.log("[AUTH STORE] Utilisateur authentifié:",t.data.user),this.user=t.data.user,!0):(console.log("[AUTH STORE] Utilisateur non authentifié"),!1)}catch(t){return console.error("[AUTH STORE] Erreur lors de la vérification de l'authentification:",t),this.user=null,!1}},async forgotPassword(I){console.log("[AUTH STORE] Demande de réinitialisation pour:",I);try{const t=await he.post("/api/v1/auth/forgot-password",{email:I});return console.log("[AUTH STORE] Email de réinitialisation envoyé"),t.data}catch(t){throw console.error("[AUTH STORE] Erreur lors de la demande:",t),t}},async resetPassword(I,t){try{return this.loading=!0,this.error=null,await he.post("/api/v1/auth/reset-password",{token:I,password:t}),!0}catch(w){return this.error=w.message,!1}finally{this.loading=!1}},async updateLanguage(I){console.log(`[AUTH STORE] Changement de langue vers: ${I}`);try{return this.user&&(this.user={...this.user,language:I}),!0}catch(t){return console.error("[AUTH STORE] Erreur lors du changement de langue:",t),!1}}}}),wt=Pe("theme",()=>{console.log("[THEME STORE] Initialisation du store de thème");const I=z(localStorage.getItem("darkMode")==="true"),t=()=>{console.log("[THEME STORE] Basculement du mode sombre"),I.value=!I.value,localStorage.setItem("darkMode",I.value.toString())};return Ne(I,w=>{console.log("[THEME STORE] Application du thème:",w?"sombre":"clair"),w?(document.documentElement.classList.add("dark"),document.body.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.body.classList.remove("dark"))},{immediate:!0}),{darkMode:I,toggleDarkMode:t}}),cN=Pe("language",{state:()=>({currentLanguage:localStorage.getItem("language")||"fr"}),actions:{setLanguage(I){return console.log(`[LANGUAGE STORE] Changement de langue vers: ${I}`),this.currentLanguage=I,localStorage.setItem("language",I),!0}},persist:{key:"language-state",storage:localStorage}}),uN={md5(I){return Ms.MD5(I).toString()}},dN={class:"top-bar","data-component":"topbar"},pN={class:"search-bar"},fN=["placeholder"],vN={class:"top-bar-actions"},mN={class:"current-lang"},hN={class:"menu-header"},gN={class:"menu-items"},_N={class:"label"},yN={key:0,class:"fas fa-check"},bN={class:"label"},$N={key:0,class:"fas fa-check"},SN=["aria-label"],wN={key:0,class:"badge"},kN={class:"notifications-header"},CN={id:"notification-title"},AN=["aria-label"],EN={class:"notifications-list"},ON={key:0,class:"empty-notifications"},TN={class:"notification-icon"},RN={class:"notification-content"},xN={class:"notification-title"},IN={class:"notification-message"},PN={class:"notification-time"},MN=["onClick"],DN={class:"notifications-footer"},NN=["src"],LN={class:"username"},UN={class:"menu-header"},VN={class:"user-info"},FN=["src"],qN={class:"user-details"},BN={class:"username"},jN={class:"email"},GN={class:"menu-items"},zN=_e({__name:"AppHeader",setup(I){const{t,locale:w}=we(),i=Te(),u=Ge(),v=de(),n=wt(),x=cN(),y=z(""),A=z(!1),m=z(!1),C=z(!1),$=z(null),_=z(null),r=z(null),h=X(()=>x.currentLanguage),S=X(()=>n.isDarkMode),O=X(()=>v.unreadCount),b=X(()=>v.notifications),E=X(()=>{var D;return((D=u.user)==null?void 0:D.username)||""}),P=X(()=>{var D;return((D=u.user)==null?void 0:D.email)||""}),f=X(()=>{var U;return`https://www.gravatar.com/avatar/${(U=u.user)!=null&&U.email?uN.md5(u.user.email.toLowerCase().trim()):""}?s=40&d=identicon`}),p=()=>{},a=()=>{A.value=!A.value,m.value=!1,C.value=!1},o=async D=>{await u.updateLanguage(D),x.setLanguage(D),w.value=D,A.value=!1},d=()=>{n.toggleDarkMode()},l=()=>{m.value=!m.value,A.value=!1,C.value=!1},g=D=>{v.markAsRead(D)},R=()=>{v.markAllAsRead()},k=()=>{C.value=!C.value,A.value=!1,m.value=!1},T=async()=>{await u.logout(),i.push("/login")},V=D=>{const U=typeof D=="string"?new Date(D):D;return Ds(U,{addSuffix:!0,locale:w.value==="fr"?Ke:Ns})},F=()=>{m.value=!1},M=D=>{$.value&&!$.value.contains(D.target)&&(A.value=!1),_.value&&!_.value.contains(D.target)&&(m.value=!1),r.value&&!r.value.contains(D.target)&&(C.value=!1)};return be(()=>{document.addEventListener("click",M)}),Tt(()=>{document.removeEventListener("click",M)}),(D,U)=>{const B=He("router-link");return N(),L("div",dN,[e("div",pN,[U[3]||(U[3]=e("i",{class:"fas fa-search"},null,-1)),H(e("input",{type:"text",placeholder:D.$t("common.search"),"onUpdate:modelValue":U[0]||(U[0]=Q=>y.value=Q),onInput:p},null,40,fN),[[ee,y.value]])]),e("div",vN,[e("div",{class:"dropdown",ref_key:"languageDropdown",ref:$},[e("button",{class:"btn-icon dropdown-toggle",onClick:a},[U[4]||(U[4]=e("i",{class:"fas fa-globe"},null,-1)),e("span",mN,s(h.value.toUpperCase()),1),U[5]||(U[5]=e("i",{class:"fas fa-chevron-down"},null,-1))]),e("div",{class:se(["dropdown-menu",{show:A.value}])},[e("div",hN,[e("h3",null,s(D.$t("common.language.select")),1)]),e("div",gN,[e("a",{href:"#",class:se(["menu-item",{active:h.value==="fr"}]),onClick:U[1]||(U[1]=Se(Q=>o("fr"),["prevent"]))},[U[6]||(U[6]=e("span",{class:"flag"},"🇫🇷",-1)),e("span",_N,s(D.$t("common.language.fr")),1),h.value==="fr"?(N(),L("i",yN)):J("",!0)],2),e("a",{href:"#",class:se(["menu-item",{active:h.value==="en"}]),onClick:U[2]||(U[2]=Se(Q=>o("en"),["prevent"]))},[U[7]||(U[7]=e("span",{class:"flag"},"🇬🇧",-1)),e("span",bN,s(D.$t("common.language.en")),1),h.value==="en"?(N(),L("i",$N)):J("",!0)],2)])],2)],512),e("button",{class:"btn-icon",onClick:d},[e("i",{class:se(S.value?"fas fa-sun":"fas fa-moon")},null,2)]),e("div",{class:"notifications-container",ref_key:"notificationsDropdown",ref:_},[e("button",{type:"button",class:"btn-icon notification-btn","aria-label":D.$t("topbar.notifications.toggle"),onClick:l},[U[8]||(U[8]=e("i",{class:"fas fa-bell"},null,-1)),O.value>0?(N(),L("span",wN,s(O.value),1)):J("",!0)],8,SN),e("div",{class:se(["notification-panel",{show:m.value}]),role:"dialog","aria-labelledby":"notification-title"},[e("div",kN,[e("h3",CN,s(D.$t("topbar.notifications.title")),1),e("button",{type:"button",class:"mark-all-read",onClick:R,"aria-label":D.$t("topbar.notifications.mark_all_read")},[U[9]||(U[9]=e("i",{class:"fas fa-check-double"},null,-1)),e("span",null,s(D.$t("topbar.notifications.mark_all_read")),1)],8,AN)]),e("div",EN,[b.value.length===0?(N(),L("div",ON,[U[10]||(U[10]=e("i",{class:"fas fa-bell-slash"},null,-1)),e("p",null,s(D.$t("topbar.notifications.empty")),1)])):(N(!0),L(ae,{key:1},le(b.value,Q=>(N(),L("div",{key:Q.id,class:se(["notification-item",{unread:!Q.read}])},[e("div",TN,[e("i",{class:se(Q.icon)},null,2)]),e("div",RN,[e("div",xN,s(Q.title),1),e("div",IN,s(Q.message),1),e("div",PN,s(V(Q.time)),1)]),Q.read?J("",!0):(N(),L("button",{key:0,class:"notification-action",onClick:te=>g(Q.id)},U[11]||(U[11]=[e("i",{class:"fas fa-check"},null,-1)]),8,MN))],2))),128))]),e("div",DN,[Ce(B,{to:"/notifications",onClick:F},{default:Ee(()=>[ne(s(D.$t("topbar.notifications.view_all"))+" ",1),U[12]||(U[12]=e("i",{class:"fas fa-arrow-right"},null,-1))]),_:1})])],2)],512),e("div",{class:"profile-container",ref_key:"profileDropdown",ref:r},[e("button",{class:"profile-btn",onClick:k},[e("img",{src:f.value,alt:"Avatar",class:"avatar"},null,8,NN),e("span",LN,s(E.value),1),U[13]||(U[13]=e("i",{class:"fas fa-chevron-down"},null,-1))]),e("div",{class:se(["profile-menu",{show:C.value}])},[e("div",UN,[e("div",VN,[e("img",{src:f.value,alt:"Avatar",class:"avatar"},null,8,FN),e("div",qN,[e("div",BN,s(E.value),1),e("div",jN,s(P.value),1)])])]),e("div",GN,[Ce(B,{to:"/profile",class:"menu-item"},{default:Ee(()=>[U[14]||(U[14]=e("i",{class:"fas fa-user"},null,-1)),e("span",null,s(D.$t("topbar.profile.my_profile")),1)]),_:1}),Ce(B,{to:"/settings",class:"menu-item"},{default:Ee(()=>[U[15]||(U[15]=e("i",{class:"fas fa-cog"},null,-1)),e("span",null,s(D.$t("topbar.profile.settings")),1)]),_:1}),U[17]||(U[17]=e("div",{class:"menu-divider"},null,-1)),e("a",{href:"#",class:"menu-item text-red-600",onClick:Se(T,["prevent"])},[U[16]||(U[16]=e("i",{class:"fas fa-sign-out-alt"},null,-1)),e("span",null,s(D.$t("topbar.profile.logout")),1)])])],2)],512)])])}}}),HN=$e(zN,[["__scopeId","data-v-2b83a61c"]]),WN="/admin/dist/assets/logo-Bg22NIcH.png",KN={class:"sidebar","data-component":"sidebar"},JN={class:"sidebar-header"},QN={class:"sidebar-nav"},YN={key:0,class:"badge"},XN=_e({__name:"AppSidebar",setup(I){const t=Me(),{t:w}=we(),i=de(),u=z([]),v=X(()=>i.unreadCount),n=A=>{console.log("Tentative d'ouverture du sous-menu:",A),u.value.indexOf(A)===-1?(u.value=[A],console.log(`Sous-menu ${A} ouvert`)):(u.value=[],console.log(`Sous-menu ${A} fermé`)),console.log("État des sous-menus après toggle:",u.value)};be(()=>{var C;console.log("Route actuelle:",t.name);const A=((C=t.name)==null?void 0:C.toString())||"";let m="";A==="products"?m="catalogue":A==="invoices"||A==="payments"||A==="subscriptions"?m="billing":(A==="tickets"||A==="kb")&&(m="support"),console.log("Menu à ouvrir:",m),m&&!u.value.includes(m)&&u.value.push(m),document.addEventListener("click",y)}),Es(()=>{document.removeEventListener("click",y)});const x=()=>{document.body.classList.toggle("sidebar-open")},y=A=>{if(document.body.classList.contains("sidebar-open")&&window.innerWidth<=768){const m=document.querySelector(".sidebar"),C=document.querySelector(".sidebar-toggle");m&&!m.contains(A.target)&&C&&!C.contains(A.target)&&document.body.classList.remove("sidebar-open")}};return(A,m)=>{const C=He("router-link");return N(),L("aside",KN,[e("div",JN,[Ce(C,{to:"/dashboard",class:"logo"},{default:Ee(()=>m[3]||(m[3]=[e("img",{src:WN,alt:"TechCMS"},null,-1)])),_:1}),e("button",{class:"sidebar-toggle",onClick:x},m[4]||(m[4]=[e("i",{class:"fas fa-bars"},null,-1)]))]),e("nav",QN,[e("ul",null,[e("li",{class:se({active:c(t).name==="dashboard"})},[Ce(C,{to:"/dashboard"},{default:Ee(()=>[m[5]||(m[5]=e("i",{class:"fas fa-home"},null,-1)),e("span",null,s(A.$t("sidebar.menu.dashboard")),1)]),_:1})],2),e("li",{class:se({active:c(t).name==="clients"})},[Ce(C,{to:"/clients"},{default:Ee(()=>[m[6]||(m[6]=e("i",{class:"fas fa-users"},null,-1)),e("span",null,s(A.$t("sidebar.menu.clients")),1)]),_:1})],2),e("li",{class:se({active:c(t).name&&c(t).name.toString().includes("service")})},[Ce(C,{to:"/services"},{default:Ee(()=>[m[7]||(m[7]=e("i",{class:"fas fa-server"},null,-1)),e("span",null,s(A.$t("sidebar.menu.services")),1)]),_:1})],2),e("li",{class:se(["has-submenu",{"submenu-open":u.value.includes("catalogue")}])},[e("a",{href:"#",class:se(["menu-toggle",{active:c(t).name==="products"}]),onClick:m[0]||(m[0]=Se($=>n("catalogue"),["prevent"]))},[m[8]||(m[8]=e("i",{class:"fas fa-cube"},null,-1)),e("span",null,s(A.$t("sidebar.menu.catalog.title")),1),m[9]||(m[9]=e("i",{class:"fas fa-chevron-right menu-arrow"},null,-1))],2),e("ul",{class:se(["submenu",{show:u.value.includes("catalogue")}])},[e("li",{class:se({active:c(t).name==="products"})},[Ce(C,{to:"/products"},{default:Ee(()=>[m[10]||(m[10]=e("i",{class:"fas fa-cogs"},null,-1)),e("span",null,s(A.$t("sidebar.menu.catalog.products_services")),1)]),_:1})],2)],2)],2),e("li",{class:se(["has-submenu",{"submenu-open":u.value.includes("billing")}])},[e("a",{href:"#",class:se(["menu-toggle",{active:c(t).name==="invoices"||c(t).name==="payments"||c(t).name==="subscriptions"}]),onClick:m[1]||(m[1]=Se($=>n("billing"),["prevent"]))},[m[11]||(m[11]=e("i",{class:"fas fa-file-invoice-dollar"},null,-1)),e("span",null,s(A.$t("sidebar.menu.billing.title")),1),m[12]||(m[12]=e("i",{class:"fas fa-chevron-right menu-arrow"},null,-1))],2),e("ul",{class:se(["submenu",{show:u.value.includes("billing")}])},[e("li",{class:se({active:c(t).name==="invoices"})},[Ce(C,{to:"/invoices"},{default:Ee(()=>[m[13]||(m[13]=e("i",{class:"fas fa-file-invoice"},null,-1)),e("span",null,s(A.$t("sidebar.menu.billing.invoices")),1)]),_:1})],2),e("li",{class:se({active:c(t).name==="payments"})},[Ce(C,{to:"/payments"},{default:Ee(()=>[m[14]||(m[14]=e("i",{class:"fas fa-credit-card"},null,-1)),e("span",null,s(A.$t("sidebar.menu.billing.payments")),1)]),_:1})],2),e("li",{class:se({active:c(t).name==="subscriptions"})},[Ce(C,{to:"/subscriptions"},{default:Ee(()=>[m[15]||(m[15]=e("i",{class:"fas fa-sync"},null,-1)),e("span",null,s(A.$t("sidebar.menu.billing.subscriptions")),1)]),_:1})],2)],2)],2),e("li",{class:se(["has-submenu",{"submenu-open":u.value.includes("support")}])},[e("a",{href:"#",class:se(["menu-toggle",{active:c(t).name==="tickets"||c(t).name==="kb"}]),onClick:m[2]||(m[2]=Se($=>n("support"),["prevent"]))},[m[16]||(m[16]=e("i",{class:"fas fa-headset"},null,-1)),e("span",null,s(A.$t("sidebar.menu.support.title")),1),v.value>0?(N(),L("span",YN,s(v.value),1)):J("",!0),m[17]||(m[17]=e("i",{class:"fas fa-chevron-right menu-arrow"},null,-1))],2),e("ul",{class:se(["submenu",{show:u.value.includes("support")}])},[e("li",{class:se({active:c(t).name==="tickets"})},[Ce(C,{to:"/tickets"},{default:Ee(()=>[m[18]||(m[18]=e("i",{class:"fas fa-ticket-alt"},null,-1)),e("span",null,s(A.$t("sidebar.menu.support.tickets")),1)]),_:1})],2),e("li",{class:se({active:c(t).name==="kb"})},[Ce(C,{to:"/kb"},{default:Ee(()=>[m[19]||(m[19]=e("i",{class:"fas fa-book"},null,-1)),e("span",null,s(A.$t("sidebar.menu.support.kb")),1)]),_:1})],2)],2)],2),e("li",{class:se({active:c(t).name==="settings"})},[Ce(C,{to:"/settings"},{default:Ee(()=>[m[20]||(m[20]=e("i",{class:"fas fa-cog"},null,-1)),e("span",null,s(A.$t("sidebar.menu.settings")),1)]),_:1})],2)])])])}}}),ZN=$e(XN,[["__scopeId","data-v-07158219"]]),e5={class:"app-container"},t5={class:"app-content"},s5={key:1},o5=_e({__name:"AppLayout",setup(I){const t=Me(),w=wt(),i=X(()=>t.meta.public),u=X(()=>w.darkMode);return(v,n)=>i.value?(N(),L("div",s5,[at(v.$slots,"default",{},void 0)])):(N(),L("div",{key:0,class:se(["app-layout",{dark:u.value}])},[e("header",null,[Ce(HN)]),e("div",e5,[Ce(ZN),e("main",t5,[at(v.$slots,"default",{},void 0)])])],2))}}),n5=$e(o5,[["__scopeId","data-v-054b068a"]]),i5={class:"notifications-wrapper"},r5={class:"fixed-notifications"},a5={class:"notification-content"},l5={class:"notification-icon"},c5={class:"notification-text"},u5={class:"notification-title"},d5={class:"notification-message"},p5=["onClick"],f5={__name:"NotificationsContainer",setup(I){const t=de(),w=v=>{t.removeToast(v)};be(()=>{console.log("[NotificationsContainer] Composant monté")});const i=v=>{switch(v){case"success":return"success-toast";case"error":return"error-toast";case"warning":return"warning-toast";case"info":return"info-toast";default:return"info-toast"}},u=v=>{switch(v){case"success":return"fas fa-check-circle";case"error":return"fas fa-exclamation-circle";case"warning":return"fas fa-exclamation-triangle";case"info":return"fas fa-info-circle";default:return"fas fa-info-circle"}};return(v,n)=>(N(),L("div",i5,[e("div",r5,[(N(!0),L(ae,null,le(c(t).activeToasts,x=>(N(),L("div",{key:x.id,class:se(["notification-toast",[i(x.type),{closing:x.closing}]])},[e("div",a5,[e("div",l5,[e("i",{class:se(u(x.type))},null,2)]),e("div",c5,[e("div",u5,s(x.title),1),e("div",d5,s(x.message),1)]),e("button",{class:"notification-close",onClick:y=>w(x.id)},n[0]||(n[0]=[e("i",{class:"fas fa-times"},null,-1)]),8,p5)])],2))),128))])]))}},v5=$e(f5,[["__scopeId","data-v-ecfd1444"]]),m5={key:0,class:"realtime-error-banner"},h5={class:"realtime-error-content"},g5=_e({__name:"App",setup(I){const t=Ge(),w=wt(),i=Ft(),u=X(()=>w.darkMode),v=X(()=>i.hasError&&t.isAuthenticated);be(async()=>{console.log("TechCMS Admin - Initialisation..."),await t.init(),t.isAuthenticated&&(console.log("TechCMS Admin - Initialisation du temps réel..."),n())}),Ne(()=>t.isAuthenticated,y=>{y?(console.log("TechCMS Admin - Utilisateur authentifié, initialisation du temps réel..."),n()):(console.log("TechCMS Admin - Utilisateur déconnecté, déconnexion du temps réel..."),i.disconnect())});const n=async()=>{try{await i.init()}catch(y){console.error("TechCMS Admin - Erreur d'initialisation du temps réel:",y)}},x=async()=>{console.log("TechCMS Admin - Tentative de reconnexion au service temps réel..."),await i.retry()};return(y,A)=>{const m=He("router-view");return N(),L("div",{id:"app",class:se(["tech-cms-app",{dark:u.value}])},[Ce(n5,null,{default:Ee(()=>[Ce(m,null,{default:Ee(({Component:C})=>[Ce(Rt,{name:"fade",mode:"out-in"},{default:Ee(()=>[(N(),We(Os(C)))]),_:2},1024)]),_:1})]),_:1}),Ce(v5),v.value?(N(),L("div",m5,[e("div",h5,[e("span",null,s(y.$t("errors.realtime_connection")),1),e("button",{onClick:x,class:"retry-button"},s(y.$t("common.retry")),1)])])):J("",!0)],2)}}}),_5={back:"Retour",save:"Enregistrer",cancel:"Annuler",delete:"Supprimer",deleting:"Suppression en cours",edit:"Modifier",loading:"Chargement...",actions:"Actions",select:"Sélectionner...",close:"Fermer",search:"Rechercher",view_all:"Voir tout",continue:"Continuer",add:"Ajouter",month:"Mois",months:"Mois",saving:"Enregistrement...",create:"Créer",update:"Mettre à jour",retry:"Réessayer",error:"Erreur",error_occurred:"Une erreur est survenue",language:{select:"Sélectionner la langue",fr:"Français",en:"Anglais"}},y5={welcome:"Bienvenue sur TechCMS",subtitle:"Connectez-vous pour accéder à votre espace d'administration",email:"Email",emailPlaceholder:"Votre adresse email",password:"Mot de passe",passwordPlaceholder:"Votre mot de passe",rememberMe:"Se souvenir de moi",forgotPassword:"Mot de passe oublié ?",signIn:"Se connecter",resetPassword:"Réinitialiser le mot de passe",resetInstructions:"Entrez votre adresse email pour recevoir les instructions de réinitialisation",sendReset:"Envoyer les instructions",resetSent:"Les instructions de réinitialisation ont été envoyées à votre adresse email",errorFields:"Veuillez remplir tous les champs",errorEmail:"Veuillez entrer une adresse email valide",errorGeneral:"Email ou mot de passe incorrect",errorForgot:"Une erreur est survenue lors de l'envoi des instructions",copyright:" {year} TechCMS. Tous droits réservés."},b5={title:"Produits/Services",description:"Gérez vos produits et services dans une interface unifiée",add:"Ajouter un produit/service",add_title:"Ajouter un produit/service",edit_title:"Modifier le produit/service",search:"Rechercher un produit/service...",columns:{name:"Nom",description:"Description",price:"Prix",status:"Statut",clients:"Clients",type:"Type",group:"Groupe"},status:{all:"Tous les statuts",active:"Actif",inactive:"Inactif",maintenance:"Maintenance"},types:{all:"Tous les types",product:"Produit",service:"Service",shared_hosting:"Hébergement mutualisé",reseller_hosting:"Hébergement revendeur",server_vps:"Serveur / VPS",other:"Autre"},groups:{all:"Tous les groupes",none:"Aucun groupe"},modules:{none:"Aucun module",custom:"Module personnalisé",title:"Paramètres du module",description:"Configurez le module serveur pour votre produit",module_name:"Nom du module",module_name_help:"Sélectionnez le module serveur à utiliser pour ce produit",no_module_info:"Aucun module sélectionné. Ce produit ne sera pas automatiquement provisionné sur un serveur.",server_group:"Groupe de serveurs",no_server_group:"Aucun groupe de serveurs",shared_servers:"Serveurs d'hébergement mutualisé",reseller_servers:"Serveurs d'hébergement revendeur",vps_servers:"Serveurs VPS/Dédiés",server_group_help:"Sélectionnez le groupe de serveurs où ce produit sera provisionné",choose_module_info:"Choisissez un module pour voir les options de configuration supplémentaires",auto_setup_options:"Options de configuration automatique",auto_setup_on_order:"Configuration automatique à la commande",auto_setup_on_order_help:"Provisionner automatiquement le produit lorsque la commande est passée",auto_setup_on_payment:"Configuration automatique au paiement",auto_setup_on_payment_help:"Provisionner automatiquement le produit lorsque le paiement est reçu",auto_setup_on_pending_order:"Configuration automatique sur commande en attente",auto_setup_on_pending_order_help:"Provisionner automatiquement le produit lorsque la commande est marquée comme en attente",no_auto_setup:"Pas de configuration automatique",no_auto_setup_help:"Ne pas provisionner automatiquement le produit. Une configuration manuelle sera nécessaire.",errors:{server_group_required:"Un groupe de serveurs est requis lorsqu'un module est sélectionné",server_required:"Un serveur est requis pour ce module",cpanel_plan_required:"Un plan cPanel est requis",virtualizor_resources_required:"Vous devez configurer au moins une ressource pour Virtualizor",proxmox_resources_required:"Vous devez configurer au moins une ressource pour Proxmox"},resources:{title:"Configuration des ressources",description:"Configurez les ressources qui seront allouées pour ce produit",cpu:"CPU (vCores)",cpu_help:"Nombre de cœurs de processeur virtuels",memory:"Mémoire RAM (Mo)",memory_help:"Quantité de mémoire en mégaoctets",disk_space:"Espace disque (Go)",disk_space_help:"Espace disque en gigaoctets",bandwidth:"Bande passante (Go)",bandwidth_help:"Bande passante mensuelle en gigaoctets",ips:"Adresses IP",ips_help:"Nombre d'adresses IP à allouer",virtualizor:{title:"Ressources Virtualizor",description:"Configurez les ressources spécifiques pour Virtualizor",virtualization:"Type de virtualisation",virtualization_help:"Sélectionnez le type de virtualisation",os_template:"Template OS",os_template_help:"Sélectionnez le template d'OS à utiliser"},proxmox:{title:"Ressources Proxmox",description:"Configurez les ressources spécifiques pour Proxmox",container_type:"Type de conteneur",container_type_help:"Sélectionnez le type de conteneur (LXC ou VM)",storage:"Stockage",storage_help:"Sélectionnez le stockage Proxmox à utiliser",template:"Template",template_help:"Sélectionnez le template à utiliser pour la création"}}},custom_fields:{title:"Champs personnalisés",description:"Configurez les champs personnalisés pour votre produit",list_title:"Liste des champs personnalisés",add_field:"Ajouter un champ personnalisé",no_fields:"Aucun champ personnalisé n'a encore été ajouté",add_first_field:"Ajoutez votre premier champ personnalisé"},configurable_options:{title:"Options configurables",description:"Configurez des options personnalisables que les clients peuvent sélectionner lors de la commande de ce produit",empty_state:"Aucune option configurable n'a encore été ajoutée",add_first_option:"Ajoutez votre première option configurable",add_option:"Ajouter une option",new_option:"Nouvelle option",fields:{name:"Nom de l'option",type:"Type d'option",option_group:"Groupe d'options",description:"Description",description_help:"Cette description sera affichée aux clients lors de la commande",required:"Obligatoire",item_name:"Nom de l'élément",price:"Prix",setup_fee:"Frais de configuration",set_as_default:"Définir par défaut"},types:{dropdown:"Liste déroulante",radio:"Bouton radio",checkbox:"Case à cocher",quantity:"Quantité",text:"Texte"},no_group:"Aucun groupe",option_items:"Éléments d'option",errors:{name_required:"Le nom de l'option est requis",items_required:"Au moins un élément d'option est requis"}},upgrades:{title:"Mises à niveau & Rétrogradations",description:"Configurez les options de mise à niveau et de rétrogradation du produit",configuration_title:"Configuration",allow_downgrade:"Autoriser la rétrogradation",allow_downgrade_help:"Permettre aux clients de rétrograder vers un produit de niveau inférieur",upgrade_package_quantity:"Mise à niveau de la quantité du forfait",upgrade_package_quantity_help:"Permettre aux clients d'augmenter la quantité de leur forfait",products_title:"Produits disponibles",product_name:"Nom du produit",action:"Action",add:"Ajouter une mise à niveau",selected_upgrades:"Mises à niveau sélectionnées",remove:"Supprimer"},freedomain:{title:"Domaine gratuit",description:"Configurez les options de domaine gratuit pour ce produit",configuration_title:"Configuration",enable_freedomain:"Activer le domaine gratuit",enable_freedomain_help:"Offrir un domaine gratuit avec ce produit",required_period:"Période de facturation requise",required_period_help:"Période de facturation minimale requise pour bénéficier d'un domaine gratuit",initial_order_only:"Commande initiale uniquement",initial_order_only_help:"Offrir un domaine gratuit uniquement sur la commande initiale, pas sur les renouvellements",available_tlds:"TLDs disponibles",tlds_help:"Sélectionnez les TLDs éligibles pour un domaine gratuit",selected_tlds:"TLDs sélectionnés"},cross_sells:{title:"Ventes croisées",description:"Configurez les produits en vente croisée à proposer avec ce produit",configuration_title:"Configuration",show_on_checkout:"Afficher lors du paiement",show_on_checkout_help:"Afficher les produits en vente croisée pendant le processus de paiement",discount_percent:"Pourcentage de remise",discount_percent_help:"Appliquer une remise aux produits en vente croisée lorsqu'ils sont achetés ensemble",search_title:"Recherche de produits",search_products:"Rechercher des produits",search_placeholder:"Rechercher des produits à vendre en vente croisée",selected_products:"Produits sélectionnés",no_products_selected:"Aucun produit sélectionné",no_search_results:"Aucun produit correspondant à votre recherche",product_name:"Nom du produit",product_type:"Type de produit",product_price:"Prix",action:"Action",add:"Ajouter",remove:"Supprimer"},other:{title:"Autres paramètres",description:"Configurez des paramètres supplémentaires pour ce produit",configuration_title:"Configuration",require_domain:"Domaine requis",require_domain_help:"Exiger qu'un domaine soit associé à ce produit",auto_setup:"Configuration automatique",auto_setup_help:"Provisionner automatiquement ce produit lors de la commande",stock_control:"Contrôle de stock",stock_control_help:"Activer le contrôle de stock pour ce produit",stock_quantity_help:"Définir la quantité disponible pour ce produit",hidden:"Masqué",hidden_help:"Masquer ce produit dans la liste des produits",featured:"Mis en avant",featured_help:"Marquer ce produit comme mis en avant",welcome_email_help:"Sélectionnez l'email de bienvenue à envoyer lorsque ce produit est commandé",welcome_email_none:"Pas d'email de bienvenue",welcome_email_product:"Email de bienvenue spécifique au produit",welcome_email_general:"Email de bienvenue général",welcome_email_both:"Les deux emails de bienvenue (produit et général)",notes_help:"Notes internes sur ce produit (non visibles par les clients)",notes_placeholder:"Entrez ici toutes les notes ou commentaires concernant ce produit..."},links:{title:"Liens du produit",description:"Gérer les liens directs et les URLs promotionnelles pour ce produit",direct_links_title:"Liens de commande directe",direct_cart_link_placeholder:"Lien direct vers le panier",direct_cart_link_template_placeholder:"Lien direct vers le panier avec modèle",direct_cart_link_domain_placeholder:"Lien direct vers le panier avec domaine",group_cart_link_placeholder:"Lien vers le panier de groupe",product_links_title:"Liens promotionnels",url:"URL",visits:"Visites",actions:"Actions",add_link:"Ajouter un lien",url_placeholder:"Entrez l'URL promotionnelle",finalize_product:"Veuillez finaliser le produit avant de générer des liens",finalizing:"Finalisation du produit..."},welcome_emails:{none:"Aucun email de bienvenue",hosting:"Email de bienvenue pour l'hébergement",general:"Email de bienvenue général"},tabs:{type:"Type",details:"Details",pricing:"Tarification",module:"Module",custom_fields:"Champs personnalisés",configurable_options:"Options configurables",upgrades:"Mises à niveau",freedomain:"Domaine gratuit",cross_sells:"Ventes croisées",other:"Autres",links:"Liens"},fields:{name:"Nom",description:"Description",price:"Prix",status:"Statut",type:"Type",features:"Fonctionnalités",featureName:"Nom de la fonctionnalité",included:"Inclus",addFeature:"Ajouter une fonctionnalité",group:"Groupe"},filters:{search:"Recherche",status:"Statut",type:"Type",price_range:"Gamme de prix",all_prices:"Tous les prix",price_low:"Prix bas (< 50€)",price_medium:"Prix moyen (50€ - 200€)",price_high:"Prix élevé (> 200€)",apply:"Appliquer les filtres",group:"Groupe"},empty:{title:"Aucun produit ou service trouvé",description:"Commencez par ajouter un produit ou un service en cliquant sur le bouton ci-dessus."},validation:{nameRequired:"Le nom est obligatoire",pricePositive:"Le prix doit être positif"},success:{create:"Produit/service créé",createMessage:"Le produit/service {name} a été créé avec succès",update:"Produit/service mis à jour",updateMessage:"Le produit/service {name} a été mis à jour avec succès",delete:"Produit/service supprimé",deleteMessage:"Le produit/service {name} a été supprimé avec succès"},errors:{fetch:"Erreur de chargement",fetchMessage:"Impossible de charger les produits/services",create:"Erreur de création",update:"Erreur de mise à jour",saveMessage:"Une erreur est survenue lors de l'enregistrement du produit/service",delete:"Erreur de suppression",deleteMessage:"Une erreur est survenue lors de la suppression du produit/service",nameRequired:"Le nom est requis",pricePositive:"Le prix doit être positif",name_required:"Le nom est requis",group_required:"Le groupe est requis"},confirm:{delete:"Êtes-vous sûr de vouloir supprimer le produit/service {name} ?"},pricing:{title:"Tarification",description:"Configurez les options de tarification pour votre produit",payment_type:"Type de paiement",free:"Gratuit",one_time:"Unique",recurring:"Récurrent",allow_multiple_quantities:"Autoriser les quantités multiples",multiple_quantities_no_help:"Les clients ne peuvent acheter qu'un seul exemplaire de ce produit à la fois",no:"Non",yes:"Oui",multiple_quantities_yes_help:"Les clients peuvent acheter plusieurs exemplaires de ce produit",auto_termination_days:"Jours avant résiliation automatique",auto_termination_days_help:"Nombre de jours après lesquels le produit sera automatiquement résilié. Laissez vide pour désactiver la résiliation automatique.",promotion_code:"Code de promotion",promotion_code_help:"Appliquer un code de promotion à ce produit par défaut",prorata_billing:"Facturation au prorata",prorata_billing_help:"Facturer aux clients uniquement les jours restants du cycle de facturation",private_billing_date:"Date de facturation privée",private_billing_date_help:"Définir une date de facturation spécifique pour ce produit, remplaçant la date de facturation du client",charge_next_month:"Facturer le mois suivant",charge_next_month_help:"Facturer au client le mois suivant au lieu du mois en cours",pricing_configuration:"Configuration de la tarification",system_default:"Paramètres par défaut",system_default_help:"Utiliser la configuration de tarification par défaut du système",product_specific:"Spécifique au produit",product_specific_help:"Utiliser une configuration de tarification spécifique pour ce produit",payment_options:"Options de paiement",option:"Option",monthly:"Mensuel",quarterly:"Trimestriel",semiannually:"Semestriel",annually:"Annuel",biennially:"Biennal",triennially:"Triennal",payment_options_help:"Configurez les options de paiement pour ce produit",enabled:"Activé",price:"Prix",setup_fee:"Frais d'installation",recurring_cycles_limit:"Limite de cycles récurrents",recurring_cycles_limit_help:"Nombre maximum de cycles de facturation pour ce produit. Laissez vide pour des cycles illimités."},create_product:{title:"Créer un produit",description:"Créez un nouveau produit en suivant les étapes ci-dessous",step1_title:"Informations générales",step2_title:"Détails et tarification",step3_title:"Fonctionnalités et options",product_type:"Type de produit",select_type:"Sélectionnez un type de produit",type_help:"Choisissez le type de produit que vous souhaitez créer",type_other_help:"Créez un type de produit personnalisé non listé ci-dessus",types:{shared_hosting:"Hébergement mutualisé",reseller_hosting:"Hébergement revendeur",server_vps:"Serveur / VPS",other:"Autre"},group:"Groupe",name:"Nom",slug:"Slug",slug_help:"Utilisé pour les URL. Laissez vide pour générer automatiquement à partir du nom.",module:"Module",no_module:"Aucun module",hidden:"Masqué",hidden_help:"Les produits masqués ne sont pas visibles pour les clients dans la boutique.",price:"Prix",setup_fee:"Frais d'installation",recurring:"Récurrent",billing_cycle:"Cycle de facturation",cycles:{monthly:"Mensuel",quarterly:"Trimestriel",semiannually:"Semestriel",annually:"Annuel",biennially:"Biennal"},status:"Statut",statuses:{active:"Actif",inactive:"Inactif",draft:"Brouillon"},features:"Fonctionnalités",no_features:"Aucune fonctionnalité ajoutée. Cliquez sur le bouton Ajouter pour commencer.",feature_name:"Nom de la fonctionnalité",feature_value:"Valeur",options:"Options",no_options:"Aucune option ajoutée. Cliquez sur le bouton Ajouter pour commencer.",option_name:"Nom de l'option",option_type:"Type d'option",option_types:{select:"Liste déroulante",radio:"Boutons radio",checkbox:"Case à cocher",quantity:"Quantité"},required:"Obligatoire",option_choices:"Choix disponibles",choice_name:"Nom du choix",choice_price:"Prix supplémentaire",summary:"Résumé du produit",summary_description:"Vérifiez les détails de votre produit avant de l'enregistrer.",type_description:"Description du type de produit"},details:{title:"Détails du produit",description:"Configurez les détails de votre produit",product_type:"Type de produit",product_group:"Groupe de produits",product_type_help:"Le type de produit détermine ses fonctionnalités et sa fonctionnalité",product_group_help:"Regroupez des produits similaires pour une meilleure organisation",product_name:"Nom du produit",product_name_help:"Entrez un nom descriptif pour votre produit",product_tagline:"Slogan du produit",product_tagline_help:"Une courte description qui apparaît dans les listes de produits",url:"URL",url_help:"URL personnalisée pour ce produit",module:"Module",module_help:"Sélectionnez un module pour gérer ce produit",product_short_description:"Description courte",product_short_description_help:"Brève description affichée dans les listes de produits",product_description:"Description complète",product_description_help:"Description détaillée du produit",product_color:"Couleur du produit",product_color_help:"Couleur utilisée pour l'image de marque et les éléments d'interface",welcome_email:"Email de bienvenue",welcome_email_help:"Modèle d'email envoyé aux clients après l'achat",advanced_options:"Options avancées",create_as_hidden:"Créer comme masqué",create_as_hidden_help:"Les produits masqués ne sont pas visibles dans la boutique",require_domain:"Domaine requis",require_domain_help:"Le client doit sélectionner un domaine lors de la commande de ce produit",stock_control:"Gestion des stocks",stock_control_help:"Suivre l'inventaire pour ce produit",apply_tax:"Appliquer la taxe",apply_tax_help:"Appliquer les taux de taxe à ce produit",featured:"Produit en vedette",featured_help:"Les produits en vedette sont mis en évidence dans la boutique",hide_other_products:"Masquer les autres produits",hide_other_products_help:"Lorsque ce produit est dans le panier, masquer les autres produits",select_group:"Sélectionner un groupe"}},$5={title:"Groupes de produits",add:"Créer un groupe",add_title:"Créer un nouveau groupe",edit_title:"Modifier le groupe",fields:{name:"Nom",slug:"Slug",description:"Description"},placeholders:{name:"Nom du groupe",slug:"slug-du-groupe",description:"Description du groupe"},slug_help:"Le slug est utilisé dans les URLs. Utilisez uniquement des lettres minuscules, des chiffres et des tirets.",empty:{title:"Aucun groupe",message:"Vous n'avez pas encore de groupes de produits. Cliquez sur le bouton ci-dessus pour en créer un."},success:{create:"Le groupe a été créé avec succès",update:"Le groupe a été mis à jour avec succès",delete:"Le groupe a été supprimé avec succès"},errors:{name_required:"Le nom est obligatoire",slug_required:"Le slug est obligatoire",slug_invalid:"Le slug n'est pas valide. Utilisez uniquement des lettres minuscules, des chiffres et des tirets.",create:"Une erreur est survenue lors de la création du groupe",update:"Une erreur est survenue lors de la mise à jour du groupe",delete:"Une erreur est survenue lors de la suppression du groupe",fetch:"Une erreur est survenue lors de la récupération des groupes"},confirm_delete:"Êtes-vous sûr de vouloir supprimer ce groupe ? Tous les produits associés à ce groupe seront déplacés dans le groupe par défaut."},S5={title:"Factures",actions:{add:"Ajouter une facture",edit:"Modifier la facture",view:"Voir la facture",delete:"Supprimer la facture",mark_paid:"Marquer comme payée"},modal:{add_title:"Ajouter une facture",edit_title:"Modifier la facture",view_title:"Détails de la facture"},columns:{number:"Numéro",client:"Client",service:"Service",amount:"Montant",due_date:"Date d'échéance",paid_date:"Date de paiement",status:"Statut",created_at:"Date de création"},status:{pending:"En attente",paid:"Payée",overdue:"En retard",cancelled:"Annulée",deleted:"Supprimée"},filters:{label:"Filtrer par statut",all:"Toutes",pending:"En attente",paid:"Payées",overdue:"En retard",cancelled:"Annulées"},search:{placeholder:"Rechercher une facture..."},empty:{message:"Aucune facture trouvée",action:"Ajouter une facture"},confirm:{delete:"Êtes-vous sûr de vouloir supprimer cette facture ?",mark_paid:"Êtes-vous sûr de vouloir marquer cette facture comme payée ?"},success:{create:"Facture créée avec succès",update:"Facture mise à jour avec succès",delete:"Facture supprimée avec succès",mark_paid:"Facture marquée comme payée avec succès"},errors:{fetch:"Erreur lors du chargement des factures",create:"Erreur lors de la création de la facture",update:"Erreur lors de la mise à jour de la facture",delete:"Erreur lors de la suppression de la facture",mark_paid:"Erreur lors du marquage de la facture comme payée"}},w5={title:"Abonnements",description:"Gérez les abonnements de vos clients",actions:{add:"Ajouter un abonnement",edit:"Modifier l'abonnement",view:"Voir l'abonnement",cancel:"Annuler l'abonnement",renew:"Renouveler l'abonnement"},table:{id:"ID",client:"Client",product:"Produit",startDate:"Date de début",endDate:"Date de fin",renewalDate:"Date de renouvellement",price:"Prix",billingCycle:"Cycle de facturation",status:"Statut",actions:"Actions"},filters:{search:"Recherche",status:"Statut",billing_cycle:"Cycle de facturation",all_cycles:"Tous les cycles",apply:"Appliquer les filtres",all:"Tous",active:"Actifs",pending:"En attente",cancelled:"Annulés",expired:"Expirés"},search:{placeholder:"Rechercher un abonnement..."},empty:{title:"Aucun abonnement trouvé",message:"Vous n'avez pas encore d'abonnements. Commencez par en créer un."},statuses:{active:"Actif",pending:"En attente",cancelled:"Annulé",expired:"Expiré"},billingCycles:{monthly:"Mensuel",quarterly:"Trimestriel",semiAnnual:"Semestriel",annual:"Annuel"},form:{client:"Client",product:"Produit",startDate:"Date de début",endDate:"Date de fin",price:"Prix",billingCycle:"Cycle de facturation",status:"Statut",autoRenew:"Renouvellement automatique",notes:"Notes",cancelReason:"Raison de l'annulation"},confirm:{cancel:"Êtes-vous sûr de vouloir annuler cet abonnement ?",renew:"Êtes-vous sûr de vouloir renouveler cet abonnement ?"},success:{create:"Abonnement créé avec succès",update:"Abonnement mis à jour avec succès",cancel:"Abonnement annulé avec succès",renew:"Abonnement renouvelé avec succès"},errors:{fetch:"Erreur lors du chargement des abonnements",fetchOne:"Erreur lors du chargement de l'abonnement",create:"Erreur lors de la création de l'abonnement",update:"Erreur lors de la mise à jour de l'abonnement",cancel:"Erreur lors de l'annulation de l'abonnement",renew:"Erreur lors du renouvellement de l'abonnement"}},k5={title:"Paiements",actions:{add:"Ajouter un paiement",edit:"Modifier le paiement",view:"Voir le paiement",delete:"Supprimer le paiement",refund:"Rembourser"},modal:{add_title:"Ajouter un paiement",edit_title:"Modifier le paiement",view_title:"Détails du paiement"},columns:{id:"ID",invoice:"Facture",client:"Client",amount:"Montant",date:"Date de paiement",method:"Méthode",transaction_id:"ID de transaction",status:"Statut",notes:"Notes",created_at:"Date de création"},status:{completed:"Complété",pending:"En attente",failed:"Échoué",refunded:"Remboursé"},methods:{card:"Carte bancaire",bank_transfer:"Virement bancaire",paypal:"PayPal",cash:"Espèces",check:"Chèque"},fields:{transaction_id_help:"Numéro de référence de la transaction (facultatif)"},filters:{label:"Filtrer par statut",all:"Tous",completed:"Complétés",pending:"En attente",failed:"Échoués",refunded:"Remboursés"},search:{placeholder:"Rechercher un paiement..."},empty:{message:"Aucun paiement trouvé",action:"Ajouter un paiement"},confirm:{delete:"Êtes-vous sûr de vouloir supprimer ce paiement ?"},refund:{title:"Rembourser le paiement",reason:"Motif du remboursement",reason_placeholder:"Veuillez indiquer le motif du remboursement",confirm:"Confirmer le remboursement",error_title:"Erreur de remboursement",error_reason_required:"Le motif du remboursement est obligatoire"},success:{create:"Paiement créé avec succès",update:"Paiement mis à jour avec succès",delete:"Paiement supprimé avec succès",refund:"Remboursement traité avec succès"},errors:{fetch:"Erreur lors du chargement des paiements",create:"Erreur lors de la création du paiement",update:"Erreur lors de la mise à jour du paiement",delete:"Erreur lors de la suppression du paiement",refund:"Erreur lors du traitement du remboursement"}},C5={title:"Tickets",actions:{add:"Ajouter un ticket",create:"Créer",update:"Mettre à jour",delete:"Supprimer",view:"Voir"},modal:{add_title:"Ajouter un ticket",edit_title:"Modifier le ticket",view_title:"Détails du ticket"},fields:{client:"Client",subject:"Sujet",message:"Message",priority:"Priorité",status:"Statut"},priority:{low:"Basse",medium:"Moyenne",high:"Haute",urgent:"Urgente"},status:{open:"Ouvert",pending:"En attente",closed:"Fermé",resolved:"Résolu"},filters:{all:"Tous",open:"Ouverts",pending:"En attente",closed:"Fermés",resolved:"Résolus"},table:{id:"ID",subject:"Sujet",client:"Client",priority:"Priorité",status:"Statut",lastReply:"Dernière réponse",createdAt:"Créé le",actions:"Actions"},search:{placeholder:"Rechercher un ticket..."},empty:{message:"Aucun ticket trouvé",description:"Créez un nouveau ticket ou modifiez vos filtres"},confirm:{delete:{title:"Supprimer le ticket",message:"Êtes-vous sûr de vouloir supprimer ce ticket ? Cette action est irréversible."}},success:{create:"Le ticket a été créé avec succès",update:"Le ticket a été mis à jour avec succès",delete:"Le ticket a été supprimé avec succès",close:"Le ticket a été fermé avec succès",reopen:"Le ticket a été rouvert avec succès",reply:"Votre réponse a été ajoutée avec succès"},errors:{create:"Une erreur est survenue lors de la création du ticket",update:"Une erreur est survenue lors de la mise à jour du ticket",delete:"Une erreur est survenue lors de la suppression du ticket",fetch:"Une erreur est survenue lors de la récupération des tickets",close:"Une erreur est survenue lors de la fermeture du ticket",reopen:"Une erreur est survenue lors de la réouverture du ticket",reply:"Une erreur est survenue lors de l'ajout de votre réponse"},selectClient:"Sélectionner un client",noMessages:"Aucun message pour ce ticket",addReply:"Ajouter une réponse",replyPlaceholder:"Votre réponse...",sendReply:"Envoyer"},A5={title:"Clients",description:"Gérez vos clients et leurs services",add_new:"Ajouter un client",filters:{search:"Rechercher",search_placeholder:"Rechercher un client...",service_type:"Type de service",status:"Statut"},services:{all:"Tous les services",hosting:"Hébergement",domain:"Nom de domaine",ssl:"Certificat SSL"},table:{client:"Client",company:"Entreprise",email:"Email",phone:"Téléphone",status:"Statut",services:"Services",actions:"Actions"},status:{all:"Tous les statuts",active:"Actif",inactive:"Inactif",pending:"En attente"},empty:{title:"Aucun client trouvé",description:"Vous n'avez pas encore de clients. Ajoutez-en un pour commencer."},no_services:"Aucun service",form:{firstname:"Prénom",firstname_placeholder:"Entrez le prénom",lastname:"Nom",lastname_placeholder:"Entrez le nom",email:"Email",email_placeholder:"Entrez l'adresse email",phone:"Téléphone",phone_placeholder:"Entrez le numéro de téléphone",company:"Entreprise",company_placeholder:"Entrez le nom de l'entreprise",status:"Statut",address:"Adresse",address_placeholder:"Entrez l'adresse",postal_code:"Code postal",postal_code_placeholder:"Entrez le code postal",city:"Ville",city_placeholder:"Entrez la ville",country:"Pays",country_placeholder:"Entrez le pays",password:"Mot de passe",password_placeholder:"Entrez le mot de passe",password_optional:"(Optionnel)",password_leave_empty:"Laissez vide pour conserver le mot de passe actuel",address_title:"Adresse",personal_info:"Informations personnelles"},actions:{view:"Voir les détails",edit:"Modifier",delete:"Supprimer"},confirm_delete:"Êtes-vous sûr de vouloir supprimer ce client ?",details:{title:"Détails du client",description:"Informations détaillées du client",personal_info:"Informations personnelles",address:"Adresse",services:"Services",no_services:"Ce client n'a aucun service actif",invoices:"Factures",no_invoices:"Aucune facture trouvée pour ce client",tab_info:"Informations",tab_services:"Services",tab_invoices:"Factures",error_loading:"Erreur lors du chargement des informations du client",error_deleting:"Erreur lors de la suppression du client",not_found:"Client non trouvé"},edit:{title:"Modifier le client",description:"Mettre à jour les informations du client"},add:{title:"Ajouter un client",description:"Créer un nouveau client"},delete_modal:{title:"Supprimer le client",confirmation:"Êtes-vous sûr de vouloir supprimer ce client ?",warning:"Cette action est irréversible. Toutes les données associées à ce client seront supprimées."},validation:{firstname_required:"Le prénom est requis",lastname_required:"Le nom est requis",email_required:"L'adresse email est requise",email_invalid:"L'adresse email n'est pas valide",password_required:"Le mot de passe est requis"}},E5={menu:{dashboard:"Tableau de bord",clients:"Clients",services:"Services",catalog:{title:"Catalogue",products_services:"Produits & Services"},billing:{title:"Facturation",invoices:"Factures",payments:"Paiements",subscriptions:"Abonnements"},support:{title:"Support",tickets:"Tickets",kb:"Base de connaissances"},settings:"Paramètres",logout:"Déconnexion"}},O5={title:"Paramètres",description:"Configurez les paramètres de votre système",tabs:{home:"Accueil",general:"Général",notifications:"Notifications",security:"Sécurité",billing:"Facturation",servers:"Serveurs",integrations:"Intégrations",license:"Licence"},general:{title:"Paramètres généraux",description:"Configurez les paramètres généraux de votre système",siteName:"Nom du site",siteDescription:"Description du site",siteEmail:"Email du site",sitePhone:"Téléphone du site",siteAddress:"Adresse du site",siteUrl:"URL du site",logo:"Logo",favicon:"Favicon",timezone:"Fuseau horaire",dateFormat:"Format de date",timeFormat:"Format d'heure",language:"Langue",currency:"Devise",currencySymbol:"Symbole de devise",currencyPosition:"Position du symbole de devise",decimalSeparator:"Séparateur décimal",thousandSeparator:"Séparateur de milliers",decimalPlaces:"Nombre de décimales"},security:{title:"Paramètres de sécurité",description:"Configurez les paramètres de sécurité de votre système",sessionTimeout:"Délai d'expiration de session (minutes)",loginAttempts:"Nombre de tentatives de connexion avant blocage",loginBlockTime:"Durée de blocage après tentatives échouées (minutes)",passwordMinLength:"Longueur minimale du mot de passe",passwordRequireUppercase:"Exiger une majuscule dans le mot de passe",passwordRequireLowercase:"Exiger une minuscule dans le mot de passe",passwordRequireNumber:"Exiger un chiffre dans le mot de passe",passwordRequireSpecial:"Exiger un caractère spécial dans le mot de passe",passwordExpiration:"Expiration du mot de passe (jours, 0 = jamais)",twoFactorAuth:"Authentification à deux facteurs",twoFactorAuthRequired:"Exiger l'authentification à deux facteurs",apiTokenExpiration:"Expiration des jetons API (jours, 0 = jamais)"},billing:{title:"Paramètres de facturation",description:"Configurez les paramètres de facturation de votre système",invoicePrefix:"Préfixe des factures",invoiceStartNumber:"Numéro de départ des factures",invoiceFooter:"Pied de page des factures",invoiceTerms:"Conditions des factures",invoiceDueDays:"Délai de paiement par défaut (jours)",invoiceAutoReminder:"Envoyer des rappels automatiques",invoiceReminderDays:"Jours avant échéance pour le rappel",taxEnabled:"Activer la taxe",taxName:"Nom de la taxe",taxRate:"Taux de taxe (%)",taxNumber:"Numéro de taxe",paymentMethods:"Méthodes de paiement",bankTransfer:"Virement bancaire",bankName:"Nom de la banque",bankAccount:"Numéro de compte",bankIban:"IBAN",bankSwift:"SWIFT/BIC"},integrations:{title:"Paramètres d'intégration",description:"Configurez les intégrations avec des services externes",mailDriver:"Service d'envoi d'emails",mailHost:"Hôte SMTP",mailPort:"Port SMTP",mailUsername:"Nom d'utilisateur SMTP",mailPassword:"Mot de passe SMTP",mailEncryption:"Chiffrement SMTP",mailFromAddress:"Adresse d'expédition",mailFromName:"Nom d'expédition",smsEnabled:"Activer les SMS",smsProvider:"Fournisseur SMS",smsApiKey:"Clé API SMS",smsFromNumber:"Numéro d'expédition SMS",pushEnabled:"Activer les notifications push",pushProvider:"Fournisseur de notifications push",pushApiKey:"Clé API notifications push",googleAnalyticsId:"ID Google Analytics",recaptchaSiteKey:"Clé de site reCAPTCHA",recaptchaSecretKey:"Clé secrète reCAPTCHA"},actions:{save:"Enregistrer les paramètres",reset:"Réinitialiser les paramètres",testEmail:"Tester l'envoi d'email",testSms:"Tester l'envoi de SMS"},messages:{saved:"Paramètres enregistrés avec succès",error:"Une erreur est survenue lors de l'enregistrement des paramètres",emailTestSent:"Email de test envoyé avec succès",emailTestError:"Une erreur est survenue lors de l'envoi de l'email de test",smsTestSent:"SMS de test envoyé avec succès",smsTestError:"Une erreur est survenue lors de l'envoi du SMS de test"},license:{title:"Gestion de Licence",description:"Gérez votre licence TechCMS et vérifiez son statut",licenseKey:"Clé de licence",licenseType:"Type de licence",licenseStatus:"Statut de la licence",licenseExpiration:"Date d'expiration",licenseDomain:"Domaine enregistré",licenseSupport:"Support jusqu'au",licenseRenew:"Renouveler la licence",licenseDeactivate:"Désactiver la licence",active:"Active",inactive:"Inactive",free:"Gratuit",pro:"Professionnel",updateSuccess:"Licence mise à jour avec succès",updateError:"Erreur lors de la mise à jour de la licence",verifyingLicense:"Vérification de la licence...",enterLicenseKey:"Veuillez entrer une clé de licence valide"},servers:{title:"Gestion des Serveurs",description:"Configurez et gérez vos serveurs (cPanel, Proxmox, Virtualizor)",add:"Ajouter un serveur",edit:"Modifier le serveur",delete:"Supprimer le serveur",test:"Tester la connexion",name:"Nom du serveur",hostname:"Nom d'hôte",type:"Type de serveur",ipAddress:"Adresse IP",username:"Nom d'utilisateur",password:"Mot de passe",port:"Port",secure:"Connexion sécurisée",accessKey:"Clé d'accès API",active:"Actif",status:"Statut",load:"Charge",types:{cpanel:"cPanel",proxmox:"Proxmox",virtualizor:"Virtualizor"},statuses:{online:"En ligne",offline:"Hors ligne",maintenance:"Maintenance"},confirmDelete:"Êtes-vous sûr de vouloir supprimer ce serveur ?",testSuccess:"Connexion au serveur réussie",testError:"Échec de la connexion au serveur",saveSuccess:"Serveur enregistré avec succès",saveError:"Erreur lors de l'enregistrement du serveur",deleteSuccess:"Serveur supprimé avec succès",deleteError:"Erreur lors de la suppression du serveur"}},T5={title:"Tableau de bord",stats:{active_clients:"Clients actifs",active_services:"Services actifs",total_products:"Total des produits",monthly_revenue:"Revenu mensuel"},recent_clients:{title:"Clients récents"},recent_tickets:{title:"Tickets récents"}},R5={notifications:{title:"Notifications",mark_all_read:"Marquer tout comme lu",empty:"Aucune notification",view_all:"Voir toutes les notifications"},profile:{my_profile:"Mon profil",settings:"Paramètres",logout:"Déconnexion"}},x5={title:"Services",description:"Gérez les services de vos clients",add_new:"Ajouter un service",empty:{title:"Aucun service trouvé",message:"Vous n'avez pas encore de services. Commencez par en créer un."},filters:{search:"Rechercher",search_placeholder:"Rechercher par domaine, nom de client...",status:"Statut",client:"Client",product:"Produit",all_clients:"Tous les clients",all_products:"Tous les produits"},table:{client:"Client",product:"Produit",domain:"Domaine",status:"Statut",next_due_date:"Prochaine échéance",recurring_amount:"Montant récurrent",actions:"Actions"},status:{all:"Tous les statuts",pending:"En attente",active:"Actif",suspended:"Suspendu",cancelled:"Annulé",terminated:"Résilié",fraud:"Fraude"},actions:{view:"Voir",edit:"Modifier",delete:"Supprimer",activate:"Activer",suspend:"Suspendre",cancel:"Annuler",terminate:"Résilier"},delete_modal:{title:"Supprimer le service",confirmation:"Êtes-vous sûr de vouloir supprimer ce service ?",warning:"Cette action est irréversible et supprimera toutes les données associées à ce service."},create:{title:"Créer un service",description:"Ajoutez un nouveau service pour un client"},edit:{title:"Modifier le service",description:"Modifiez les détails du service"},details:{title:"Détails du service",description:"Consultez les informations détaillées du service",client:"Client",client_name:"Nom du client",client_email:"Email du client",product:"Produit",product_name:"Nom du produit",server:"Serveur",server_name:"Nom du serveur",billing:"Facturation",billing_cycle:"Cycle de facturation",next_due_date:"Prochaine échéance",recurring_amount:"Montant récurrent",setup_fee:"Frais d'installation",important_dates:"Dates importantes",created_at:"Date de création",suspension_date:"Date de suspension",cancellation_date:"Date d'annulation",termination_date:"Date de résiliation",login_details:"Identifiants de connexion",username:"Nom d'utilisateur",password:"Mot de passe",configuration:"Configuration personnalisée",notes:"Notes",unknown:"Inconnu",unknown_product:"Produit inconnu",not_set:"Non défini",no_server:"Aucun serveur associé",no_login_details:"Aucun identifiant de connexion défini",view_client:"Voir le client",view_product:"Voir le produit",view_server:"Voir le serveur",error_loading:"Erreur lors du chargement du service"},form:{section:{client_product:"Client et produit",details:"Détails du service",billing:"Facturation",notes:"Notes",configurations:"Configurations personnalisées"},client:"Client",select_client:"Sélectionner un client",product:"Produit",select_product:"Sélectionner un produit",domain:"Domaine",domain_placeholder:"exemple.com",username:"Nom d'utilisateur",username_placeholder:"Nom d'utilisateur",password:"Mot de passe",password_placeholder:"Mot de passe",server:"Serveur",select_server:"Sélectionner un serveur",status:"Statut",billing_cycle:"Cycle de facturation",next_due_date:"Prochaine échéance",recurring_amount:"Montant récurrent",amount_placeholder:"0.00",setup_fee:"Frais d'installation",fee_placeholder:"0.00",notes:"Notes",notes_placeholder:"Notes internes sur ce service...",config_name:"Nom",config_value:"Valeur",action:"Action",add_config:"Ajouter une configuration",errors:{client_required:"Le client est requis",product_required:"Le produit est requis",status_required:"Le statut est requis",invalid_date:"Format de date invalide",negative_amount:"Le montant ne peut pas être négatif",negative_fee:"Les frais ne peuvent pas être négatifs"},success_create_title:"Service créé",success_create_message:"Le service a été créé avec succès",success_update_title:"Service mis à jour",success_update_message:"Le service a été mis à jour avec succès",error_loading:"Erreur lors du chargement des données",error_submit:"Erreur lors de l'enregistrement du service"},billing_cycles:{monthly:"Mensuel",quarterly:"Trimestriel",semi_annually:"Semestriel",annually:"Annuel",biennially:"Biennal",triennially:"Triennal"},status_change:{activate_title:"Activer le service",suspend_title:"Suspendre le service",cancel_title:"Annuler le service",terminate_title:"Résilier le service",activate_confirmation:"Êtes-vous sûr de vouloir activer ce service ?",suspend_confirmation:"Êtes-vous sûr de vouloir suspendre ce service ?",cancel_confirmation:"Êtes-vous sûr de vouloir annuler ce service ?",terminate_confirmation:"Êtes-vous sûr de vouloir résilier ce service ? Cette action est irréversible.",notes:"Notes",notes_placeholder:"Raison du changement de statut...",success_title:"Statut modifié",activate_success:"Le service a été activé avec succès",suspend_success:"Le service a été suspendu avec succès",cancel_success:"Le service a été annulé avec succès",terminate_success:"Le service a été résilié avec succès",error:"Erreur lors du changement de statut",invalid_action:"Action invalide"}},I5={common:_5,login:y5,products_services:b5,product_groups:$5,invoices:S5,subscriptions:w5,payments:k5,tickets:C5,clients:A5,sidebar:E5,settings:O5,dashboard:T5,topbar:R5,services:x5},P5={back:"Back",save:"Save",cancel:"Cancel",delete:"Delete",deleting:"Deleting",edit:"Edit",loading:"Loading...",actions:"Actions",select:"Select...",close:"Close",search:"Search",view_all:"View all",continue:"Continue",add:"Add",month:"Month",months:"Months",saving:"Saving...",create:"Create",update:"Update",retry:"Retry",error:"Error",error_occurred:"An error occurred",language:{select:"Select language",fr:"French",en:"English"}},M5={welcome:"Welcome to TechCMS",subtitle:"Log in to access your administration area",email:"Email",emailPlaceholder:"Your email address",password:"Password",passwordPlaceholder:"Your password",rememberMe:"Remember me",forgotPassword:"Forgot password?",signIn:"Sign in",resetPassword:"Reset password",resetInstructions:"Enter your email address to receive reset instructions",sendReset:"Send instructions",resetSent:"Reset instructions have been sent to your email address",errorFields:"Please fill in all fields",errorEmail:"Please enter a valid email address",errorGeneral:"Incorrect email or password",errorForgot:"An error occurred while sending instructions",copyright:" {year} TechCMS. All rights reserved."},D5={title:"Products/Services",description:"Manage your products and services in a unified interface",add:"Add product/service",add_title:"Add product/service",edit_title:"Edit product/service",search:"Search for a product/service...",columns:{name:"Name",description:"Description",price:"Price",status:"Status",clients:"Clients",type:"Type",group:"Group"},status:{all:"All",active:"Active",inactive:"Inactive",maintenance:"Maintenance"},types:{all:"All types",product:"Product",service:"Service",shared_hosting:"Shared hosting",reseller_hosting:"Reseller hosting",server_vps:"Server / VPS",other:"Other"},fields:{name:"Name",description:"Description",price:"Price",status:"Status",type:"Type",features:"Features",featureName:"Feature name",included:"Included",addFeature:"Add feature",group:"Group"},filters:{search:"Search",status:"Status",type:"Type",price_range:"Price range",all_prices:"All prices",price_low:"Low price (< €50)",price_medium:"Medium price (€50 - €200)",price_high:"High price (> €200)",apply:"Apply filters",group:"Group"},groups:{all:"All groups",none:"No group"},empty:{title:"No products or services found",description:"Start by adding a product or service by clicking the button above."},validation:{nameRequired:"Name is required",pricePositive:"Price must be positive"},success:{create:"Product/service created",createMessage:"The product/service {name} has been successfully created",update:"Product/service updated",updateMessage:"The product/service {name} has been successfully updated",delete:"Product/service deleted",deleteMessage:"The product/service {name} has been successfully deleted"},errors:{fetch:"Loading error",fetchMessage:"Unable to load products/services",create:"Creation error",update:"Update error",saveMessage:"An error occurred while saving the product/service",delete:"Deletion error",deleteMessage:"An error occurred while deleting the product/service",nameRequired:"Name is required",pricePositive:"Price must be positive",name_required:"Name is required",group_required:"Group is required"},confirm:{delete:"Are you sure you want to delete the product/service {name}?"},pricing:{title:"Pricing",description:"Configure pricing options for your product",payment_type:"Payment Type",free:"Free",one_time:"One Time",recurring:"Recurring",allow_multiple_quantities:"Allow Multiple Quantities",multiple_quantities_no_help:"Clients can only purchase one of this product at a time",no:"No",yes:"Yes",multiple_quantities_yes_help:"Clients can purchase multiple quantities of this product",auto_termination_days:"Auto Termination Days",auto_termination_days_help:"Number of days after which the product will be automatically terminated. Leave empty for no auto termination.",promotion_code:"Promotion Code",promotion_code_help:"Apply a promotion code to this product by default",prorata_billing:"Prorata Billing",prorata_billing_help:"Charge clients only for the remaining days in the billing cycle",private_billing_date:"Private Billing Date",private_billing_date_help:"Set a specific billing date for this product, overriding the client's billing date",charge_next_month:"Charge Next Month",charge_next_month_help:"Charge the client for the next month instead of the current month",pricing_configuration:"Pricing Configuration",system_default:"System Default",system_default_help:"Use the system default pricing configuration",product_specific:"Product Specific",product_specific_help:"Use a specific pricing configuration for this product",payment_options:"Payment Options",option:"Option",monthly:"Monthly",quarterly:"Quarterly",semiannually:"Semiannually",annually:"Annually",biennially:"Biennially",triennially:"Triennially",payment_options_help:"Configure payment options for this product",enabled:"Enabled",price:"Price",setup_fee:"Setup Fee",recurring_cycles_limit:"Recurring Cycles Limit",recurring_cycles_limit_help:"Maximum number of billing cycles for this product. Leave empty for unlimited cycles."},create_product:{title:"Create a product",description:"Create a new product by following the steps below",step1_title:"General information",step2_title:"Details and pricing",step3_title:"Features and options",product_type:"Product type",select_type:"Select a product type",type_help:"Choose the type of product you want to create",type_other_help:"Create a custom product type not listed above",type_description:"Description of the product type",types:{shared_hosting:"Shared hosting",reseller_hosting:"Reseller hosting",server_vps:"Server / VPS",other:"Other"},group:"Group",name:"Name",slug:"Slug",slug_help:"Used for URLs. Leave empty to generate automatically from the name.",module:"Module",no_module:"No module",hidden:"Hidden",hidden_help:"Hidden products are not visible to customers in the store.",price:"Price",setup_fee:"Setup fee",recurring:"Recurring",billing_cycle:"Billing cycle",cycles:{monthly:"Monthly",quarterly:"Quarterly",semiannually:"Semiannually",annually:"Annually",biennially:"Biennially"},status:"Status",statuses:{active:"Active",inactive:"Inactive",draft:"Draft"},features:"Features",no_features:"No features added. Click the Add button to start.",feature_name:"Feature name",feature_value:"Value",options:"Options",no_options:"No options added. Click the Add button to start.",option_name:"Option name",option_type:"Option type",option_types:{select:"Select",radio:"Radio",checkbox:"Checkbox",quantity:"Quantity"},required:"Required",option_choices:"Available choices",choice_name:"Choice name",choice_price:"Additional price",summary:"Product summary",summary_description:"Check the details of your product before saving."},details:{title:"Product Details",description:"Configure the details of your product",product_type:"Product Type",product_group:"Product Group",product_type_help:"The type of product determines its features and functionality",product_group_help:"Group similar products together for better organization",product_name:"Product Name",product_name_help:"Enter a descriptive name for your product",product_tagline:"Product Tagline",product_tagline_help:"A short description that appears in product listings",url:"URL",url_help:"Custom URL for this product",module:"Module",module_help:"Select a module to handle this product",product_short_description:"Short Description",product_short_description_help:"Brief description displayed in product listings",product_description:"Full Description",product_description_help:"Detailed description of the product",product_color:"Product Color",product_color_help:"Color used for product branding and UI elements",welcome_email:"Welcome Email",welcome_email_help:"Email template sent to customers after purchase",advanced_options:"Advanced Options",create_as_hidden:"Create as Hidden",create_as_hidden_help:"Hidden products are not visible in the store",require_domain:"Require Domain",require_domain_help:"Customer must select a domain when ordering this product",stock_control:"Stock Control",stock_control_help:"Track inventory for this product",apply_tax:"Apply Tax",apply_tax_help:"Apply tax rates to this product",featured:"Featured Product",featured_help:"Featured products are highlighted in the store",hide_other_products:"Hide Other Products",hide_other_products_help:"When this product is in the cart, hide other products",select_group:"Select a group"},modules:{none:"No module",custom:"Custom module",title:"Module Settings",description:"Configure the server module for your product",module_name:"Module Name",module_name_help:"Select the server module to use for this product",no_module_info:"No module selected. This product will not be automatically provisioned on any server.",server_group:"Server Group",no_server_group:"No server group",shared_servers:"Shared Hosting Servers",reseller_servers:"Reseller Hosting Servers",vps_servers:"VPS/Dedicated Servers",server_group_help:"Select the server group where this product will be provisioned",choose_module_info:"Choose a module to see additional configuration options",auto_setup_options:"Auto Setup Options",auto_setup_on_order:"Auto Setup On Order",auto_setup_on_order_help:"Automatically provision the product when the order is placed",auto_setup_on_payment:"Auto Setup On Payment",auto_setup_on_payment_help:"Automatically provision the product when payment is received",auto_setup_on_pending_order:"Auto Setup On Pending Order",auto_setup_on_pending_order_help:"Automatically provision the product when the order is marked as pending",no_auto_setup:"No Auto Setup",no_auto_setup_help:"Do not automatically provision the product. Manual setup will be required.",errors:{server_group_required:"A server group is required when a module is selected",server_required:"A server is required for this module",cpanel_plan_required:"A cPanel plan is required",virtualizor_resources_required:"You must configure at least one resource for Virtualizor",proxmox_resources_required:"You must configure at least one resource for Proxmox"},resources:{title:"Resource Configuration",description:"Configure the resources that will be allocated for this product",cpu:"CPU (vCores)",cpu_help:"Number of virtual processor cores",memory:"RAM Memory (MB)",memory_help:"Amount of memory in megabytes",disk_space:"Disk Space (GB)",disk_space_help:"Disk space in gigabytes",bandwidth:"Bandwidth (GB)",bandwidth_help:"Monthly bandwidth in gigabytes",ips:"IP Addresses",ips_help:"Number of IP addresses to allocate",virtualizor:{title:"Virtualizor Resources",description:"Configure specific resources for Virtualizor",virtualization:"Virtualization Type",virtualization_help:"Select the virtualization type",os_template:"OS Template",os_template_help:"Select the OS template to use"},proxmox:{title:"Proxmox Resources",description:"Configure specific resources for Proxmox",container_type:"Container Type",container_type_help:"Select the container type (LXC or VM)",storage:"Storage",storage_help:"Select Proxmox storage to use",template:"Template",template_help:"Select the template to use for creation"}}},custom_fields:{title:"Custom Fields",description:"Configure custom fields for your product",list_title:"Custom Fields List",add_field:"Add Custom Field",no_fields:"No custom fields have been added yet",add_first_field:"Add your first custom field"},configurable_options:{title:"Configurable Options",description:"Configure customizable options that clients can select when ordering this product",empty_state:"No configurable options have been added yet",add_first_option:"Add your first configurable option",add_option:"Add Option",new_option:"New Option",fields:{name:"Option Name",type:"Option Type",option_group:"Option Group",description:"Description",description_help:"This description will be shown to customers when ordering",required:"Required",item_name:"Item Name",price:"Price",setup_fee:"Setup Fee",set_as_default:"Set as Default"},types:{dropdown:"Dropdown",radio:"Radio",checkbox:"Checkbox",quantity:"Quantity",text:"Text"},no_group:"No Group",option_items:"Option Items",errors:{name_required:"Option name is required",items_required:"At least one option item is required"}},upgrades:{title:"Upgrades & Downgrades",description:"Configure product upgrade and downgrade options",configuration_title:"Configuration",allow_downgrade:"Allow Downgrade",allow_downgrade_help:"Allow customers to downgrade to a lower-tier product",upgrade_package_quantity:"Upgrade Package Quantity",upgrade_package_quantity_help:"Allow customers to upgrade the quantity of their package",products_title:"Available Products",product_name:"Product Name",action:"Action",add:"Add Upgrade",selected_upgrades:"Selected Upgrades",remove:"Remove"},freedomain:{title:"Free Domain",description:"Configure free domain options for this product",configuration_title:"Configuration",enable_freedomain:"Enable Free Domain",enable_freedomain_help:"Offer a free domain with this product",required_period:"Required Billing Period",required_period_help:"Minimum billing period required to qualify for a free domain",initial_order_only:"Initial Order Only",initial_order_only_help:"Only offer free domain on the initial order, not on renewals",available_tlds:"Available TLDs",tlds_help:"Select which TLDs are eligible for free domain",selected_tlds:"Selected TLDs"},cross_sells:{title:"Cross-Sells",description:"Configure cross-sell products to offer with this product",configuration_title:"Configuration",show_on_checkout:"Show on Checkout",show_on_checkout_help:"Display cross-sell products during checkout process",discount_percent:"Discount Percentage",discount_percent_help:"Apply a discount to cross-sell products when purchased together",search_title:"Product Search",search_products:"Search Products",search_placeholder:"Search for products to cross-sell",selected_products:"Selected Products",no_products_selected:"No products selected",no_search_results:"No products found matching your search",product_name:"Product Name",product_type:"Product Type",product_price:"Price",action:"Action",add:"Add",remove:"Remove"},other:{title:"Other Settings",description:"Configure additional settings for this product",configuration_title:"Configuration",require_domain:"Require Domain",require_domain_help:"Require a domain to be associated with this product",auto_setup:"Auto Setup",auto_setup_help:"Automatically provision this product when ordered",stock_control:"Stock Control",stock_control_help:"Enable stock control for this product",stock_quantity_help:"Set the available quantity for this product",hidden:"Hidden",hidden_help:"Hide this product from the product listing",featured:"Featured",featured_help:"Mark this product as featured",welcome_email_help:"Select welcome email to send when this product is ordered",welcome_email_none:"No welcome email",welcome_email_product:"Product-specific welcome email",welcome_email_general:"General welcome email",welcome_email_both:"Both product and general welcome emails",notes_help:"Internal notes about this product (not visible to customers)",notes_placeholder:"Enter any notes or comments about this product here..."},links:{title:"Product Links",description:"Manage direct links and promotional URLs for this product",direct_links_title:"Direct Order Links",direct_cart_link_placeholder:"Direct cart link",direct_cart_link_template_placeholder:"Direct cart link with template",direct_cart_link_domain_placeholder:"Direct cart link with domain",group_cart_link_placeholder:"Group cart link",product_links_title:"Promotional Links",url:"URL",visits:"Visits",actions:"Actions",add_link:"Add Link",url_placeholder:"Enter promotional URL",finalize_product:"Please finalize the product before generating links",finalizing:"Finalizing product..."},welcome_emails:{none:"No welcome email",hosting:"Hosting welcome email",general:"General welcome email"},tabs:{type:"Type",details:"Details",pricing:"Pricing",module:"Module",custom_fields:"Custom Fields",configurable_options:"Configurable Options",upgrades:"Upgrades",freedomain:"Free Domain",cross_sells:"Cross-Sells",other:"Other",links:"Links"}},N5={title:"Product groups",add:"Create a group",add_title:"Create a new group",edit_title:"Edit group",fields:{name:"Name",slug:"Slug",description:"Description"},placeholders:{name:"Group name",slug:"group-slug",description:"Group description"},slug_help:"The slug is used in URLs. Use only lowercase letters, numbers and hyphens.",empty:{title:"No groups",message:"You don't have any groups yet. Click the button above to create one."},success:{create:"Group created successfully",update:"Group updated successfully",delete:"Group deleted successfully"},errors:{name_required:"Name is required",slug_required:"Slug is required",slug_invalid:"The slug is not valid. Use only lowercase letters, numbers and hyphens.",create:"An error occurred while creating the group",update:"An error occurred while updating the group",delete:"An error occurred while deleting the group",fetch:"An error occurred while retrieving groups"},confirm_delete:"Are you sure you want to delete this group? All products associated with this group will be moved to the default group."},L5={title:"Invoices",actions:{add:"Add invoice",edit:"Edit invoice",view:"View invoice",delete:"Delete invoice",mark_paid:"Mark as paid"},modal:{add_title:"Add invoice",edit_title:"Edit invoice",view_title:"Invoice details"},columns:{number:"Number",client:"Client",service:"Service",amount:"Amount",due_date:"Due date",paid_date:"Payment date",status:"Status",created_at:"Creation date"},status:{pending:"Pending",paid:"Paid",overdue:"Overdue",cancelled:"Cancelled",deleted:"Deleted"},filters:{label:"Filter by status",all:"All",pending:"Pending",paid:"Paid",overdue:"Overdue",cancelled:"Cancelled"},search:{placeholder:"Search for an invoice..."},empty:{message:"No invoices found",action:"Add an invoice"},confirm:{delete:"Are you sure you want to delete this invoice?",mark_paid:"Are you sure you want to mark this invoice as paid?"},success:{create:"Invoice successfully created",update:"Invoice successfully updated",delete:"Invoice successfully deleted",mark_paid:"Invoice successfully marked as paid"},errors:{fetch:"Error loading invoices",create:"Error creating invoice",update:"Error updating invoice",delete:"Error deleting invoice",mark_paid:"Error marking invoice as paid"}},U5={title:"Subscriptions",description:"Manage your customers subscriptions",actions:{add:"Add subscription",edit:"Edit subscription",view:"View subscription",cancel:"Cancel subscription",renew:"Renew subscription"},table:{id:"ID",client:"Client",product:"Product",startDate:"Start date",endDate:"End date",renewalDate:"Renewal date",price:"Price",billingCycle:"Billing cycle",status:"Status",actions:"Actions"},filters:{search:"Search",status:"Status",billing_cycle:"Billing cycle",all_cycles:"All cycles",apply:"Apply filters",all:"All",active:"Active",pending:"Pending",cancelled:"Cancelled",expired:"Expired"},search:{placeholder:"Search for a subscription..."},empty:{title:"No subscriptions found",message:"You don't have any subscriptions yet. Start by creating one."},statuses:{active:"Active",pending:"Pending",cancelled:"Cancelled",expired:"Expired"},billingCycles:{monthly:"Monthly",quarterly:"Quarterly",semiAnnual:"Semi-annual",annual:"Annual"},form:{client:"Client",product:"Product",startDate:"Start date",endDate:"End date",price:"Price",billingCycle:"Billing cycle",status:"Status",autoRenew:"Auto-renewal",notes:"Notes",cancelReason:"Cancellation reason"},confirm:{cancel:"Are you sure you want to cancel this subscription?",renew:"Are you sure you want to renew this subscription?"},success:{create:"Subscription created successfully",update:"Subscription updated successfully",cancel:"Subscription cancelled successfully",renew:"Subscription renewed successfully"},errors:{fetch:"Error loading subscriptions",fetchOne:"Error loading subscription",create:"Error creating subscription",update:"Error updating subscription",cancel:"Error cancelling subscription",renew:"Error renewing subscription"}},V5={title:"Payments",actions:{add:"Add payment",edit:"Edit payment",view:"View payment",delete:"Delete payment",refund:"Refund"},modal:{add_title:"Add payment",edit_title:"Edit payment",view_title:"Payment details"},columns:{id:"ID",invoice:"Invoice",client:"Client",amount:"Amount",date:"Payment date",method:"Method",transaction_id:"Transaction ID",status:"Status",notes:"Notes",created_at:"Creation date"},status:{completed:"Completed",pending:"Pending",failed:"Failed",refunded:"Refunded"},methods:{card:"Credit card",bank_transfer:"Bank transfer",paypal:"PayPal",cash:"Cash",check:"Check"},fields:{transaction_id_help:"Transaction reference number (optional)"},filters:{label:"Filter by status",all:"All",completed:"Completed",pending:"Pending",failed:"Failed",refunded:"Refunded"},search:{placeholder:"Search for a payment..."},empty:{message:"No payment found",action:"Add a payment"},confirm:{delete:"Are you sure you want to delete this payment?"},refund:{title:"Refund payment",reason:"Refund reason",reason_placeholder:"Please indicate the reason for the refund",confirm:"Confirm refund",error_title:"Refund error",error_reason_required:"Refund reason is required"},success:{create:"Payment successfully created",update:"Payment successfully updated",delete:"Payment successfully deleted",refund:"Refund successfully processed"},errors:{fetch:"Error loading payments",create:"Error creating payment",update:"Error updating payment",delete:"Error deleting payment",refund:"Error processing refund"}},F5={title:"Tickets",actions:{add:"Add ticket",create:"Create",update:"Update",delete:"Delete",view:"View"},modal:{add_title:"Add a ticket",edit_title:"Edit ticket",view_title:"Ticket details"},fields:{client:"Client",subject:"Subject",message:"Message",priority:"Priority",status:"Status"},priority:{low:"Low",medium:"Medium",high:"High",urgent:"Urgent"},status:{open:"Open",pending:"Pending",closed:"Closed",resolved:"Resolved"},filters:{all:"All",open:"Open",pending:"Pending",closed:"Closed",resolved:"Resolved"},table:{id:"ID",subject:"Subject",client:"Client",priority:"Priority",status:"Status",lastReply:"Last reply",createdAt:"Created at",actions:"Actions"},search:{placeholder:"Search for a ticket..."},empty:{message:"No tickets found",description:"Create a new ticket or modify your filters"},confirm:{delete:{title:"Delete ticket",message:"Are you sure you want to delete this ticket? This action is irreversible."}},success:{create:"Ticket created successfully",update:"Ticket updated successfully",delete:"Ticket deleted successfully",close:"Ticket closed successfully",reopen:"Ticket reopened successfully",reply:"Your reply has been added successfully"},errors:{create:"An error occurred while creating the ticket",update:"An error occurred while updating the ticket",delete:"An error occurred while deleting the ticket",fetch:"An error occurred while retrieving tickets",close:"An error occurred while closing the ticket",reopen:"An error occurred while reopening the ticket",reply:"An error occurred while adding your reply"},selectClient:"Select a client",noMessages:"No messages for this ticket",addReply:"Add a reply",replyPlaceholder:"Your reply...",sendReply:"Send"},q5={menu:{dashboard:"Dashboard",clients:"Clients",services:"Services",catalog:{title:"Catalog",products_services:"Products & Services"},billing:{title:"Billing",invoices:"Invoices",payments:"Payments",subscriptions:"Subscriptions"},support:{title:"Support",tickets:"Tickets",kb:"Knowledge base"},settings:"Settings",logout:"Logout"}},B5={title:"Settings",description:"Configure your system settings",tabs:{home:"Home",general:"General",notifications:"Notifications",security:"Security",billing:"Billing",servers:"Servers",integrations:"Integrations",license:"License"},general:{title:"General settings",description:"Configure the general settings of your system",siteName:"Site name",siteDescription:"Site description",siteEmail:"Site email",sitePhone:"Site phone",siteAddress:"Site address",siteUrl:"Site URL",logo:"Logo",favicon:"Favicon",timezone:"Timezone",dateFormat:"Date format",timeFormat:"Time format",language:"Language",currency:"Currency",currencySymbol:"Currency symbol",currencyPosition:"Currency symbol position",decimalSeparator:"Decimal separator",thousandSeparator:"Thousand separator",decimalPlaces:"Number of decimal places"},security:{title:"Security settings",description:"Configure the security settings of your system",sessionTimeout:"Session timeout (minutes)",loginAttempts:"Number of login attempts before blocking",loginBlockTime:"Blocking time after failed attempts (minutes)",passwordMinLength:"Minimum password length",passwordRequireUppercase:"Require uppercase in password",passwordRequireLowercase:"Require lowercase in password",passwordRequireNumber:"Require number in password",passwordRequireSpecial:"Require special character in password",passwordExpiration:"Password expiration (days, 0 = never)",twoFactorAuth:"Two-factor authentication",twoFactorAuthRequired:"Require two-factor authentication",apiTokenExpiration:"API token expiration (days, 0 = never)"},billing:{title:"Billing settings",description:"Configure the billing settings of your system",invoicePrefix:"Invoice prefix",invoiceStartNumber:"Invoice start number",invoiceFooter:"Invoice footer",invoiceTerms:"Invoice terms",invoiceDueDays:"Default payment due days",invoiceAutoReminder:"Send automatic reminders",invoiceReminderDays:"Days before due date for reminder",taxEnabled:"Enable tax",taxName:"Tax name",taxRate:"Tax rate (%)",taxNumber:"Tax number",paymentMethods:"Payment methods",bankTransfer:"Bank transfer",bankName:"Bank name",bankAccount:"Bank account",bankIban:"IBAN",bankSwift:"SWIFT/BIC"},integrations:{title:"Integration settings",description:"Configure integrations with external services",mailDriver:"Email service",mailHost:"SMTP host",mailPort:"SMTP port",mailUsername:"SMTP username",mailPassword:"SMTP password",mailEncryption:"SMTP encryption",mailFromAddress:"From address",mailFromName:"From name",smsEnabled:"Enable SMS",smsProvider:"SMS provider",smsApiKey:"SMS API key",smsFromNumber:"SMS from number",pushEnabled:"Enable push notifications",pushProvider:"Push notification provider",pushApiKey:"Push notification API key",googleAnalyticsId:"Google Analytics ID",recaptchaSiteKey:"reCAPTCHA site key",recaptchaSecretKey:"reCAPTCHA secret key"},actions:{save:"Save settings",reset:"Reset settings",testEmail:"Test email sending",testSms:"Test SMS sending"},messages:{saved:"Settings saved successfully",error:"An error occurred while saving settings",emailTestSent:"Email test sent successfully",emailTestError:"An error occurred while sending email test",smsTestSent:"SMS test sent successfully",smsTestError:"An error occurred while sending SMS test"},license:{title:"License Management",description:"Manage your TechCMS license and check its status",licenseKey:"License key",licenseType:"License type",licenseStatus:"License status",licenseExpiration:"Expiration date",licenseDomain:"Registered domain",licenseSupport:"Support until",licenseRenew:"Renew license",licenseDeactivate:"Deactivate license",active:"Active",inactive:"Inactive",free:"Free",pro:"Pro",updateSuccess:"License updated successfully",updateError:"Error updating license",verifyingLicense:"Verifying license...",enterLicenseKey:"Please enter a valid license key"},servers:{title:"Server Management",description:"Configure and manage your servers (cPanel, Proxmox, Virtualizor)",add:"Add server",edit:"Edit server",delete:"Delete server",test:"Test connection",name:"Server name",hostname:"Hostname",type:"Server type",ipAddress:"IP address",username:"Username",password:"Password",port:"Port",secure:"Secure connection",accessKey:"API access key",active:"Active",status:"Status",load:"Load",types:{cpanel:"cPanel",proxmox:"Proxmox",virtualizor:"Virtualizor"},statuses:{online:"Online",offline:"Offline",maintenance:"Maintenance"},confirmDelete:"Are you sure you want to delete this server?",testSuccess:"Connection to server successful",testError:"Failed to connect to server",saveSuccess:"Server saved successfully",saveError:"Error saving server",deleteSuccess:"Server deleted successfully",deleteError:"Error deleting server"}},j5={title:"Dashboard",stats:{active_clients:"Active clients",active_services:"Active services",total_products:"Total products",monthly_revenue:"Monthly revenue"},recent_clients:{title:"Recent clients"},recent_tickets:{title:"Recent tickets"}},G5={notifications:{title:"Notifications",mark_all_read:"Mark all as read",empty:"No notifications",view_all:"View all notifications"},profile:{my_profile:"My profile",settings:"Settings",logout:"Logout"}},z5={title:"Clients",description:"Manage your clients and their services",add_new:"Add client",filters:{search:"Search",search_placeholder:"Search for a client...",service_type:"Service type",status:"Status"},services:{all:"All services",hosting:"Hosting",domain:"Domain name",ssl:"SSL Certificate"},table:{client:"Client",company:"Company",email:"Email",phone:"Phone",status:"Status",services:"Services",actions:"Actions"},status:{all:"All statuses",active:"Active",inactive:"Inactive",pending:"Pending"},empty:{title:"No clients found",description:"You don't have any clients yet. Start by adding one."},no_services:"No services",form:{firstname:"First name",firstname_placeholder:"Enter first name",lastname:"Last name",lastname_placeholder:"Enter last name",email:"Email",email_placeholder:"Enter email address",phone:"Phone",phone_placeholder:"Enter phone number",company:"Company",company_placeholder:"Enter company name",status:"Status",address:"Address",address_placeholder:"Enter address",postal_code:"Postal code",postal_code_placeholder:"Enter postal code",city:"City",city_placeholder:"Enter city",country:"Country",country_placeholder:"Enter country",password:"Password",password_placeholder:"Enter password",password_optional:"(Optional)",password_leave_empty:"Leave empty to keep current password",address_title:"Address",personal_info:"Personal information"},actions:{view:"View details",edit:"Edit",delete:"Delete"},confirm_delete:"Are you sure you want to delete this client?",details:{title:"Client details",description:"Detailed client information",personal_info:"Personal information",address:"Address",services:"Services",no_services:"This client has no active services",invoices:"Invoices",no_invoices:"No invoices found for this client",tab_info:"Information",tab_services:"Services",tab_invoices:"Invoices",error_loading:"Error loading client information",error_deleting:"Error deleting client",not_found:"Client not found"},edit:{title:"Edit client",description:"Update client information"},add:{title:"Add client",description:"Create a new client"},delete_modal:{title:"Delete client",confirmation:"Are you sure you want to delete this client?",warning:"This action is irreversible. All data associated with this client will be deleted."},validation:{firstname_required:"First name is required",lastname_required:"Last name is required",email_required:"Email address is required",email_invalid:"Email address is invalid",password_required:"Password is required"}},H5={title:"Services",description:"Manage your client services",add_new:"Add Service",empty:{title:"No services found",message:"You don't have any services yet. Start by creating one."},filters:{search:"Search",search_placeholder:"Search by domain, client name...",status:"Status",client:"Client",product:"Product",all_clients:"All clients",all_products:"All products"},table:{client:"Client",product:"Product",domain:"Domain",status:"Status",next_due_date:"Next Due Date",recurring_amount:"Recurring Amount",actions:"Actions"},status:{all:"All statuses",pending:"Pending",active:"Active",suspended:"Suspended",cancelled:"Cancelled",terminated:"Terminated",fraud:"Fraud"},actions:{view:"View",edit:"Edit",delete:"Delete",activate:"Activate",suspend:"Suspend",cancel:"Cancel",terminate:"Terminate"},delete_modal:{title:"Delete Service",confirmation:"Are you sure you want to delete this service?",warning:"This action is irreversible and will delete all data associated with this service."},create:{title:"Create Service",description:"Add a new service for a client"},edit:{title:"Edit Service",description:"Modify service details"},details:{title:"Service Details",description:"View detailed information about the service",client:"Client",client_name:"Client Name",client_email:"Client Email",product:"Product",product_name:"Product Name",server:"Server",server_name:"Server Name",billing:"Billing",billing_cycle:"Billing Cycle",next_due_date:"Next Due Date",recurring_amount:"Recurring Amount",setup_fee:"Setup Fee",important_dates:"Important Dates",created_at:"Created At",suspension_date:"Suspension Date",cancellation_date:"Cancellation Date",termination_date:"Termination Date",login_details:"Login Details",username:"Username",password:"Password",configuration:"Custom Configuration",notes:"Notes",unknown:"Unknown",unknown_product:"Unknown Product",not_set:"Not set",no_server:"No server associated",no_login_details:"No login details defined",view_client:"View client",view_product:"View product",view_server:"View server",error_loading:"Error loading service"},form:{section:{client_product:"Client and Product",details:"Service Details",billing:"Billing",notes:"Notes",configurations:"Custom Configurations"},client:"Client",select_client:"Select a client",product:"Product",select_product:"Select a product",domain:"Domain",domain_placeholder:"example.com",username:"Username",username_placeholder:"Username",password:"Password",password_placeholder:"Password",server:"Server",select_server:"Select a server",status:"Status",billing_cycle:"Billing Cycle",next_due_date:"Next Due Date",recurring_amount:"Recurring Amount",amount_placeholder:"0.00",setup_fee:"Setup Fee",fee_placeholder:"0.00",notes:"Notes",notes_placeholder:"Internal notes about this service...",config_name:"Name",config_value:"Value",action:"Action",add_config:"Add Configuration",errors:{client_required:"Client is required",product_required:"Product is required",status_required:"Status is required",invalid_date:"Invalid date format",negative_amount:"Amount cannot be negative",negative_fee:"Fee cannot be negative"},success_create_title:"Service Created",success_create_message:"Service has been created successfully",success_update_title:"Service Updated",success_update_message:"Service has been updated successfully",error_loading:"Error loading data",error_submit:"Error saving service"},billing_cycles:{monthly:"Monthly",quarterly:"Quarterly",semi_annually:"Semi-Annually",annually:"Annually",biennially:"Biennially",triennially:"Triennially"},status_change:{activate_title:"Activate Service",suspend_title:"Suspend Service",cancel_title:"Cancel Service",terminate_title:"Terminate Service",activate_confirmation:"Are you sure you want to activate this service?",suspend_confirmation:"Are you sure you want to suspend this service?",cancel_confirmation:"Are you sure you want to cancel this service?",terminate_confirmation:"Are you sure you want to terminate this service? This action is irreversible.",notes:"Notes",notes_placeholder:"Reason for status change...",success_title:"Status Changed",activate_success:"Service has been activated successfully",suspend_success:"Service has been suspended successfully",cancel_success:"Service has been cancelled successfully",terminate_success:"Service has been terminated successfully",error:"Error changing status",invalid_action:"Invalid action"}},W5={common:P5,login:M5,products_services:D5,product_groups:N5,invoices:L5,subscriptions:U5,payments:V5,tickets:F5,sidebar:q5,settings:B5,dashboard:j5,topbar:G5,clients:z5,services:H5},K5=localStorage.getItem("language")||"fr",J5=Ts({legacy:!1,locale:K5,fallbackLocale:"en",messages:{fr:I5,en:W5}});console.log("[MAIN] Démarrage de l'application");console.log("[MAIN] Création de l'application Vue");const ut=Rs(g5);console.log("[MAIN] Initialisation de Pinia");const ys=xs();ys.use(Hs);ut.use(ys);console.log("[MAIN] Initialisation du Router");ut.use(tt);console.log("[MAIN] Initialisation de i18n");ut.use(J5);console.log("[MAIN] Montage de l'application");ut.mount("#vue-app");console.log("[MAIN] Application montée avec succès");
