import{d as je,r as Q,a as ke,u as Le,o as Fe,b as xt,c as K,e as q,f as e,t as T,g as Ce,h as ie,w as Ae,F as _e,i as Se,n as ce,j as W,k as Re,l as ae,m as Z,v as le,p as yo,q as Oe,s as kt,x as ue,y as xe,z as at,T as rs,A as Dt,B as ss,C as pt,D as xo,E as bo,G as Co,H as Ao,I as os,J as Eo,K as _o,L as So,M as wo,N as Ro}from"./vendor-VX4jqcI5.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const p of r)if(p.type==="childList")for(const i of p.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const p={};return r.integrity&&(p.integrity=r.integrity),r.referrerPolicy&&(p.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?p.credentials="include":r.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function t(r){if(r.ep)return;r.ep=!0;const p=s(r);fetch(r.href,p)}})();const Do=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Oo=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Bo=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function To(o,n){if(o==="__proto__"||o==="constructor"&&n&&typeof n=="object"&&"prototype"in n){ko(o);return}return n}function ko(o){console.warn(`[destr] Dropping "${o}" key to prevent prototype pollution.`)}function $o(o,n={}){if(typeof o!="string")return o;const s=o.trim();if(o[0]==='"'&&o.endsWith('"')&&!o.includes("\\"))return s.slice(1,-1);if(s.length<=9){const t=s.toLowerCase();if(t==="true")return!0;if(t==="false")return!1;if(t==="undefined")return;if(t==="null")return null;if(t==="nan")return Number.NaN;if(t==="infinity")return Number.POSITIVE_INFINITY;if(t==="-infinity")return Number.NEGATIVE_INFINITY}if(!Bo.test(o)){if(n.strict)throw new SyntaxError("[destr] Invalid JSON");return o}try{if(Do.test(o)||Oo.test(o)){if(n.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(o,To)}return JSON.parse(o)}catch(t){if(n.strict)throw t;return o}}function Fo(o,n){if(o==null)return;let s=o;for(let t=0;t<n.length;t++){if(s==null||s[n[t]]==null)return;s=s[n[t]]}return s}function In(o,n,s){if(s.length===0)return n;const t=s[0];return s.length>1&&(n=In(typeof o!="object"||o===null||!Object.prototype.hasOwnProperty.call(o,t)?Number.isInteger(Number(s[1]))?[]:{}:o[t],n,Array.prototype.slice.call(s,1))),Number.isInteger(Number(t))&&Array.isArray(o)?o.slice()[t]:Object.assign({},o,{[t]:n})}function is(o,n){if(o==null||n.length===0)return o;if(n.length===1){if(o==null)return o;if(Number.isInteger(n[0])&&Array.isArray(o))return Array.prototype.slice.call(o,0).splice(n[0],1);const s={};for(const t in o)s[t]=o[t];return delete s[n[0]],s}if(o[n[0]]==null){if(Number.isInteger(n[0])&&Array.isArray(o))return Array.prototype.concat.call([],o);const s={};for(const t in o)s[t]=o[t];return s}return In(o,is(o[n[0]],Array.prototype.slice.call(n,1)),[n[0]])}function as(o,n){return n.map(s=>s.split(".")).map(s=>[s,Fo(o,s)]).filter(s=>s[1]!==void 0).reduce((s,t)=>In(s,t[1],t[0]),{})}function ls(o,n){return n.map(s=>s.split(".")).reduce((s,t)=>is(s,t),o)}function tr(o,{storage:n,serializer:s,key:t,debug:r,pick:p,omit:i,beforeHydrate:h,afterHydrate:C},u,v=!0){try{v&&(h==null||h(u));const E=n.getItem(t);if(E){const y=s.deserialize(E),w=p?as(y,p):y,f=i?ls(w,i):w;o.$patch(f)}v&&(C==null||C(u))}catch(E){r&&console.error("[pinia-plugin-persistedstate]",E)}}function nr(o,{storage:n,serializer:s,key:t,debug:r,pick:p,omit:i}){try{const h=p?as(o,p):o,C=i?ls(h,i):h,u=s.serialize(C);n.setItem(t,u)}catch(h){r&&console.error("[pinia-plugin-persistedstate]",h)}}function Po(o,n,s){const{pinia:t,store:r,options:{persist:p=s}}=o;if(!p)return;if(!(r.$id in t.state.value)){const C=t._s.get(r.$id.replace("__hot:",""));C&&Promise.resolve().then(()=>C.$persist());return}const h=(Array.isArray(p)?p:p===!0?[{}]:[p]).map(n);r.$hydrate=({runHooks:C=!0}={})=>{h.forEach(u=>{tr(r,u,o,C)})},r.$persist=()=>{h.forEach(C=>{nr(r.$state,C)})},h.forEach(C=>{tr(r,C,o),r.$subscribe((u,v)=>nr(v,C),{detached:!0})})}function Mo(o={}){return function(n){Po(n,s=>({key:(o.key?o.key:t=>t)(s.key??n.store.$id),debug:s.debug??o.debug??!1,serializer:s.serializer??o.serializer??{serialize:t=>JSON.stringify(t),deserialize:t=>$o(t)},storage:s.storage??o.storage??window.localStorage,beforeHydrate:s.beforeHydrate,afterHydrate:s.afterHydrate,pick:s.pick,omit:s.omit}),o.auto??!1)}}var Io=Mo();function cs(o,n){return function(){return o.apply(n,arguments)}}const{toString:No}=Object.prototype,{getPrototypeOf:Nn}=Object,$t=(o=>n=>{const s=No.call(n);return o[s]||(o[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),qe=o=>(o=o.toLowerCase(),n=>$t(n)===o),Ft=o=>n=>typeof n===o,{isArray:ht}=Array,gt=Ft("undefined");function Uo(o){return o!==null&&!gt(o)&&o.constructor!==null&&!gt(o.constructor)&&We(o.constructor.isBuffer)&&o.constructor.isBuffer(o)}const us=qe("ArrayBuffer");function Lo(o){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(o):n=o&&o.buffer&&us(o.buffer),n}const Ho=Ft("string"),We=Ft("function"),ds=Ft("number"),Pt=o=>o!==null&&typeof o=="object",jo=o=>o===!0||o===!1,_t=o=>{if($t(o)!=="object")return!1;const n=Nn(o);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Vo=qe("Date"),Go=qe("File"),Wo=qe("Blob"),zo=qe("FileList"),qo=o=>Pt(o)&&We(o.pipe),Ko=o=>{let n;return o&&(typeof FormData=="function"&&o instanceof FormData||We(o.append)&&((n=$t(o))==="formdata"||n==="object"&&We(o.toString)&&o.toString()==="[object FormData]"))},Xo=qe("URLSearchParams"),[Jo,Qo,Yo,Zo]=["ReadableStream","Request","Response","Headers"].map(qe),ei=o=>o.trim?o.trim():o.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function bt(o,n,{allOwnKeys:s=!1}={}){if(o===null||typeof o>"u")return;let t,r;if(typeof o!="object"&&(o=[o]),ht(o))for(t=0,r=o.length;t<r;t++)n.call(null,o[t],t,o);else{const p=s?Object.getOwnPropertyNames(o):Object.keys(o),i=p.length;let h;for(t=0;t<i;t++)h=p[t],n.call(null,o[h],h,o)}}function fs(o,n){n=n.toLowerCase();const s=Object.keys(o);let t=s.length,r;for(;t-- >0;)if(r=s[t],n===r.toLowerCase())return r;return null}const ot=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ps=o=>!gt(o)&&o!==ot;function Bn(){const{caseless:o}=ps(this)&&this||{},n={},s=(t,r)=>{const p=o&&fs(n,r)||r;_t(n[p])&&_t(t)?n[p]=Bn(n[p],t):_t(t)?n[p]=Bn({},t):ht(t)?n[p]=t.slice():n[p]=t};for(let t=0,r=arguments.length;t<r;t++)arguments[t]&&bt(arguments[t],s);return n}const ti=(o,n,s,{allOwnKeys:t}={})=>(bt(n,(r,p)=>{s&&We(r)?o[p]=cs(r,s):o[p]=r},{allOwnKeys:t}),o),ni=o=>(o.charCodeAt(0)===65279&&(o=o.slice(1)),o),ri=(o,n,s,t)=>{o.prototype=Object.create(n.prototype,t),o.prototype.constructor=o,Object.defineProperty(o,"super",{value:n.prototype}),s&&Object.assign(o.prototype,s)},si=(o,n,s,t)=>{let r,p,i;const h={};if(n=n||{},o==null)return n;do{for(r=Object.getOwnPropertyNames(o),p=r.length;p-- >0;)i=r[p],(!t||t(i,o,n))&&!h[i]&&(n[i]=o[i],h[i]=!0);o=s!==!1&&Nn(o)}while(o&&(!s||s(o,n))&&o!==Object.prototype);return n},oi=(o,n,s)=>{o=String(o),(s===void 0||s>o.length)&&(s=o.length),s-=n.length;const t=o.indexOf(n,s);return t!==-1&&t===s},ii=o=>{if(!o)return null;if(ht(o))return o;let n=o.length;if(!ds(n))return null;const s=new Array(n);for(;n-- >0;)s[n]=o[n];return s},ai=(o=>n=>o&&n instanceof o)(typeof Uint8Array<"u"&&Nn(Uint8Array)),li=(o,n)=>{const t=(o&&o[Symbol.iterator]).call(o);let r;for(;(r=t.next())&&!r.done;){const p=r.value;n.call(o,p[0],p[1])}},ci=(o,n)=>{let s;const t=[];for(;(s=o.exec(n))!==null;)t.push(s);return t},ui=qe("HTMLFormElement"),di=o=>o.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,t,r){return t.toUpperCase()+r}),rr=(({hasOwnProperty:o})=>(n,s)=>o.call(n,s))(Object.prototype),fi=qe("RegExp"),hs=(o,n)=>{const s=Object.getOwnPropertyDescriptors(o),t={};bt(s,(r,p)=>{let i;(i=n(r,p,o))!==!1&&(t[p]=i||r)}),Object.defineProperties(o,t)},pi=o=>{hs(o,(n,s)=>{if(We(o)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const t=o[s];if(We(t)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},hi=(o,n)=>{const s={},t=r=>{r.forEach(p=>{s[p]=!0})};return ht(o)?t(o):t(String(o).split(n)),s},vi=()=>{},mi=(o,n)=>o!=null&&Number.isFinite(o=+o)?o:n,jt="abcdefghijklmnopqrstuvwxyz",sr="0123456789",vs={DIGIT:sr,ALPHA:jt,ALPHA_DIGIT:jt+jt.toUpperCase()+sr},gi=(o=16,n=vs.ALPHA_DIGIT)=>{let s="";const{length:t}=n;for(;o--;)s+=n[Math.random()*t|0];return s};function yi(o){return!!(o&&We(o.append)&&o[Symbol.toStringTag]==="FormData"&&o[Symbol.iterator])}const xi=o=>{const n=new Array(10),s=(t,r)=>{if(Pt(t)){if(n.indexOf(t)>=0)return;if(!("toJSON"in t)){n[r]=t;const p=ht(t)?[]:{};return bt(t,(i,h)=>{const C=s(i,r+1);!gt(C)&&(p[h]=C)}),n[r]=void 0,p}}return t};return s(o,0)},bi=qe("AsyncFunction"),Ci=o=>o&&(Pt(o)||We(o))&&We(o.then)&&We(o.catch),ms=((o,n)=>o?setImmediate:n?((s,t)=>(ot.addEventListener("message",({source:r,data:p})=>{r===ot&&p===s&&t.length&&t.shift()()},!1),r=>{t.push(r),ot.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",We(ot.postMessage)),Ai=typeof queueMicrotask<"u"?queueMicrotask.bind(ot):typeof process<"u"&&process.nextTick||ms,Y={isArray:ht,isArrayBuffer:us,isBuffer:Uo,isFormData:Ko,isArrayBufferView:Lo,isString:Ho,isNumber:ds,isBoolean:jo,isObject:Pt,isPlainObject:_t,isReadableStream:Jo,isRequest:Qo,isResponse:Yo,isHeaders:Zo,isUndefined:gt,isDate:Vo,isFile:Go,isBlob:Wo,isRegExp:fi,isFunction:We,isStream:qo,isURLSearchParams:Xo,isTypedArray:ai,isFileList:zo,forEach:bt,merge:Bn,extend:ti,trim:ei,stripBOM:ni,inherits:ri,toFlatObject:si,kindOf:$t,kindOfTest:qe,endsWith:oi,toArray:ii,forEachEntry:li,matchAll:ci,isHTMLForm:ui,hasOwnProperty:rr,hasOwnProp:rr,reduceDescriptors:hs,freezeMethods:pi,toObjectSet:hi,toCamelCase:di,noop:vi,toFiniteNumber:mi,findKey:fs,global:ot,isContextDefined:ps,ALPHABET:vs,generateString:gi,isSpecCompliantForm:yi,toJSONObject:xi,isAsyncFn:bi,isThenable:Ci,setImmediate:ms,asap:Ai};function ve(o,n,s,t,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=o,this.name="AxiosError",n&&(this.code=n),s&&(this.config=s),t&&(this.request=t),r&&(this.response=r,this.status=r.status?r.status:null)}Y.inherits(ve,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Y.toJSONObject(this.config),code:this.code,status:this.status}}});const gs=ve.prototype,ys={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(o=>{ys[o]={value:o}});Object.defineProperties(ve,ys);Object.defineProperty(gs,"isAxiosError",{value:!0});ve.from=(o,n,s,t,r,p)=>{const i=Object.create(gs);return Y.toFlatObject(o,i,function(C){return C!==Error.prototype},h=>h!=="isAxiosError"),ve.call(i,o.message,n,s,t,r),i.cause=o,i.name=o.name,p&&Object.assign(i,p),i};const Ei=null;function Tn(o){return Y.isPlainObject(o)||Y.isArray(o)}function xs(o){return Y.endsWith(o,"[]")?o.slice(0,-2):o}function or(o,n,s){return o?o.concat(n).map(function(r,p){return r=xs(r),!s&&p?"["+r+"]":r}).join(s?".":""):n}function _i(o){return Y.isArray(o)&&!o.some(Tn)}const Si=Y.toFlatObject(Y,{},null,function(n){return/^is[A-Z]/.test(n)});function Mt(o,n,s){if(!Y.isObject(o))throw new TypeError("target must be an object");n=n||new FormData,s=Y.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,R){return!Y.isUndefined(R[_])});const t=s.metaTokens,r=s.visitor||v,p=s.dots,i=s.indexes,C=(s.Blob||typeof Blob<"u"&&Blob)&&Y.isSpecCompliantForm(n);if(!Y.isFunction(r))throw new TypeError("visitor must be a function");function u(f){if(f===null)return"";if(Y.isDate(f))return f.toISOString();if(!C&&Y.isBlob(f))throw new ve("Blob is not supported. Use a Buffer instead.");return Y.isArrayBuffer(f)||Y.isTypedArray(f)?C&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function v(f,_,R){let D=f;if(f&&!R&&typeof f=="object"){if(Y.endsWith(_,"{}"))_=t?_:_.slice(0,-2),f=JSON.stringify(f);else if(Y.isArray(f)&&_i(f)||(Y.isFileList(f)||Y.endsWith(_,"[]"))&&(D=Y.toArray(f)))return _=xs(_),D.forEach(function(g,S){!(Y.isUndefined(g)||g===null)&&n.append(i===!0?or([_],S,p):i===null?_:_+"[]",u(g))}),!1}return Tn(f)?!0:(n.append(or(R,_,p),u(f)),!1)}const E=[],y=Object.assign(Si,{defaultVisitor:v,convertValue:u,isVisitable:Tn});function w(f,_){if(!Y.isUndefined(f)){if(E.indexOf(f)!==-1)throw Error("Circular reference detected in "+_.join("."));E.push(f),Y.forEach(f,function(D,b){(!(Y.isUndefined(D)||D===null)&&r.call(n,D,Y.isString(b)?b.trim():b,_,y))===!0&&w(D,_?_.concat(b):[b])}),E.pop()}}if(!Y.isObject(o))throw new TypeError("data must be an object");return w(o),n}function ir(o){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(o).replace(/[!'()~]|%20|%00/g,function(t){return n[t]})}function Un(o,n){this._pairs=[],o&&Mt(o,this,n)}const bs=Un.prototype;bs.append=function(n,s){this._pairs.push([n,s])};bs.toString=function(n){const s=n?function(t){return n.call(this,t,ir)}:ir;return this._pairs.map(function(r){return s(r[0])+"="+s(r[1])},"").join("&")};function wi(o){return encodeURIComponent(o).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Cs(o,n,s){if(!n)return o;const t=s&&s.encode||wi;Y.isFunction(s)&&(s={serialize:s});const r=s&&s.serialize;let p;if(r?p=r(n,s):p=Y.isURLSearchParams(n)?n.toString():new Un(n,s).toString(t),p){const i=o.indexOf("#");i!==-1&&(o=o.slice(0,i)),o+=(o.indexOf("?")===-1?"?":"&")+p}return o}class ar{constructor(){this.handlers=[]}use(n,s,t){return this.handlers.push({fulfilled:n,rejected:s,synchronous:t?t.synchronous:!1,runWhen:t?t.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Y.forEach(this.handlers,function(t){t!==null&&n(t)})}}const As={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ri=typeof URLSearchParams<"u"?URLSearchParams:Un,Di=typeof FormData<"u"?FormData:null,Oi=typeof Blob<"u"?Blob:null,Bi={isBrowser:!0,classes:{URLSearchParams:Ri,FormData:Di,Blob:Oi},protocols:["http","https","file","blob","url","data"]},Ln=typeof window<"u"&&typeof document<"u",kn=typeof navigator=="object"&&navigator||void 0,Ti=Ln&&(!kn||["ReactNative","NativeScript","NS"].indexOf(kn.product)<0),ki=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",$i=Ln&&window.location.href||"http://localhost",Fi=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ln,hasStandardBrowserEnv:Ti,hasStandardBrowserWebWorkerEnv:ki,navigator:kn,origin:$i},Symbol.toStringTag,{value:"Module"})),Ue={...Fi,...Bi};function Pi(o,n){return Mt(o,new Ue.classes.URLSearchParams,Object.assign({visitor:function(s,t,r,p){return Ue.isNode&&Y.isBuffer(s)?(this.append(t,s.toString("base64")),!1):p.defaultVisitor.apply(this,arguments)}},n))}function Mi(o){return Y.matchAll(/\w+|\[(\w*)]/g,o).map(n=>n[0]==="[]"?"":n[1]||n[0])}function Ii(o){const n={},s=Object.keys(o);let t;const r=s.length;let p;for(t=0;t<r;t++)p=s[t],n[p]=o[p];return n}function Es(o){function n(s,t,r,p){let i=s[p++];if(i==="__proto__")return!0;const h=Number.isFinite(+i),C=p>=s.length;return i=!i&&Y.isArray(r)?r.length:i,C?(Y.hasOwnProp(r,i)?r[i]=[r[i],t]:r[i]=t,!h):((!r[i]||!Y.isObject(r[i]))&&(r[i]=[]),n(s,t,r[i],p)&&Y.isArray(r[i])&&(r[i]=Ii(r[i])),!h)}if(Y.isFormData(o)&&Y.isFunction(o.entries)){const s={};return Y.forEachEntry(o,(t,r)=>{n(Mi(t),r,s,0)}),s}return null}function Ni(o,n,s){if(Y.isString(o))try{return(n||JSON.parse)(o),Y.trim(o)}catch(t){if(t.name!=="SyntaxError")throw t}return(s||JSON.stringify)(o)}const Ct={transitional:As,adapter:["xhr","http","fetch"],transformRequest:[function(n,s){const t=s.getContentType()||"",r=t.indexOf("application/json")>-1,p=Y.isObject(n);if(p&&Y.isHTMLForm(n)&&(n=new FormData(n)),Y.isFormData(n))return r?JSON.stringify(Es(n)):n;if(Y.isArrayBuffer(n)||Y.isBuffer(n)||Y.isStream(n)||Y.isFile(n)||Y.isBlob(n)||Y.isReadableStream(n))return n;if(Y.isArrayBufferView(n))return n.buffer;if(Y.isURLSearchParams(n))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let h;if(p){if(t.indexOf("application/x-www-form-urlencoded")>-1)return Pi(n,this.formSerializer).toString();if((h=Y.isFileList(n))||t.indexOf("multipart/form-data")>-1){const C=this.env&&this.env.FormData;return Mt(h?{"files[]":n}:n,C&&new C,this.formSerializer)}}return p||r?(s.setContentType("application/json",!1),Ni(n)):n}],transformResponse:[function(n){const s=this.transitional||Ct.transitional,t=s&&s.forcedJSONParsing,r=this.responseType==="json";if(Y.isResponse(n)||Y.isReadableStream(n))return n;if(n&&Y.isString(n)&&(t&&!this.responseType||r)){const i=!(s&&s.silentJSONParsing)&&r;try{return JSON.parse(n)}catch(h){if(i)throw h.name==="SyntaxError"?ve.from(h,ve.ERR_BAD_RESPONSE,this,null,this.response):h}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ue.classes.FormData,Blob:Ue.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Y.forEach(["delete","get","head","post","put","patch"],o=>{Ct.headers[o]={}});const Ui=Y.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Li=o=>{const n={};let s,t,r;return o&&o.split(`
`).forEach(function(i){r=i.indexOf(":"),s=i.substring(0,r).trim().toLowerCase(),t=i.substring(r+1).trim(),!(!s||n[s]&&Ui[s])&&(s==="set-cookie"?n[s]?n[s].push(t):n[s]=[t]:n[s]=n[s]?n[s]+", "+t:t)}),n},lr=Symbol("internals");function mt(o){return o&&String(o).trim().toLowerCase()}function St(o){return o===!1||o==null?o:Y.isArray(o)?o.map(St):String(o)}function Hi(o){const n=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let t;for(;t=s.exec(o);)n[t[1]]=t[2];return n}const ji=o=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(o.trim());function Vt(o,n,s,t,r){if(Y.isFunction(t))return t.call(this,n,s);if(r&&(n=s),!!Y.isString(n)){if(Y.isString(t))return n.indexOf(t)!==-1;if(Y.isRegExp(t))return t.test(n)}}function Vi(o){return o.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,s,t)=>s.toUpperCase()+t)}function Gi(o,n){const s=Y.toCamelCase(" "+n);["get","set","has"].forEach(t=>{Object.defineProperty(o,t+s,{value:function(r,p,i){return this[t].call(this,n,r,p,i)},configurable:!0})})}let He=class{constructor(n){n&&this.set(n)}set(n,s,t){const r=this;function p(h,C,u){const v=mt(C);if(!v)throw new Error("header name must be a non-empty string");const E=Y.findKey(r,v);(!E||r[E]===void 0||u===!0||u===void 0&&r[E]!==!1)&&(r[E||C]=St(h))}const i=(h,C)=>Y.forEach(h,(u,v)=>p(u,v,C));if(Y.isPlainObject(n)||n instanceof this.constructor)i(n,s);else if(Y.isString(n)&&(n=n.trim())&&!ji(n))i(Li(n),s);else if(Y.isHeaders(n))for(const[h,C]of n.entries())p(C,h,t);else n!=null&&p(s,n,t);return this}get(n,s){if(n=mt(n),n){const t=Y.findKey(this,n);if(t){const r=this[t];if(!s)return r;if(s===!0)return Hi(r);if(Y.isFunction(s))return s.call(this,r,t);if(Y.isRegExp(s))return s.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,s){if(n=mt(n),n){const t=Y.findKey(this,n);return!!(t&&this[t]!==void 0&&(!s||Vt(this,this[t],t,s)))}return!1}delete(n,s){const t=this;let r=!1;function p(i){if(i=mt(i),i){const h=Y.findKey(t,i);h&&(!s||Vt(t,t[h],h,s))&&(delete t[h],r=!0)}}return Y.isArray(n)?n.forEach(p):p(n),r}clear(n){const s=Object.keys(this);let t=s.length,r=!1;for(;t--;){const p=s[t];(!n||Vt(this,this[p],p,n,!0))&&(delete this[p],r=!0)}return r}normalize(n){const s=this,t={};return Y.forEach(this,(r,p)=>{const i=Y.findKey(t,p);if(i){s[i]=St(r),delete s[p];return}const h=n?Vi(p):String(p).trim();h!==p&&delete s[p],s[h]=St(r),t[h]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const s=Object.create(null);return Y.forEach(this,(t,r)=>{t!=null&&t!==!1&&(s[r]=n&&Y.isArray(t)?t.join(", "):t)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,s])=>n+": "+s).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...s){const t=new this(n);return s.forEach(r=>t.set(r)),t}static accessor(n){const t=(this[lr]=this[lr]={accessors:{}}).accessors,r=this.prototype;function p(i){const h=mt(i);t[h]||(Gi(r,i),t[h]=!0)}return Y.isArray(n)?n.forEach(p):p(n),this}};He.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Y.reduceDescriptors(He.prototype,({value:o},n)=>{let s=n[0].toUpperCase()+n.slice(1);return{get:()=>o,set(t){this[s]=t}}});Y.freezeMethods(He);function Gt(o,n){const s=this||Ct,t=n||s,r=He.from(t.headers);let p=t.data;return Y.forEach(o,function(h){p=h.call(s,p,r.normalize(),n?n.status:void 0)}),r.normalize(),p}function _s(o){return!!(o&&o.__CANCEL__)}function vt(o,n,s){ve.call(this,o??"canceled",ve.ERR_CANCELED,n,s),this.name="CanceledError"}Y.inherits(vt,ve,{__CANCEL__:!0});function Ss(o,n,s){const t=s.config.validateStatus;!s.status||!t||t(s.status)?o(s):n(new ve("Request failed with status code "+s.status,[ve.ERR_BAD_REQUEST,ve.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function Wi(o){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(o);return n&&n[1]||""}function zi(o,n){o=o||10;const s=new Array(o),t=new Array(o);let r=0,p=0,i;return n=n!==void 0?n:1e3,function(C){const u=Date.now(),v=t[p];i||(i=u),s[r]=C,t[r]=u;let E=p,y=0;for(;E!==r;)y+=s[E++],E=E%o;if(r=(r+1)%o,r===p&&(p=(p+1)%o),u-i<n)return;const w=v&&u-v;return w?Math.round(y*1e3/w):void 0}}function qi(o,n){let s=0,t=1e3/n,r,p;const i=(u,v=Date.now())=>{s=v,r=null,p&&(clearTimeout(p),p=null),o.apply(null,u)};return[(...u)=>{const v=Date.now(),E=v-s;E>=t?i(u,v):(r=u,p||(p=setTimeout(()=>{p=null,i(r)},t-E)))},()=>r&&i(r)]}const Ot=(o,n,s=3)=>{let t=0;const r=zi(50,250);return qi(p=>{const i=p.loaded,h=p.lengthComputable?p.total:void 0,C=i-t,u=r(C),v=i<=h;t=i;const E={loaded:i,total:h,progress:h?i/h:void 0,bytes:C,rate:u||void 0,estimated:u&&h&&v?(h-i)/u:void 0,event:p,lengthComputable:h!=null,[n?"download":"upload"]:!0};o(E)},s)},cr=(o,n)=>{const s=o!=null;return[t=>n[0]({lengthComputable:s,total:o,loaded:t}),n[1]]},ur=o=>(...n)=>Y.asap(()=>o(...n)),Ki=Ue.hasStandardBrowserEnv?((o,n)=>s=>(s=new URL(s,Ue.origin),o.protocol===s.protocol&&o.host===s.host&&(n||o.port===s.port)))(new URL(Ue.origin),Ue.navigator&&/(msie|trident)/i.test(Ue.navigator.userAgent)):()=>!0,Xi=Ue.hasStandardBrowserEnv?{write(o,n,s,t,r,p){const i=[o+"="+encodeURIComponent(n)];Y.isNumber(s)&&i.push("expires="+new Date(s).toGMTString()),Y.isString(t)&&i.push("path="+t),Y.isString(r)&&i.push("domain="+r),p===!0&&i.push("secure"),document.cookie=i.join("; ")},read(o){const n=document.cookie.match(new RegExp("(^|;\\s*)("+o+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(o){this.write(o,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Ji(o){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(o)}function Qi(o,n){return n?o.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):o}function ws(o,n){return o&&!Ji(n)?Qi(o,n):n}const dr=o=>o instanceof He?{...o}:o;function lt(o,n){n=n||{};const s={};function t(u,v,E,y){return Y.isPlainObject(u)&&Y.isPlainObject(v)?Y.merge.call({caseless:y},u,v):Y.isPlainObject(v)?Y.merge({},v):Y.isArray(v)?v.slice():v}function r(u,v,E,y){if(Y.isUndefined(v)){if(!Y.isUndefined(u))return t(void 0,u,E,y)}else return t(u,v,E,y)}function p(u,v){if(!Y.isUndefined(v))return t(void 0,v)}function i(u,v){if(Y.isUndefined(v)){if(!Y.isUndefined(u))return t(void 0,u)}else return t(void 0,v)}function h(u,v,E){if(E in n)return t(u,v);if(E in o)return t(void 0,u)}const C={url:p,method:p,data:p,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:h,headers:(u,v,E)=>r(dr(u),dr(v),E,!0)};return Y.forEach(Object.keys(Object.assign({},o,n)),function(v){const E=C[v]||r,y=E(o[v],n[v],v);Y.isUndefined(y)&&E!==h||(s[v]=y)}),s}const Rs=o=>{const n=lt({},o);let{data:s,withXSRFToken:t,xsrfHeaderName:r,xsrfCookieName:p,headers:i,auth:h}=n;n.headers=i=He.from(i),n.url=Cs(ws(n.baseURL,n.url),o.params,o.paramsSerializer),h&&i.set("Authorization","Basic "+btoa((h.username||"")+":"+(h.password?unescape(encodeURIComponent(h.password)):"")));let C;if(Y.isFormData(s)){if(Ue.hasStandardBrowserEnv||Ue.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((C=i.getContentType())!==!1){const[u,...v]=C?C.split(";").map(E=>E.trim()).filter(Boolean):[];i.setContentType([u||"multipart/form-data",...v].join("; "))}}if(Ue.hasStandardBrowserEnv&&(t&&Y.isFunction(t)&&(t=t(n)),t||t!==!1&&Ki(n.url))){const u=r&&p&&Xi.read(p);u&&i.set(r,u)}return n},Yi=typeof XMLHttpRequest<"u",Zi=Yi&&function(o){return new Promise(function(s,t){const r=Rs(o);let p=r.data;const i=He.from(r.headers).normalize();let{responseType:h,onUploadProgress:C,onDownloadProgress:u}=r,v,E,y,w,f;function _(){w&&w(),f&&f(),r.cancelToken&&r.cancelToken.unsubscribe(v),r.signal&&r.signal.removeEventListener("abort",v)}let R=new XMLHttpRequest;R.open(r.method.toUpperCase(),r.url,!0),R.timeout=r.timeout;function D(){if(!R)return;const g=He.from("getAllResponseHeaders"in R&&R.getAllResponseHeaders()),m={data:!h||h==="text"||h==="json"?R.responseText:R.response,status:R.status,statusText:R.statusText,headers:g,config:o,request:R};Ss(function(c){s(c),_()},function(c){t(c),_()},m),R=null}"onloadend"in R?R.onloadend=D:R.onreadystatechange=function(){!R||R.readyState!==4||R.status===0&&!(R.responseURL&&R.responseURL.indexOf("file:")===0)||setTimeout(D)},R.onabort=function(){R&&(t(new ve("Request aborted",ve.ECONNABORTED,o,R)),R=null)},R.onerror=function(){t(new ve("Network Error",ve.ERR_NETWORK,o,R)),R=null},R.ontimeout=function(){let S=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const m=r.transitional||As;r.timeoutErrorMessage&&(S=r.timeoutErrorMessage),t(new ve(S,m.clarifyTimeoutError?ve.ETIMEDOUT:ve.ECONNABORTED,o,R)),R=null},p===void 0&&i.setContentType(null),"setRequestHeader"in R&&Y.forEach(i.toJSON(),function(S,m){R.setRequestHeader(m,S)}),Y.isUndefined(r.withCredentials)||(R.withCredentials=!!r.withCredentials),h&&h!=="json"&&(R.responseType=r.responseType),u&&([y,f]=Ot(u,!0),R.addEventListener("progress",y)),C&&R.upload&&([E,w]=Ot(C),R.upload.addEventListener("progress",E),R.upload.addEventListener("loadend",w)),(r.cancelToken||r.signal)&&(v=g=>{R&&(t(!g||g.type?new vt(null,o,R):g),R.abort(),R=null)},r.cancelToken&&r.cancelToken.subscribe(v),r.signal&&(r.signal.aborted?v():r.signal.addEventListener("abort",v)));const b=Wi(r.url);if(b&&Ue.protocols.indexOf(b)===-1){t(new ve("Unsupported protocol "+b+":",ve.ERR_BAD_REQUEST,o));return}R.send(p||null)})},ea=(o,n)=>{const{length:s}=o=o?o.filter(Boolean):[];if(n||s){let t=new AbortController,r;const p=function(u){if(!r){r=!0,h();const v=u instanceof Error?u:this.reason;t.abort(v instanceof ve?v:new vt(v instanceof Error?v.message:v))}};let i=n&&setTimeout(()=>{i=null,p(new ve(`timeout ${n} of ms exceeded`,ve.ETIMEDOUT))},n);const h=()=>{o&&(i&&clearTimeout(i),i=null,o.forEach(u=>{u.unsubscribe?u.unsubscribe(p):u.removeEventListener("abort",p)}),o=null)};o.forEach(u=>u.addEventListener("abort",p));const{signal:C}=t;return C.unsubscribe=()=>Y.asap(h),C}},ta=function*(o,n){let s=o.byteLength;if(s<n){yield o;return}let t=0,r;for(;t<s;)r=t+n,yield o.slice(t,r),t=r},na=async function*(o,n){for await(const s of ra(o))yield*ta(s,n)},ra=async function*(o){if(o[Symbol.asyncIterator]){yield*o;return}const n=o.getReader();try{for(;;){const{done:s,value:t}=await n.read();if(s)break;yield t}}finally{await n.cancel()}},fr=(o,n,s,t)=>{const r=na(o,n);let p=0,i,h=C=>{i||(i=!0,t&&t(C))};return new ReadableStream({async pull(C){try{const{done:u,value:v}=await r.next();if(u){h(),C.close();return}let E=v.byteLength;if(s){let y=p+=E;s(y)}C.enqueue(new Uint8Array(v))}catch(u){throw h(u),u}},cancel(C){return h(C),r.return()}},{highWaterMark:2})},It=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Ds=It&&typeof ReadableStream=="function",sa=It&&(typeof TextEncoder=="function"?(o=>n=>o.encode(n))(new TextEncoder):async o=>new Uint8Array(await new Response(o).arrayBuffer())),Os=(o,...n)=>{try{return!!o(...n)}catch{return!1}},oa=Ds&&Os(()=>{let o=!1;const n=new Request(Ue.origin,{body:new ReadableStream,method:"POST",get duplex(){return o=!0,"half"}}).headers.has("Content-Type");return o&&!n}),pr=64*1024,$n=Ds&&Os(()=>Y.isReadableStream(new Response("").body)),Bt={stream:$n&&(o=>o.body)};It&&(o=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!Bt[n]&&(Bt[n]=Y.isFunction(o[n])?s=>s[n]():(s,t)=>{throw new ve(`Response type '${n}' is not supported`,ve.ERR_NOT_SUPPORT,t)})})})(new Response);const ia=async o=>{if(o==null)return 0;if(Y.isBlob(o))return o.size;if(Y.isSpecCompliantForm(o))return(await new Request(Ue.origin,{method:"POST",body:o}).arrayBuffer()).byteLength;if(Y.isArrayBufferView(o)||Y.isArrayBuffer(o))return o.byteLength;if(Y.isURLSearchParams(o)&&(o=o+""),Y.isString(o))return(await sa(o)).byteLength},aa=async(o,n)=>{const s=Y.toFiniteNumber(o.getContentLength());return s??ia(n)},la=It&&(async o=>{let{url:n,method:s,data:t,signal:r,cancelToken:p,timeout:i,onDownloadProgress:h,onUploadProgress:C,responseType:u,headers:v,withCredentials:E="same-origin",fetchOptions:y}=Rs(o);u=u?(u+"").toLowerCase():"text";let w=ea([r,p&&p.toAbortSignal()],i),f;const _=w&&w.unsubscribe&&(()=>{w.unsubscribe()});let R;try{if(C&&oa&&s!=="get"&&s!=="head"&&(R=await aa(v,t))!==0){let m=new Request(n,{method:"POST",body:t,duplex:"half"}),l;if(Y.isFormData(t)&&(l=m.headers.get("content-type"))&&v.setContentType(l),m.body){const[c,a]=cr(R,Ot(ur(C)));t=fr(m.body,pr,c,a)}}Y.isString(E)||(E=E?"include":"omit");const D="credentials"in Request.prototype;f=new Request(n,{...y,signal:w,method:s.toUpperCase(),headers:v.normalize().toJSON(),body:t,duplex:"half",credentials:D?E:void 0});let b=await fetch(f);const g=$n&&(u==="stream"||u==="response");if($n&&(h||g&&_)){const m={};["status","statusText","headers"].forEach(x=>{m[x]=b[x]});const l=Y.toFiniteNumber(b.headers.get("content-length")),[c,a]=h&&cr(l,Ot(ur(h),!0))||[];b=new Response(fr(b.body,pr,c,()=>{a&&a(),_&&_()}),m)}u=u||"text";let S=await Bt[Y.findKey(Bt,u)||"text"](b,o);return!g&&_&&_(),await new Promise((m,l)=>{Ss(m,l,{data:S,headers:He.from(b.headers),status:b.status,statusText:b.statusText,config:o,request:f})})}catch(D){throw _&&_(),D&&D.name==="TypeError"&&/fetch/i.test(D.message)?Object.assign(new ve("Network Error",ve.ERR_NETWORK,o,f),{cause:D.cause||D}):ve.from(D,D&&D.code,o,f)}}),Fn={http:Ei,xhr:Zi,fetch:la};Y.forEach(Fn,(o,n)=>{if(o){try{Object.defineProperty(o,"name",{value:n})}catch{}Object.defineProperty(o,"adapterName",{value:n})}});const hr=o=>`- ${o}`,ca=o=>Y.isFunction(o)||o===null||o===!1,Bs={getAdapter:o=>{o=Y.isArray(o)?o:[o];const{length:n}=o;let s,t;const r={};for(let p=0;p<n;p++){s=o[p];let i;if(t=s,!ca(s)&&(t=Fn[(i=String(s)).toLowerCase()],t===void 0))throw new ve(`Unknown adapter '${i}'`);if(t)break;r[i||"#"+p]=t}if(!t){const p=Object.entries(r).map(([h,C])=>`adapter ${h} `+(C===!1?"is not supported by the environment":"is not available in the build"));let i=n?p.length>1?`since :
`+p.map(hr).join(`
`):" "+hr(p[0]):"as no adapter specified";throw new ve("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return t},adapters:Fn};function Wt(o){if(o.cancelToken&&o.cancelToken.throwIfRequested(),o.signal&&o.signal.aborted)throw new vt(null,o)}function vr(o){return Wt(o),o.headers=He.from(o.headers),o.data=Gt.call(o,o.transformRequest),["post","put","patch"].indexOf(o.method)!==-1&&o.headers.setContentType("application/x-www-form-urlencoded",!1),Bs.getAdapter(o.adapter||Ct.adapter)(o).then(function(t){return Wt(o),t.data=Gt.call(o,o.transformResponse,t),t.headers=He.from(t.headers),t},function(t){return _s(t)||(Wt(o),t&&t.response&&(t.response.data=Gt.call(o,o.transformResponse,t.response),t.response.headers=He.from(t.response.headers))),Promise.reject(t)})}const Ts="1.7.9",Nt={};["object","boolean","number","function","string","symbol"].forEach((o,n)=>{Nt[o]=function(t){return typeof t===o||"a"+(n<1?"n ":" ")+o}});const mr={};Nt.transitional=function(n,s,t){function r(p,i){return"[Axios v"+Ts+"] Transitional option '"+p+"'"+i+(t?". "+t:"")}return(p,i,h)=>{if(n===!1)throw new ve(r(i," has been removed"+(s?" in "+s:"")),ve.ERR_DEPRECATED);return s&&!mr[i]&&(mr[i]=!0,console.warn(r(i," has been deprecated since v"+s+" and will be removed in the near future"))),n?n(p,i,h):!0}};Nt.spelling=function(n){return(s,t)=>(console.warn(`${t} is likely a misspelling of ${n}`),!0)};function ua(o,n,s){if(typeof o!="object")throw new ve("options must be an object",ve.ERR_BAD_OPTION_VALUE);const t=Object.keys(o);let r=t.length;for(;r-- >0;){const p=t[r],i=n[p];if(i){const h=o[p],C=h===void 0||i(h,p,o);if(C!==!0)throw new ve("option "+p+" must be "+C,ve.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new ve("Unknown option "+p,ve.ERR_BAD_OPTION)}}const wt={assertOptions:ua,validators:Nt},Xe=wt.validators;let it=class{constructor(n){this.defaults=n,this.interceptors={request:new ar,response:new ar}}async request(n,s){try{return await this._request(n,s)}catch(t){if(t instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const p=r.stack?r.stack.replace(/^.+\n/,""):"";try{t.stack?p&&!String(t.stack).endsWith(p.replace(/^.+\n.+\n/,""))&&(t.stack+=`
`+p):t.stack=p}catch{}}throw t}}_request(n,s){typeof n=="string"?(s=s||{},s.url=n):s=n||{},s=lt(this.defaults,s);const{transitional:t,paramsSerializer:r,headers:p}=s;t!==void 0&&wt.assertOptions(t,{silentJSONParsing:Xe.transitional(Xe.boolean),forcedJSONParsing:Xe.transitional(Xe.boolean),clarifyTimeoutError:Xe.transitional(Xe.boolean)},!1),r!=null&&(Y.isFunction(r)?s.paramsSerializer={serialize:r}:wt.assertOptions(r,{encode:Xe.function,serialize:Xe.function},!0)),wt.assertOptions(s,{baseUrl:Xe.spelling("baseURL"),withXsrfToken:Xe.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let i=p&&Y.merge(p.common,p[s.method]);p&&Y.forEach(["delete","get","head","post","put","patch","common"],f=>{delete p[f]}),s.headers=He.concat(i,p);const h=[];let C=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(s)===!1||(C=C&&_.synchronous,h.unshift(_.fulfilled,_.rejected))});const u=[];this.interceptors.response.forEach(function(_){u.push(_.fulfilled,_.rejected)});let v,E=0,y;if(!C){const f=[vr.bind(this),void 0];for(f.unshift.apply(f,h),f.push.apply(f,u),y=f.length,v=Promise.resolve(s);E<y;)v=v.then(f[E++],f[E++]);return v}y=h.length;let w=s;for(E=0;E<y;){const f=h[E++],_=h[E++];try{w=f(w)}catch(R){_.call(this,R);break}}try{v=vr.call(this,w)}catch(f){return Promise.reject(f)}for(E=0,y=u.length;E<y;)v=v.then(u[E++],u[E++]);return v}getUri(n){n=lt(this.defaults,n);const s=ws(n.baseURL,n.url);return Cs(s,n.params,n.paramsSerializer)}};Y.forEach(["delete","get","head","options"],function(n){it.prototype[n]=function(s,t){return this.request(lt(t||{},{method:n,url:s,data:(t||{}).data}))}});Y.forEach(["post","put","patch"],function(n){function s(t){return function(p,i,h){return this.request(lt(h||{},{method:n,headers:t?{"Content-Type":"multipart/form-data"}:{},url:p,data:i}))}}it.prototype[n]=s(),it.prototype[n+"Form"]=s(!0)});let da=class ks{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(p){s=p});const t=this;this.promise.then(r=>{if(!t._listeners)return;let p=t._listeners.length;for(;p-- >0;)t._listeners[p](r);t._listeners=null}),this.promise.then=r=>{let p;const i=new Promise(h=>{t.subscribe(h),p=h}).then(r);return i.cancel=function(){t.unsubscribe(p)},i},n(function(p,i,h){t.reason||(t.reason=new vt(p,i,h),s(t.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const s=this._listeners.indexOf(n);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const n=new AbortController,s=t=>{n.abort(t)};return this.subscribe(s),n.signal.unsubscribe=()=>this.unsubscribe(s),n.signal}static source(){let n;return{token:new ks(function(r){n=r}),cancel:n}}};function fa(o){return function(s){return o.apply(null,s)}}function pa(o){return Y.isObject(o)&&o.isAxiosError===!0}const Pn={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Pn).forEach(([o,n])=>{Pn[n]=o});function $s(o){const n=new it(o),s=cs(it.prototype.request,n);return Y.extend(s,it.prototype,n,{allOwnKeys:!0}),Y.extend(s,n,null,{allOwnKeys:!0}),s.create=function(r){return $s(lt(o,r))},s}const fe=$s(Ct);fe.Axios=it;fe.CanceledError=vt;fe.CancelToken=da;fe.isCancel=_s;fe.VERSION=Ts;fe.toFormData=Mt;fe.AxiosError=ve;fe.Cancel=fe.CanceledError;fe.all=function(n){return Promise.all(n)};fe.spread=fa;fe.isAxiosError=pa;fe.mergeConfig=lt;fe.AxiosHeaders=He;fe.formToJSON=o=>Es(Y.isHTMLForm(o)?new FormData(o):o);fe.getAdapter=Bs.getAdapter;fe.HttpStatusCode=Pn;fe.default=fe;const{Axios:v8,AxiosError:m8,CanceledError:g8,isCancel:y8,CancelToken:x8,VERSION:b8,all:C8,Cancel:A8,isAxiosError:E8,spread:_8,toFormData:S8,AxiosHeaders:w8,HttpStatusCode:R8,formToJSON:D8,getAdapter:O8,mergeConfig:B8}=fe,ha=je("dashboard",()=>{const o=Q(!1),n=Q(null),s=Q({clients:{total:0,active:0,new:0},services:{total:0,active:0,pending:0},tickets:{total:0,open:0,urgent:0}}),t=Q({clients:[],services:[],tickets:[]});return{loading:o,error:n,stats:s,activity:t,fetchStats:async()=>{console.log("[DASHBOARD STORE] Chargement des statistiques");try{o.value=!0,n.value=null;const i=await Ee.get("/dashboard/stats");s.value=i.data,console.log("[DASHBOARD STORE] Statistiques chargées")}catch(i){throw console.error("[DASHBOARD STORE] Erreur de chargement des statistiques:",i),n.value=i,i}finally{o.value=!1}},fetchActivity:async()=>{console.log("[DASHBOARD STORE] Chargement de l'activité");try{o.value=!0,n.value=null;const i=await Ee.get("/dashboard/activity");t.value=i.data,console.log("[DASHBOARD STORE] Activité chargée")}catch(i){throw console.error("[DASHBOARD STORE] Erreur de chargement de l'activité:",i),n.value=i,i}finally{o.value=!1}}}}),va={id:"dashboard"},ma={class:"header-box"},ga={class:"stats-grid box-grid"},ya={class:"stat-card card-box"},xa={class:"stat-number","data-type":"clients","data-count":"totalClients"},ba={class:"stat-label"},Ca={class:"stat-card card-box"},Aa={class:"stat-number","data-type":"services","data-count":"totalServices"},Ea={class:"stat-label"},_a={class:"stat-card card-box"},Sa={class:"stat-number","data-type":"products","data-count":"totalProducts"},wa={class:"stat-label"},Ra={class:"stat-card card-box"},Da={class:"stat-number","data-type":"revenue","data-amount":"revenue"},Oa={class:"stat-label"},Ba={class:"dashboard-grid box-grid"},Ta={class:"card card-box"},ka={class:"card-header"},$a={class:"card-title"},Fa={class:"card-body"},Pa={key:0,class:"loading-state"},Ma={key:1,class:"error-state"},Ia={key:2,class:"table-responsive"},Na={class:"table"},Ua={class:"card card-box"},La={class:"card-header"},Ha={class:"card-title"},ja={class:"card-body"},Va={key:0,class:"loading-state"},Ga={key:1,class:"error-state"},Wa={key:2,class:"tickets-list"},za={class:"ticket-content"},qa={class:"ticket-meta"},Ka={class:"ticket-client"},Xa={class:"ticket-time"},Ja=ke({__name:"DashboardView",setup(o){const{t:n}=Le(),s=ha(),t=Q(!0),r=Q(null),p=Q(0),i=Q(0),h=Q(0),C=Q(0),u=Q([]),v=Q([]);Fe(async()=>{try{const R=await s.fetchDashboardData();p.value=R.stats.clients,i.value=R.stats.services,h.value=R.stats.products,C.value=R.stats.revenue,u.value=R.recentClients,v.value=R.recentTickets}catch(R){r.value=R.message}finally{t.value=!1}});function E(R){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(R)}function y(R){return new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"}).format(new Date(R))}function w(R){return{active:"status-badge status-success",pending:"status-badge status-warning",suspended:"status-badge status-danger"}[R]||"status-badge status-default"}function f(R){return{open:"status-open",in_progress:"status-progress",resolved:"status-resolved",closed:"status-closed"}[R]||"status-default"}function _(R){return{low:"priority-low",medium:"priority-medium",high:"priority-high",urgent:"priority-urgent"}[R]||"priority-default"}return(R,D)=>{const b=xt("router-link");return q(),K("div",va,[e("div",ma,[e("h1",null,T(R.$t("dashboard.title")),1)]),e("div",ga,[e("div",ya,[D[0]||(D[0]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-users"})],-1)),e("div",xa,T(p.value),1),e("div",ba,T(R.$t("dashboard.stats.active_clients")),1)]),e("div",Ca,[D[1]||(D[1]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-server"})],-1)),e("div",Aa,T(i.value),1),e("div",Ea,T(R.$t("dashboard.stats.active_services")),1)]),e("div",_a,[D[2]||(D[2]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-cube"})],-1)),e("div",Sa,T(h.value),1),e("div",wa,T(R.$t("dashboard.stats.total_products")),1)]),e("div",Ra,[D[3]||(D[3]=e("div",{class:"stat-icon"},[e("i",{class:"fas fa-chart-line"})],-1)),e("div",Da,T(E(C.value)),1),e("div",Oa,T(R.$t("dashboard.stats.monthly_revenue")),1)])]),e("div",Ba,[e("div",Ta,[e("div",ka,[e("h3",$a,[D[4]||(D[4]=e("i",{class:"fas fa-users"},null,-1)),ie(" "+T(R.$t("dashboard.recent_clients.title")),1)]),Ce(b,{to:"/clients",class:"btn btn-sm btn-outline"},{default:Ae(()=>[ie(T(R.$t("common.view_all")),1)]),_:1})]),e("div",Fa,[t.value?(q(),K("div",Pa,D[5]||(D[5]=[e("i",{class:"fas fa-spinner fa-spin"},null,-1)]))):r.value?(q(),K("div",Ma,T(r.value),1)):(q(),K("div",Ia,[e("table",Na,[e("thead",null,[e("tr",null,[e("th",null,T(R.$t("common.client")),1),e("th",null,T(R.$t("common.email")),1),e("th",null,T(R.$t("common.status")),1),e("th",null,T(R.$t("common.date")),1)])]),e("tbody",null,[(q(!0),K(_e,null,Se(u.value,g=>(q(),K("tr",{key:g.id},[e("td",null,[Ce(b,{to:`/clients/${g.id}`,class:"client-link"},{default:Ae(()=>[ie(T(g.name),1)]),_:2},1032,["to"])]),e("td",null,T(g.email),1),e("td",null,[e("span",{class:ce(w(g.status))},T(g.status),3)]),e("td",null,T(y(g.created_at)),1)]))),128))])])]))])]),e("div",Ua,[e("div",La,[e("h3",Ha,[D[6]||(D[6]=e("i",{class:"fas fa-headset"},null,-1)),ie(" "+T(R.$t("dashboard.recent_tickets.title")),1)]),Ce(b,{to:"/tickets",class:"btn btn-sm btn-outline"},{default:Ae(()=>[ie(T(R.$t("common.view_all")),1)]),_:1})]),e("div",ja,[t.value?(q(),K("div",Va,D[7]||(D[7]=[e("i",{class:"fas fa-spinner fa-spin"},null,-1)]))):r.value?(q(),K("div",Ga,T(r.value),1)):(q(),K("div",Wa,[(q(!0),K(_e,null,Se(v.value,g=>(q(),K("div",{key:g.id,class:"ticket-item"},[e("div",{class:ce(["ticket-status",f(g.status)])},null,2),e("div",za,[Ce(b,{to:`/tickets/${g.id}`,class:"ticket-title"},{default:Ae(()=>[ie(T(g.title),1)]),_:2},1032,["to"]),e("div",qa,[e("span",Ka,T(g.client_name),1),e("span",Xa,T(y(g.created_at)),1)])]),e("div",{class:ce(["ticket-priority",_(g.priority)])},T(g.priority),3)]))),128))]))])])])])}}}),Pe=(o,n)=>{const s=o.__vccOpts||o;for(const[t,r]of n)s[t]=r;return s},Fs=Pe(Ja,[["__scopeId","data-v-fd447ef2"]]),gr=o=>{var n,s;return console.error("Error:",o),o.response?(console.error("Response data:",o.response.data),console.error("Response status:",o.response.status),console.error("Response headers:",o.response.headers)):o.request?console.error("Request:",o.request):console.error("Error message:",o.message),(s=(n=o.response)==null?void 0:n.data)!=null&&s.message?o.response.data.message:o.message?o.message:"Une erreur inattendue est survenue"},Qa={},Ya={class:"logo"};function Za(o,n){return q(),K("div",Ya,n[0]||(n[0]=[e("h1",{class:"logo-text"},"TechCMS",-1)]))}const el=Pe(Qa,[["render",Za],["__scopeId","data-v-8b8f127c"]]),tl={class:"login-view"},nl={class:"login-container"},rl={class:"login-header"},sl={key:0,class:"login-form"},ol={class:"form-group"},il={for:"email"},al={class:"input-group"},ll=["placeholder"],cl={class:"form-group"},ul={for:"password"},dl={class:"input-group"},fl=["type","placeholder"],pl={class:"form-options"},hl={class:"remember-me"},vl={for:"remember"},ml={key:0,class:"error-message"},gl=["disabled"],yl={key:0,class:"fas fa-spinner fa-spin"},xl={key:1},bl={key:1,class:"forgot-password-form"},Cl={class:"form-group"},Al={for:"forgot-email"},El={class:"input-group"},_l=["placeholder"],Sl={key:0,class:"error-message"},wl={key:1,class:"success-message"},Rl={class:"form-actions"},Dl=["disabled"],Ol={key:0,class:"fas fa-spinner fa-spin"},Bl={key:1},Tl={class:"login-footer"},kl=ke({__name:"LoginView",setup(o){console.log("[LOGIN] Initialisation du composant Login");const{t:n}=Le(),s=ct(),t=kt(),r=Q(""),p=Q(""),i=Q(!1),h=Q(!1),C=Q(!1),u=Q(""),v=Q(!1),E=Q(""),y=Q(!1);Fe(()=>{console.log("[LOGIN] Composant Login monté")});const w=async()=>{if(console.log("[LOGIN] Tentative de connexion"),!r.value||!p.value){console.log("[LOGIN] Champs manquants"),u.value=n("login.errorFields");return}try{C.value=!0,u.value="",console.log("[LOGIN] Appel de authStore.login"),await s.login(r.value,p.value,i.value),console.log("[LOGIN] Connexion réussie"),t.push("/dashboard")}catch(R){console.error("[LOGIN] Erreur de connexion:",R),u.value=gr(R)}finally{C.value=!1}},f=async()=>{if(console.log("[LOGIN] Tentative de réinitialisation du mot de passe"),!E.value){console.log("[LOGIN] Email manquant"),u.value=n("login.errorEmail");return}try{C.value=!0,console.log("[LOGIN] Appel de authStore.forgotPassword"),await s.forgotPassword(E.value),console.log("[LOGIN] Email de réinitialisation envoyé"),y.value=!0,u.value=""}catch(R){console.error("[LOGIN] Erreur de réinitialisation:",R),u.value=gr(R)}finally{C.value=!1}},_=()=>{console.log("[LOGIN] Basculement du formulaire de réinitialisation"),v.value=!v.value,u.value="",y.value=!1};return(R,D)=>(q(),K("div",tl,[e("div",nl,[e("div",rl,[Ce(el,{class:"login-logo"}),e("h1",null,T(W(n)("login.welcome")),1),e("p",null,T(W(n)("login.subtitle")),1)]),v.value?(q(),K("div",bl,[e("h2",null,T(W(n)("login.resetTitle")),1),e("p",null,T(W(n)("login.resetDescription")),1),e("form",{onSubmit:Re(f,["prevent"])},[e("div",Cl,[e("label",Al,T(W(n)("login.email")),1),e("div",El,[D[8]||(D[8]=e("i",{class:"fas fa-envelope"},null,-1)),Z(e("input",{id:"forgot-email",type:"email","onUpdate:modelValue":D[4]||(D[4]=b=>E.value=b),placeholder:W(n)("login.emailPlaceholder"),required:""},null,8,_l),[[le,E.value]])])]),u.value?(q(),K("div",Sl,[D[9]||(D[9]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),ie(" "+T(u.value),1)])):ae("",!0),y.value?(q(),K("div",wl,[D[10]||(D[10]=e("i",{class:"fas fa-check-circle"},null,-1)),ie(" "+T(W(n)("login.resetSuccess")),1)])):ae("",!0),e("div",Rl,[e("button",{type:"button",class:"back-button",onClick:_},[D[11]||(D[11]=e("i",{class:"fas fa-arrow-left"},null,-1)),ie(" "+T(W(n)("common.back")),1)]),e("button",{type:"submit",class:"reset-button",disabled:C.value},[C.value?(q(),K("i",Ol)):(q(),K("span",Bl,T(W(n)("login.sendReset")),1))],8,Dl)])],32)])):(q(),K("div",sl,[e("form",{onSubmit:Re(w,["prevent"])},[e("div",ol,[e("label",il,T(W(n)("login.email")),1),e("div",al,[D[5]||(D[5]=e("i",{class:"fas fa-envelope"},null,-1)),Z(e("input",{id:"email",type:"email","onUpdate:modelValue":D[0]||(D[0]=b=>r.value=b),placeholder:W(n)("login.emailPlaceholder"),required:"",autocomplete:"email"},null,8,ll),[[le,r.value]])])]),e("div",cl,[e("label",ul,T(W(n)("login.password")),1),e("div",dl,[D[6]||(D[6]=e("i",{class:"fas fa-lock"},null,-1)),Z(e("input",{id:"password",type:h.value?"text":"password","onUpdate:modelValue":D[1]||(D[1]=b=>p.value=b),placeholder:W(n)("login.passwordPlaceholder"),required:"",autocomplete:"current-password"},null,8,fl),[[yo,p.value]]),e("button",{type:"button",class:"password-toggle",onClick:D[2]||(D[2]=b=>h.value=!h.value)},[e("i",{class:ce(h.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])])]),e("div",pl,[e("div",hl,[Z(e("input",{type:"checkbox",id:"remember","onUpdate:modelValue":D[3]||(D[3]=b=>i.value=b)},null,512),[[Oe,i.value]]),e("label",vl,T(W(n)("login.rememberMe")),1)]),e("button",{type:"button",class:"forgot-password",onClick:_},T(W(n)("login.forgotPassword")),1)]),u.value?(q(),K("div",ml,[D[7]||(D[7]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),ie(" "+T(u.value),1)])):ae("",!0),e("button",{type:"submit",class:"login-button",disabled:C.value},[C.value?(q(),K("i",yl)):(q(),K("span",xl,T(W(n)("login.signIn")),1))],8,gl)],32)])),e("div",Tl,[e("p",null,T(W(n)("login.copyright",{year:new Date().getFullYear()})),1)])])]))}}),Ps=Pe(kl,[["__scopeId","data-v-08c7c871"]]);console.log("[CLIENTS STORE] Initialisation du store clients");const Ut=je("clients",{state:()=>({clients:[],loading:!1,error:null,currentPage:1,totalPages:1,perPage:10}),getters:{hasClients:o=>o.clients.length>0,totalClients:o=>o.clients.length},actions:{async fetchClients(){console.log("[CLIENTS STORE] Récupération des clients..."),this.loading=!0,this.error=null;try{if(!await ct().checkAuth())return console.error("[CLIENTS STORE] Utilisateur non authentifié"),this.error="Vous devez être connecté pour accéder à cette ressource",this.loading=!1,!1;console.log("[CLIENTS STORE] Envoi de la requête API pour récupérer les clients");const s=await Ee.get("/api/v1/clients");return console.log("[CLIENTS STORE] Réponse reçue:",s.status),this.clients=s.data.data||[],this.loading=!1,!0}catch(o){return console.error("[CLIENTS STORE] Erreur lors de la récupération des clients:",o.message),this.error=o.message||"Erreur lors de la récupération des clients",this.loading=!1,!1}},async getClient(o){console.log(`[CLIENTS STORE] Récupération du client #${o}`);try{return(await Ee.get(`/api/v1/clients/${o}`)).data.data}catch(n){return console.error(`[CLIENTS STORE] Erreur lors de la récupération du client #${o}:`,n.message),this.error=n.message,null}}}});var ge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $l(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function Fl(o){if(o.__esModule)return o;var n=o.default;if(typeof n=="function"){var s=function t(){return this instanceof t?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};s.prototype=n.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(o).forEach(function(t){var r=Object.getOwnPropertyDescriptor(o,t);Object.defineProperty(s,t,r.get?r:{enumerable:!0,get:function(){return o[t]}})}),s}var Ms={exports:{}},Is={exports:{}};(function(){var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(s,t){return s<<t|s>>>32-t},rotr:function(s,t){return s<<32-t|s>>>t},endian:function(s){if(s.constructor==Number)return n.rotl(s,8)&16711935|n.rotl(s,24)&4278255360;for(var t=0;t<s.length;t++)s[t]=n.endian(s[t]);return s},randomBytes:function(s){for(var t=[];s>0;s--)t.push(Math.floor(Math.random()*256));return t},bytesToWords:function(s){for(var t=[],r=0,p=0;r<s.length;r++,p+=8)t[p>>>5]|=s[r]<<24-p%32;return t},wordsToBytes:function(s){for(var t=[],r=0;r<s.length*32;r+=8)t.push(s[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(s){for(var t=[],r=0;r<s.length;r++)t.push((s[r]>>>4).toString(16)),t.push((s[r]&15).toString(16));return t.join("")},hexToBytes:function(s){for(var t=[],r=0;r<s.length;r+=2)t.push(parseInt(s.substr(r,2),16));return t},bytesToBase64:function(s){for(var t=[],r=0;r<s.length;r+=3)for(var p=s[r]<<16|s[r+1]<<8|s[r+2],i=0;i<4;i++)r*8+i*6<=s.length*8?t.push(o.charAt(p>>>6*(3-i)&63)):t.push("=");return t.join("")},base64ToBytes:function(s){s=s.replace(/[^A-Z0-9+\/]/ig,"");for(var t=[],r=0,p=0;r<s.length;p=++r%4)p!=0&&t.push((o.indexOf(s.charAt(r-1))&Math.pow(2,-2*p+8)-1)<<p*2|o.indexOf(s.charAt(r))>>>6-p*2);return t}};Is.exports=n})();var Pl=Is.exports,Mn={utf8:{stringToBytes:function(o){return Mn.bin.stringToBytes(unescape(encodeURIComponent(o)))},bytesToString:function(o){return decodeURIComponent(escape(Mn.bin.bytesToString(o)))}},bin:{stringToBytes:function(o){for(var n=[],s=0;s<o.length;s++)n.push(o.charCodeAt(s)&255);return n},bytesToString:function(o){for(var n=[],s=0;s<o.length;s++)n.push(String.fromCharCode(o[s]));return n.join("")}}},yr=Mn;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Ml=function(o){return o!=null&&(Ns(o)||Il(o)||!!o._isBuffer)};function Ns(o){return!!o.constructor&&typeof o.constructor.isBuffer=="function"&&o.constructor.isBuffer(o)}function Il(o){return typeof o.readFloatLE=="function"&&typeof o.slice=="function"&&Ns(o.slice(0,0))}(function(){var o=Pl,n=yr.utf8,s=Ml,t=yr.bin,r=function(p,i){p.constructor==String?i&&i.encoding==="binary"?p=t.stringToBytes(p):p=n.stringToBytes(p):s(p)?p=Array.prototype.slice.call(p,0):!Array.isArray(p)&&p.constructor!==Uint8Array&&(p=p.toString());for(var h=o.bytesToWords(p),C=p.length*8,u=1732584193,v=-271733879,E=-1732584194,y=271733878,w=0;w<h.length;w++)h[w]=(h[w]<<8|h[w]>>>24)&16711935|(h[w]<<24|h[w]>>>8)&4278255360;h[C>>>5]|=128<<C%32,h[(C+64>>>9<<4)+14]=C;for(var f=r._ff,_=r._gg,R=r._hh,D=r._ii,w=0;w<h.length;w+=16){var b=u,g=v,S=E,m=y;u=f(u,v,E,y,h[w+0],7,-680876936),y=f(y,u,v,E,h[w+1],12,-389564586),E=f(E,y,u,v,h[w+2],17,606105819),v=f(v,E,y,u,h[w+3],22,-1044525330),u=f(u,v,E,y,h[w+4],7,-176418897),y=f(y,u,v,E,h[w+5],12,1200080426),E=f(E,y,u,v,h[w+6],17,-1473231341),v=f(v,E,y,u,h[w+7],22,-45705983),u=f(u,v,E,y,h[w+8],7,1770035416),y=f(y,u,v,E,h[w+9],12,-1958414417),E=f(E,y,u,v,h[w+10],17,-42063),v=f(v,E,y,u,h[w+11],22,-1990404162),u=f(u,v,E,y,h[w+12],7,1804603682),y=f(y,u,v,E,h[w+13],12,-40341101),E=f(E,y,u,v,h[w+14],17,-1502002290),v=f(v,E,y,u,h[w+15],22,1236535329),u=_(u,v,E,y,h[w+1],5,-165796510),y=_(y,u,v,E,h[w+6],9,-1069501632),E=_(E,y,u,v,h[w+11],14,643717713),v=_(v,E,y,u,h[w+0],20,-373897302),u=_(u,v,E,y,h[w+5],5,-701558691),y=_(y,u,v,E,h[w+10],9,38016083),E=_(E,y,u,v,h[w+15],14,-660478335),v=_(v,E,y,u,h[w+4],20,-405537848),u=_(u,v,E,y,h[w+9],5,568446438),y=_(y,u,v,E,h[w+14],9,-1019803690),E=_(E,y,u,v,h[w+3],14,-187363961),v=_(v,E,y,u,h[w+8],20,1163531501),u=_(u,v,E,y,h[w+13],5,-1444681467),y=_(y,u,v,E,h[w+2],9,-51403784),E=_(E,y,u,v,h[w+7],14,1735328473),v=_(v,E,y,u,h[w+12],20,-1926607734),u=R(u,v,E,y,h[w+5],4,-378558),y=R(y,u,v,E,h[w+8],11,-2022574463),E=R(E,y,u,v,h[w+11],16,1839030562),v=R(v,E,y,u,h[w+14],23,-35309556),u=R(u,v,E,y,h[w+1],4,-1530992060),y=R(y,u,v,E,h[w+4],11,1272893353),E=R(E,y,u,v,h[w+7],16,-155497632),v=R(v,E,y,u,h[w+10],23,-1094730640),u=R(u,v,E,y,h[w+13],4,681279174),y=R(y,u,v,E,h[w+0],11,-358537222),E=R(E,y,u,v,h[w+3],16,-722521979),v=R(v,E,y,u,h[w+6],23,76029189),u=R(u,v,E,y,h[w+9],4,-640364487),y=R(y,u,v,E,h[w+12],11,-421815835),E=R(E,y,u,v,h[w+15],16,530742520),v=R(v,E,y,u,h[w+2],23,-995338651),u=D(u,v,E,y,h[w+0],6,-198630844),y=D(y,u,v,E,h[w+7],10,1126891415),E=D(E,y,u,v,h[w+14],15,-1416354905),v=D(v,E,y,u,h[w+5],21,-57434055),u=D(u,v,E,y,h[w+12],6,1700485571),y=D(y,u,v,E,h[w+3],10,-1894986606),E=D(E,y,u,v,h[w+10],15,-1051523),v=D(v,E,y,u,h[w+1],21,-2054922799),u=D(u,v,E,y,h[w+8],6,1873313359),y=D(y,u,v,E,h[w+15],10,-30611744),E=D(E,y,u,v,h[w+6],15,-1560198380),v=D(v,E,y,u,h[w+13],21,1309151649),u=D(u,v,E,y,h[w+4],6,-145523070),y=D(y,u,v,E,h[w+11],10,-1120210379),E=D(E,y,u,v,h[w+2],15,718787259),v=D(v,E,y,u,h[w+9],21,-343485551),u=u+b>>>0,v=v+g>>>0,E=E+S>>>0,y=y+m>>>0}return o.endian([u,v,E,y])};r._ff=function(p,i,h,C,u,v,E){var y=p+(i&h|~i&C)+(u>>>0)+E;return(y<<v|y>>>32-v)+i},r._gg=function(p,i,h,C,u,v,E){var y=p+(i&C|h&~C)+(u>>>0)+E;return(y<<v|y>>>32-v)+i},r._hh=function(p,i,h,C,u,v,E){var y=p+(i^h^C)+(u>>>0)+E;return(y<<v|y>>>32-v)+i},r._ii=function(p,i,h,C,u,v,E){var y=p+(h^(i|~C))+(u>>>0)+E;return(y<<v|y>>>32-v)+i},r._blocksize=16,r._digestsize=16,Ms.exports=function(p,i){if(p==null)throw new Error("Illegal argument "+p);var h=o.wordsToBytes(r(p,i));return i&&i.asBytes?h:i&&i.asString?t.bytesToString(h):o.bytesToHex(h)}})();var Nl=Ms.exports;const Ul=$l(Nl),Ll={id:"clientsList",class:"view-container"},Hl={class:"header-box"},jl={class:"page-title"},Vl={class:"page-description"},Gl={class:"filter-box"},Wl={class:"filter-grid"},zl={class:"filter-group"},ql={class:"filter-label"},Kl={class:"filter-input-wrapper"},Xl=["placeholder"],Jl={class:"filter-group"},Ql={class:"filter-label"},Yl={class:"filter-input-wrapper"},Zl={value:""},ec={value:"active"},tc={value:"inactive"},nc={value:"pending"},rc={class:"filter-group"},sc={class:"filter-label"},oc={class:"filter-input-wrapper"},ic={value:""},ac={value:"hosting"},lc={value:"domain"},cc={value:"ssl"},uc={class:"filter-group"},dc={class:"filter-input-wrapper"},fc={key:0,class:"loading-state box"},pc={key:1,class:"empty-state box"},hc={class:"empty-title"},vc={class:"empty-description"},mc={key:2,class:"table-box"},gc={class:"w-full"},yc={class:"table-header"},xc={class:"client-info"},bc=["src"],Cc={class:"client-details"},Ac={class:"client-name"},Ec={class:"client-id"},_c={class:"services-list"},Sc={key:1,class:"no-services"},wc={class:"actions-menu"},Rc=["onClick","title"],Dc=["onClick","title"],Oc=["onClick","title"],Bc={key:3,class:"pagination"},Tc=["onClick"],kc={key:4,class:"modal"},$c={class:"modal-content modal-box"},Fc={class:"modal-header"},Pc={class:"modal-body"},Mc={class:"form-section"},Ic={class:"form-row"},Nc={class:"form-group"},Uc={for:"firstname"},Lc={class:"form-group"},Hc={for:"lastname"},jc={class:"form-row"},Vc={class:"form-group"},Gc={for:"email"},Wc={class:"form-group"},zc={for:"phone"},qc={class:"form-row"},Kc={class:"form-group"},Xc={for:"company"},Jc={class:"form-group"},Qc={for:"status"},Yc={value:"active"},Zc={value:"inactive"},eu={value:"pending"},tu={class:"form-row"},nu={class:"form-group"},ru={for:"address"},su={class:"form-row postal-city"},ou={class:"form-group"},iu={for:"postal_code"},au={class:"form-group"},lu={for:"city"},cu={class:"form-row"},uu={class:"form-group"},du={for:"country"},fu={class:"modal-footer"},pu={type:"submit",class:"btn btn-primary"},hu={key:5,class:"modal"},vu={class:"modal-content modal-box"},mu={class:"modal-header"},gu={key:0,class:"modal-body"},yu={class:"client-view-details"},xu={class:"client-view-section"},bu={class:"client-view-grid"},Cu={class:"client-view-item"},Au={class:"client-view-label"},Eu={class:"client-view-value"},_u={class:"client-view-item"},Su={class:"client-view-label"},wu={class:"client-view-value"},Ru={class:"client-view-item"},Du={class:"client-view-label"},Ou={class:"client-view-value"},Bu={class:"client-view-item"},Tu={class:"client-view-label"},ku={class:"client-view-value"},$u={class:"client-view-item"},Fu={class:"client-view-label"},Pu={class:"client-view-value"},Mu={class:"client-view-item"},Iu={class:"client-view-label"},Nu={class:"client-view-section"},Uu={class:"client-view-grid"},Lu={class:"client-view-item"},Hu={class:"client-view-label"},ju={class:"client-view-value"},Vu={class:"client-view-item"},Gu={class:"client-view-label"},Wu={class:"client-view-value"},zu={class:"client-view-item"},qu={class:"client-view-label"},Ku={class:"client-view-value"},Xu={class:"client-view-item"},Ju={class:"client-view-label"},Qu={class:"client-view-value"},Yu={class:"modal-footer"},Zu=ke({__name:"ClientsView",setup(o){console.log("[CLIENTS VIEW] Initialisation du composant");const{t:n}=Le(),s=Ut(),t=Q(!1),r=Q(!1),p=Q(null),i=Q(null),h=Q("name"),C=Q(!1),u=Q(""),v=Q(""),E=Q(""),y=Q(1),w=Q(10),f=Q(1),_=Q({firstname:"",lastname:"",email:"",phone:"",company:"",address:"",postal_code:"",city:"",country:"",status:"active"}),R=ue(()=>{if(!s.clients.length)return[];let x=[...s.clients];if(u.value){const B=u.value.toLowerCase();x=x.filter(O=>O.firstname&&O.firstname.toLowerCase().includes(B)||O.lastname&&O.lastname.toLowerCase().includes(B)||O.email&&O.email.toLowerCase().includes(B)||O.company&&O.company.toLowerCase().includes(B))}v.value&&(x=x.filter(B=>B.status===v.value)),E.value&&(x=x.filter(B=>B.services&&B.services.some(O=>O.type===E.value))),x.sort((B,O)=>{const k=B[h.value],F=O[h.value];return k<F?C.value?1:-1:k>F?C.value?-1:1:0}),f.value=Math.ceil(x.length/w.value);const d=(y.value-1)*w.value,A=d+w.value;return x.slice(d,A)}),D=async()=>{console.log("[ClientsView] Composant monté"),console.log("[ClientsView] État d'authentification:",s.isAuthenticated?"Authentifié":"Non authentifié");try{console.log("[ClientsView] Chargement des clients..."),await s.fetchClients(),console.log("[ClientsView] Clients chargés:",s.clients.length)}catch(x){console.error("[ClientsView] Erreur lors du chargement des clients:",x)}},b=x=>{y.value=x,window.scrollTo({top:0,behavior:"smooth"})},g=()=>{y.value=1},S=x=>{i.value=x,r.value=!0},m=x=>{p.value=x,_.value={...x},r.value=!1,t.value=!0},l=()=>{p.value=null,_.value={firstname:"",lastname:"",email:"",phone:"",company:"",address:"",postal_code:"",city:"",country:"",status:"active"},t.value=!0},c=async()=>{try{p.value?await s.updateClient(p.value.id,_.value):await s.createClient(_.value),t.value=!1,await D()}catch(x){console.error("[ClientsView] Erreur lors de la soumission du formulaire:",x)}},a=async x=>{if(confirm(n("clients.confirm_delete")))try{await s.deleteClient(x),await D()}catch(d){console.error("[ClientsView] Erreur lors de la suppression du client:",d)}};return Fe(async()=>{await D()}),(x,d)=>(q(),K("div",Ll,[e("div",Hl,[e("div",null,[e("h1",jl,T(W(n)("clients.title")),1),e("span",Vl,T(W(n)("clients.description")),1)]),e("button",{class:"btn btn-gradient",onClick:l},[d[20]||(d[20]=e("i",{class:"fas fa-plus"},null,-1)),ie(" "+T(W(n)("clients.add_new")),1)])]),e("div",Gl,[e("div",Wl,[e("div",zl,[e("label",ql,T(W(n)("clients.filters.search")),1),e("div",Kl,[d[21]||(d[21]=e("i",{class:"fas fa-search"},null,-1)),Z(e("input",{type:"text","onUpdate:modelValue":d[0]||(d[0]=A=>u.value=A),class:"filter-input",placeholder:W(n)("clients.filters.search_placeholder")},null,8,Xl),[[le,u.value]])])]),e("div",Jl,[e("label",Ql,T(W(n)("clients.filters.status")),1),e("div",Yl,[d[22]||(d[22]=e("i",{class:"fas fa-user-clock"},null,-1)),Z(e("select",{"onUpdate:modelValue":d[1]||(d[1]=A=>v.value=A),class:"filter-input"},[e("option",Zl,T(W(n)("clients.status.all")),1),e("option",ec,T(W(n)("clients.status.active")),1),e("option",tc,T(W(n)("clients.status.inactive")),1),e("option",nc,T(W(n)("clients.status.pending")),1)],512),[[xe,v.value]])])]),e("div",rc,[e("label",sc,T(W(n)("clients.filters.service_type")),1),e("div",oc,[d[23]||(d[23]=e("i",{class:"fas fa-cog"},null,-1)),Z(e("select",{"onUpdate:modelValue":d[2]||(d[2]=A=>E.value=A),class:"filter-input"},[e("option",ic,T(W(n)("clients.services.all")),1),e("option",ac,T(W(n)("clients.services.hosting")),1),e("option",lc,T(W(n)("clients.services.domain")),1),e("option",cc,T(W(n)("clients.services.ssl")),1)],512),[[xe,E.value]])])]),e("div",uc,[d[25]||(d[25]=e("label",{class:"filter-label"}," ",-1)),e("div",dc,[e("button",{onClick:g,class:"btn btn-gradient filter-button"},[d[24]||(d[24]=e("i",{class:"fas fa-filter"},null,-1)),ie(" "+T(W(n)("clients.filters.filter_button")),1)])])])])]),W(s).loading?(q(),K("div",fc,[d[26]||(d[26]=e("div",{class:"spinner"},null,-1)),e("p",null,T(W(n)("common.loading")),1)])):R.value.length===0?(q(),K("div",pc,[d[27]||(d[27]=e("div",{class:"empty-icon"},[e("i",{class:"fas fa-users"})],-1)),e("h3",hc,T(W(n)("clients.empty.title")),1),e("p",vc,T(W(n)("clients.empty.description")),1)])):(q(),K("div",mc,[e("table",gc,[e("thead",yc,[e("tr",null,[e("th",null,T(W(n)("clients.table.client")),1),e("th",null,T(W(n)("clients.table.company")),1),e("th",null,T(W(n)("clients.table.email")),1),e("th",null,T(W(n)("clients.table.phone")),1),e("th",null,T(W(n)("clients.table.status")),1),e("th",null,T(W(n)("clients.table.services")),1),e("th",null,T(W(n)("clients.table.actions")),1)])]),e("tbody",null,[(q(!0),K(_e,null,Se(R.value,A=>(q(),K("tr",{key:A.id},[e("td",null,[e("div",xc,[e("img",{src:`https://www.gravatar.com/avatar/${W(Ul)(A.email.toLowerCase())}?s=40&d=mp`,alt:"Avatar",class:"client-avatar"},null,8,bc),e("div",Cc,[e("span",Ac,T(A.firstname)+" "+T(A.lastname),1),e("span",Ec,"#"+T(A.id),1)])])]),e("td",null,T(A.company||"-"),1),e("td",null,T(A.email),1),e("td",null,T(A.phone||"-"),1),e("td",null,[e("span",{class:ce(`status-badge status-${A.status}`)},T(W(n)(`clients.status.${A.status}`)),3)]),e("td",null,[e("div",_c,[A.services&&A.services.length?(q(!0),K(_e,{key:0},Se(A.services,B=>(q(),K("span",{key:B.id,class:"service-badge"},T(W(n)(`clients.services.${B.type}`)),1))),128)):(q(),K("span",Sc,T(W(n)("clients.no_services")),1))])]),e("td",null,[e("div",wc,[e("button",{onClick:B=>S(A),class:"action-link",title:W(n)("clients.actions.view")},d[28]||(d[28]=[e("i",{class:"fas fa-eye"},null,-1)]),8,Rc),e("button",{onClick:B=>m(A),class:"action-link",title:W(n)("clients.actions.edit")},d[29]||(d[29]=[e("i",{class:"fas fa-edit"},null,-1)]),8,Dc),e("button",{class:"action-link text-danger",onClick:B=>a(A.id),title:W(n)("clients.actions.delete")},d[30]||(d[30]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Oc)])])]))),128))])])])),f.value>1?(q(),K("div",Bc,[(q(!0),K(_e,null,Se(f.value,A=>(q(),K("a",{key:A,onClick:B=>b(A),class:ce(["page-link",{active:A===y.value}])},T(A),11,Tc))),128))])):ae("",!0),t.value?(q(),K("div",kc,[e("div",{class:"modal-backdrop",onClick:d[3]||(d[3]=A=>t.value=!1)}),e("div",$c,[e("div",Fc,[e("h3",null,T(p.value?W(n)("clients.form.title_edit"):W(n)("clients.form.title_add")),1),e("button",{type:"button",class:"close",onClick:d[4]||(d[4]=A=>t.value=!1)},"×")]),e("form",{onSubmit:Re(c,["prevent"])},[e("div",Pc,[e("div",Mc,[e("div",Ic,[e("div",Nc,[e("label",Uc,T(W(n)("clients.form.firstname")),1),Z(e("input",{type:"text",id:"firstname","onUpdate:modelValue":d[5]||(d[5]=A=>_.value.firstname=A),class:"form-input",required:""},null,512),[[le,_.value.firstname]])]),e("div",Lc,[e("label",Hc,T(W(n)("clients.form.lastname")),1),Z(e("input",{type:"text",id:"lastname","onUpdate:modelValue":d[6]||(d[6]=A=>_.value.lastname=A),class:"form-input",required:""},null,512),[[le,_.value.lastname]])])]),e("div",jc,[e("div",Vc,[e("label",Gc,T(W(n)("clients.form.email")),1),Z(e("input",{type:"email",id:"email","onUpdate:modelValue":d[7]||(d[7]=A=>_.value.email=A),class:"form-input",required:""},null,512),[[le,_.value.email]])]),e("div",Wc,[e("label",zc,T(W(n)("clients.form.phone")),1),Z(e("input",{type:"tel",id:"phone","onUpdate:modelValue":d[8]||(d[8]=A=>_.value.phone=A),class:"form-input"},null,512),[[le,_.value.phone]])])]),e("div",qc,[e("div",Kc,[e("label",Xc,T(W(n)("clients.form.company")),1),Z(e("input",{type:"text",id:"company","onUpdate:modelValue":d[9]||(d[9]=A=>_.value.company=A),class:"form-input"},null,512),[[le,_.value.company]])]),e("div",Jc,[e("label",Qc,T(W(n)("clients.form.status")),1),Z(e("select",{id:"status","onUpdate:modelValue":d[10]||(d[10]=A=>_.value.status=A),class:"form-input",required:""},[e("option",Yc,T(W(n)("clients.status.active")),1),e("option",Zc,T(W(n)("clients.status.inactive")),1),e("option",eu,T(W(n)("clients.status.pending")),1)],512),[[xe,_.value.status]])])]),e("div",tu,[e("div",nu,[e("label",ru,T(W(n)("clients.form.address")),1),Z(e("input",{type:"text",id:"address","onUpdate:modelValue":d[11]||(d[11]=A=>_.value.address=A),class:"form-input"},null,512),[[le,_.value.address]])])]),e("div",su,[e("div",ou,[e("label",iu,T(W(n)("clients.form.postal_code")),1),Z(e("input",{type:"text",id:"postal_code","onUpdate:modelValue":d[12]||(d[12]=A=>_.value.postal_code=A),class:"form-input"},null,512),[[le,_.value.postal_code]])]),e("div",au,[e("label",lu,T(W(n)("clients.form.city")),1),Z(e("input",{type:"text",id:"city","onUpdate:modelValue":d[13]||(d[13]=A=>_.value.city=A),class:"form-input"},null,512),[[le,_.value.city]])])]),e("div",cu,[e("div",uu,[e("label",du,T(W(n)("clients.form.country")),1),Z(e("input",{type:"text",id:"country","onUpdate:modelValue":d[14]||(d[14]=A=>_.value.country=A),class:"form-input"},null,512),[[le,_.value.country]])])])])]),e("div",fu,[e("button",{type:"button",class:"btn btn-secondary",onClick:d[15]||(d[15]=A=>t.value=!1)},T(W(n)("clients.form.cancel")),1),e("button",pu,T(W(n)("clients.form.submit")),1)])],32)])])):ae("",!0),r.value?(q(),K("div",hu,[e("div",{class:"modal-backdrop",onClick:d[16]||(d[16]=A=>r.value=!1)}),e("div",vu,[e("div",mu,[e("h3",null,T(W(n)("clients.view.title")),1),e("button",{type:"button",class:"close",onClick:d[17]||(d[17]=A=>r.value=!1)},"×")]),i.value?(q(),K("div",gu,[e("div",yu,[e("div",xu,[e("h4",null,T(W(n)("clients.view.basic_info")),1),e("div",bu,[e("div",Cu,[e("span",Au,T(W(n)("clients.form.firstname")),1),e("span",Eu,T(i.value.firstname),1)]),e("div",_u,[e("span",Su,T(W(n)("clients.form.lastname")),1),e("span",wu,T(i.value.lastname),1)]),e("div",Ru,[e("span",Du,T(W(n)("clients.form.email")),1),e("span",Ou,T(i.value.email),1)]),e("div",Bu,[e("span",Tu,T(W(n)("clients.form.phone")),1),e("span",ku,T(i.value.phone||"-"),1)]),e("div",$u,[e("span",Fu,T(W(n)("clients.form.company")),1),e("span",Pu,T(i.value.company||"-"),1)]),e("div",Mu,[e("span",Iu,T(W(n)("clients.form.status")),1),e("span",{class:ce(`status-badge status-${i.value.status}`)},T(W(n)(`clients.status.${i.value.status}`)),3)])])]),e("div",Nu,[e("h4",null,T(W(n)("clients.view.address")),1),e("div",Uu,[e("div",Lu,[e("span",Hu,T(W(n)("clients.form.address")),1),e("span",ju,T(i.value.address||"-"),1)]),e("div",Vu,[e("span",Gu,T(W(n)("clients.form.postal_code")),1),e("span",Wu,T(i.value.postal_code||"-"),1)]),e("div",zu,[e("span",qu,T(W(n)("clients.form.city")),1),e("span",Ku,T(i.value.city||"-"),1)]),e("div",Xu,[e("span",Ju,T(W(n)("clients.form.country")),1),e("span",Qu,T(i.value.country||"-"),1)])])])])])):ae("",!0),e("div",Yu,[e("button",{type:"button",class:"btn btn-secondary",onClick:d[18]||(d[18]=A=>r.value=!1)},T(W(n)("common.close")),1),e("button",{type:"button",class:"btn btn-primary",onClick:d[19]||(d[19]=A=>m(i.value))},T(W(n)("clients.actions.edit")),1)])])])):ae("",!0)]))}}),Us=Pe(Zu,[["__scopeId","data-v-87957332"]]),ed={class:"datatable"},td={class:"datatable-inner"},nd=["onClick"],rd={key:0,class:"fas fa-sort"},sd={key:0,class:"loading-row"},od=["colspan"],id={key:1,class:"empty-row"},ad=["colspan"],ld=["onClick"],cd=ke({__name:"DataTable",props:{columns:{},data:{},loading:{type:Boolean,default:!1},sortBy:{default:""},sortDesc:{type:Boolean,default:!1}},emits:["sort","row-click"],setup(o,{emit:n}){const s=o,t=n,r=ue(()=>s.sortBy?[...s.data].sort((i,h)=>{const C=i[s.sortBy],u=h[s.sortBy];return s.sortDesc?C>u?-1:C<u?1:0:C<u?-1:C>u?1:0}):s.data),p=i=>{if(!i.sortable)return;const h=s.sortBy===i.key?!s.sortDesc:!1;t("sort",i.key,h)};return(i,h)=>(q(),K("div",ed,[e("div",td,[e("table",null,[e("thead",null,[e("tr",null,[(q(!0),K(_e,null,Se(i.columns,C=>(q(),K("th",{key:C.key,class:ce({sortable:C.sortable,sorted:i.sortBy===C.key,"sort-desc":i.sortDesc&&i.sortBy===C.key}),onClick:u=>p(C)},[ie(T(C.label)+" ",1),C.sortable?(q(),K("i",rd)):ae("",!0)],10,nd))),128))])]),e("tbody",null,[i.loading?(q(),K("tr",sd,[e("td",{colspan:i.columns.length},h[0]||(h[0]=[e("div",{class:"loading-spinner"},[e("i",{class:"fas fa-spinner fa-spin"}),ie(" Chargement... ")],-1)]),8,od)])):r.value.length===0?(q(),K("tr",id,[e("td",{colspan:i.columns.length}," Aucune donnée disponible ",8,ad)])):(q(!0),K(_e,{key:2},Se(r.value,(C,u)=>(q(),K("tr",{key:u,onClick:v=>t("row-click",C)},[(q(!0),K(_e,null,Se(i.columns,v=>(q(),K("td",{key:v.key},T(v.formatter?v.formatter(C[v.key]):C[v.key]),1))),128))],8,ld))),128))])])])]))}}),Ls=Pe(cd,[["__scopeId","data-v-fba294df"]]),ud={class:"modal-header"},dd={class:"modal-body"},fd={class:"modal-footer"},pd=ke({__name:"Modal",props:{show:{type:Boolean,default:!0},title:{},size:{default:"md"}},emits:["close"],setup(o,{emit:n}){const s=n,t=r=>{r.target===r.currentTarget&&s("close")};return(r,p)=>(q(),at(rs,{name:"modal"},{default:Ae(()=>[r.show?(q(),K("div",{key:0,class:"modal-backdrop",onClick:t},[e("div",{class:ce(["modal-container",`modal-${r.size}`])},[e("div",ud,[e("h3",null,T(r.title),1),e("button",{class:"close-btn",onClick:p[0]||(p[0]=i=>s("close"))},p[2]||(p[2]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",dd,[Dt(r.$slots,"default",{},void 0,!0)]),e("div",fd,[Dt(r.$slots,"footer",{},()=>[e("button",{class:"btn btn-secondary",onClick:p[1]||(p[1]=i=>s("close"))}," Fermer ")],!0)])],2)])):ae("",!0)]),_:3}))}}),Hn=Pe(pd,[["__scopeId","data-v-704938b9"]]),Hs=je("services",()=>{const o=Q([]),n=Q(!1),s=Q(null),t=ue(()=>o.value||[]),r=ue(()=>(o.value||[]).filter(v=>v.status==="active")),p=ue(()=>(o.value||[]).filter(v=>v.status==="maintenance"));return{services:o,loading:n,error:s,allServices:t,activeServices:r,maintenanceServices:p,fetchServices:async()=>{try{n.value=!0;const v=await fe.get("/api/v1/services");return o.value=Array.isArray(v.data)?v.data:[],o.value}catch(v){throw s.value=v,o.value=[],v}finally{n.value=!1}},updateService:async v=>{try{n.value=!0;const E=await fe.put(`/api/v1/services/${v.id}`,v),y=o.value.findIndex(w=>w.id===v.id);return y!==-1&&(o.value[y]=E.data),E.data}catch(E){throw s.value=E,E}finally{n.value=!1}},createService:async v=>{try{n.value=!0;const E=await fe.post("/api/v1/services",v);return o.value.push(E.data),E.data}catch(E){throw s.value=E,E}finally{n.value=!1}},deleteService:async v=>{try{n.value=!0,await fe.delete(`/api/v1/services/${v}`),o.value=o.value.filter(E=>E.id!==v)}catch(E){throw s.value=E,E}finally{n.value=!1}}}});var hd={exports:{}};/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.50
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */(function(o,n){(function(t,r){o.exports=r()})(window,function(){return function(s){var t={};function r(p){if(t[p])return t[p].exports;var i=t[p]={i:p,l:!1,exports:{}};return s[p].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=s,r.c=t,r.d=function(p,i,h){r.o(p,i)||Object.defineProperty(p,i,{enumerable:!0,get:h})},r.r=function(p){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(p,"__esModule",{value:!0})},r.t=function(p,i){if(i&1&&(p=r(p)),i&8||i&4&&typeof p=="object"&&p&&p.__esModule)return p;var h=Object.create(null);if(r.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:p}),i&2&&typeof p!="string")for(var C in p)r.d(h,C,(function(u){return p[u]}).bind(null,C));return h},r.n=function(p){var i=p&&p.__esModule?function(){return p.default}:function(){return p};return r.d(i,"a",i),i},r.o=function(p,i){return Object.prototype.hasOwnProperty.call(p,i)},r.p="",r(r.s=42)}([function(s,t,r){r.r(t),r.d(t,"__extends",function(){return i}),r.d(t,"__assign",function(){return h}),r.d(t,"__rest",function(){return C}),r.d(t,"__decorate",function(){return u}),r.d(t,"__param",function(){return v}),r.d(t,"__metadata",function(){return E}),r.d(t,"__awaiter",function(){return y}),r.d(t,"__generator",function(){return w}),r.d(t,"__createBinding",function(){return f}),r.d(t,"__exportStar",function(){return _}),r.d(t,"__values",function(){return R}),r.d(t,"__read",function(){return D}),r.d(t,"__spread",function(){return b}),r.d(t,"__spreadArrays",function(){return g}),r.d(t,"__spreadArray",function(){return S}),r.d(t,"__await",function(){return m}),r.d(t,"__asyncGenerator",function(){return l}),r.d(t,"__asyncDelegator",function(){return c}),r.d(t,"__asyncValues",function(){return a}),r.d(t,"__makeTemplateObject",function(){return x}),r.d(t,"__importStar",function(){return A}),r.d(t,"__importDefault",function(){return B}),r.d(t,"__classPrivateFieldGet",function(){return O}),r.d(t,"__classPrivateFieldSet",function(){return k});/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var p=function(F,M){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,U){P.__proto__=U}||function(P,U){for(var N in U)Object.prototype.hasOwnProperty.call(U,N)&&(P[N]=U[N])},p(F,M)};function i(F,M){if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");p(F,M);function P(){this.constructor=F}F.prototype=M===null?Object.create(M):(P.prototype=M.prototype,new P)}var h=function(){return h=Object.assign||function(M){for(var P,U=1,N=arguments.length;U<N;U++){P=arguments[U];for(var H in P)Object.prototype.hasOwnProperty.call(P,H)&&(M[H]=P[H])}return M},h.apply(this,arguments)};function C(F,M){var P={};for(var U in F)Object.prototype.hasOwnProperty.call(F,U)&&M.indexOf(U)<0&&(P[U]=F[U]);if(F!=null&&typeof Object.getOwnPropertySymbols=="function")for(var N=0,U=Object.getOwnPropertySymbols(F);N<U.length;N++)M.indexOf(U[N])<0&&Object.prototype.propertyIsEnumerable.call(F,U[N])&&(P[U[N]]=F[U[N]]);return P}function u(F,M,P,U){var N=arguments.length,H=N<3?M:U===null?U=Object.getOwnPropertyDescriptor(M,P):U,G;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(F,M,P,U);else for(var z=F.length-1;z>=0;z--)(G=F[z])&&(H=(N<3?G(H):N>3?G(M,P,H):G(M,P))||H);return N>3&&H&&Object.defineProperty(M,P,H),H}function v(F,M){return function(P,U){M(P,U,F)}}function E(F,M){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(F,M)}function y(F,M,P,U){function N(H){return H instanceof P?H:new P(function(G){G(H)})}return new(P||(P=Promise))(function(H,G){function z(I){try{$(U.next(I))}catch(L){G(L)}}function j(I){try{$(U.throw(I))}catch(L){G(L)}}function $(I){I.done?H(I.value):N(I.value).then(z,j)}$((U=U.apply(F,M||[])).next())})}function w(F,M){var P={label:0,sent:function(){if(H[0]&1)throw H[1];return H[1]},trys:[],ops:[]},U,N,H,G;return G={next:z(0),throw:z(1),return:z(2)},typeof Symbol=="function"&&(G[Symbol.iterator]=function(){return this}),G;function z($){return function(I){return j([$,I])}}function j($){if(U)throw new TypeError("Generator is already executing.");for(;P;)try{if(U=1,N&&(H=$[0]&2?N.return:$[0]?N.throw||((H=N.return)&&H.call(N),0):N.next)&&!(H=H.call(N,$[1])).done)return H;switch(N=0,H&&($=[$[0]&2,H.value]),$[0]){case 0:case 1:H=$;break;case 4:return P.label++,{value:$[1],done:!1};case 5:P.label++,N=$[1],$=[0];continue;case 7:$=P.ops.pop(),P.trys.pop();continue;default:if(H=P.trys,!(H=H.length>0&&H[H.length-1])&&($[0]===6||$[0]===2)){P=0;continue}if($[0]===3&&(!H||$[1]>H[0]&&$[1]<H[3])){P.label=$[1];break}if($[0]===6&&P.label<H[1]){P.label=H[1],H=$;break}if(H&&P.label<H[2]){P.label=H[2],P.ops.push($);break}H[2]&&P.ops.pop(),P.trys.pop();continue}$=M.call(F,P)}catch(I){$=[6,I],N=0}finally{U=H=0}if($[0]&5)throw $[1];return{value:$[0]?$[1]:void 0,done:!0}}}var f=Object.create?function(F,M,P,U){U===void 0&&(U=P),Object.defineProperty(F,U,{enumerable:!0,get:function(){return M[P]}})}:function(F,M,P,U){U===void 0&&(U=P),F[U]=M[P]};function _(F,M){for(var P in F)P!=="default"&&!Object.prototype.hasOwnProperty.call(M,P)&&f(M,F,P)}function R(F){var M=typeof Symbol=="function"&&Symbol.iterator,P=M&&F[M],U=0;if(P)return P.call(F);if(F&&typeof F.length=="number")return{next:function(){return F&&U>=F.length&&(F=void 0),{value:F&&F[U++],done:!F}}};throw new TypeError(M?"Object is not iterable.":"Symbol.iterator is not defined.")}function D(F,M){var P=typeof Symbol=="function"&&F[Symbol.iterator];if(!P)return F;var U=P.call(F),N,H=[],G;try{for(;(M===void 0||M-- >0)&&!(N=U.next()).done;)H.push(N.value)}catch(z){G={error:z}}finally{try{N&&!N.done&&(P=U.return)&&P.call(U)}finally{if(G)throw G.error}}return H}function b(){for(var F=[],M=0;M<arguments.length;M++)F=F.concat(D(arguments[M]));return F}function g(){for(var F=0,M=0,P=arguments.length;M<P;M++)F+=arguments[M].length;for(var U=Array(F),N=0,M=0;M<P;M++)for(var H=arguments[M],G=0,z=H.length;G<z;G++,N++)U[N]=H[G];return U}function S(F,M,P){if(P||arguments.length===2)for(var U=0,N=M.length,H;U<N;U++)(H||!(U in M))&&(H||(H=Array.prototype.slice.call(M,0,U)),H[U]=M[U]);return F.concat(H||Array.prototype.slice.call(M))}function m(F){return this instanceof m?(this.v=F,this):new m(F)}function l(F,M,P){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var U=P.apply(F,M||[]),N,H=[];return N={},G("next"),G("throw"),G("return"),N[Symbol.asyncIterator]=function(){return this},N;function G(V){U[V]&&(N[V]=function(J){return new Promise(function(ne,se){H.push([V,J,ne,se])>1||z(V,J)})})}function z(V,J){try{j(U[V](J))}catch(ne){L(H[0][3],ne)}}function j(V){V.value instanceof m?Promise.resolve(V.value.v).then($,I):L(H[0][2],V)}function $(V){z("next",V)}function I(V){z("throw",V)}function L(V,J){V(J),H.shift(),H.length&&z(H[0][0],H[0][1])}}function c(F){var M,P;return M={},U("next"),U("throw",function(N){throw N}),U("return"),M[Symbol.iterator]=function(){return this},M;function U(N,H){M[N]=F[N]?function(G){return(P=!P)?{value:m(F[N](G)),done:N==="return"}:H?H(G):G}:H}}function a(F){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var M=F[Symbol.asyncIterator],P;return M?M.call(F):(F=typeof R=="function"?R(F):F[Symbol.iterator](),P={},U("next"),U("throw"),U("return"),P[Symbol.asyncIterator]=function(){return this},P);function U(H){P[H]=F[H]&&function(G){return new Promise(function(z,j){G=F[H](G),N(z,j,G.done,G.value)})}}function N(H,G,z,j){Promise.resolve(j).then(function($){H({value:$,done:z})},G)}}function x(F,M){return Object.defineProperty?Object.defineProperty(F,"raw",{value:M}):F.raw=M,F}var d=Object.create?function(F,M){Object.defineProperty(F,"default",{enumerable:!0,value:M})}:function(F,M){F.default=M};function A(F){if(F&&F.__esModule)return F;var M={};if(F!=null)for(var P in F)P!=="default"&&Object.prototype.hasOwnProperty.call(F,P)&&f(M,F,P);return d(M,F),M}function B(F){return F&&F.__esModule?F:{default:F}}function O(F,M,P,U){if(P==="a"&&!U)throw new TypeError("Private accessor was defined without a getter");if(typeof M=="function"?F!==M||!U:!M.has(F))throw new TypeError("Cannot read private member from an object whose class did not declare it");return P==="m"?U:P==="a"?U.call(F):U?U.value:M.get(F)}function k(F,M,P,U,N){if(U==="m")throw new TypeError("Private method is not writable");if(U==="a"&&!N)throw new TypeError("Private accessor was defined without a setter");if(typeof M=="function"?F!==M||!N:!M.has(F))throw new TypeError("Cannot write private member to an object whose class did not declare it");return U==="a"?N.call(F,P):N?N.value=P:M.set(F,P),P}},function(s,t,r){(function(p){Object.defineProperty(t,"__esModule",{value:!0}),t.allToUpperCase=t.allToLowerCase=t.encodeBody=t.decodeBody=t.Format=t.promisify=t.trim=t.arrChooseN=t.randomHexString=t.randomString=t.cheapRandStr=t.dataSizeBytes=t.inspectBody=t.inspectError=t.isErrorInfoOrPartialErrorInfo=t.now=t.parseQueryString=t.toQueryString=t.arrPopRandomElement=t.defaultPostHeaders=t.defaultGetHeaders=t.allSame=t.arrEvery=t.arrFilter=t.arrMap=t.safeArrForEach=t.arrForEach=t.forInOwnNonNullProperties=t.valuesArray=t.keysArray=t.arrWithoutValue=t.arrDeleteValue=t.arrIn=t.arrIndexOf=t.arrSubtract=t.arrIntersectOb=t.arrIntersect=t.intersect=t.containsValue=t.inherits=t.prototypicalClone=t.shallowClone=t.isEmptyArg=t.isOnlyPropIn=t.isEmpty=t.isObject=t.ensureArray=t.isArray=t.copy=t.mixin=void 0,t.arrEquals=t.toBase64=t.matchDerivedChannel=t.shallowEquals=t.getGlobalObject=t.getRetryTime=t.getJitterCoefficient=t.getBackoffCoefficient=void 0;var i=r(0),h=i.__importDefault(r(3)),C=i.__importStar(r(8)),u=i.__importDefault(r(4)),v=r(11),E=r(31);function y(X){return Math.floor(Math.random()*X.length)}function w(X){for(var ee=[],te=1;te<arguments.length;te++)ee[te-1]=arguments[te];for(var oe=0;oe<ee.length;oe++){var he=ee[oe];if(!he)break;var Ne=Object.prototype.hasOwnProperty;for(var et in he)(!Ne||Ne.call(he,et))&&(X[et]=he[et])}return X}t.mixin=w;function f(X){return w({},X)}t.copy=f,t.isArray=Array.isArray||function(X){return Object.prototype.toString.call(X)=="[object Array]"};function _(X){return g(X)?[]:(0,t.isArray)(X)?X:[X]}t.ensureArray=_;function R(X){return Object.prototype.toString.call(X)=="[object Object]"}t.isObject=R;function D(X){for(var ee in X)return!1;return!0}t.isEmpty=D;function b(X,ee){for(var te in X)if(te!==ee)return!1;return!0}t.isOnlyPropIn=b;function g(X){return X==null}t.isEmptyArg=g;function S(X){var ee=new Object;for(var te in X)ee[te]=X[te];return ee}t.shallowClone=S;function m(X,ee){var te=function(){function he(){}return he}();te.prototype=X;var oe=new te;return ee&&w(oe,ee),oe}t.prototypicalClone=m;var l=function(X,ee){if(h.default.Config.inherits){h.default.Config.inherits(X,ee);return}X.super_=ee,X.prototype=m(ee.prototype,{constructor:X})};t.inherits=l;function c(X,ee){for(var te in X)if(X[te]==ee)return!0;return!1}t.containsValue=c;function a(X,ee){return(0,t.isArray)(ee)?x(X,ee):d(X,ee)}t.intersect=a;function x(X,ee){for(var te=[],oe=0;oe<X.length;oe++){var he=X[oe];(0,t.arrIndexOf)(ee,he)!=-1&&te.push(he)}return te}t.arrIntersect=x;function d(X,ee){for(var te=[],oe=0;oe<X.length;oe++){var he=X[oe];he in ee&&te.push(he)}return te}t.arrIntersectOb=d;function A(X,ee){for(var te=[],oe=0;oe<X.length;oe++){var he=X[oe];(0,t.arrIndexOf)(ee,he)==-1&&te.push(he)}return te}t.arrSubtract=A,t.arrIndexOf=Array.prototype.indexOf?function(X,ee,te){return X.indexOf(ee,te)}:function(X,ee,te){te=te||0;for(var oe=X.length;te<oe;te++)if(X[te]===ee)return te;return-1};function B(X,ee){return(0,t.arrIndexOf)(X,ee)!==-1}t.arrIn=B;function O(X,ee){var te=(0,t.arrIndexOf)(X,ee),oe=te!=-1;return oe&&X.splice(te,1),oe}t.arrDeleteValue=O;function k(X,ee){var te=X.slice();return O(te,ee),te}t.arrWithoutValue=k;function F(X,ee){var te=[];for(var oe in X)ee&&!Object.prototype.hasOwnProperty.call(X,oe)||te.push(oe);return te}t.keysArray=F;function M(X,ee){var te=[];for(var oe in X)ee&&!Object.prototype.hasOwnProperty.call(X,oe)||te.push(X[oe]);return te}t.valuesArray=M;function P(X,ee){for(var te in X)Object.prototype.hasOwnProperty.call(X,te)&&X[te]&&ee(te)}t.forInOwnNonNullProperties=P,t.arrForEach=Array.prototype.forEach?function(X,ee){X.forEach(ee)}:function(X,ee){for(var te=X.length,oe=0;oe<te;oe++)ee(X[oe],oe,X)};function U(X,ee){return(0,t.arrForEach)(X.slice(),ee)}t.safeArrForEach=U,t.arrMap=Array.prototype.map?function(X,ee){return X.map(ee)}:function(X,ee){for(var te=[],oe=X.length,he=0;he<oe;he++)te.push(ee(X[he],he,X));return te},t.arrFilter=Array.prototype.filter?function(X,ee){return X.filter(ee)}:function(X,ee){for(var te=[],oe=X.length,he=0;he<oe;he++)ee(X[he])&&te.push(X[he]);return te},t.arrEvery=Array.prototype.every?function(X,ee){return X.every(ee)}:function(X,ee){for(var te=X.length,oe=0;oe<te;oe++)if(!ee(X[oe],oe,X))return!1;return!0};function N(X,ee){if(X.length===0)return!0;var te=X[0][ee];return(0,t.arrEvery)(X,function(oe){return oe[ee]===te})}t.allSame=N;var H={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function G(X,ee){var te=H[ee||we.json];return{accept:te,"X-Ably-Version":C.default.protocolVersion.toString(),"Ably-Agent":(0,C.getAgentString)(X)}}t.defaultGetHeaders=G;function z(X,ee){var te,oe=te=H[ee||we.json];return{accept:oe,"content-type":te,"X-Ably-Version":C.default.protocolVersion.toString(),"Ably-Agent":(0,C.getAgentString)(X)}}t.defaultPostHeaders=z;function j(X){return X.splice(y(X),1)[0]}t.arrPopRandomElement=j;function $(X){var ee=[];if(X)for(var te in X)ee.push(encodeURIComponent(te)+"="+encodeURIComponent(X[te]));return ee.length?"?"+ee.join("&"):""}t.toQueryString=$;function I(X){for(var ee,te=/([^?&=]+)=?([^&]*)/g,oe={};ee=te.exec(X);)oe[decodeURIComponent(ee[1])]=decodeURIComponent(ee[2]);return oe}t.parseQueryString=I,t.now=Date.now||function(){return new Date().getTime()};function L(X){return typeof X=="object"&&X!==null&&(X.constructor.name=="ErrorInfo"||X.constructor.name=="PartialErrorInfo")}t.isErrorInfoOrPartialErrorInfo=L;function V(X){var ee,te;return X instanceof Error||((ee=X==null?void 0:X.constructor)===null||ee===void 0?void 0:ee.name)==="ErrorInfo"||((te=X==null?void 0:X.constructor)===null||te===void 0?void 0:te.name)==="PartialErrorInfo"?X.toString():h.default.Config.inspect(X)}t.inspectError=V;function J(X){return h.default.BufferUtils.isBuffer(X)?X.toString():typeof X=="string"?X:h.default.Config.inspect(X)}t.inspectBody=J;function ne(X){if(h.default.BufferUtils.isBuffer(X))return h.default.BufferUtils.byteLength(X);if(typeof X=="string")return h.default.Config.stringByteSize(X);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof X)}t.dataSizeBytes=ne;function se(){return String(Math.random()).substr(2)}t.cheapRandStr=se;var de=function(X){if(h.default.Config.getRandomValues&&typeof Uint8Array<"u"){var ee=new Uint8Array(X);return h.default.Config.getRandomValues(ee),h.default.BufferUtils.base64Encode(ee)}for(var te=h.default.BufferUtils.base64CharSet,oe=Math.round(X*4/3),he="",Ne=0;Ne<oe;Ne++)he+=te[y(te)];return he};t.randomString=de;var pe=function(X){if(h.default.Config.getRandomValues&&typeof Uint8Array<"u"){var ee=new Uint8Array(X);return h.default.Config.getRandomValues(ee),h.default.BufferUtils.hexEncode(ee)}for(var te=h.default.BufferUtils.hexCharSet,oe=X*2,he="",Ne=0;Ne<oe;Ne++)he+=te[y(te)];return he};t.randomHexString=pe;function me(X,ee){for(var te=Math.min(ee,X.length),oe=X.slice(),he=[],Ne=0;Ne<te;Ne++)he.push(j(oe));return he}t.arrChooseN=me,t.trim=String.prototype.trim?function(X){return X.trim()}:function(X){return X.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function re(X,ee,te){return new Promise(function(oe,he){X[ee].apply(X,i.__spreadArray(i.__spreadArray([],te,!1),[function(Ne,et){Ne?he(Ne):oe(et)}],!1))})}t.promisify=re;var we;(function(X){X.msgpack="msgpack",X.json="json"})(we=t.Format||(t.Format={}));function Be(X,ee){return ee=="msgpack"?h.default.Config.msgpack.decode(X):JSON.parse(String(X))}t.decodeBody=Be;function $e(X,ee){return ee=="msgpack"?h.default.Config.msgpack.encode(X,!0):JSON.stringify(X)}t.encodeBody=$e;function De(X){return X.map(function(ee){return ee&&ee.toLowerCase()})}t.allToLowerCase=De;function Ve(X){return X.map(function(ee){return ee&&ee.toUpperCase()})}t.allToUpperCase=Ve;function Ke(X){return Math.min((X+2)/3,2)}t.getBackoffCoefficient=Ke;function Te(){return 1-Math.random()*.2}t.getJitterCoefficient=Te;function Ie(X,ee){return X*Ke(ee)*Te()}t.getRetryTime=Ie;function ze(){return p||(typeof window<"u"?window:self)}t.getGlobalObject=ze;function Ye(X,ee){return Object.keys(X).every(function(te){return X[te]===ee[te]})&&Object.keys(ee).every(function(te){return ee[te]===X[te]})}t.shallowEquals=Ye;function At(X){var ee=/^(\[([^?]*)(?:(.*))\])?(.+)$/,te=X.match(ee);if(!te||!te.length||te.length<5)throw new u.default("regex match failed",400,40010);if(te[2])throw new u.default("cannot use a derived option with a ".concat(te[2]," channel"),400,40010);return{qualifierParam:te[3]||"",channelName:te[4]}}t.matchDerivedChannel=At;function Ze(X){return h.default.Config.createHmac?Buffer.from(X,"ascii").toString("base64"):(0,v.stringify)((0,E.parse)(X))}t.toBase64=Ze;function st(X,ee){return X.length===ee.length&&(0,t.arrEvery)(X,function(te,oe){return te===ee[oe]})}t.arrEquals=st}).call(this,r(13))},function(s,t,r){(function(p){Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),h=i.__importDefault(r(3)),C=p||(typeof window<"u"?window:self),u;(function(f){f[f.None=0]="None",f[f.Error=1]="Error",f[f.Major=2]="Major",f[f.Minor=3]="Minor",f[f.Micro=4]="Micro"})(u||(u={}));function v(f,_){return"".concat(f).padStart(_?3:2,"0")}function E(f){return h.default.Config.logTimestamps?function(_){var R=new Date;f(v(R.getHours())+":"+v(R.getMinutes())+":"+v(R.getSeconds())+"."+v(R.getMilliseconds(),1)+" "+_)}:f}var y=function(){var f,_,R,D;return typeof Window>"u"&&typeof WorkerGlobalScope>"u"||typeof((_=(f=C==null?void 0:C.console)===null||f===void 0?void 0:f.log)===null||_===void 0?void 0:_.apply)=="function"?(R=function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];console.log.apply(console,b)},D=console.warn?function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];console.warn.apply(console,b)}:R):C!=null&&C.console.log?R=D=function(){Function.prototype.apply.call(console.log,console,arguments)}:R=D=function(){},[R,D].map(E)},w=function(){function f(){f.logLevel=f.LOG_DEFAULT}return f.initLogHandlers=function(){var _=y(),R=_[0],D=_[1];this.logHandler=R,this.logErrorHandler=D},f.renamedClientOption=function(_,R){f.deprecationWarning("The `".concat(_,"` client option has been renamed to `").concat(R,"`. Please update your code to use `").concat(R,"` instead. `").concat(_,"` will be removed in a future version."))},f.renamedMethod=function(_,R,D){f.deprecationWarning("`".concat(_,"`’s `").concat(R,"` method has been renamed to `").concat(D,"`. Please update your code to use `").concat(D,"` instead. `").concat(R,"` will be removed in a future version."))},f.deprecationWarning=function(_){f.shouldLog(u.Error)&&f.logErrorHandler("Ably: Deprecation warning - ".concat(_))},f.logLevel=u.Error,f.LOG_NONE=u.None,f.LOG_ERROR=u.Error,f.LOG_MAJOR=u.Major,f.LOG_MINOR=u.Minor,f.LOG_MICRO=u.Micro,f.LOG_DEFAULT=u.Error,f.LOG_DEBUG=u.Micro,f.logAction=function(_,R,D){f.shouldLog(_)&&(_===u.Error?f.logErrorHandler:f.logHandler)("Ably: "+R+": "+D)},f.deprecated=function(_,R){f.deprecationWarning("".concat(_," is deprecated and will be removed in a future version. ").concat(R))},f.shouldLog=function(_){return _<=f.logLevel},f.setLog=function(_,R){_!==void 0&&(f.logLevel=_),R!==void 0&&(f.logHandler=f.logErrorHandler=R)},f}();t.default=w}).call(this,r(13))},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=function(){function i(){}return i}();t.default=p},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.PartialErrorInfo=void 0;var p=r(0),i=p.__importDefault(r(3)),h=p.__importStar(r(1));function C(E){var y="["+E.constructor.name;return E.message&&(y+=": "+E.message),E.statusCode&&(y+="; statusCode="+E.statusCode),E.code&&(y+="; code="+E.code),E.cause&&(y+="; cause="+h.inspectError(E.cause)),E.href&&!(E.message&&E.message.indexOf("help.ably.io")>-1)&&(y+="; see "+E.href+" "),y+="]",y}var u=function(E){p.__extends(y,E);function y(w,f,_,R){var D=E.call(this,w)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(D,y.prototype),D.code=f,D.statusCode=_,D.cause=R,D}return y.prototype.toString=function(){return C(this)},y.fromValues=function(w){var f=w,_=f.message,R=f.code,D=f.statusCode;if(typeof _!="string"||typeof R!="number"||typeof D!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+i.default.Config.inspect(w));var b=Object.assign(new y(_,R,D),w);return b.code&&!b.href&&(b.href="https://help.ably.io/error/"+b.code),b},y}(Error);t.default=u;var v=function(E){p.__extends(y,E);function y(w,f,_,R){var D=E.call(this,w)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(D,y.prototype),D.code=f,D.statusCode=_,D.cause=R,D}return y.prototype.toString=function(){return C(this)},y}(Error);t.PartialErrorInfo=v},function(s,t,r){(function(p,i){s.exports=i(r(6))})(this,function(p){return function(){if(typeof ArrayBuffer=="function"){var i=p,h=i.lib,C=h.WordArray,u=C.init,v=C.init=function(E){if(E instanceof ArrayBuffer&&(E=new Uint8Array(E)),(E instanceof Int8Array||typeof Uint8ClampedArray<"u"&&E instanceof Uint8ClampedArray||E instanceof Int16Array||E instanceof Uint16Array||E instanceof Int32Array||E instanceof Uint32Array||E instanceof Float32Array||E instanceof Float64Array)&&(E=new Uint8Array(E.buffer,E.byteOffset,E.byteLength)),E instanceof Uint8Array){for(var y=E.byteLength,w=[],f=0;f<y;f++)w[f>>>2]|=E[f]<<24-f%4*8;u.call(this,w,y)}else u.apply(this,arguments)};v.prototype=C}}(),p.lib.WordArray})},function(s,t,r){(function(p){(function(i,h){s.exports=h()})(this,function(){var i=i||function(h,C){var u;if(typeof window<"u"&&window.crypto&&(u=window.crypto),!u&&typeof window<"u"&&window.msCrypto&&(u=window.msCrypto),!u&&typeof p<"u"&&p.crypto&&(u=p.crypto),!u)try{u=r(44)}catch{}var v=function(){if(u){if(typeof u.getRandomValues=="function")try{return u.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof u.randomBytes=="function")try{return u.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},E=Object.create||function(){function l(){}return function(c){var a;return l.prototype=c,a=new l,l.prototype=null,a}}(),y={},w=y.lib={},f=w.Base=function(){return{extend:function(l){var c=E(this);return l&&c.mixIn(l),(!c.hasOwnProperty("init")||this.init===c.init)&&(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var l=this.extend();return l.init.apply(l,arguments),l},init:function(){},mixIn:function(l){for(var c in l)l.hasOwnProperty(c)&&(this[c]=l[c]);l.hasOwnProperty("toString")&&(this.toString=l.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),_=w.WordArray=f.extend({init:function(l,c){l=this.words=l||[],c!=C?this.sigBytes=c:this.sigBytes=l.length*4},toString:function(l){return(l||D).stringify(this)},concat:function(l){var c=this.words,a=l.words,x=this.sigBytes,d=l.sigBytes;if(this.clamp(),x%4)for(var A=0;A<d;A++){var B=a[A>>>2]>>>24-A%4*8&255;c[x+A>>>2]|=B<<24-(x+A)%4*8}else for(var A=0;A<d;A+=4)c[x+A>>>2]=a[A>>>2];return this.sigBytes+=d,this},clamp:function(){var l=this.words,c=this.sigBytes;l[c>>>2]&=4294967295<<32-c%4*8,l.length=h.ceil(c/4)},clone:function(){var l=f.clone.call(this);return l.words=this.words.slice(0),l},random:function(l){for(var c=[],a=0;a<l;a+=4)c.push(v());return new _.init(c,l)}}),R=y.enc={},D=R.Hex={stringify:function(l){for(var c=l.words,a=l.sigBytes,x=[],d=0;d<a;d++){var A=c[d>>>2]>>>24-d%4*8&255;x.push((A>>>4).toString(16)),x.push((A&15).toString(16))}return x.join("")},parse:function(l){for(var c=l.length,a=[],x=0;x<c;x+=2)a[x>>>3]|=parseInt(l.substr(x,2),16)<<24-x%8*4;return new _.init(a,c/2)}},b=R.Latin1={stringify:function(l){for(var c=l.words,a=l.sigBytes,x=[],d=0;d<a;d++){var A=c[d>>>2]>>>24-d%4*8&255;x.push(String.fromCharCode(A))}return x.join("")},parse:function(l){for(var c=l.length,a=[],x=0;x<c;x++)a[x>>>2]|=(l.charCodeAt(x)&255)<<24-x%4*8;return new _.init(a,c)}},g=R.Utf8={stringify:function(l){try{return decodeURIComponent(escape(b.stringify(l)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(l){return b.parse(unescape(encodeURIComponent(l)))}},S=w.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new _.init,this._nDataBytes=0},_append:function(l){typeof l=="string"&&(l=g.parse(l)),this._data.concat(l),this._nDataBytes+=l.sigBytes},_process:function(l){var c,a=this._data,x=a.words,d=a.sigBytes,A=this.blockSize,B=A*4,O=d/B;l?O=h.ceil(O):O=h.max((O|0)-this._minBufferSize,0);var k=O*A,F=h.min(k*4,d);if(k){for(var M=0;M<k;M+=A)this._doProcessBlock(x,M);c=x.splice(0,k),a.sigBytes-=F}return new _.init(c,F)},clone:function(){var l=f.clone.call(this);return l._data=this._data.clone(),l},_minBufferSize:0});w.Hasher=S.extend({cfg:f.extend(),init:function(l){this.cfg=this.cfg.extend(l),this.reset()},reset:function(){S.reset.call(this),this._doReset()},update:function(l){return this._append(l),this._process(),this},finalize:function(l){l&&this._append(l);var c=this._doFinalize();return c},blockSize:16,_createHelper:function(l){return function(c,a){return new l.init(a).finalize(c)}},_createHmacHelper:function(l){return function(c,a){return new m.HMAC.init(l,a).finalize(c)}}});var m=y.algo={};return y}(Math);return i})}).call(this,r(13))},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importStar(r(1)),h=p.__importDefault(r(2)),C=p.__importDefault(r(3));function u(y,w,f){try{w.apply(y,f)}catch(_){h.default.logAction(h.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+_+"; stack = "+(_&&_.stack))}}function v(y,w,f){for(var _,R,D,b=0;b<y.length;b++)if(_=y[b],f&&(_=_[f]),i.isArray(_)){for(;(R=i.arrIndexOf(_,w))!==-1;)_.splice(R,1);f&&_.length===0&&delete y[b][f]}else if(i.isObject(_))for(D in _)Object.prototype.hasOwnProperty.call(_,D)&&i.isArray(_[D])&&v([_],w,D)}var E=function(){function y(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return y.prototype.on=function(){for(var w=this,f=[],_=0;_<arguments.length;_++)f[_]=arguments[_];if(f.length===1){var R=f[0];if(typeof R=="function")this.any.push(R);else throw new Error("EventListener.on(): Invalid arguments: "+C.default.Config.inspect(f))}if(f.length===2){var D=f[0],b=f[1];if(typeof b!="function")throw new Error("EventListener.on(): Invalid arguments: "+C.default.Config.inspect(f));if(i.isEmptyArg(D))this.any.push(b);else if(i.isArray(D))D.forEach(function(S){w.on(S,b)});else{if(typeof D!="string")throw new Error("EventListener.on(): Invalid arguments: "+C.default.Config.inspect(f));var g=this.events[D]||(this.events[D]=[]);g.push(b)}}},y.prototype.off=function(){for(var w,f=this,_=[],R=0;R<arguments.length;R++)_[R]=arguments[R];if(_.length==0||i.isEmptyArg(_[0])&&i.isEmptyArg(_[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}var D=_[0],b=_[1],g=null,S=null;if(_.length===1||!b)typeof D=="function"?g=D:S=D;else{if(typeof b!="function")throw new Error("EventEmitter.off(): invalid arguments:"+C.default.Config.inspect(_));w=[D,b],S=w[0],g=w[1]}if(g&&i.isEmptyArg(S)){v([this.any,this.events,this.anyOnce,this.eventsOnce],g);return}if(i.isArray(S)){S.forEach(function(m){f.off(m,g)});return}if(typeof S!="string")throw new Error("EventEmitter.off(): invalid arguments:"+C.default.Config.inspect(_));g?v([this.events,this.eventsOnce],g,S):(delete this.events[S],delete this.eventsOnce[S])},y.prototype.listeners=function(w){if(w){var f=this.events[w]||[];return this.eventsOnce[w]&&Array.prototype.push.apply(f,this.eventsOnce[w]),f.length?f:null}return this.any.length?this.any:null},y.prototype.emit=function(w){for(var f=[],_=1;_<arguments.length;_++)f[_-1]=arguments[_];var R={event:w},D=[];this.anyOnce.length&&(Array.prototype.push.apply(D,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(D,this.any);var b=this.eventsOnce[w];b&&(Array.prototype.push.apply(D,b),delete this.eventsOnce[w]);var g=this.events[w];g&&Array.prototype.push.apply(D,g),i.arrForEach(D,function(S){u(R,S,f)})},y.prototype.once=function(){for(var w=this,f=[],_=0;_<arguments.length;_++)f[_]=arguments[_];var R=f.length;if((R===0||R===1&&typeof f[0]!="function")&&C.default.Config.Promise){var D=f[0];return new C.default.Config.Promise(function(c){w.once(D,c)})}var b=f[0],g=f[1];if(f.length===1&&typeof b=="function")this.anyOnce.push(b);else if(i.isEmptyArg(b)){if(typeof g!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+C.default.Config.inspect(f));this.anyOnce.push(g)}else if(i.isArray(b)){var S=this,m=function(){var c=Array.prototype.slice.call(arguments);if(i.arrForEach(b,function(a){S.off(a,m)}),typeof g!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+C.default.Config.inspect(f));g.apply(this,c)};i.arrForEach(b,function(c){S.on(c,m)})}else{if(typeof b!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+C.default.Config.inspect(f));var l=this.eventsOnce[b]||(this.eventsOnce[b]=[]);if(g){if(typeof g!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+C.default.Config.inspect(f));l.push(g)}}},y.prototype.whenState=function(w,f,_){for(var R=this,D=[],b=3;b<arguments.length;b++)D[b-3]=arguments[b];var g={event:w};if(typeof w!="string"||typeof f!="string")throw"whenState requires a valid event String argument";if(typeof _!="function"&&C.default.Config.Promise)return new C.default.Config.Promise(function(S){y.prototype.whenState.apply(R,[w,f,S].concat(D))});w===f?u(g,_,D):this.once(w,_)},y}();t.default=E},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaults=t.normaliseOptions=t.objectifyOptions=t.getAgentString=t.getHosts=t.getFallbackHosts=t.environmentFallbackHosts=t.getHttpScheme=t.getPort=t.getHost=void 0;var p=r(0),i=p.__importDefault(r(3)),h=p.__importStar(r(1)),C=p.__importDefault(r(2)),u=p.__importDefault(r(4)),v=r(43),E="ably-js/"+v.version,y={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:v.version,protocolVersion:2,agent:E,getHost:w,getPort:f,getHttpScheme:_,environmentFallbackHosts:R,getFallbackHosts:D,getHosts:b,checkHost:g,objectifyOptions:c,normaliseOptions:a};function w(d,A,B){return B?A=A==d.restHost&&d.realtimeHost||A||d.realtimeHost:A=A||d.restHost,A}t.getHost=w;function f(d,A){return A||d.tls?d.tlsPort:d.port}t.getPort=f;function _(d){return d.tls?"https://":"http://"}t.getHttpScheme=_;function R(d){return[d+"-a-fallback.ably-realtime.com",d+"-b-fallback.ably-realtime.com",d+"-c-fallback.ably-realtime.com",d+"-d-fallback.ably-realtime.com",d+"-e-fallback.ably-realtime.com"]}t.environmentFallbackHosts=R;function D(d){var A=d.fallbackHosts,B=typeof d.httpMaxRetryCount<"u"?d.httpMaxRetryCount:y.httpMaxRetryCount;return A?h.arrChooseN(A,B):[]}t.getFallbackHosts=D;function b(d){return[d.restHost].concat(D(d))}t.getHosts=b;function g(d){if(typeof d!="string")throw new u.default("host must be a string; was a "+typeof d,4e4,400);if(!d.length)throw new u.default("host must not be zero-length",4e4,400)}function S(d,A,B){return d.realtimeHost?d.realtimeHost:d.restHost?(C.default.logAction(C.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+d.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+d.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),d.restHost):A?y.REALTIME_HOST:B+"-"+y.REALTIME_HOST}function m(d){var A={};for(var B in y.TIMEOUTS)A[B]=d[B]||y.TIMEOUTS[B];return A}function l(d){var A=y.agent;if(d.agents)for(var B in d.agents)A+=" "+B+"/"+d.agents[B];return A}t.getAgentString=l;function c(d){return typeof d=="string"?d.indexOf(":")==-1?{token:d}:{key:d}:d}t.objectifyOptions=c;function a(d){if(d.host&&(C.default.renamedClientOption("host","restHost"),d.restHost=d.host),d.wsHost&&(C.default.renamedClientOption("wsHost","realtimeHost"),d.realtimeHost=d.wsHost),d.queueEvents&&(C.default.renamedClientOption("queueEvents","queueMessages"),d.queueMessages=d.queueEvents),d.headers&&C.default.deprecated("the `headers` client option",""),d.fallbackHostsUseDefault){if(d.fallbackHosts){var A="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw C.default.logAction(C.default.LOG_ERROR,"Defaults.normaliseOptions",A),new u.default(A,4e4,400)}if(d.port||d.tlsPort){var A="fallbackHostsUseDefault cannot be set when port or tlsPort are set";throw C.default.logAction(C.default.LOG_ERROR,"Defaults.normaliseOptions",A),new u.default(A,4e4,400)}d.environment?C.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’ve set the `environment` client option, then this is no longer necessary: remove your usage of the `fallbackHostsUseDefault` client option and the library will then automatically choose the correct fallback hosts to use for the specified environment."):C.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’re not using the primary Ably environment, then stop using `fallbackHostsUseDefault`, and update your code to either pass the `environment` client option (in which case the library will automatically choose the correct fallback hosts to use for the specified environment), or to pass the `fallbackHosts` client option to specify a custom list of fallback hosts to use (for example, if you’re using a custom CNAME, in which case Ably will have provided you with an explicit list of fallback hosts)."),d.fallbackHosts=y.FALLBACK_HOSTS}d.recover===!0&&(C.default.deprecated("The ability to use a boolean value for the `recover` client option","If you wish for the connection to always be recovered, replace `{ recover: true }` with a function that always passes `true` to its callback: `{ recover: function(lastConnectionDetails, cb) { cb(true); } }`"),d.recover=function(j,$){$(!0)}),typeof d.recover=="function"&&d.closeOnUnload===!0&&(C.default.logAction(C.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),d.recover=void 0),"closeOnUnload"in d||(d.closeOnUnload=!d.recover),d.transports&&h.arrIn(d.transports,"xhr")&&(C.default.deprecationWarning('The "xhr" transport has been renamed to "xhr_streaming". Please update your client options code to use `transports: ["xhr_streaming"]` instead. The ability to use `transports: ["xhr"]` will be removed in a future version.'),h.arrDeleteValue(d.transports,"xhr"),d.transports.push("xhr_streaming")),"queueMessages"in d||(d.queueMessages=!0);var B=d.environment&&String(d.environment).toLowerCase()||y.ENVIRONMENT,O=!B||B==="production";!d.fallbackHosts&&!d.restHost&&!d.realtimeHost&&!d.port&&!d.tlsPort&&(d.fallbackHosts=O?y.FALLBACK_HOSTS:R(B));var k=d.restHost||(O?y.REST_HOST:B+"-"+y.REST_HOST),F=S(d,O,B);h.arrForEach((d.fallbackHosts||[]).concat(k,F),g),d.port=d.port||y.PORT,d.tlsPort=d.tlsPort||y.TLS_PORT,"tls"in d||(d.tls=!0);var M=m(d);if("useBinaryProtocol"in d?d.useBinaryProtocol=i.default.Config.supportsBinary&&d.useBinaryProtocol:d.useBinaryProtocol=i.default.Config.preferBinary,d.clientId){var P=d.headers=d.headers||{};P["X-Ably-ClientId"]=i.default.BufferUtils.base64Encode(i.default.BufferUtils.utf8Encode(d.clientId))}"idempotentRestPublishing"in d||(d.idempotentRestPublishing=!0),d.promises&&!i.default.Config.Promise&&(C.default.logAction(C.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),d.promises=!1);var U=null,N=d.connectivityCheckUrl;if(d.connectivityCheckUrl){var H=d.connectivityCheckUrl.split("?"),G=H[0],z=H[1];U=z?h.parseQueryString(z):{},G.indexOf("://")===-1&&(G="https://"+G),N=G}return p.__assign(p.__assign({},d),{useBinaryProtocol:"useBinaryProtocol"in d?i.default.Config.supportsBinary&&d.useBinaryProtocol:i.default.Config.preferBinary,realtimeHost:F,restHost:k,maxMessageSize:d.maxMessageSize||y.maxMessageSize,timeouts:M,connectivityCheckParams:U,connectivityCheckUrl:N})}t.normaliseOptions=a,t.default=y;function x(d){return Object.assign(y,d)}t.getDefaults=x},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importDefault(r(3)),h=p.__importDefault(r(2)),C=p.__importDefault(r(4)),u=p.__importStar(r(1));function v(f){return!f||!f.channelOptions?{channelOptions:f,plugins:{},baseEncodedPreviousPayload:void 0}:f}function E(f){if(f&&f.cipher){if(!i.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var _=i.default.Crypto.getCipher(f.cipher);return{cipher:_.cipherParams,channelCipher:_.cipher}}return f??{}}function y(f){var _=0;return f.name&&(_+=f.name.length),f.clientId&&(_+=f.clientId.length),f.extras&&(_+=JSON.stringify(f.extras).length),f.data&&(_+=u.dataSizeBytes(f.data)),_}var w=function(){function f(){}return f.prototype.toJSON=function(){var _=this.encoding,R=this.data;return R&&i.default.BufferUtils.isBuffer(R)&&(arguments.length>0?(_=_?_+"/base64":"base64",R=i.default.BufferUtils.base64Encode(R)):R=i.default.BufferUtils.toBuffer(R)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:_,data:R}},f.prototype.toString=function(){var _="[Message";return this.name&&(_+="; name="+this.name),this.id&&(_+="; id="+this.id),this.timestamp&&(_+="; timestamp="+this.timestamp),this.clientId&&(_+="; clientId="+this.clientId),this.connectionId&&(_+="; connectionId="+this.connectionId),this.encoding&&(_+="; encoding="+this.encoding),this.extras&&(_+="; extras ="+JSON.stringify(this.extras)),this.data&&(typeof this.data=="string"?_+="; data="+this.data:i.default.BufferUtils.isBuffer(this.data)?_+="; data (buffer)="+i.default.BufferUtils.base64Encode(this.data):_+="; data (json)="+JSON.stringify(this.data)),this.extras&&(_+="; extras="+JSON.stringify(this.extras)),_+="]",_},f.encrypt=function(_,R,D){var b=_.data,g=_.encoding,S=R.channelCipher;g=g?g+"/":"",i.default.BufferUtils.isBuffer(b)||(b=i.default.BufferUtils.utf8Encode(String(b)),g=g+"utf-8/"),S.encrypt(b,function(m,l){if(m){D(m);return}_.data=l,_.encoding=g+"cipher+"+S.algorithm,D(null,_)})},f.encode=function(_,R,D){var b=_.data,g=typeof b=="string"||i.default.BufferUtils.isBuffer(b)||b===null||b===void 0;if(!g)if(u.isObject(b)||u.isArray(b))_.data=JSON.stringify(b),_.encoding=_.encoding?_.encoding+"/json":"json";else throw new C.default("Data type is unsupported",40013,400);R!=null&&R.cipher?f.encrypt(_,R,D):D(null,_)},f.encodeArray=function(_,R,D){for(var b=0,g=0;g<_.length;g++)f.encode(_[g],R,function(S){if(S){D(S);return}b++,b==_.length&&D(null,_)})},f.decode=function(_,R){var D=v(R),b=_.data,g=_.encoding;if(g){var S=g.split("/"),m=void 0,l=S.length,c=_.data,a="";try{for(;(m=l)>0;){var x=S[--l].match(/([-\w]+)(\+([\w-]+))?/);if(!x)break;switch(a=x[1],a){case"base64":c=i.default.BufferUtils.base64Decode(String(c)),m==S.length&&(b=c);continue;case"utf-8":c=i.default.BufferUtils.utf8Decode(c);continue;case"json":c=JSON.parse(c);continue;case"cipher":if(D.channelOptions!=null&&D.channelOptions.cipher&&D.channelOptions.channelCipher){var d=x[3],A=D.channelOptions.channelCipher;if(d!=A.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");c=A.decrypt(c);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!D.plugins||!D.plugins.vcdiff)throw new C.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new C.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var B=D.baseEncodedPreviousPayload;typeof B=="string"&&(B=i.default.BufferUtils.utf8Encode(B)),B=i.default.BufferUtils.toBuffer(B),c=i.default.BufferUtils.toBuffer(c),c=i.default.BufferUtils.typedArrayToBuffer(D.plugins.vcdiff.decode(c,B)),b=c}catch(k){throw new C.default("Vcdiff delta decode failed with "+k,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(k){var O=k;throw new C.default("Error processing the "+a+" encoding, decoder returned ‘"+O.message+"’",O.code||40013,400)}finally{_.encoding=m<=0?null:S.slice(0,m).join("/"),_.data=c}}D.baseEncodedPreviousPayload=b},f.fromResponseBody=function(_,R,D){D&&(_=u.decodeBody(_,D));for(var b=0;b<_.length;b++){var g=_[b]=f.fromValues(_[b]);try{f.decode(g,R)}catch(S){h.default.logAction(h.default.LOG_ERROR,"Message.fromResponseBody()",S.toString())}}return _},f.fromValues=function(_){return Object.assign(new f,_)},f.fromValuesArray=function(_){for(var R=_.length,D=new Array(R),b=0;b<R;b++)D[b]=f.fromValues(_[b]);return D},f.fromEncoded=function(_,R){var D=f.fromValues(_),b=E(R??null);try{f.decode(D,b)}catch(g){h.default.logAction(h.default.LOG_ERROR,"Message.fromEncoded()",g.toString())}return D},f.fromEncodedArray=function(_,R){return _.map(function(D){return f.fromEncoded(D,R)})},f.getMessagesSize=function(_){for(var R,D=0,b=0;b<_.length;b++)R=_[b],D+=R.size||(R.size=y(R));return D},f.serialize=u.encodeBody,f}();t.default=w},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importStar(r(1)),h=p.__importDefault(r(4)),C=p.__importDefault(r(9)),u=p.__importDefault(r(16)),v={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},E=[];Object.keys(v).forEach(function(D){E[v[D]]=D});var y={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},w=Object.keys(y);y.MODE_ALL=y.PRESENCE|y.PUBLISH|y.SUBSCRIBE|y.PRESENCE_SUBSCRIBE;function f(D){var b=[];if(D)for(var g=0;g<D.length;g++)b.push(D[g].toString());return"[ "+b.join(", ")+" ]"}var _="id channel channelSerial connectionId count msgSerial timestamp".split(" "),R=function(){function D(){var b=this;this.hasFlag=function(g){return(b.flags&y[g])>0}}return D.prototype.setFlag=function(b){return this.flags=this.flags|y[b]},D.prototype.getMode=function(){return this.flags&&this.flags&y.MODE_ALL},D.prototype.encodeModesToFlags=function(b){var g=this;b.forEach(function(S){return g.setFlag(S)})},D.prototype.decodeModesFromFlags=function(){var b=this,g=[];return D.channelModes.forEach(function(S){b.hasFlag(S)&&g.push(S)}),g.length>0?g:void 0},D.fromValues=function(b){return Object.assign(new D,b)},D.Action=v,D.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],D.ActionName=E,D.serialize=i.encodeBody,D.deserialize=function(b,g){var S=i.decodeBody(b,g);return D.fromDeserialized(S)},D.fromDeserialized=function(b){var g=b.error;g&&(b.error=h.default.fromValues(g));var S=b.messages;if(S)for(var m=0;m<S.length;m++)S[m]=C.default.fromValues(S[m]);var l=b.presence;if(l)for(var m=0;m<l.length;m++)l[m]=u.default.fromValues(l[m],!0);return Object.assign(new D,b)},D.stringify=function(b){var g="[ProtocolMessage";b.action!==void 0&&(g+="; action="+D.ActionName[b.action]||!1);for(var S,m=0;m<_.length;m++)S=_[m],b[S]!==void 0&&(g+="; "+S+"="+b[S]);if(b.messages&&(g+="; messages="+f(C.default.fromValuesArray(b.messages))),b.presence&&(g+="; presence="+f(u.default.fromValuesArray(b.presence))),b.error&&(g+="; error="+h.default.fromValues(b.error).toString()),b.auth&&b.auth.accessToken&&(g+="; token="+b.auth.accessToken),b.flags&&(g+="; flags="+w.filter(b.hasFlag).join(",")),b.params){var l="";i.forInOwnNonNullProperties(b.params,function(c){l.length>0&&(l+="; "),l+=c+"="+b.params[c]}),l.length>0&&(g+="; params=["+l+"]")}return g+="]",g},D}();t.default=R},function(s,t,r){(function(p,i){s.exports=i(r(6))})(this,function(p){return function(){var i=p,h=i.lib,C=h.WordArray,u=i.enc;u.Base64={stringify:function(E){var y=E.words,w=E.sigBytes,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";E.clamp();for(var _=[],R=0;R<w;R+=3)for(var D=y[R>>>2]>>>24-R%4*8&255,b=y[R+1>>>2]>>>24-(R+1)%4*8&255,g=y[R+2>>>2]>>>24-(R+2)%4*8&255,S=D<<16|b<<8|g,m=0;m<4&&R+m*.75<w;m++)_.push(f.charAt(S>>>6*(3-m)&63));var l=f.charAt(64);if(l)for(;_.length%4;)_.push(l);return _.join("")},parse:function(E){var y=E.length,w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var _=0;_<w.length;_++)f[w.charCodeAt(_)]=_}var R=w.charAt(64);if(R){var D=E.indexOf(R);D!==-1&&(y=D)}return v(E,y,f)}};function v(E,y,w){for(var f=[],_=0,R=0;R<y;R++)if(R%4){var D=w[E.charCodeAt(R-1)]<<R%4*2,b=w[E.charCodeAt(R)]>>>6-R%4*2,g=D|b;f[_>>>2]|=g<<24-_%4*8,_++}return C.create(f,_)}}(),p.enc.Base64})},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importStar(r(1)),h=p.__importDefault(r(10)),C=p.__importDefault(r(26)),u=p.__importDefault(r(2)),v=p.__importDefault(r(8)),E=p.__importDefault(r(21)),y=p.__importDefault(r(18)),w=p.__importDefault(r(4)),f=p.__importDefault(r(22)),_=p.__importDefault(r(3));function R(g){var S=[80015,80017,80030];return g.code?y.default.isTokenErr(g)?!1:i.arrIn(S,g.code)?!0:g.code>=4e4&&g.code<5e4:!1}function D(g){return R(g)?[h.default.fromValues({action:h.default.Action.ERROR,error:g})]:[h.default.fromValues({action:h.default.Action.DISCONNECTED,error:g})]}var b=function(g){p.__extends(S,g);function S(m,l,c){var a=g.call(this,m,l,c,!0)||this;return a.onAuthUpdated=function(x){a.authParams={access_token:x.token}},a.stream="stream"in c?c.stream:!0,a.sendRequest=null,a.recvRequest=null,a.pendingCallback=null,a.pendingItems=null,a}return S.prototype.connect=function(){var m=this;u.default.logAction(u.default.LOG_MINOR,"CometTransport.connect()","starting"),C.default.prototype.connect.call(this);var l=this.params,c=l.options,a=v.default.getHost(c,l.host),x=v.default.getPort(c),d=c.tls?"https://":"http://";this.baseUri=d+a+":"+x+"/comet/";var A=this.baseUri+"connect";u.default.logAction(u.default.LOG_MINOR,"CometTransport.connect()","uri: "+A),this.auth.getAuthParams(function(B,O){if(B){m.disconnect(B);return}if(!m.isDisposed){m.authParams=O;var k=m.params.getConnectParams(O);"stream"in k&&(m.stream=k.stream),u.default.logAction(u.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+i.toQueryString(k));var F=!1,M=m.recvRequest=m.createRequest(A,null,k,null,m.stream?f.default.REQ_RECV_STREAM:f.default.REQ_RECV);M.on("data",function(P){m.recvRequest&&(F||(F=!0,m.emit("preconnect")),m.onData(P))}),M.on("complete",function(P){if(m.recvRequest||(P=P||new w.default("Request cancelled",80003,400)),m.recvRequest=null,!F&&!P&&(F=!0,m.emit("preconnect")),m.onActivity(),P){P.code?m.onData(D(P)):m.disconnect(P);return}_.default.Config.nextTick(function(){m.recv()})}),M.exec()}})},S.prototype.requestClose=function(){u.default.logAction(u.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},S.prototype.requestDisconnect=function(){u.default.logAction(u.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},S.prototype._requestCloseOrDisconnect=function(m){var l=this,c=m?this.closeUri:this.disconnectUri;if(c){var a=this.createRequest(c,null,this.authParams,null,f.default.REQ_SEND);a.on("complete",function(x){x&&(u.default.logAction(u.default.LOG_ERROR,"CometTransport.request"+(m?"Close()":"Disconnect()"),"request returned err = "+i.inspectError(x)),l.finish("disconnected",x))}),a.exec()}},S.prototype.dispose=function(){var m=this;u.default.logAction(u.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(u.default.logAction(u.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",E.default.disconnected()),_.default.Config.nextTick(function(){m.emit("disposed")}))},S.prototype.onConnect=function(m){var l;if(!this.isDisposed){var c=(l=m.connectionDetails)===null||l===void 0?void 0:l.connectionKey;C.default.prototype.onConnect.call(this,m);var a=this.baseUri+c;u.default.logAction(u.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+a),this.sendUri=a+"/send",this.recvUri=a+"/recv",this.closeUri=a+"/close",this.disconnectUri=a+"/disconnect"}},S.prototype.send=function(m){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(m);return}var l=this.pendingItems||[];l.push(m),this.pendingItems=null,this.sendItems(l)},S.prototype.sendAnyPending=function(){var m=this.pendingItems;m&&(this.pendingItems=null,this.sendItems(m))},S.prototype.sendItems=function(m){var l=this,c=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(m),f.default.REQ_SEND);c.on("complete",function(a,x){if(a&&u.default.logAction(u.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+i.inspectError(a)),l.sendRequest=null,a){a.code?l.onData(D(a)):l.disconnect(a);return}x&&l.onData(x),l.pendingItems&&_.default.Config.nextTick(function(){l.sendRequest||l.sendAnyPending()})}),c.exec()},S.prototype.recv=function(){var m=this;if(!this.recvRequest&&this.isConnected){var l=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?f.default.REQ_RECV_STREAM:f.default.REQ_RECV_POLL);l.on("data",function(c){m.onData(c)}),l.on("complete",function(c){if(m.recvRequest=null,m.onActivity(),c){c.code?m.onData(D(c)):m.disconnect(c);return}_.default.Config.nextTick(function(){m.recv()})}),l.exec()}},S.prototype.onData=function(m){try{var l=this.decodeResponse(m);if(l&&l.length)for(var c=0;c<l.length;c++)this.onProtocolMessage(h.default.fromDeserialized(l[c]))}catch(a){u.default.logAction(u.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+a.stack)}},S.prototype.encodeRequest=function(m){return JSON.stringify(m)},S.prototype.decodeResponse=function(m){return typeof m=="string"?JSON.parse(m):m},S}(C.default);t.default=b},function(s,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}s.exports=r},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isSuccessCode=void 0;var p;(function(h){h[h.Success=200]="Success",h[h.NoContent=204]="NoContent",h[h.BadRequest=400]="BadRequest",h[h.Unauthorized=401]="Unauthorized",h[h.Forbidden=403]="Forbidden",h[h.RequestTimeout=408]="RequestTimeout",h[h.InternalServerError=500]="InternalServerError"})(p||(p={}));function i(h){return h>=p.Success&&h<p.BadRequest}t.isSuccessCode=i,t.default=p},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importDefault(r(3)),h=p.__importStar(r(1)),C=p.__importDefault(r(2)),u=p.__importDefault(r(18)),v=p.__importDefault(r(19)),E=r(4),y=p.__importDefault(r(14));function w(g,S,m,l,c){g.http.supportsAuthHeaders?g.auth.getAuthHeaders(function(a,x){a?l(a):c(h.mixin(x,S),m)}):g.auth.getAuthParams(function(a,x){a?l(a):c(S,h.mixin(x,m))})}function f(g,S){return function(m,l,c,a,x){if(m&&!l){g(m);return}if(x===y.default.NoContent){g(m,[],c,!0,x);return}if(!a)try{l=h.decodeBody(l,S)}catch(F){h.isErrorInfoOrPartialErrorInfo(F)?g(F):g(new E.PartialErrorInfo(h.inspectError(F),null));return}if(!l){g(new E.PartialErrorInfo("unenvelope(): Response body is missing",null));return}var d=l,A=d.statusCode,B=d.response,O=d.headers;if(A===void 0){g(m,l,c,!0,x);return}if(A<200||A>=300){var k=B&&B.error||m;k||(k=new Error("Error in unenveloping "+l),k.statusCode=A),g(k,B,O,!0,A);return}g(m,B,O,!0,A)}}function _(g){var S=[];if(g)for(var m in g)S.push(m+"="+g[m]);return S.join("&")}function R(g,S){return g+(S?"?":"")+_(S)}function D(g,S,m,l){return function(c,a,x,d,A){c?C.default.logAction(C.default.LOG_MICRO,"Resource."+S+"()","Received Error; "+R(m,l)+"; Error: "+h.inspectError(c)):C.default.logAction(C.default.LOG_MICRO,"Resource."+S+"()","Received; "+R(m,l)+"; Headers: "+_(x)+"; StatusCode: "+A+"; Body: "+(i.default.BufferUtils.isBuffer(a)?a.toString():a)),g&&g(c,a,x,d,A)}}var b=function(){function g(){}return g.get=function(S,m,l,c,a,x){g.do(v.default.Get,S,m,null,l,c,a,x)},g.delete=function(S,m,l,c,a,x){g.do(v.default.Delete,S,m,null,l,c,a,x)},g.post=function(S,m,l,c,a,x,d){g.do(v.default.Post,S,m,l,c,a,x,d)},g.patch=function(S,m,l,c,a,x,d){g.do(v.default.Patch,S,m,l,c,a,x,d)},g.put=function(S,m,l,c,a,x,d){g.do(v.default.Put,S,m,l,c,a,x,d)},g.do=function(S,m,l,c,a,x,d,A){C.default.shouldLog(C.default.LOG_MICRO)&&(A=D(A,S,l,x)),d&&(A=A&&f(A,d),(x=x||{}).envelope=d);function B(O,k){var F;if(C.default.shouldLog(C.default.LOG_MICRO)&&C.default.logAction(C.default.LOG_MICRO,"Resource."+S+"()","Sending; "+R(l,k)),C.default.shouldLog(C.default.LOG_MICRO)){var M=c;if(((F=O["content-type"])===null||F===void 0?void 0:F.indexOf("msgpack"))>0)try{M=i.default.Config.msgpack.decode(c)}catch(P){C.default.logAction(C.default.LOG_MICRO,"Resource."+S+"()","Sending MsgPack Decoding Error: "+h.inspectError(P))}C.default.logAction(C.default.LOG_MICRO,"Resource."+S+"()","Sending; "+R(l,k)+"; Body: "+M)}m.http.do(S,m,l,O,c,k,function(P,U,N,H,G){if(P&&u.default.isTokenErr(P)){m.auth.authorize(null,null,function(z){if(z){A(z);return}w(m,O,k,A,B)});return}A(P,U,N,H,G)})}w(m,a,x,A,B)},g}();t.default=b},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importDefault(r(2)),h=p.__importDefault(r(3)),C=p.__importDefault(r(9)),u=p.__importStar(r(1));function v(y){return E.Actions.indexOf(y)}var E=function(){function y(){}return y.prototype.isSynthesized=function(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId},y.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var w=this.id.split(":");return{connectionId:w[0],msgSerial:parseInt(w[1],10),index:parseInt(w[2],10)}},y.prototype.toJSON=function(){var w=this.data,f=this.encoding;return w&&h.default.BufferUtils.isBuffer(w)&&(arguments.length>0?(f=f?f+"/base64":"base64",w=h.default.BufferUtils.base64Encode(w)):w=h.default.BufferUtils.toBuffer(w)),{id:this.id,clientId:this.clientId,action:v(this.action),data:w,encoding:f,extras:this.extras}},y.prototype.toString=function(){var w="[PresenceMessage";return w+="; action="+this.action,this.id&&(w+="; id="+this.id),this.timestamp&&(w+="; timestamp="+this.timestamp),this.clientId&&(w+="; clientId="+this.clientId),this.connectionId&&(w+="; connectionId="+this.connectionId),this.encoding&&(w+="; encoding="+this.encoding),this.data&&(typeof this.data=="string"?w+="; data="+this.data:h.default.BufferUtils.isBuffer(this.data)?w+="; data (buffer)="+h.default.BufferUtils.base64Encode(this.data):w+="; data (json)="+JSON.stringify(this.data)),this.extras&&(w+="; extras="+JSON.stringify(this.extras)),w+="]",w},y.fromResponseBody=function(w,f,_){var R=[];_&&(w=u.decodeBody(w,_));for(var D=0;D<w.length;D++){var b=R[D]=y.fromValues(w[D],!0);try{y.decode(b,f)}catch(g){i.default.logAction(i.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",g.toString())}}return R},y.fromValues=function(w,f){return f&&(w.action=y.Actions[w.action]),Object.assign(new y,w)},y.fromValuesArray=function(w){for(var f=w.length,_=new Array(f),R=0;R<f;R++)_[R]=y.fromValues(w[R]);return _},y.fromEncoded=function(w,f){var _=y.fromValues(w,!0);try{y.decode(_,f??{})}catch(R){i.default.logAction(i.default.LOG_ERROR,"PresenceMessage.fromEncoded()",R.toString())}return _},y.fromEncodedArray=function(w,f){return w.map(function(_){return y.fromEncoded(_,f)})},y.fromData=function(w){return w instanceof y?w:y.fromValues({data:w})},y.Actions=["absent","present","enter","leave","update"],y.encode=C.default.encode,y.decode=C.default.decode,y.getMessagesSize=C.default.getMessagesSize,y}();t.default=E},function(s,t,r){(function(p){Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),h=i.__importStar(r(1)),C=i.__importDefault(r(7)),u=i.__importStar(r(4)),v=i.__importDefault(r(2)),E=i.__importDefault(r(8)),y=i.__importDefault(r(22)),w=i.__importDefault(r(3));function f(d,A){return h.arrIn(h.allToLowerCase(h.keysArray(A)),"x-ably-errorcode")}function _(d,A){if(f(d,A))return d.error&&u.default.fromValues(d.error)}var R=function(){},D=0,b={},g=typeof p<"u"&&p.XDomainRequest;function S(){var d=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/);return d&&Number(d[1])}function m(){var d;return g&&(d=S())&&d===10}function l(d,A){return d.getResponseHeader&&d.getResponseHeader(A)}function c(d){return d.getResponseHeader&&(d.getResponseHeader("transfer-encoding")||!d.getResponseHeader("content-length"))}function a(d){for(var A=h.trim(d.getAllResponseHeaders()).split(`\r
`),B={},O=0;O<A.length;O++){var k=A[O].split(":").map(h.trim);B[k[0].toLowerCase()]=k[1]}return B}var x=function(d){i.__extends(A,d);function A(B,O,k,F,M,P,U){var N=d.call(this)||this;return k=k||{},k.rnd=h.cheapRandStr(),m()&&!k.envelope&&(k.envelope="json"),N.uri=B+h.toQueryString(k),N.headers=O||{},N.body=F,N.method=U?U.toUpperCase():h.isEmptyArg(F)?"GET":"POST",N.requestMode=M,N.timeouts=P,N.timedOut=!1,N.requestComplete=!1,N.id=String(++D),b[N.id]=N,N}return A.createRequest=function(B,O,k,F,M,P,U){var N=P||E.default.TIMEOUTS;return new A(B,O,h.copy(k),F,M,N,U)},A.prototype.complete=function(B,O,k,F,M){this.requestComplete||(this.requestComplete=!0,!B&&O&&this.emit("data",O),this.emit("complete",B,O,k,F,M),this.dispose())},A.prototype.abort=function(){this.dispose()},A.prototype.exec=function(){var B=this,O=this.headers,k=this.requestMode==y.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,F=this.timer=setTimeout(function(){B.timedOut=!0,P.abort()},k),M=this.method,P=this.xhr=new XMLHttpRequest,U=O.accept,N=this.body,H="text";if(U?U.indexOf("application/x-msgpack")===0&&(H="arraybuffer"):O.accept="application/json",N){var G=O["content-type"]||(O["content-type"]="application/json");G.indexOf("application/json")>-1&&typeof N!="string"&&(N=JSON.stringify(N))}P.open(M,this.uri,!0),P.responseType=H,"authorization"in O&&(P.withCredentials=!0);for(var z in O)P.setRequestHeader(z,O[z]);var j=function(re,we,Be,$e){var De,Ve=we+" (event type: "+re.type+")";!((De=B==null?void 0:B.xhr)===null||De===void 0)&&De.statusText&&(Ve+=", current statusText is "+B.xhr.statusText),v.default.logAction(v.default.LOG_ERROR,"Request.on"+re.type+"()",Ve),B.complete(new u.PartialErrorInfo(Ve,Be,$e))};P.onerror=function(re){j(re,"XHR error occurred",null,400)},P.onabort=function(re){B.timedOut?j(re,"Request aborted due to request timeout expiring",null,408):j(re,"Request cancelled",null,400)},P.ontimeout=function(re){j(re,"Request timed out",null,408)};var $,I,L,V=0,J=!1,ne=function(){if(clearTimeout(F),L=I<400,I==204){B.complete(null,null,null,null,I);return}$=B.requestMode==y.default.REQ_RECV_STREAM&&L&&c(P)},se=function(){var re;try{var we=l(P,"content-type"),Be=we?we.indexOf("application/json")>=0:P.responseType=="text";if(Be){var $e=P.responseType==="arraybuffer"?w.default.BufferUtils.utf8Decode(P.response):String(P.responseText);$e.length?re=JSON.parse($e):re=$e,J=!0}else re=P.response;re.response!==void 0?(I=re.statusCode,L=I<400,O=re.headers,re=re.response):O=a(P)}catch(Ve){B.complete(new u.PartialErrorInfo("Malformed response body from server: "+Ve.message,null,400));return}if(L||h.isArray(re)){B.complete(null,re,O,J,I);return}var De=_(re,O);De||(De=new u.PartialErrorInfo("Error response received from server: "+I+" body was: "+w.default.Config.inspect(re),null,I)),B.complete(De,re,O,J,I)};function de(){for(var re=P.responseText,we=re.length-1,Be,$e;V<we&&(Be=re.indexOf(`
`,V))>-1;)$e=re.slice(V,Be),V=Be+1,pe($e)}var pe=function(re){try{re=JSON.parse(re)}catch(we){B.complete(new u.PartialErrorInfo("Malformed response body from server: "+we.message,null,400));return}B.emit("data",re)},me=function(){de(),B.streamComplete=!0,w.default.Config.nextTick(function(){B.complete()})};P.onreadystatechange=function(){var re=P.readyState;re<3||P.status!==0&&(I===void 0&&(I=P.status,I===1223&&(I=204),ne()),re==3&&$?de():re==4&&($?me():se()))},P.send(N)},A.prototype.dispose=function(){var B=this.xhr;if(B){B.onreadystatechange=B.onerror=B.onabort=B.ontimeout=R,this.xhr=null;var O=this.timer;O&&(clearTimeout(O),this.timer=null),this.requestComplete||B.abort()}delete b[this.id]},A}(C.default);t.default=x}).call(this,r(13))},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importDefault(r(2)),h=p.__importStar(r(1)),C=p.__importDefault(r(24)),u=p.__importDefault(r(4)),v=p.__importDefault(r(45)),E=r(11),y=p.__importDefault(r(19)),w=p.__importDefault(r(14)),f=p.__importDefault(r(3)),_=p.__importDefault(r(15)),R=Math.pow(2,17);function D(){}function b(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function g(k){return!!k.connection}function S(k){return h.isErrorInfoOrPartialErrorInfo(k)?(k.code||(k.statusCode===403?k.code=40300:(k.code=40170,k.statusCode=401)),k):new u.default(h.inspectError(k),k.code||40170,k.statusCode||401)}var m=function(k,F){if(f.default.Config.createHmac){var M=f.default.Config.createHmac("SHA256",F);return M.update(k),M.digest("base64")}return(0,E.stringify)((0,v.default)(k,F))};function l(k){if(!k)return"";typeof k=="string"&&(k=JSON.parse(k));var F=Object.create(null),M=h.keysArray(k,!0);if(!M)return"";M.sort();for(var P=0;P<M.length;P++)F[M[P]]=k[M[P]].sort();return JSON.stringify(F)}function c(k){if(k.authCallback)i.default.logAction(i.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(k.authUrl)i.default.logAction(i.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(k.key)i.default.logAction(i.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(k.tokenDetails)i.default.logAction(i.default.LOG_MINOR,"Auth()","using token auth with supplied token only");else{var F="authOptions must include valid authentication parameters";throw i.default.logAction(i.default.LOG_ERROR,"Auth()",F),new Error(F)}}function a(k){return"useTokenAuth"in k&&!k.useTokenAuth}function x(k){return k.useTokenAuth||!a(k)&&(k.authCallback||k.authUrl||k.token||k.tokenDetails)}function d(k){return!k.key&&!k.authCallback&&!k.authUrl}var A=0;function B(){return A++}var O=function(){function k(F,M){if(this.authOptions={},this.client=F,this.tokenParams=M.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,x(M)){if(M.key&&!m){var P="client-side token request signing not supported";throw i.default.logAction(i.default.LOG_ERROR,"Auth()",P),new Error(P)}d(M)&&i.default.logAction(i.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(M.defaultTokenParams,M),c(this.authOptions)}else{if(!M.key){var P="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw i.default.logAction(i.default.LOG_ERROR,"Auth()",P),new u.default(P,40160,401)}i.default.logAction(i.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(M)}}return k.prototype.authorize=function(F,M,P){var U=this,N;if(typeof F=="function"&&!P?(P=F,N=F=null):typeof M=="function"&&!P?(P=M,N=null):N=M,!P&&this.client.options.promises)return h.promisify(this,"authorize",arguments);if(N&&N.key&&this.authOptions.key!==N.key)throw new u.default("Unable to update auth options with incompatible key",40102,401);N&&"force"in N&&(i.default.deprecated("The `force` auth option","If you’re using this option to force `authorize()` to fetch a new token even if the current token has not expired, this is no longer necessary, as `authorize()` now always fetches a new token. Update your code to no longer pass the `force` auth option. Note that, in general, passing an auth options argument to `authorize()` will overwrite the library’s stored auth options, which may not be what you want. The library currently contains a special case behavior where passing an auth options object which only contains `{ force: true }` will _not_ overwrite the stored options. This special case behavior will be removed alongside support for the `force` option, so if you’re currently passing `authorize()` an auth options object which only contains `{ force: true }`, you should stop passing it an auth options object entirely."),h.isOnlyPropIn(N,"force")&&(N=null)),this._forceNewToken(F,N,function(H,G){if(H){U.client.connection&&H.statusCode===w.default.Forbidden&&U.client.connection.connectionManager.actOnErrorFromAuthorize(H),P==null||P(H);return}g(U.client)?U.client.connection.connectionManager.onAuthUpdated(G,P||D):P==null||P(null,G)})},k.prototype.authorise=function(F,M,P){i.default.renamedMethod("Auth","authorise","authorize"),this.authorize(F,M,P)},k.prototype._forceNewToken=function(F,M,P){var U=this;this.tokenDetails=null,this._saveTokenOptions(F,M),c(this.authOptions),this._ensureValidAuthCredentials(!0,function(N,H){delete U.tokenParams.timestamp,delete U.authOptions.queryTime,P(N,H)})},k.prototype.requestToken=function(F,M,P){var U=this;if(typeof F=="function"&&!P?(P=F,M=F=null):typeof M=="function"&&!P&&(P=M,M=null),!P&&this.client.options.promises)return h.promisify(this,"requestToken",arguments);M=M||this.authOptions,F=F||h.copy(this.tokenParams);var N=P||D,H,G=this.client;if(M.authCallback)i.default.logAction(i.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),H=M.authCallback;else if(M.authUrl)i.default.logAction(i.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),H=function(V,J){var ne=h.mixin({accept:"application/json, text/plain"},M.authHeaders),se=M.authMethod&&M.authMethod.toLowerCase()==="post",de,pe=M.authUrl.indexOf("?");pe>-1&&(de=h.parseQueryString(M.authUrl.slice(pe)),M.authUrl=M.authUrl.slice(0,pe),se||(M.authParams=h.mixin(de,M.authParams)));var me=h.mixin({},M.authParams||{},V),re=function($e,De,Ve,Ke){var Te;if($e?i.default.logAction(i.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+h.inspectError($e)):(Te=Ve["content-type"],i.default.logAction(i.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+Te+"; body: "+h.inspectBody(De))),$e||Ke)return J($e,De);if(f.default.BufferUtils.isBuffer(De)&&(De=De.toString()),!Te){J(new u.default("authUrl response is missing a content-type header",40170,401));return}var Ie=Te.indexOf("application/json")>-1,ze=Te.indexOf("text/plain")>-1||Te.indexOf("application/jwt")>-1;if(!Ie&&!ze){J(new u.default("authUrl responded with unacceptable content-type "+Te+", should be either text/plain, application/jwt or application/json",40170,401));return}if(Ie){if(De.length>R){J(new u.default("authUrl response exceeded max permitted length",40170,401));return}try{De=JSON.parse(De)}catch(Ye){J(new u.default("Unexpected error processing authURL response; err = "+Ye.message,40170,401));return}}J(null,De,Te)};if(i.default.logAction(i.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+M.authUrl+"; Params: "+JSON.stringify(me)+"; method: "+(se?"POST":"GET")),se){var we=ne||{};we["content-type"]="application/x-www-form-urlencoded";var Be=h.toQueryString(me).slice(1);U.client.http.doUri(y.default.Post,G,M.authUrl,we,Be,de,re)}else U.client.http.doUri(y.default.Get,G,M.authUrl,ne||{},null,me,re)};else if(M.key)i.default.logAction(i.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),H=function(V,J){U.createTokenRequest(V,M,J)};else{var z="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";i.default.logAction(i.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),N(new u.default(z,40171,403));return}"capability"in F&&(F.capability=l(F.capability));var j=function(V,J){var ne=V.keyName,se="/keys/"+ne+"/requestToken",de=function(me){return G.baseUri(me)+se},pe=h.defaultPostHeaders(U.client.options);M.requestHeaders&&h.mixin(pe,M.requestHeaders),i.default.logAction(i.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+se+"; Token params: "+JSON.stringify(V)),U.client.http.do(y.default.Post,G,de,pe,JSON.stringify(V),null,J)},$=!1,I=this.client.options.timeouts.realtimeRequestTimeout,L=setTimeout(function(){$=!0;var V="Token request callback timed out after "+I/1e3+" seconds";i.default.logAction(i.default.LOG_ERROR,"Auth.requestToken()",V),N(new u.default(V,40170,401))},I);H(F,function(V,J,ne){if(!$){if(clearTimeout(L),V){i.default.logAction(i.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+h.inspectError(V)),N(S(V));return}if(typeof J=="string"){J.length===0?N(new u.default("Token string is empty",40170,401)):J.length>R?N(new u.default("Token string exceeded max permitted length (was "+J.length+" bytes)",40170,401)):J==="undefined"||J==="null"?N(new u.default("Token string was literal null/undefined",40170,401)):J[0]==="{"&&!(ne&&ne.indexOf("application/jwt")>-1)?N(new u.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):N(null,{token:J});return}if(typeof J!="object"){var se="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof J;i.default.logAction(i.default.LOG_ERROR,"Auth.requestToken()",se),N(new u.default(se,40170,401));return}var de=JSON.stringify(J).length;if(de>R&&!M.suppressMaxLengthCheck){N(new u.default("Token request/details object exceeded max permitted stringified size (was "+de+" bytes)",40170,401));return}if("issued"in J){N(null,J);return}if(!("keyName"in J)){var se="Expected token request callback to call back with a token string, token request object, or token details object";i.default.logAction(i.default.LOG_ERROR,"Auth.requestToken()",se),N(new u.default(se,40170,401));return}j(J,function(pe,me,re,we){if(pe){i.default.logAction(i.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+h.inspectError(pe)),N(S(pe));return}we||(me=JSON.parse(me)),i.default.logAction(i.default.LOG_MINOR,"Auth.getToken()","token received"),N(null,me)})}})},k.prototype.createTokenRequest=function(F,M,P){var U=this;if(typeof F=="function"&&!P?(P=F,M=F=null):typeof M=="function"&&!P&&(P=M,M=null),!P&&this.client.options.promises)return h.promisify(this,"createTokenRequest",arguments);M=M||this.authOptions,F=F||h.copy(this.tokenParams);var N=M.key;if(!N){P(new u.default("No key specified",40101,403));return}var H=N.split(":"),G=H[0],z=H[1];if(!z){P(new u.default("Invalid key specified",40101,403));return}if(F.clientId===""){P(new u.default("clientId can’t be an empty string",40012,400));return}"capability"in F&&(F.capability=l(F.capability));var j=h.mixin({keyName:G},F),$=F.clientId||"",I=F.ttl||"",L=F.capability||"";(function(V){if(j.timestamp){V();return}U.getTimestamp(M&&M.queryTime,function(J,ne){if(J){P(J);return}j.timestamp=ne,V()})})(function(){var V=j.nonce||(j.nonce=b()),J=j.timestamp,ne=j.keyName+`
`+I+`
`+L+`
`+$+`
`+J+`
`+V+`
`;j.mac=j.mac||m(ne,z),i.default.logAction(i.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),P(null,j)})},k.prototype.getAuthParams=function(F){this.method=="basic"?F(null,{key:this.key}):this._ensureValidAuthCredentials(!1,function(M,P){if(M){F(M);return}if(!P)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");F(null,{access_token:P.token})})},k.prototype.getAuthHeaders=function(F){this.method=="basic"?F(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,function(M,P){if(M){F(M);return}if(!P)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");F(null,{authorization:"Bearer "+h.toBase64(P.token)})})},k.prototype.getTimestamp=function(F,M){!this.isTimeOffsetSet()&&(F||this.authOptions.queryTime)?this.client.time(M):M(null,this.getTimestampUsingOffset())},k.prototype.getTimestampUsingOffset=function(){return h.now()+(this.client.serverTimeOffset||0)},k.prototype.isTimeOffsetSet=function(){return this.client.serverTimeOffset!==null},k.prototype._saveBasicOptions=function(F){this.method="basic",this.key=F.key,this.basicKey=h.toBase64(F.key),this.authOptions=F||{},"clientId"in F&&this._userSetClientId(F.clientId)},k.prototype._saveTokenOptions=function(F,M){this.method="token",F&&(this.tokenParams=F),M&&(M.token&&(M.tokenDetails=typeof M.token=="string"?{token:M.token}:M.token),M.tokenDetails&&(this.tokenDetails=M.tokenDetails),"clientId"in M&&this._userSetClientId(M.clientId),this.authOptions=M)},k.prototype._ensureValidAuthCredentials=function(F,M){var P=this,U=this.tokenDetails;if(U){if(this._tokenClientIdMismatch(U.clientId)){M(new u.default("Mismatch between clientId in token ("+U.clientId+") and current clientId ("+this.clientId+")",40102,403));return}if(!this.isTimeOffsetSet()||!U.expires||U.expires>=this.getTimestampUsingOffset()){i.default.logAction(i.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+U.expires),M(null,U);return}i.default.logAction(i.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=C.default.create())).push(M),!(this.currentTokenRequestId!==null&&!F)){var N=this.currentTokenRequestId=B();this.requestToken(this.tokenParams,this.authOptions,function(H,G){if(P.currentTokenRequestId>N){i.default.logAction(i.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");return}P.currentTokenRequestId=null;var z=P.waitingForTokenRequest||D;if(P.waitingForTokenRequest=null,H){z(H);return}z(null,P.tokenDetails=G)})}},k.prototype._userSetClientId=function(F){if(typeof F=="string"||F===null){if(F==="*")throw new u.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var M=this._uncheckedSetClientId(F);if(M)throw M}else throw new u.default("clientId must be either a string or null",40012,400)},k.prototype._uncheckedSetClientId=function(F){if(this._tokenClientIdMismatch(F)){var M="Unexpected clientId mismatch: client has "+this.clientId+", requested "+F,P=new u.default(M,40102,401);return i.default.logAction(i.default.LOG_ERROR,"Auth._uncheckedSetClientId()",M),P}else return this.clientId=this.tokenParams.clientId=F,null},k.prototype._tokenClientIdMismatch=function(F){return!!(this.clientId&&this.clientId!=="*"&&F&&F!=="*"&&this.clientId!==F)},k.isTokenErr=function(F){return F.code&&F.code>=40140&&F.code<40150},k.prototype.revokeTokens=function(F,M,P){if(x(this.client.options))throw new u.default("Cannot revoke tokens when using token auth",40162,401);var U=this.client.options.keyName,N;if(typeof M=="function"?(P=M,N={}):N=M??{},P===void 0){if(this.client.options.promises)return h.promisify(this,"revokeTokens",[F,N]);P=D}var H=P,G=p.__assign({targets:F.map(function(I){return"".concat(I.type,":").concat(I.value)})},N),z=this.client.options.useBinaryProtocol?h.Format.msgpack:h.Format.json,j=h.defaultPostHeaders(this.client.options,z);this.client.options.headers&&h.mixin(j,this.client.options.headers);var $=h.encodeBody(G,z);_.default.post(this.client,"/keys/".concat(U,"/revokeTokens"),$,j,{newBatchResponse:"true"},null,function(I,L,V,J){if(I){H(I);return}var ne=J?L:h.decodeBody(L,z);H(null,ne)})},k}();t.default=O},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p;(function(i){i.Get="get",i.Delete="delete",i.Post="post",i.Put="put",i.Patch="patch"})(p||(p={})),t.default=p},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.HttpPaginatedResponse=t.PaginatedResult=void 0;var p=r(0),i=p.__importStar(r(1)),h=p.__importDefault(r(2)),C=p.__importDefault(r(15)),u=p.__importDefault(r(14));function v(R){var D=R.match(/^\.\/(\w+)\?(.*)$/);return D&&D[2]&&i.parseQueryString(D[2])}function E(R){typeof R=="string"&&(R=R.split(","));for(var D={},b=0;b<R.length;b++){var g=R[b].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(g){var S=v(g[1]);S&&(D[g[2]]=S)}}return D}function y(R,D,b){return!(b&&(D||typeof R.code=="number"))}var w=function(){function R(D,b,g,S,m,l){this.rest=D,this.path=b,this.headers=g,this.envelope=S??null,this.bodyHandler=m,this.useHttpPaginatedResponse=l||!1}return R.prototype.get=function(D,b){var g=this;C.default.get(this.rest,this.path,this.headers,D,this.envelope,function(S,m,l,c,a){g.handlePage(S,m,l,c,a,b)})},R.prototype.delete=function(D,b){var g=this;C.default.delete(this.rest,this.path,this.headers,D,this.envelope,function(S,m,l,c,a){g.handlePage(S,m,l,c,a,b)})},R.prototype.post=function(D,b,g){var S=this;C.default.post(this.rest,this.path,b,this.headers,D,this.envelope,function(m,l,c,a,x){g&&S.handlePage(m,l,c,a,x,g)})},R.prototype.put=function(D,b,g){var S=this;C.default.put(this.rest,this.path,b,this.headers,D,this.envelope,function(m,l,c,a,x){g&&S.handlePage(m,l,c,a,x,g)})},R.prototype.patch=function(D,b,g){var S=this;C.default.patch(this.rest,this.path,b,this.headers,D,this.envelope,function(m,l,c,a,x){g&&S.handlePage(m,l,c,a,x,g)})},R.prototype.handlePage=function(D,b,g,S,m,l){if(D&&y(D,b,this.useHttpPaginatedResponse)){h.default.logAction(h.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+i.inspectError(D)),l==null||l(D);return}var c,a,x;try{c=m==u.default.NoContent?[]:this.bodyHandler(b,g||{},S)}catch(d){l==null||l(D||d);return}g&&(a=g.Link||g.link)&&(x=E(a)),this.useHttpPaginatedResponse?l(null,new _(this,c,g||{},m,x,D)):l(null,new f(this,c,x))},R}(),f=function(){function R(D,b,g){var S=this;this.resource=D,this.items=b;var m=this;g&&("first"in g&&(this.first=function(l){if(!l&&m.resource.rest.options.promises)return i.promisify(m,"first",[]);m.get(g.first,l)}),"current"in g&&(this.current=function(l){if(!l&&m.resource.rest.options.promises)return i.promisify(m,"current",[]);m.get(g.current,l)}),this.next=function(l){if(!l&&m.resource.rest.options.promises)return i.promisify(m,"next",[]);"next"in g?m.get(g.next,l):l(null,null)},this.hasNext=function(){return"next"in g},this.isLast=function(){var l;return!(!((l=S.hasNext)===null||l===void 0)&&l.call(S))})}return R.prototype.get=function(D,b){var g=this.resource;C.default.get(g.rest,g.path,g.headers,D,g.envelope,function(S,m,l,c,a){g.handlePage(S,m,l,c,a,b)})},R}();t.PaginatedResult=f;var _=function(R){p.__extends(D,R);function D(b,g,S,m,l,c){var a=R.call(this,b,g,l)||this;return a.statusCode=m,a.success=m<300&&m>=200,a.headers=S,a.errorCode=c&&c.code,a.errorMessage=c&&c.message,a}return D.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},D}(f);t.HttpPaginatedResponse=_,t.default=w},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isRetriable=void 0;var p=r(0),i=p.__importDefault(r(4)),h={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},C={disconnected:function(){return i.default.fromValues({statusCode:400,code:h.DISCONNECTED,message:"Connection to server temporarily unavailable"})},suspended:function(){return i.default.fromValues({statusCode:400,code:h.SUSPENDED,message:"Connection to server unavailable"})},failed:function(){return i.default.fromValues({statusCode:400,code:h.FAILED,message:"Connection failed or disconnected by server"})},closing:function(){return i.default.fromValues({statusCode:400,code:h.CLOSING,message:"Connection closing"})},closed:function(){return i.default.fromValues({statusCode:400,code:h.CLOSED,message:"Connection closed"})},unknownConnectionErr:function(){return i.default.fromValues({statusCode:500,code:h.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"})},unknownChannelErr:function(){return i.default.fromValues({statusCode:500,code:h.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})}};function u(v){return!v.statusCode||!v.code||v.statusCode>=500?!0:Object.values(h).includes(v.code)}t.isRetriable=u,t.default=C},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p;(function(i){i[i.REQ_SEND=0]="REQ_SEND",i[i.REQ_RECV=1]="REQ_RECV",i[i.REQ_RECV_POLL=2]="REQ_RECV_POLL",i[i.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"})(p||(p={})),t.default=p},function(s,t,r){(function(p,i){s.exports=i(r(6),r(5),r(58),r(11),r(40),r(32),r(25),r(27),r(28),r(59),r(60))})(this,function(p){return p})},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importDefault(r(2)),h=function(){function C(u){this.members=u||[]}return C.prototype.call=function(){for(var u=[],v=0;v<arguments.length;v++)u[v]=arguments[v];for(var E=0,y=this.members;E<y.length;E++){var w=y[E];if(w)try{w.apply(void 0,u)}catch(f){i.default.logAction(i.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+f+"; stack = "+f.stack)}}},C.prototype.push=function(){for(var u,v=[],E=0;E<arguments.length;E++)v[E]=arguments[E];(u=this.members).push.apply(u,v)},C.create=function(u){var v=new C(u);return Object.assign(function(){for(var E=[],y=0;y<arguments.length;y++)E[y]=arguments[y];return v.call.apply(v,E)},{push:function(E){return v.push(E)}})},C}();t.default=h},function(s,t,r){(function(p,i){s.exports=i(r(6))})(this,function(p){(function(){var i=p,h=i.lib,C=h.Base,u=i.enc,v=u.Utf8,E=i.algo;E.HMAC=C.extend({init:function(y,w){y=this._hasher=new y.init,typeof w=="string"&&(w=v.parse(w));var f=y.blockSize,_=f*4;w.sigBytes>_&&(w=y.finalize(w)),w.clamp();for(var R=this._oKey=w.clone(),D=this._iKey=w.clone(),b=R.words,g=D.words,S=0;S<f;S++)b[S]^=1549556828,g[S]^=909522486;R.sigBytes=D.sigBytes=_,this.reset()},reset:function(){var y=this._hasher;y.reset(),y.update(this._iKey)},update:function(y){return this._hasher.update(y),this},finalize:function(y){var w=this._hasher,f=w.finalize(y);w.reset();var _=w.finalize(this._oKey.clone().concat(f));return _}})})()})},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importDefault(r(10)),h=p.__importStar(r(1)),C=p.__importDefault(r(7)),u=p.__importDefault(r(2)),v=p.__importDefault(r(21)),E=p.__importDefault(r(4)),y=p.__importDefault(r(3)),w=i.default.Action,f=i.default.fromValues({action:w.CLOSE}),_=i.default.fromValues({action:w.DISCONNECT}),R=function(D){p.__extends(b,D);function b(g,S,m,l){var c=D.call(this)||this;return l&&(m.format=void 0,m.heartbeats=!0),c.connectionManager=g,g.registerProposedTransport(c),c.auth=S,c.params=m,c.timeouts=m.options.timeouts,c.format=m.format,c.isConnected=!1,c.isFinished=!1,c.isDisposed=!1,c.maxIdleInterval=null,c.idleTimer=null,c.lastActivity=null,c}return b.prototype.connect=function(){},b.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",v.default.closed())},b.prototype.disconnect=function(g){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",g||v.default.disconnected())},b.prototype.fail=function(g){this.isConnected&&this.requestDisconnect(),this.finish("failed",g||v.default.failed())},b.prototype.finish=function(g,S){var m;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((m=this.idleTimer)!==null&&m!==void 0?m:void 0),this.idleTimer=null,this.emit(g,S),this.dispose())},b.prototype.onProtocolMessage=function(g){switch(u.default.shouldLog(u.default.LOG_MICRO)&&u.default.logAction(u.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+i.default.stringify(g)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),g.action){case w.HEARTBEAT:u.default.logAction(u.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",g.id);break;case w.CONNECTED:this.onConnect(g),this.emit("connected",g.error,g.connectionId,g.connectionDetails,g);break;case w.CLOSED:this.onClose(g);break;case w.DISCONNECTED:this.onDisconnect(g);break;case w.ACK:this.emit("ack",g.msgSerial,g.count);break;case w.NACK:this.emit("nack",g.msgSerial,g.count,g.error);break;case w.SYNC:this.connectionManager.onChannelMessage(g,this);break;case w.ACTIVATE:break;case w.AUTH:this.auth.authorize(function(S){S&&u.default.logAction(u.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+h.inspectError(S))});break;case w.ERROR:if(u.default.logAction(u.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+y.default.Config.inspect(g.error)+(g.channel?", channel: "+g.channel:"")),g.channel===void 0){this.onFatalError(g);break}this.connectionManager.onChannelMessage(g,this);break;default:this.connectionManager.onChannelMessage(g,this)}},b.prototype.onConnect=function(g){if(this.isConnected=!0,!g.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var S=g.connectionDetails.maxIdleInterval;S&&(this.maxIdleInterval=S+this.timeouts.realtimeRequestTimeout,this.onActivity())},b.prototype.onDisconnect=function(g){var S=g&&g.error;u.default.logAction(u.default.LOG_MINOR,"Transport.onDisconnect()","err = "+h.inspectError(S)),this.finish("disconnected",S)},b.prototype.onFatalError=function(g){var S=g&&g.error;u.default.logAction(u.default.LOG_MINOR,"Transport.onFatalError()","err = "+h.inspectError(S)),this.finish("failed",S)},b.prototype.onClose=function(g){var S=g&&g.error;u.default.logAction(u.default.LOG_MINOR,"Transport.onClose()","err = "+h.inspectError(S)),this.finish("closed",S)},b.prototype.requestClose=function(){u.default.logAction(u.default.LOG_MINOR,"Transport.requestClose()",""),this.send(f)},b.prototype.requestDisconnect=function(){u.default.logAction(u.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(_)},b.prototype.ping=function(g){var S={action:i.default.Action.HEARTBEAT};g&&(S.id=g),this.send(i.default.fromValues(S))},b.prototype.dispose=function(){u.default.logAction(u.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},b.prototype.onActivity=function(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=h.now(),this.setIdleTimer(this.maxIdleInterval+100))},b.prototype.setIdleTimer=function(g){var S=this;this.idleTimer||(this.idleTimer=setTimeout(function(){S.onIdleTimerExpire()},g))},b.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var g=h.now()-this.lastActivity,S=this.maxIdleInterval-g;if(S<=0){var m="No activity seen from realtime in "+g+"ms; assuming connection has dropped";u.default.logAction(u.default.LOG_ERROR,"Transport.onIdleTimerExpire()",m),this.disconnect(new E.default(m,80003,408))}else this.setIdleTimer(S+100)},b.tryConnect=function(g,S,m,l,c){var a=new g(S,m,l),x,d=function(B){clearTimeout(x),c({event:this.event,error:B})},A=S.options.timeouts.realtimeRequestTimeout;x=setTimeout(function(){a.off(["preconnect","disconnected","failed"]),a.dispose(),d.call({event:"disconnected"},new E.default("Timeout waiting for transport to indicate itself viable",5e4,500))},A),a.on(["failed","disconnected"],d),a.on("preconnect",function(){u.default.logAction(u.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+a),clearTimeout(x),a.off(["failed","disconnected"],d),c(null,a)}),a.connect()},b}(C.default);t.default=R},function(s,t,r){(function(p,i){s.exports=i(r(6),r(40),r(25))})(this,function(p){return function(){var i=p,h=i.lib,C=h.Base,u=h.WordArray,v=i.algo,E=v.MD5,y=v.EvpKDF=C.extend({cfg:C.extend({keySize:128/32,hasher:E,iterations:1}),init:function(w){this.cfg=this.cfg.extend(w)},compute:function(w,f){for(var _,R=this.cfg,D=R.hasher.create(),b=u.create(),g=b.words,S=R.keySize,m=R.iterations;g.length<S;){_&&D.update(_),_=D.update(w).finalize(f),D.reset();for(var l=1;l<m;l++)_=D.finalize(_),D.reset();b.concat(_)}return b.sigBytes=S*4,b}});i.EvpKDF=function(w,f,_){return y.create(_).compute(w,f)}}(),p.EvpKDF})},function(s,t,r){(function(p,i){s.exports=i(r(6),r(27))})(this,function(p){p.lib.Cipher||function(i){var h=p,C=h.lib,u=C.Base,v=C.WordArray,E=C.BufferedBlockAlgorithm,y=h.enc;y.Utf8;var w=y.Base64,f=h.algo,_=f.EvpKDF,R=C.Cipher=E.extend({cfg:u.extend(),createEncryptor:function(O,k){return this.create(this._ENC_XFORM_MODE,O,k)},createDecryptor:function(O,k){return this.create(this._DEC_XFORM_MODE,O,k)},init:function(O,k,F){this.cfg=this.cfg.extend(F),this._xformMode=O,this._key=k,this.reset()},reset:function(){E.reset.call(this),this._doReset()},process:function(O){return this._append(O),this._process()},finalize:function(O){O&&this._append(O);var k=this._doFinalize();return k},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function O(k){return typeof k=="string"?B:x}return function(k){return{encrypt:function(F,M,P){return O(M).encrypt(k,F,M,P)},decrypt:function(F,M,P){return O(M).decrypt(k,F,M,P)}}}}()});C.StreamCipher=R.extend({_doFinalize:function(){var O=this._process(!0);return O},blockSize:1});var D=h.mode={},b=C.BlockCipherMode=u.extend({createEncryptor:function(O,k){return this.Encryptor.create(O,k)},createDecryptor:function(O,k){return this.Decryptor.create(O,k)},init:function(O,k){this._cipher=O,this._iv=k}}),g=D.CBC=function(){var O=b.extend();O.Encryptor=O.extend({processBlock:function(F,M){var P=this._cipher,U=P.blockSize;k.call(this,F,M,U),P.encryptBlock(F,M),this._prevBlock=F.slice(M,M+U)}}),O.Decryptor=O.extend({processBlock:function(F,M){var P=this._cipher,U=P.blockSize,N=F.slice(M,M+U);P.decryptBlock(F,M),k.call(this,F,M,U),this._prevBlock=N}});function k(F,M,P){var U,N=this._iv;N?(U=N,this._iv=i):U=this._prevBlock;for(var H=0;H<P;H++)F[M+H]^=U[H]}return O}(),S=h.pad={},m=S.Pkcs7={pad:function(O,k){for(var F=k*4,M=F-O.sigBytes%F,P=M<<24|M<<16|M<<8|M,U=[],N=0;N<M;N+=4)U.push(P);var H=v.create(U,M);O.concat(H)},unpad:function(O){var k=O.words[O.sigBytes-1>>>2]&255;O.sigBytes-=k}};C.BlockCipher=R.extend({cfg:R.cfg.extend({mode:g,padding:m}),reset:function(){var O;R.reset.call(this);var k=this.cfg,F=k.iv,M=k.mode;this._xformMode==this._ENC_XFORM_MODE?O=M.createEncryptor:(O=M.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==O?this._mode.init(this,F&&F.words):(this._mode=O.call(M,this,F&&F.words),this._mode.__creator=O)},_doProcessBlock:function(O,k){this._mode.processBlock(O,k)},_doFinalize:function(){var O,k=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(k.pad(this._data,this.blockSize),O=this._process(!0)):(O=this._process(!0),k.unpad(O)),O},blockSize:128/32});var l=C.CipherParams=u.extend({init:function(O){this.mixIn(O)},toString:function(O){return(O||this.formatter).stringify(this)}}),c=h.format={},a=c.OpenSSL={stringify:function(O){var k,F=O.ciphertext,M=O.salt;return M?k=v.create([1398893684,1701076831]).concat(M).concat(F):k=F,k.toString(w)},parse:function(O){var k,F=w.parse(O),M=F.words;return M[0]==1398893684&&M[1]==1701076831&&(k=v.create(M.slice(2,4)),M.splice(0,4),F.sigBytes-=16),l.create({ciphertext:F,salt:k})}},x=C.SerializableCipher=u.extend({cfg:u.extend({format:a}),encrypt:function(O,k,F,M){M=this.cfg.extend(M);var P=O.createEncryptor(F,M),U=P.finalize(k),N=P.cfg;return l.create({ciphertext:U,key:F,iv:N.iv,algorithm:O,mode:N.mode,padding:N.padding,blockSize:O.blockSize,formatter:M.format})},decrypt:function(O,k,F,M){M=this.cfg.extend(M),k=this._parse(k,M.format);var P=O.createDecryptor(F,M).finalize(k.ciphertext);return P},_parse:function(O,k){return typeof O=="string"?k.parse(O,this):O}}),d=h.kdf={},A=d.OpenSSL={execute:function(O,k,F,M){M||(M=v.random(64/8));var P=_.create({keySize:k+F}).compute(O,M),U=v.create(P.words.slice(k),F*4);return P.sigBytes=k*4,l.create({key:P,iv:U,salt:M})}},B=C.PasswordBasedCipher=x.extend({cfg:x.cfg.extend({kdf:A}),encrypt:function(O,k,F,M){M=this.cfg.extend(M);var P=M.kdf.execute(F,O.keySize,O.ivSize);M.iv=P.iv;var U=x.encrypt.call(this,O,k,P.key,M);return U.mixIn(P),U},decrypt:function(O,k,F,M){M=this.cfg.extend(M),k=this._parse(k,M.format);var P=M.kdf.execute(F,O.keySize,O.ivSize,k.salt);M.iv=P.iv;var U=x.decrypt.call(this,O,k,P.key,M);return U}})}()})},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Request=t.createRequest=void 0;var p=r(0),i=p.__importStar(r(1)),h=p.__importDefault(r(12)),C=p.__importDefault(r(3)),u=p.__importDefault(r(7)),v=r(4),E=p.__importDefault(r(8)),y=p.__importDefault(r(2)),w=p.__importDefault(r(22)),f=i.getGlobalObject(),_=function(){},R=f._ablyjs_jsonp={};R._=function(c){return R["_"+c]||_};var D=1,b="jsonp";function g(c,a,x,d,A,B,O){return B=B||E.default.TIMEOUTS,new m(void 0,c,a,i.copy(x),d,A,B,O)}t.createRequest=g;var S=function(c){p.__extends(a,c);function a(x,d,A){var B=c.call(this,x,d,A)||this;return B.shortName=b,A.stream=!1,B}return a.isAvailable=function(){return C.default.Config.jsonpSupported&&C.default.Config.allowComet},a.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},a.prototype.createRequest=function(x,d,A,B,O,k,F){return k=(this===null||this===void 0?void 0:this.timeouts)||k||E.default.TIMEOUTS,g(x,d,A,B,O,k,F)},a}(h.default),m=function(c){p.__extends(a,c);function a(x,d,A,B,O,k,F,M){var P=c.call(this)||this;return x===void 0&&(x=D++),P.id=x,P.uri=d,P.params=B||{},P.params.rnd=i.cheapRandStr(),A&&(A["X-Ably-Version"]&&(P.params.v=A["X-Ably-Version"]),A["X-Ably-Lib"]&&(P.params.lib=A["X-Ably-Lib"])),P.body=O,P.method=M,P.requestMode=k,P.timeouts=F,P.requestComplete=!1,P}return a.prototype.exec=function(){var x=this,d=this.id,A=this.body,B=this.method,O=this.uri,k=this.params;k.callback="_ablyjs_jsonp._("+d+")",k.envelope="jsonp",A&&(k.body=A),B&&B!=="get"&&(k.method=B);var F=this.script=document.createElement("script"),M=O+i.toQueryString(k);F.src=M,F.src.split("/").slice(-1)[0]!==M.split("/").slice(-1)[0]&&y.default.logAction(y.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),F.async=!0,F.type="text/javascript",F.charset="UTF-8",F.onerror=function(N){x.complete(new v.PartialErrorInfo("JSONP script error (event: "+C.default.Config.inspect(N)+")",null,400))},R["_"+d]=function(N){if(N.statusCode){var H=N.response;if(N.statusCode==204)x.complete(null,null,null,N.statusCode);else if(!H)x.complete(new v.PartialErrorInfo("Invalid server response: no envelope detected",null,500));else if(N.statusCode<400||i.isArray(H))x.complete(null,H,N.headers,N.statusCode);else{var G=H.error||new v.PartialErrorInfo("Error response received from server",null,N.statusCode);x.complete(G)}}else x.complete(null,N)};var P=this.requestMode==w.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),P);var U=document.getElementsByTagName("head")[0];U.insertBefore(F,U.firstChild)},a.prototype.complete=function(x,d,A,B){if(A=A||{},!this.requestComplete){this.requestComplete=!0;var O=void 0;d&&(O=typeof d=="string"?"text/plain":"application/json",A["content-type"]=O,this.emit("data",d)),this.emit("complete",x,d,A,!0,B),this.dispose()}},a.prototype.abort=function(){this.dispose()},a.prototype.dispose=function(){var x=this.timer;x&&(clearTimeout(x),this.timer=null);var d=this.script;d.parentNode&&d.parentNode.removeChild(d),delete R[this.id],this.emit("disposed")},a}(u.default);t.Request=m;function l(c){return f.JSONPTransport=S,S.isAvailable()&&(c.supportedTransports[b]=S),S}t.default=l},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importStar(r(1)),h=p.__importDefault(r(2)),C=p.__importDefault(r(8)),u=p.__importDefault(r(18)),v=p.__importDefault(r(46)),E=p.__importDefault(r(20)),y=p.__importDefault(r(33)),w=p.__importDefault(r(4)),f=p.__importDefault(r(49)),_=p.__importDefault(r(19)),R=p.__importDefault(r(3)),D=p.__importDefault(r(9)),b=p.__importDefault(r(16)),g=p.__importDefault(r(15)),S=function(){},m=function(){function c(a){if(!a){var x="no options provided";throw h.default.logAction(h.default.LOG_ERROR,"Rest()",x),new Error(x)}var d=C.default.objectifyOptions(a);d.log?(h.default.setLog(d.log.level,d.log.handler),h.default.deprecated("The `log` client option","Equivalent functionality is provided by the `logLevel` and `logHandler` client options. Update your client options code of the form `{ log: { level: logLevel, handler: logHandler } }` to instead be `{ logLevel, logHandler }`.")):h.default.setLog(d.logLevel,d.logHandler),h.default.logAction(h.default.LOG_MICRO,"Rest()","initialized with clientOptions "+R.default.Config.inspect(a));var A=this.options=C.default.normaliseOptions(d);if(A.key){var B=A.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!B){var x="invalid key parameter";throw h.default.logAction(h.default.LOG_ERROR,"Rest()",x),new w.default(x,40400,404)}A.keyName=B[1],A.keySecret=B[2]}if("clientId"in A)if(typeof A.clientId=="string"||A.clientId===null){if(A.clientId==="*")throw new w.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new w.default("clientId must be either a string or null",40012,400);h.default.logAction(h.default.LOG_MINOR,"Rest()","started; version = "+C.default.version),this.baseUri=this.authority=function(O){return C.default.getHttpScheme(A)+O+":"+C.default.getPort(A,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new R.default.Http(A),this.auth=new u.default(this,A),this.channels=new l(this),this.push=new v.default(this)}return c.prototype.stats=function(a,x){if(x===void 0)if(typeof a=="function")x=a,a=null;else{if(this.options.promises)return i.promisify(this,"stats",[a]);x=S}var d=i.defaultGetHeaders(this.options),A=this.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,B=this.http.supportsLinkHeaders?void 0:A;this.options.headers&&i.mixin(d,this.options.headers),new E.default(this,"/stats",d,B,function(O,k,F){for(var M=F?O:JSON.parse(O),P=0;P<M.length;P++)M[P]=f.default.fromValues(M[P]);return M}).get(a,x)},c.prototype.time=function(a,x){var d=this;if(x===void 0){if(typeof a=="function")x=a,a=null;else if(this.options.promises)return i.promisify(this,"time",[a])}var A=x||S,B=i.defaultGetHeaders(this.options);this.options.headers&&i.mixin(B,this.options.headers);var O=function(k){return d.authority(k)+"/time"};this.http.do(_.default.Get,this,O,B,null,a,function(k,F,M,P){if(k){A(k);return}P||(F=JSON.parse(F));var U=F[0];if(!U){A(new w.default("Internal error (unexpected result type from GET /time)",5e4,500));return}d.serverTimeOffset=U-i.now(),A(null,U)})},c.prototype.request=function(a,x,d,A,B,O){var k=this.options.useBinaryProtocol,F=k?R.default.Config.msgpack.encode:JSON.stringify,M=k?R.default.Config.msgpack.decode:JSON.parse,P=k?i.Format.msgpack:i.Format.json,U=this.http.supportsLinkHeaders?void 0:P;d=d||{};var N=a.toLowerCase(),H=N=="get"?i.defaultGetHeaders(this.options,P):i.defaultPostHeaders(this.options,P);if(O===void 0){if(this.options.promises)return i.promisify(this,"request",[a,x,d,A,B]);O=S}typeof A!="string"&&(A=F(A)),this.options.headers&&i.mixin(H,this.options.headers),B&&i.mixin(H,B);var G=new E.default(this,x,H,U,function(z,j,$){return i.ensureArray($?z:M(z))},!0);if(!i.arrIn(R.default.Http.methods,N))throw new w.default("Unsupported method "+N,40500,405);i.arrIn(R.default.Http.methodsWithBody,N)?G[N](d,A,O):G[N](d,O)},c.prototype.batchPublish=function(a,x){if(x===void 0){if(this.options.promises)return i.promisify(this,"batchPublish",[a]);x=S}var d=x,A,B;i.isArray(a)?(A=a,B=!1):(A=[a],B=!0);var O=this.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,k=i.defaultPostHeaders(this.options,O);this.options.headers&&i.mixin(k,this.options.headers);var F=i.encodeBody(A,O);g.default.post(this,"/messages",F,k,{newBatchResponse:"true"},null,function(M,P,U,N){if(M){d(M);return}var H=N?P:i.decodeBody(P,O);B?d(null,H[0]):d(null,H)})},c.prototype.batchPresence=function(a,x){if(x===void 0){if(this.options.promises)return i.promisify(this,"batchPresence",[a]);x=S}var d=x,A=this.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,B=i.defaultPostHeaders(this.options,A);this.options.headers&&i.mixin(B,this.options.headers);var O=a.join(",");g.default.get(this,"/presence",B,{newBatchResponse:"true",channels:O},null,function(k,F,M,P){if(k){d(k);return}var U=P?F:i.decodeBody(F,A);d(null,U)})},c.prototype.setLog=function(a){h.default.setLog(a.level,a.handler)},c.Promise=function(a){return a=C.default.objectifyOptions(a),a.promises=!0,new c(a)},c.Callbacks=c,c.Platform=R.default,c.Message=D.default,c.PresenceMessage=b.default,c}(),l=function(){function c(a){this.rest=a,this.all=Object.create(null)}return c.prototype.get=function(a,x){a=String(a);var d=this.all[a];return d?x&&d.setOptions(x):this.all[a]=d=new y.default(this.rest,a,x),d},c.prototype.release=function(a){delete this.all[String(a)]},c}();t.default=m},function(s,t,r){(function(p,i){s.exports=i(r(6))})(this,function(p){return p.enc.Utf8})},function(s,t,r){(function(p,i){s.exports=i(r(6))})(this,function(p){return function(i){var h=p,C=h.lib,u=C.WordArray,v=C.Hasher,E=h.algo,y=[],w=[];(function(){function R(S){for(var m=i.sqrt(S),l=2;l<=m;l++)if(!(S%l))return!1;return!0}function D(S){return(S-(S|0))*4294967296|0}for(var b=2,g=0;g<64;)R(b)&&(g<8&&(y[g]=D(i.pow(b,1/2))),w[g]=D(i.pow(b,1/3)),g++),b++})();var f=[],_=E.SHA256=v.extend({_doReset:function(){this._hash=new u.init(y.slice(0))},_doProcessBlock:function(R,D){for(var b=this._hash.words,g=b[0],S=b[1],m=b[2],l=b[3],c=b[4],a=b[5],x=b[6],d=b[7],A=0;A<64;A++){if(A<16)f[A]=R[D+A]|0;else{var B=f[A-15],O=(B<<25|B>>>7)^(B<<14|B>>>18)^B>>>3,k=f[A-2],F=(k<<15|k>>>17)^(k<<13|k>>>19)^k>>>10;f[A]=O+f[A-7]+F+f[A-16]}var M=c&a^~c&x,P=g&S^g&m^S&m,U=(g<<30|g>>>2)^(g<<19|g>>>13)^(g<<10|g>>>22),N=(c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25),H=d+N+M+w[A]+f[A],G=U+P;d=x,x=a,a=c,c=l+H|0,l=m,m=S,S=g,g=H+G|0}b[0]=b[0]+g|0,b[1]=b[1]+S|0,b[2]=b[2]+m|0,b[3]=b[3]+l|0,b[4]=b[4]+c|0,b[5]=b[5]+a|0,b[6]=b[6]+x|0,b[7]=b[7]+d|0},_doFinalize:function(){var R=this._data,D=R.words,b=this._nDataBytes*8,g=R.sigBytes*8;return D[g>>>5]|=128<<24-g%32,D[(g+64>>>9<<4)+14]=i.floor(b/4294967296),D[(g+64>>>9<<4)+15]=b,R.sigBytes=D.length*4,this._process(),this._hash},clone:function(){var R=v.clone.call(this);return R._hash=this._hash.clone(),R}});h.SHA256=v._createHelper(_),h.HmacSHA256=v._createHmacHelper(_)}(Math),p.SHA256})},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importStar(r(1)),h=p.__importDefault(r(7)),C=p.__importDefault(r(2)),u=p.__importDefault(r(34)),v=p.__importDefault(r(9)),E=p.__importDefault(r(4)),y=p.__importDefault(r(20)),w=p.__importDefault(r(15)),f=p.__importDefault(r(3));function _(){}var R=9;function D(S){return i.arrEvery(S,function(m){return!m.id})}function b(S){var m=S||{};if(m.cipher){if(!f.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var l=f.default.Crypto.getCipher(m.cipher);m.cipher=l.cipherParams,m.channelCipher=l.cipher}else"cipher"in m&&(m.cipher=void 0,m.channelCipher=null);return m}var g=function(S){p.__extends(m,S);function m(l,c,a){var x=S.call(this)||this;return C.default.logAction(C.default.LOG_MINOR,"Channel()","started; name = "+c),x.rest=l,x.name=c,x.basePath="/channels/"+encodeURIComponent(c),x.presence=new u.default(x),x.channelOptions=b(a),x}return m.prototype.setOptions=function(l){this.channelOptions=b(l)},m.prototype.history=function(l,c){if(C.default.logAction(C.default.LOG_MICRO,"Channel.history()","channel = "+this.name),c===void 0)if(typeof l=="function")c=l,l=null;else{if(this.rest.options.promises)return i.promisify(this,"history",arguments);c=_}this._history(l,c)},m.prototype._history=function(l,c){var a=this.rest,x=a.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,d=this.rest.http.supportsLinkHeaders?void 0:x,A=i.defaultGetHeaders(a.options,x);a.options.headers&&i.mixin(A,a.options.headers);var B=this.channelOptions;new y.default(a,this.basePath+"/messages",A,d,function(O,k,F){return v.default.fromResponseBody(O,B,F?void 0:x)}).get(l,c)},m.prototype.publish=function(){var l=this,c=arguments.length,a=arguments[0],x=arguments[1],d=arguments[c-1],A,B;if(typeof d!="function"){if(this.rest.options.promises)return i.promisify(this,"publish",arguments);d=_}if(typeof a=="string"||a===null)A=[v.default.fromValues({name:a,data:x})],B=arguments[2];else if(i.isObject(a))A=[v.default.fromValues(a)],B=arguments[1];else if(i.isArray(a))A=v.default.fromValuesArray(a),B=arguments[1];else throw new E.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);(typeof B!="object"||!B)&&(B={});var O=this.rest,k=O.options,F=k.useBinaryProtocol?i.Format.msgpack:i.Format.json,M=O.options.idempotentRestPublishing,P=i.defaultPostHeaders(O.options,F);if(k.headers&&i.mixin(P,k.headers),M&&D(A)){var U=i.randomString(R);i.arrForEach(A,function(N,H){N.id=U+":"+H.toString()})}v.default.encodeArray(A,this.channelOptions,function(N){if(N){d(N);return}var H=v.default.getMessagesSize(A),G=k.maxMessageSize;if(H>G){d(new E.default("Maximum size of messages that can be published at once exceeded ( was "+H+" bytes; limit is "+G+" bytes)",40009,400));return}l._publish(v.default.serialize(A,F),P,B,d)})},m.prototype._publish=function(l,c,a,x){w.default.post(this.rest,this.basePath+"/messages",l,c,a,null,x)},m.prototype.status=function(l){if(typeof l!="function"&&this.rest.options.promises)return i.promisify(this,"status",[]);var c=this.rest.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,a=i.defaultPostHeaders(this.rest.options,c);w.default.get(this.rest,this.basePath,a,{},c,l||_)},m}(h.default);t.default=g},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importStar(r(1)),h=p.__importDefault(r(7)),C=p.__importDefault(r(2)),u=p.__importDefault(r(20)),v=p.__importDefault(r(16));function E(){}var y=function(w){p.__extends(f,w);function f(_){var R=w.call(this)||this;return R.channel=_,R.basePath=_.basePath+"/presence",R}return f.prototype.get=function(_,R){if(C.default.logAction(C.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),R===void 0)if(typeof _=="function")R=_,_=null;else{if(this.channel.rest.options.promises)return i.promisify(this,"get",arguments);R=E}var D=this.channel.rest,b=D.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,g=this.channel.rest.http.supportsLinkHeaders?void 0:b,S=i.defaultGetHeaders(D.options,b);D.options.headers&&i.mixin(S,D.options.headers);var m=this.channel.channelOptions;new u.default(D,this.basePath,S,g,function(l,c,a){return v.default.fromResponseBody(l,m,a?void 0:b)}).get(_,R)},f.prototype.history=function(_,R){return C.default.logAction(C.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(_,R)},f.prototype._history=function(_,R){if(R===void 0)if(typeof _=="function")R=_,_=null;else{if(this.channel.rest.options.promises)return i.promisify(this,"_history",[_]);R=E}var D=this.channel.rest,b=D.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,g=this.channel.rest.http.supportsLinkHeaders?void 0:b,S=i.defaultGetHeaders(D.options,b);D.options.headers&&i.mixin(S,D.options.headers);var m=this.channel.channelOptions;new u.default(D,this.basePath+"/history",S,g,function(l,c,a){return v.default.fromResponseBody(l,m,a?void 0:b)}).get(_,R)},f}(h.default);t.default=y},function(s,t,r){(function(p){Object.defineProperty(t,"__esModule",{value:!0}),t.TransportParams=void 0;var i=r(0),h=i.__importDefault(r(10)),C=i.__importStar(r(1)),u=i.__importStar(r(52)),v=i.__importStar(r(8)),E=i.__importDefault(r(3)),y=i.__importDefault(r(7)),w=i.__importDefault(r(36)),f=i.__importDefault(r(2)),_=i.__importDefault(r(37)),R=i.__importStar(r(21)),D=i.__importStar(r(4)),b=i.__importDefault(r(18)),g=i.__importDefault(r(9)),S=i.__importDefault(r(24)),m=i.__importDefault(r(53)),l=i.__importDefault(r(26)),c=i.__importDefault(r(14)),a=function(){var z;return typeof E.default.WebStorage<"u"&&((z=E.default.WebStorage)===null||z===void 0?void 0:z.localSupported)},x=function(){var z;return typeof E.default.WebStorage<"u"&&((z=E.default.WebStorage)===null||z===void 0?void 0:z.sessionSupported)},d=h.default.Action,A=function(){},B="ably-transport-preference",O="ably-connection-recovery";function k(){var z,j;return x()&&((j=(z=E.default.WebStorage)===null||z===void 0?void 0:z.getSession)===null||j===void 0?void 0:j.call(z,O))}function F(z){var j,$;return x()&&(($=(j=E.default.WebStorage)===null||j===void 0?void 0:j.setSession)===null||$===void 0?void 0:$.call(j,O,z))}function M(){var z,j;return x()&&((j=(z=E.default.WebStorage)===null||z===void 0?void 0:z.removeSession)===null||j===void 0?void 0:j.call(z,O))}function P(z,j){return C.arrIndexOf(E.default.Defaults.transportPreferenceOrder,z.shortName)>C.arrIndexOf(E.default.Defaults.transportPreferenceOrder,j.shortName)}function U(z,j,$){var I;if(z.channel!==j.channel||(I=z.action)!==d.PRESENCE&&I!==d.MESSAGE||I!==j.action)return!1;var L=I===d.PRESENCE?"presence":"messages",V=z[L].concat(j[L]),J=g.default.getMessagesSize(V);return J>$||!C.allSame(V,"clientId")||!C.arrEvery(V,function(ne){return!ne.id})?!1:(z[L]=V,!0)}function N(z){try{return JSON.parse(z)}catch{return null}}var H=function(){function z(j,$,I,L){this.options=j,this.host=$,this.mode=I,this.connectionKey=L,this.format=j.useBinaryProtocol?C.Format.msgpack:C.Format.json}return z.prototype.getConnectParams=function(j){var $=j?C.copy(j):{},I=this.options;switch(this.mode){case"upgrade":$.upgrade=this.connectionKey;break;case"resume":$.resume=this.connectionKey;break;case"recover":{var L=N(I.recover);L&&($.recover=L.connectionKey);break}}return I.clientId!==void 0&&($.clientId=I.clientId),I.echoMessages===!1&&($.echo="false"),this.format!==void 0&&($.format=this.format),this.stream!==void 0&&($.stream=this.stream),this.heartbeats!==void 0&&($.heartbeats=this.heartbeats),$.v=v.default.protocolVersion,$.agent=(0,v.getAgentString)(this.options),I.transportParams!==void 0&&C.mixin($,I.transportParams),$},z.prototype.toString=function(){var j="[mode="+this.mode;return this.host&&(j+=",host="+this.host),this.connectionKey&&(j+=",connectionKey="+this.connectionKey),this.format&&(j+=",format="+this.format),j+="]",j},z}();t.TransportParams=H;var G=function(z){i.__extends(j,z);function j($,I){var L=z.call(this)||this;L.disconnectedRetryCount=0,j.initTransports(),L.realtime=$,L.options=I;var V=I.timeouts,J=V.preferenceConnectTimeout+V.realtimeRequestTimeout;if(L.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:J,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:V.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:V.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:V.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},L.state=L.states.initialized,L.errorReason=null,L.queuedMessages=new w.default,L.msgSerial=0,L.connectionDetails=void 0,L.connectionId=void 0,L.connectionKey=void 0,L.connectionStateTtl=V.connectionStateTtl,L.maxIdleInterval=null,L.transports=C.intersect(I.transports||v.default.defaultTransports,j.supportedTransports),L.baseTransport=C.intersect(v.default.baseTransportOrder,L.transports)[0],L.upgradeTransports=C.intersect(L.transports,v.default.upgradeTransports),L.transportPreference=null,L.httpHosts=v.default.getHosts(I),L.activeProtocol=null,L.proposedTransports=[],L.pendingTransports=[],L.host=null,L.lastAutoReconnectAttempt=null,L.lastActivity=null,L.forceFallbackHost=!1,L.connectCounter=0,f.default.logAction(f.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),f.default.logAction(f.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(I.transports||v.default.defaultTransports)+"]"),f.default.logAction(f.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+L.transports+"]"),f.default.logAction(f.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+L.httpHosts+"]"),!L.transports.length){var ne="no requested transports available";throw f.default.logAction(f.default.LOG_ERROR,"realtime.ConnectionManager()",ne),new Error(ne)}var se=E.default.Config.addEventListener;return se&&(x()&&typeof I.recover=="function"&&se("beforeunload",L.persistConnection.bind(L)),I.closeOnUnload===!0&&se("beforeunload",function(){f.default.logAction(f.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),L.requestState({state:"closing"})}),se("online",function(){L.state==L.states.disconnected||L.state==L.states.suspended?(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),L.requestState({state:"connecting"})):L.state==L.states.connecting&&(L.pendingTransports.forEach(function(de){de.off()}),L.disconnectAllTransports(),L.startConnect())}),se("offline",function(){L.state==L.states.connected&&(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),L.disconnectAllTransports())})),L}return j.initTransports=function(){(0,m.default)(j),C.arrForEach(E.default.Transports,function($){$(j)})},j.prototype.createTransportParams=function($,I){return new H(this.options,$,I,this.connectionKey)},j.prototype.getTransportParams=function($){var I=this,L=function(V){if(I.connectionKey){V("resume");return}if(typeof I.options.recover=="string"){V("recover");return}var J=I.options.recover,ne=k();if(ne&&typeof J=="function"){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),J(ne,function(se){se?(I.options.recover=ne.recoveryKey,V("recover")):V("clean")});return}V("clean")};L(function(V){var J=I.createTransportParams(null,V);if(V==="recover"){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+I.options.recover);var ne=N(I.options.recover);ne&&(I.msgSerial=ne.msgSerial)}else f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+J.toString());$(J)})},j.prototype.tryATransport=function($,I,L){var V=this;f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+I),l.default.tryConnect(j.supportedTransports[I],this,this.realtime.auth,$,function(J,ne){var se=V.state;if(se==V.states.closing||se==V.states.closed||se==V.states.failed){ne&&(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+se.state+" while we were attempting the transport; closing "+ne),ne.close()),L(!0);return}if(J){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+I+" "+J.event+", err: "+J.error.toString()),b.default.isTokenErr(J.error)&&!(V.errorReason&&b.default.isTokenErr(V.errorReason))?(V.errorReason=J.error,V.realtime.auth._forceNewToken(null,null,function(de){if(de){V.actOnErrorFromAuthorize(de);return}V.tryATransport($,I,L)})):J.event==="failed"?(V.notifyState({state:"failed",error:J.error}),L(!0)):J.event==="disconnected"&&((0,R.isRetriable)(J.error)?L(!1):(V.notifyState({state:V.states.connecting.failState,error:J.error}),L(!0)));return}f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+I+"; setting pending"),V.setTransportPending(ne,$),L(null,ne)})},j.prototype.setTransportPending=function($,I){var L=this,V=I.mode;f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+$+"; mode = "+V),C.arrDeleteValue(this.proposedTransports,$),this.pendingTransports.push($);var J=E.default.Defaults.transportPreferenceOrder[E.default.Defaults.transportPreferenceOrder.length-1];$.once("connected",function(se,de,pe){V=="upgrade"&&L.activeProtocol?$.shortName!==J&&C.arrIn(L.getUpgradePossibilities(),J)&&L.activeProtocol?setTimeout(function(){L.scheduleTransportActivation(se,$,de,pe)},L.options.timeouts.parallelUpgradeDelay):L.scheduleTransportActivation(se,$,de,pe):(L.activateTransport(se,$,de,pe),E.default.Config.nextTick(function(){L.connectImpl(I)})),V==="recover"&&L.options.recover&&(L.options.recover=null,L.unpersistConnection())});var ne=this;$.on(["disconnected","closed","failed"],function(se){ne.deactivateTransport($,this.event,se)}),this.emit("transport.pending",$)},j.prototype.scheduleTransportActivation=function($,I,L,V){var J=this,ne=this.activeProtocol&&this.activeProtocol.getTransport(),se=function(){I.disconnect(),C.arrDeleteValue(J.pendingTransports,I)};if(this.state!==this.states.connected&&this.state!==this.states.connecting){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+I.shortName),se();return}if(ne&&!P(I,ne)){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+I.shortName+" is no better than current active transport "+ne.shortName+" - abandoning upgrade"),se();return}f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+I);var de=null;if(!I.isConnected){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+I.shortName+"is no longer connected; abandoning upgrade"),se();return}if(this.state===this.states.connected)f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),this.state=this.states.synchronizing,de=this.activeProtocol;else if(this.state!==this.states.connecting){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+I.shortName),se();return}f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+I);var pe=function(){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+I),I.send(h.default.fromValues({action:d.ACTIVATE})),J.activateTransport($,I,L,V),J.state===J.states.synchronizing?(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+I),J.state=J.states.connected):f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+J.state.state+", so leaving unchanged"),J.state.sendEvents&&J.sendQueuedMessages()};de?de.onceIdle(pe):pe()},j.prototype.activateTransport=function($,I,L,V){var J=this;f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+I),$&&f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+$),L&&f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+L),V&&f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(V)),this.persistTransportPreference(I);var ne=this.state,se=this.states.connected.state;if(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+ne.state),ne.state==this.states.closing.state||ne.state==this.states.closed.state||ne.state==this.states.failed.state)return f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),I.disconnect(),!1;if(C.arrDeleteValue(this.pendingTransports,I),!I.isConnected)return f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+I+" since it appears to no longer be connected"),!1;var de=this.activeProtocol;this.activeProtocol=new u.default(I),this.host=I.params.host;var pe=V.connectionKey;if(pe&&this.connectionKey!=pe&&this.setConnection(L,V,!!$),this.onConnectionDetailsUpdate(V,I),E.default.Config.nextTick(function(){I.on("connected",function(re,we,Be){J.onConnectionDetailsUpdate(Be,I),J.emit("update",new _.default(se,se,null,re))})}),ne.state===this.states.connected.state?$&&(this.errorReason=this.realtime.connection.errorReason=$,this.emit("update",new _.default(se,se,null,$))):(this.notifyState({state:"connected",error:$}),this.errorReason=this.realtime.connection.errorReason=$||null),this.emit("transport.active",I),de)if(de.messageQueue.count()>0&&f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+de.transport.shortName+", new one is "+I.shortName+") finishing with "+de.messageQueue.count()+" messages still pending"),de.transport===I){var me="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+I.shortName+"; stack = "+new Error().stack;f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.activateTransport()",me)}else de.finish();return C.safeArrForEach(this.pendingTransports,function(re){if(re===I){var we="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+I.shortName+"; stack = "+new Error().stack;f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.activateTransport()",we),C.arrDeleteValue(J.pendingTransports,I)}else re.disconnect()}),C.safeArrForEach(this.proposedTransports,function(re){re===I?(f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+I.shortName+"; stack = "+new Error().stack),C.arrDeleteValue(J.proposedTransports,I)):re.dispose()}),!0},j.prototype.deactivateTransport=function($,I,L){var V=this.activeProtocol,J=V&&V.getTransport()===$,ne=C.arrDeleteValue(this.pendingTransports,$),se=C.arrDeleteValue(this.proposedTransports,$),de=this.noTransportsScheduledForActivation();if(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+$),f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+I+(J?"; was active":ne?"; was pending":se?"; was proposed":"")+(de?"":"; another transport is scheduled for activation")),L&&L.message&&f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+L.message),J&&(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(V.getPendingMessages()),E.default.Config.nextTick(function(){V.clearPendingMessages()}),this.activeProtocol=this.host=null),this.emit("transport.inactive",$),J&&de||J&&I==="failed"||I==="closed"||V===null&&ne&&this.pendingTransports.length===0){if(I==="disconnected"&&L&&L.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:I,error:L,retryImmediately:!0});return}var pe=I==="failed"&&b.default.isTokenErr(L)?"disconnected":I;this.notifyState({state:pe,error:L});return}J&&I==="disconnected"&&this.state!==this.states.synchronizing&&(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:L}))},j.prototype.noTransportsScheduledForActivation=function(){return C.isEmpty(this.pendingTransports)||this.pendingTransports.every(function($){return!$.isConnected})},j.prototype.setConnection=function($,I,L){var V=this.connectionId,J=V&&V!==$,ne=!V&&L;(J||ne)&&(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==$&&f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=$,this.realtime.connection.key=this.connectionKey=I.connectionKey},j.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()},j.prototype.createRecoveryKey=function(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null},j.prototype.checkConnectionStateFreshness=function(){if(!(!this.lastActivity||!this.connectionId)){var $=C.now()-this.lastActivity;$>this.connectionStateTtl+this.maxIdleInterval&&(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+$+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},j.prototype.persistConnection=function(){if(x()){var $=this.createRecoveryKey();$&&F({recoveryKey:$,disconnectedAt:C.now(),location:p.location,clientId:this.realtime.auth.clientId})}},j.prototype.unpersistConnection=function(){M()},j.prototype.getError=function(){return this.errorReason||this.getStateError()},j.prototype.getStateError=function(){var $,I;return(I=($=R.default)[this.state.state])===null||I===void 0?void 0:I.call($)},j.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},j.prototype.enactStateChange=function($){var I=$.current==="failed"?f.default.LOG_ERROR:f.default.LOG_MAJOR;f.default.logAction(I,"Connection state",$.current+($.reason?"; reason: "+$.reason:"")),f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+$.current+"; reason = "+($.reason&&$.reason.message));var L=this.state=this.states[$.current];$.reason&&(this.errorReason=$.reason,this.realtime.connection.errorReason=$.reason),(L.terminal||L.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",$)},j.prototype.startTransitionTimer=function($){var I=this;f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+$.state),this.transitionTimer&&(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(function(){I.transitionTimer&&(I.transitionTimer=null,f.default.logAction(f.default.LOG_MINOR,"ConnectionManager "+$.state+" timer expired","requesting new state: "+$.failState),I.notifyState({state:$.failState}))},$.retryDelay)},j.prototype.cancelTransitionTimer=function(){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},j.prototype.startSuspendTimer=function(){var $=this;this.suspendTimer||(this.suspendTimer=setTimeout(function(){$.suspendTimer&&($.suspendTimer=null,f.default.logAction(f.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),$.states.connecting.failState="suspended",$.notifyState({state:"suspended"}))},this.connectionStateTtl))},j.prototype.checkSuspendTimer=function($){$!=="disconnected"&&$!=="suspended"&&$!=="connecting"&&this.cancelSuspendTimer()},j.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},j.prototype.startRetryTimer=function($){var I=this;this.retryTimer=setTimeout(function(){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),I.retryTimer=null,I.requestState({state:"connecting"})},$)},j.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},j.prototype.notifyState=function($){var I=this,L,V,J=$.state,ne=J==="disconnected"&&(this.state===this.states.connected||this.state===this.states.synchronizing||$.retryImmediately||this.state===this.states.connecting&&$.error&&b.default.isTokenErr($.error)&&!(this.errorReason&&b.default.isTokenErr(this.errorReason)));if(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+J+(ne?"; will retry connection immediately":"")),J!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer($.state),(J==="suspended"||J==="connected")&&(this.disconnectedRetryCount=0),!this.state.terminal)){var se=this.states[$.state],de=se.retryDelay;se.state==="disconnected"&&(this.disconnectedRetryCount++,de=C.getRetryTime(se.retryDelay,this.disconnectedRetryCount));var pe=new _.default(this.state.state,se.state,de,$.error||((V=(L=R.default)[se.state])===null||V===void 0?void 0:V.call(L)));if(ne){var me=function(){I.state===I.states.disconnected&&(I.lastAutoReconnectAttempt=C.now(),I.requestState({state:"connecting"}))},re=this.lastAutoReconnectAttempt&&C.now()-this.lastAutoReconnectAttempt+1;re&&re<1e3?(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+re+"ms ago, waiting another "+(1e3-re)+"ms before trying again"),setTimeout(me,1e3-re)):E.default.Config.nextTick(me)}else(J==="disconnected"||J==="suspended")&&this.startRetryTimer(de);(J==="disconnected"&&!ne||J==="suspended"||se.terminal)&&E.default.Config.nextTick(function(){I.disconnectAllTransports()}),J=="connected"&&!this.activeProtocol&&f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(pe),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(J,pe.reason),this.failQueuedMessages(pe.reason))}},j.prototype.requestState=function($){var I=this,L,V,J=$.state;if(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+J+"; current state: "+this.state.state),J!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(J),!(J=="connecting"&&this.state.state=="connected")&&!(J=="closing"&&this.state.state=="closed"))){var ne=this.states[J],se=new _.default(this.state.state,ne.state,null,$.error||((V=(L=R.default)[ne.state])===null||V===void 0?void 0:V.call(L)));this.enactStateChange(se),J=="connecting"&&E.default.Config.nextTick(function(){I.startConnect()}),J=="closing"&&this.closeImpl()}},j.prototype.startConnect=function(){var $=this;if(this.state!==this.states.connecting){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}var I=this.realtime.auth,L=++this.connectCounter,V=function(){$.checkConnectionStateFreshness(),$.getTransportParams(function(ne){if(ne.mode==="recover"&&ne.options.recover){var se=N(ne.options.recover);se&&$.realtime.channels.recoverChannels(se.channelSerials)}L===$.connectCounter&&$.connectImpl(ne,L)})};if(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),I.method==="basic")V();else{var J=function(ne){L===$.connectCounter&&(ne?$.actOnErrorFromAuthorize(ne):V())};this.errorReason&&b.default.isTokenErr(this.errorReason)?I._forceNewToken(null,null,J):I._ensureValidAuthCredentials(!1,J)}},j.prototype.connectImpl=function($,I){var L=this.state.state;L!==this.states.connecting.state&&L!==this.states.connected.state?f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+L):this.pendingTransports.length?f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):L==this.states.connected.state?this.upgradeIfNeeded($):this.transports.length>1&&this.getTransportPreference()?this.connectPreference($,I):this.connectBase($,I)},j.prototype.connectPreference=function($,I){var L=this,V=this.getTransportPreference(),J=!1;C.arrIn(this.transports,V)||(this.unpersistTransportPreference(),this.connectImpl($,I)),f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+V);var ne=setTimeout(function(){J=!0,L.state.state!==L.states.connected.state&&(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+V+" failed; clearing preference and trying from scratch"),L.disconnectAllTransports(),L.unpersistTransportPreference()),L.connectImpl($,I)},this.options.timeouts.preferenceConnectTimeout);$.host=this.httpHosts[0],this.tryATransport($,V,function(se,de){clearTimeout(ne),J&&de?(de.off(),de.disconnect(),C.arrDeleteValue(L.pendingTransports,de)):!de&&!se&&(L.unpersistTransportPreference(),L.connectImpl($,I))})},j.prototype.connectBase=function($,I){var L=this,V=function(pe){L.notifyState({state:L.states.connecting.failState,error:pe})},J=this.httpHosts.slice(),ne=function(pe,me){I===L.connectCounter&&!me&&!pe&&de()};f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var se=J.shift();if(!se){V(new D.default("Unable to connect (no available host)",80003,404));return}$.host=se;var de=function(){if(!J.length){V(new D.default("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!L.realtime.http.checkConnectivity){V(new D.PartialErrorInfo("Internal error: Http.checkConnectivity not set",null,500));return}L.realtime.http.checkConnectivity(function(pe,me){if(I===L.connectCounter){if(pe){V(pe);return}if(!me){V(new D.default("Unable to connect (network unreachable)",80003,404));return}$.host=C.arrPopRandomElement(J),L.tryATransport($,L.baseTransport,ne)}})};if(this.forceFallbackHost&&J.length){this.forceFallbackHost=!1,de();return}this.tryATransport($,this.baseTransport,ne)},j.prototype.getUpgradePossibilities=function(){var $=this.activeProtocol.getTransport().shortName,I=C.arrIndexOf(this.upgradeTransports,$);return this.upgradeTransports.slice(I+1)},j.prototype.upgradeIfNeeded=function($){var I=this,L=this.getUpgradePossibilities();f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+E.default.Config.inspect(L)),L.length&&C.arrForEach(L,function(V){var J=I.createTransportParams($.host,"upgrade");I.tryATransport(J,V,A)})},j.prototype.closeImpl=function(){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),C.safeArrForEach(this.pendingTransports,function($){f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+$),$&&$.close()}),C.safeArrForEach(this.proposedTransports,function($){f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+$),$&&$.dispose()}),this.activeProtocol&&(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},j.prototype.onAuthUpdated=function($,I){var L=this,V;switch(this.state.state){case"connected":{if(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var J=this.activeProtocol.getTransport().params;E.default.Config.nextTick(function(){L.state.state==="connected"&&L.upgradeIfNeeded(J)})}var ne=(V=this.activeProtocol)===null||V===void 0?void 0:V.getTransport();ne&&ne.onAuthUpdated&&ne.onAuthUpdated($);var se=h.default.fromValues({action:d.AUTH,auth:{accessToken:$.token}});this.send(se);var de=function(){L.off(pe),I(null,$)},pe=function(re){re.current==="failed"&&(L.off(de),L.off(pe),I(re.reason||L.getStateError()))};this.once("connectiondetails",de),this.on("connectionstate",pe);break}case"connecting":f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");var me=function(re){switch(re.current){case"connected":L.off(me),I(null,$);break;case"failed":case"closed":case"suspended":L.off(me),I(re.reason||L.getStateError());break}};this.on("connectionstate",me),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}},j.prototype.disconnectAllTransports=function($){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+($?" except the active transport":"")),this.connectCounter++,C.safeArrForEach(this.pendingTransports,function(I){f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+I),I&&I.disconnect()}),this.pendingTransports=[],C.safeArrForEach(this.proposedTransports,function(I){f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+I),I&&I.dispose()}),this.proposedTransports=[],this.activeProtocol&&!$&&(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},j.prototype.send=function($,I,L){L=L||A;var V=this.state;if(V.sendEvents){f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new u.PendingMessage($,L));return}var J=I&&V.queueEvents||V.forceQueueEvents;if(!J){var ne="rejecting event, queueEvent was "+I+", state was "+V.state;f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.send()",ne),L(this.errorReason||new D.default(ne,9e4,400));return}f.default.shouldLog(f.default.LOG_MICRO)&&f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+h.default.stringify($)),this.queue($,L)},j.prototype.sendImpl=function($){var I=$.message;$.ackRequired&&!$.sendAttempted&&(I.msgSerial=this.msgSerial++);try{this.activeProtocol.send($)}catch(L){f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+L.stack)}},j.prototype.queue=function($,I){f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var L=this.queuedMessages.last(),V=this.options.maxMessageSize;L&&!L.sendAttempted&&U(L.message,$,V)?(L.merged||(L.callback=S.default.create([L.callback]),L.merged=!0),L.callback.push(I)):this.queuedMessages.push(new u.PendingMessage($,I))},j.prototype.sendQueuedMessages=function(){f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");for(var $;$=this.queuedMessages.shift();)this.sendImpl($)},j.prototype.queuePendingMessages=function($){$&&$.length&&(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+$.length+" pending messages"),this.queuedMessages.prepend($))},j.prototype.failQueuedMessages=function($){var I=this.queuedMessages.count();I>0&&(f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+I+" queued messages, err = "+C.inspectError($)),this.queuedMessages.completeAllMessages($))},j.prototype.onChannelMessage=function($,I){var L=this.activeProtocol&&I===this.activeProtocol.getTransport(),V=C.arrIn(this.pendingTransports,I)&&this.state==this.states.synchronizing;L||V?this.realtime.channels.onChannelMessage($):C.arrIndexOf([d.ACK,d.NACK,d.ERROR],$.action)>-1?this.realtime.channels.onChannelMessage($):f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify($)+"on defunct transport; discarding")},j.prototype.ping=function($,I){var L=this;if($){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+$);var V=function(){$.off("heartbeat",se),I(new D.default("Timeout waiting for heartbeat response",5e4,500))},J=C.now(),ne=C.cheapRandStr(),se=function(we){if(we===ne){$.off("heartbeat",se),clearTimeout(de);var Be=C.now()-J;I(null,Be)}},de=setTimeout(V,this.options.timeouts.realtimeRequestTimeout);$.on("heartbeat",se),$.ping(ne);return}if(this.state.state!=="connected"){I(new D.default("Unable to ping service; not connected",4e4,400));return}var pe=!1,me=function(we,Be){L.off("transport.active",re),pe||(pe=!0,I(we,Be))},re=function(){pe||(pe=!0,E.default.Config.nextTick(function(){L.ping(null,I)}))};this.on("transport.active",re),this.ping(this.activeProtocol.getTransport(),me)},j.prototype.abort=function($){this.activeProtocol.getTransport().fail($)},j.prototype.registerProposedTransport=function($){this.proposedTransports.push($)},j.prototype.getTransportPreference=function(){var $,I;return this.transportPreference||a()&&((I=($=E.default.WebStorage)===null||$===void 0?void 0:$.get)===null||I===void 0?void 0:I.call($,B))},j.prototype.persistTransportPreference=function($){var I,L;C.arrIn(v.default.upgradeTransports,$.shortName)&&(this.transportPreference=$.shortName,a()&&((L=(I=E.default.WebStorage)===null||I===void 0?void 0:I.set)===null||L===void 0||L.call(I,B,$.shortName)))},j.prototype.unpersistTransportPreference=function(){var $,I;this.transportPreference=null,a()&&((I=($=E.default.WebStorage)===null||$===void 0?void 0:$.remove)===null||I===void 0||I.call($,B))},j.prototype.actOnErrorFromAuthorize=function($){if($.code===40171)this.notifyState({state:"failed",error:$});else if($.code===40102)this.notifyState({state:"failed",error:$});else if($.statusCode===c.default.Forbidden){var I="Client configured authentication provider returned 403; failing the connection";f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",I),this.notifyState({state:"failed",error:new D.default(I,80019,403,$)})}else{var I="Client configured authentication provider request failed";f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",I),this.notifyState({state:this.state.failState,error:new D.default(I,80019,401,$)})}},j.prototype.onConnectionDetailsUpdate=function($,I){if($){this.connectionDetails=$,$.maxMessageSize&&(this.options.maxMessageSize=$.maxMessageSize);var L=$.clientId;if(L){var V=this.realtime.auth._uncheckedSetClientId(L);if(V){f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",V.message),I.fail(V);return}}var J=$.connectionStateTtl;J&&(this.connectionStateTtl=J),this.maxIdleInterval=$.maxIdleInterval,this.emit("connectiondetails",$)}},j.supportedTransports={},j}(y.default);t.default=G}).call(this,r(13))},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importDefault(r(7)),h=p.__importDefault(r(2)),C=function(u){p.__extends(v,u);function v(){var E=u.call(this)||this;return E.messages=[],E}return v.prototype.count=function(){return this.messages.length},v.prototype.push=function(E){this.messages.push(E)},v.prototype.shift=function(){return this.messages.shift()},v.prototype.last=function(){return this.messages[this.messages.length-1]},v.prototype.copyAll=function(){return this.messages.slice()},v.prototype.append=function(E){this.messages.push.apply(this.messages,E)},v.prototype.prepend=function(E){this.messages.unshift.apply(this.messages,E)},v.prototype.completeMessages=function(E,y,w){h.default.logAction(h.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+E+"; count = "+y),w=w||null;var f=this.messages;if(f.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var _=f[0];if(_){var R=_.message.msgSerial,D=E+y;if(D>R)for(var b=f.splice(0,D-R),g=0,S=b;g<S.length;g++){var m=S[g];m.callback(w)}f.length==0&&this.emit("idle")}},v.prototype.completeAllMessages=function(E){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,E)},v.prototype.resetSendAttempted=function(){for(var E=0,y=this.messages;E<y.length;E++){var w=y[E];w.sendAttempted=!1}},v.prototype.clear=function(){h.default.logAction(h.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},v}(i.default);t.default=C},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=function(){function i(h,C,u,v){this.previous=h,this.current=C,u&&(this.retryIn=u),v&&(this.reason=v)}return i}();t.default=p},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importDefault(r(10)),h=p.__importDefault(r(7)),C=p.__importStar(r(1)),u=p.__importDefault(r(33)),v=p.__importDefault(r(2)),E=p.__importDefault(r(54)),y=p.__importDefault(r(9)),w=p.__importDefault(r(39)),f=p.__importStar(r(4)),_=p.__importDefault(r(16)),R=p.__importDefault(r(21)),D=i.default.Action,b=function(){};function g(l){if(l&&"params"in l&&!C.isObject(l.params))return new f.default("options.params must be an object",4e4,400);if(l&&"modes"in l){if(!C.isArray(l.modes))return new f.default("options.modes must be an array",4e4,400);for(var c=0;c<l.modes.length;c++){var a=l.modes[c];if(!a||typeof a!="string"||!C.arrIn(i.default.channelModes,String.prototype.toUpperCase.call(a)))return new f.default("Invalid channel mode: "+a,4e4,400)}}}var S=function(l){p.__extends(c,l);function c(a,x,d){var A=l.call(this,a,x,d)||this;return A.retryCount=0,A.history=function(B,O){if(v.default.logAction(v.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),O===void 0)if(typeof B=="function")O=B,B=null;else{if(this.rest.options.promises)return C.promisify(this,"history",arguments);O=b}if(B&&B.untilAttach){if(this.state!=="attached"){O(new f.default("option untilAttach requires the channel to be attached",4e4,400));return}if(!this.properties.attachSerial){O(new f.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));return}delete B.untilAttach,B.from_serial=this.properties.attachSerial}u.default.prototype._history.call(this,B,O)},A.whenState=function(B,O){return h.default.prototype.whenState.call(A,B,A.state,O)},v.default.logAction(v.default.LOG_MINOR,"RealtimeChannel()","started; name = "+x),A.realtime=a,A.presence=new E.default(A),A.connectionManager=a.connection.connectionManager,A.state="initialized",A.subscriptions=new h.default,A.syncChannelSerial=void 0,A.properties={attachSerial:void 0,channelSerial:void 0},A.setOptions(d),A.errorReason=null,A._requestedFlags=null,A._mode=null,A._attachResume=!1,A._decodingContext={channelOptions:A.channelOptions,plugins:a.options.plugins||{},baseEncodedPreviousPayload:void 0},A._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},A._allChannelChanges=new h.default,A}return c.prototype.invalidStateError=function(){return new f.default("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)},c.processListenerArgs=function(a){return a=Array.prototype.slice.call(a),typeof a[0]=="function"&&a.unshift(null),a[a.length-1]==null&&a.pop(),a},c.prototype.setOptions=function(a,x){var d=this.channelOptions;if(!x&&this.rest.options.promises)return C.promisify(this,"setOptions",arguments);var A=x||function(O){O&&v.default.logAction(v.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+O.toString())},B=g(a);if(B){A(B);return}u.default.prototype.setOptions.call(this,a),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(a,d)?(this.attachImpl(),this._allChannelChanges.once(["attached","update","detached","failed"],function(O){switch(this.event){case"update":case"attached":A==null||A(null);return;default:A==null||A(O.reason);return}})):A()},c.prototype._shouldReattachToSetOptions=function(a,x){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(a!=null&&a.params){var d=m(a.params),A=m(x.params);if(Object.keys(d).length!==Object.keys(A).length||!C.shallowEquals(A,d))return!0}return!!(a!=null&&a.modes&&(!x.modes||!C.arrEquals(a.modes,x.modes)))},c.prototype.publish=function(){for(var a=this,x=[],d=0;d<arguments.length;d++)x[d]=arguments[d];var A=x[0],B=x.length,O=x[B-1];if(typeof O!="function"){if(this.realtime.options.promises)return C.promisify(this,"publish",arguments);O=b,++B}if(!this.connectionManager.activeState()){O(this.connectionManager.getError());return}if(B==2)if(C.isObject(A))A=[y.default.fromValues(A)];else if(C.isArray(A))A=y.default.fromValuesArray(A);else throw new f.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else A=[y.default.fromValues({name:x[0],data:x[1]})];var k=this.realtime.options.maxMessageSize;y.default.encodeArray(A,this.channelOptions,function(F){if(F){O(F);return}var M=y.default.getMessagesSize(A);if(M>k){O(new f.default("Maximum size of messages that can be published at once exceeded ( was "+M+" bytes; limit is "+k+" bytes)",40009,400));return}a.__publish(A,O)})},c.prototype.__publish=function(a,x){v.default.logAction(v.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+a.length);var d=this.state;switch(d){case"failed":case"suspended":x(f.default.fromValues(this.invalidStateError()));break;default:{v.default.logAction(v.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+d);var A=new i.default;A.action=D.MESSAGE,A.channel=this.name,A.messages=a,this.sendMessage(A,x);break}}},c.prototype.onEvent=function(a){v.default.logAction(v.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var x=this.subscriptions,d=0;d<a.length;d++){var A=a[d];x.emit(A.name,A)}},c.prototype.attach=function(a,x){var d;if(typeof a=="function"?(x=a,d=null):d=a,!x){if(this.realtime.options.promises)return C.promisify(this,"attach",arguments);x=function(A){A&&v.default.logAction(v.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+A.toString())}}if(d)v.default.deprecated("The ability to pass an array of channel mode flags as the first argument of `RealtimeChannel.attach()`","To set channel mode flags, populate the `modes` property of the channel options object that you pass to `Channels.get()` or `RealtimeChannel.setOptions()`."),this._requestedFlags=d;else if(this.state==="attached"){x(null,null);return}this._attach(!1,null,x)},c.prototype._attach=function(a,x,d){d||(d=function(B){B&&v.default.logAction(v.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+B.toString())});var A=this.connectionManager;if(!A.activeState()){d(A.getError());return}(this.state!=="attaching"||a)&&this.requestState("attaching",x),this.once(function(B){switch(this.event){case"attached":d==null||d(null,B);break;case"detached":case"suspended":case"failed":d==null||d(B.reason||A.getError()||new f.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":d==null||d(new f.default("Attach request superseded by a subsequent detach request",9e4,409));break}})},c.prototype.attachImpl=function(){v.default.logAction(v.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");var a=i.default.fromValues({action:D.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?a.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&a.encodeModesToFlags(C.allToUpperCase(this.channelOptions.modes)),this._attachResume&&a.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(a.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(a,b)},c.prototype.detach=function(a){if(!a){if(this.realtime.options.promises)return C.promisify(this,"detach",arguments);a=b}var x=this.connectionManager;if(!x.activeState()){a(x.getError());return}switch(this.state){case"suspended":this.notifyState("detached"),a();break;case"detached":a();break;case"failed":a(new f.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once(function(d){switch(this.event){case"detached":a();break;case"attached":case"suspended":case"failed":a(d.reason||x.getError()||new f.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":a(new f.default("Detach request superseded by a subsequent attach request",9e4,409));break}})}},c.prototype.detachImpl=function(a){v.default.logAction(v.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");var x=i.default.fromValues({action:D.DETACH,channel:this.name});this.sendMessage(x,a||b)},c.prototype.subscribe=function(){for(var a=[],x=0;x<arguments.length;x++)a[x]=arguments[x];var d=c.processListenerArgs(a),A=d[0],B=d[1],O=d[2];if(!O&&this.realtime.options.promises)return C.promisify(this,"subscribe",[A,B]);if(this.state==="failed"){O==null||O(f.default.fromValues(this.invalidStateError()));return}return A&&typeof A=="object"&&!Array.isArray(A)?this._subscribeFilter(A,B):this.subscriptions.on(A,B),this.attach(O||b)},c.prototype._subscribeFilter=function(a,x){var d=function(A){var B,O,k,F,M,P,U={name:A.name,refTimeserial:(O=(B=A.extras)===null||B===void 0?void 0:B.ref)===null||O===void 0?void 0:O.timeserial,refType:(F=(k=A.extras)===null||k===void 0?void 0:k.ref)===null||F===void 0?void 0:F.type,isRef:!!(!((P=(M=A.extras)===null||M===void 0?void 0:M.ref)===null||P===void 0)&&P.timeserial),clientId:A.clientId};Object.entries(a).find(function(N){var H=N[0],G=N[1];return G!==void 0?U[H]!==G:!1})||x(A)};this._addFilteredSubscription(a,x,d),this.subscriptions.on(d)},c.prototype._addFilteredSubscription=function(a,x,d){var A;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(x)){var B=this.filteredSubscriptions.get(x);B.set(a,((A=B==null?void 0:B.get(a))===null||A===void 0?void 0:A.concat(d))||[d])}else this.filteredSubscriptions.set(x,new Map([[a,[d]]]))},c.prototype._getAndDeleteFilteredSubscriptions=function(a,x){var d=this;if(!this.filteredSubscriptions)return[];if(!x&&a)return Array.from(this.filteredSubscriptions.entries()).map(function(k){var F,M=k[0],P=k[1],U=P.get(a);return P.delete(a),P.size===0&&((F=d.filteredSubscriptions)===null||F===void 0||F.delete(M)),U}).reduce(function(k,F){var M;return F?(M=k).concat.apply(M,F):k},[]);if(!x||!this.filteredSubscriptions.has(x))return[];var A=this.filteredSubscriptions.get(x);if(!a){var B=Array.from(A.values()).reduce(function(k,F){return k.concat.apply(k,F)},[]);return this.filteredSubscriptions.delete(x),B}var O=A.get(a);return A.delete(a),O||[]},c.prototype.unsubscribe=function(){for(var a=this,x,d=[],A=0;A<arguments.length;A++)d[A]=arguments[A];var B=c.processListenerArgs(d),O=B[0],k=B[1];if(typeof O=="object"&&!k||!((x=this.filteredSubscriptions)===null||x===void 0)&&x.has(k)){this._getAndDeleteFilteredSubscriptions(O,k).forEach(function(F){return a.subscriptions.off(F)});return}this.subscriptions.off(O,k)},c.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new f.PartialErrorInfo("Unable to sync to channel; not attached",4e4)}var a=this.connectionManager;if(!a.activeState())throw a.getError();var x=i.default.fromValues({action:D.SYNC,channel:this.name});this.syncChannelSerial&&(x.channelSerial=this.syncChannelSerial),a.send(x)},c.prototype.sendMessage=function(a,x){this.connectionManager.send(a,this.realtime.options.queueMessages,x)},c.prototype.sendPresence=function(a,x){var d=i.default.fromValues({action:D.PRESENCE,channel:this.name,presence:C.isArray(a)?_.default.fromValuesArray(a):[_.default.fromValues(a)]});this.sendMessage(d,x)},c.prototype.onMessage=function(a){(a.action===D.ATTACHED||a.action===D.MESSAGE||a.action===D.PRESENCE)&&this.setChannelSerial(a.channelSerial);var x,d=!1;switch(a.action){case D.ATTACHED:{this.properties.attachSerial=a.channelSerial,this._mode=a.getMode(),this.params=a.params||{};var A=a.decodeModesFromFlags();this.modes=A&&C.allToLowerCase(A)||void 0;var B=a.hasFlag("RESUMED"),O=a.hasFlag("HAS_PRESENCE"),k=a.hasFlag("HAS_BACKLOG");if(this.state==="attached"){B||this.presence.onAttached(O);var F=new w.default(this.state,this.state,B,k,a.error);this._allChannelChanges.emit("update",F),(!B||this.channelOptions.updateOnAttached)&&this.emit("update",F)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",a.error,B,O,k);break}case D.DETACHED:{var M=a.error?f.default.fromValues(a.error):new f.default("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",M):this.state==="attaching"?this.notifyState("suspended",M):this.requestState("attaching",M);break}case D.SYNC:if(d=!0,x=this.syncChannelSerial=a.channelSerial,!a.presence)break;case D.PRESENCE:{for(var P=a.presence,U=a.id,N=a.connectionId,H=a.timestamp,G=this.channelOptions,z=void 0,j=0;j<P.length;j++)try{z=P[j],_.default.decode(z,G),z.connectionId||(z.connectionId=N),z.timestamp||(z.timestamp=H),z.id||(z.id=U+":"+j)}catch(ne){v.default.logAction(v.default.LOG_ERROR,"RealtimeChannel.onMessage()",ne.toString())}this.presence.setPresence(P,d,x);break}case D.MESSAGE:{if(this.state!=="attached"){v.default.logAction(v.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+a.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}var $=a.messages,I=$[0],L=$[$.length-1],U=a.id,N=a.connectionId,H=a.timestamp;if(I.extras&&I.extras.delta&&I.extras.delta.from!==this._lastPayload.messageId){var V='Delta message decode failure - previous message not available for message "'+a.id+'" on this channel "'+this.name+'".';v.default.logAction(v.default.LOG_ERROR,"RealtimeChannel.onMessage()",V),this._startDecodeFailureRecovery(new f.default(V,40018,400));break}for(var j=0;j<$.length;j++){var V=$[j];try{y.default.decode(V,this._decodingContext)}catch(re){switch(v.default.logAction(v.default.LOG_ERROR,"RealtimeChannel.onMessage()",re.toString()),re.code){case 40018:this._startDecodeFailureRecovery(re);return;case 40019:case 40021:this.notifyState("failed",re);return}}V.connectionId||(V.connectionId=N),V.timestamp||(V.timestamp=H),V.id||(V.id=U+":"+j)}this._lastPayload.messageId=L.id,this._lastPayload.protocolMessageChannelSerial=a.channelSerial,this.onEvent($);break}case D.ERROR:{var J=a.error;J&&J.code==80016?this.checkPendingState():this.notifyState("failed",f.default.fromValues(J));break}default:v.default.logAction(v.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+a.action+")"),this.connectionManager.abort(R.default.unknownChannelErr())}},c.prototype._startDecodeFailureRecovery=function(a){var x=this;this._lastPayload.decodeFailureRecoveryInProgress||(v.default.logAction(v.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,a,function(){x._lastPayload.decodeFailureRecoveryInProgress=!1}))},c.prototype.onAttached=function(){v.default.logAction(v.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},c.prototype.notifyState=function(a,x,d,A,B){if(v.default.logAction(v.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+a),this.clearStateTimer(),C.arrIn(["detached","suspended","failed"],a)&&(this.properties.channelSerial=null),a!==this.state){this.presence.actOnChannelState(a,A,x),a==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),x&&(this.errorReason=x);var O=new w.default(this.state,a,d,B,x),k=a==="failed"?v.default.LOG_ERROR:v.default.LOG_MAJOR;v.default.logAction(k,'Channel state for channel "'+this.name+'"',a+(x?"; reason: "+x:"")),a!=="attaching"&&a!=="suspended"&&(this.retryCount=0),a==="attached"&&this.onAttached(),a==="attached"?this._attachResume=!0:(a==="detaching"||a==="failed")&&(this._attachResume=!1),this.state=a,this._allChannelChanges.emit(a,O),this.emit(a,O)}},c.prototype.requestState=function(a,x){v.default.logAction(v.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+a),this.notifyState(a,x),this.checkPendingState()},c.prototype.checkPendingState=function(){var a=this.connectionManager.state;if(!(a.sendEvents||a.forceQueueEvents)){v.default.logAction(v.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(v.default.logAction(v.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}},c.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":{var a=new f.default("Channel attach timed out",90007,408);this.notifyState("suspended",a);break}case"detaching":{var a=new f.default("Channel detach timed out",90007,408);this.notifyState("attached",a);break}default:this.checkPendingState();break}},c.prototype.startStateTimerIfNotRunning=function(){var a=this;this.stateTimer||(this.stateTimer=setTimeout(function(){v.default.logAction(v.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),a.stateTimer=null,a.timeoutPendingState()},this.realtime.options.timeouts.realtimeRequestTimeout))},c.prototype.clearStateTimer=function(){var a=this.stateTimer;a&&(clearTimeout(a),this.stateTimer=null)},c.prototype.startRetryTimer=function(){var a=this;if(!this.retryTimer){this.retryCount++;var x=C.getRetryTime(this.realtime.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(function(){a.state==="suspended"&&a.connectionManager.state.sendEvents&&(a.retryTimer=null,v.default.logAction(v.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),a.requestState("attaching"))},x)}},c.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},c.prototype.getReleaseErr=function(){var a=this.state;return a==="initialized"||a==="detached"||a==="failed"?null:new f.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+a,90001,400)},c.prototype.setChannelSerial=function(a){v.default.logAction(v.default.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+a+"; previous = "+this.properties.channelSerial),a&&(this.properties.channelSerial=a)},c}(u.default);function m(l){var c=l||{};c.agent;var a=p.__rest(c,["agent"]);return a}t.default=S},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=function(){function i(h,C,u,v,E){this.previous=h,this.current=C,C==="attached"&&(this.resumed=u,this.hasBacklog=v),E&&(this.reason=E)}return i}();t.default=p},function(s,t,r){(function(p,i){s.exports=i(r(6))})(this,function(p){return function(){var i=p,h=i.lib,C=h.WordArray,u=h.Hasher,v=i.algo,E=[],y=v.SHA1=u.extend({_doReset:function(){this._hash=new C.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(w,f){for(var _=this._hash.words,R=_[0],D=_[1],b=_[2],g=_[3],S=_[4],m=0;m<80;m++){if(m<16)E[m]=w[f+m]|0;else{var l=E[m-3]^E[m-8]^E[m-14]^E[m-16];E[m]=l<<1|l>>>31}var c=(R<<5|R>>>27)+S+E[m];m<20?c+=(D&b|~D&g)+1518500249:m<40?c+=(D^b^g)+1859775393:m<60?c+=(D&b|D&g|b&g)-1894007588:c+=(D^b^g)-899497514,S=g,g=b,b=D<<30|D>>>2,D=R,R=c}_[0]=_[0]+R|0,_[1]=_[1]+D|0,_[2]=_[2]+b|0,_[3]=_[3]+g|0,_[4]=_[4]+S|0},_doFinalize:function(){var w=this._data,f=w.words,_=this._nDataBytes*8,R=w.sigBytes*8;return f[R>>>5]|=128<<24-R%32,f[(R+64>>>9<<4)+14]=Math.floor(_/4294967296),f[(R+64>>>9<<4)+15]=_,w.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var w=u.clone.call(this);return w._hash=this._hash.clone(),w}});i.SHA1=u._createHelper(y),i.HmacSHA1=u._createHmacHelper(y)}(),p.SHA1})},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});function p(m){if(m===void 0)return"undefined";var l,c;if(m instanceof ArrayBuffer?(c="ArrayBuffer",l=new DataView(m)):m instanceof DataView&&(c="DataView",l=m),!l)return JSON.stringify(m);for(var a=[],x=0;x<m.byteLength;x++){if(x>20){a.push("...");break}var d=l.getUint8(x).toString(16);d.length===1&&(d="0"+d),a.push(d)}return"<"+c+" "+a.join(" ")+">"}function i(m,l,c){for(var a=0,x=c.length;a<x;a++){var d=c.charCodeAt(a);if(d<128){m.setUint8(l++,d>>>0&127|0);continue}if(d<2048){m.setUint8(l++,d>>>6&31|192),m.setUint8(l++,d>>>0&63|128);continue}if(d<65536){m.setUint8(l++,d>>>12&15|224),m.setUint8(l++,d>>>6&63|128),m.setUint8(l++,d>>>0&63|128);continue}if(d<1114112){m.setUint8(l++,d>>>18&7|240),m.setUint8(l++,d>>>12&63|128),m.setUint8(l++,d>>>6&63|128),m.setUint8(l++,d>>>0&63|128);continue}throw new Error("bad codepoint "+d)}}function h(m,l,c){for(var a="",x=l,d=l+c;x<d;x++){var A=m.getUint8(x);if(!(A&128)){a+=String.fromCharCode(A);continue}if((A&224)===192){a+=String.fromCharCode((A&15)<<6|m.getUint8(++x)&63);continue}if((A&240)===224){a+=String.fromCharCode((A&15)<<12|(m.getUint8(++x)&63)<<6|(m.getUint8(++x)&63)<<0);continue}if((A&248)===240){a+=String.fromCharCode((A&7)<<18|(m.getUint8(++x)&63)<<12|(m.getUint8(++x)&63)<<6|(m.getUint8(++x)&63)<<0);continue}throw new Error("Invalid byte "+A.toString(16))}return a}function C(m){for(var l=0,c=0,a=m.length;c<a;c++){var x=m.charCodeAt(c);if(x<128){l+=1;continue}if(x<2048){l+=2;continue}if(x<65536){l+=3;continue}if(x<1114112){l+=4;continue}throw new Error("bad codepoint "+x)}return l}function u(m,l){var c=S(m,l);if(c!==0){var a=new ArrayBuffer(c),x=new DataView(a);return g(m,x,0,l),a}}var v=65536*65536,E=1/v;function y(m,l){return l=l||0,m.getInt32(l)*v+m.getUint32(l+4)}function w(m,l){return l=l||0,m.getUint32(l)*v+m.getUint32(l+4)}function f(m,l,c){c<9223372036854776e3?(m.setInt32(l,Math.floor(c*E)),m.setInt32(l+4,c&-1)):(m.setUint32(l,2147483647),m.setUint32(l+4,2147483647))}function _(m,l,c){c<18446744073709552e3?(m.setUint32(l,Math.floor(c*E)),m.setInt32(l+4,c&-1)):(m.setUint32(l,4294967295),m.setUint32(l+4,4294967295))}var R=function(){function m(l,c){var a=this;this.map=function(x){for(var d={},A=0;A<x;A++){var B=a.parse();d[B]=a.parse()}return d},this.bin=function(x){var d=new ArrayBuffer(x);return new Uint8Array(d).set(new Uint8Array(a.view.buffer,a.offset,x),0),a.offset+=x,d},this.buf=this.bin,this.str=function(x){var d=h(a.view,a.offset,x);return a.offset+=x,d},this.array=function(x){for(var d=new Array(x),A=0;A<x;A++)d[A]=a.parse();return d},this.ext=function(x){return a.offset+=x,{type:a.view.getInt8(a.offset),data:a.buf(x)}},this.parse=function(){var x=a.view.getUint8(a.offset),d,A;if(!(x&128))return a.offset++,x;if((x&240)===128)return A=x&15,a.offset++,a.map(A);if((x&240)===144)return A=x&15,a.offset++,a.array(A);if((x&224)===160)return A=x&31,a.offset++,a.str(A);if((x&224)===224)return d=a.view.getInt8(a.offset),a.offset++,d;switch(x){case 192:return a.offset++,null;case 193:a.offset++;return;case 194:return a.offset++,!1;case 195:return a.offset++,!0;case 196:return A=a.view.getUint8(a.offset+1),a.offset+=2,a.bin(A);case 197:return A=a.view.getUint16(a.offset+1),a.offset+=3,a.bin(A);case 198:return A=a.view.getUint32(a.offset+1),a.offset+=5,a.bin(A);case 199:return A=a.view.getUint8(a.offset+1),a.offset+=2,a.ext(A);case 200:return A=a.view.getUint16(a.offset+1),a.offset+=3,a.ext(A);case 201:return A=a.view.getUint32(a.offset+1),a.offset+=5,a.ext(A);case 202:return d=a.view.getFloat32(a.offset+1),a.offset+=5,d;case 203:return d=a.view.getFloat64(a.offset+1),a.offset+=9,d;case 204:return d=a.view.getUint8(a.offset+1),a.offset+=2,d;case 205:return d=a.view.getUint16(a.offset+1),a.offset+=3,d;case 206:return d=a.view.getUint32(a.offset+1),a.offset+=5,d;case 207:return d=w(a.view,a.offset+1),a.offset+=9,d;case 208:return d=a.view.getInt8(a.offset+1),a.offset+=2,d;case 209:return d=a.view.getInt16(a.offset+1),a.offset+=3,d;case 210:return d=a.view.getInt32(a.offset+1),a.offset+=5,d;case 211:return d=y(a.view,a.offset+1),a.offset+=9,d;case 212:return A=1,a.offset++,a.ext(A);case 213:return A=2,a.offset++,a.ext(A);case 214:return A=4,a.offset++,a.ext(A);case 215:return A=8,a.offset++,a.ext(A);case 216:return A=16,a.offset++,a.ext(A);case 217:return A=a.view.getUint8(a.offset+1),a.offset+=2,a.str(A);case 218:return A=a.view.getUint16(a.offset+1),a.offset+=3,a.str(A);case 219:return A=a.view.getUint32(a.offset+1),a.offset+=5,a.str(A);case 220:return A=a.view.getUint16(a.offset+1),a.offset+=3,a.array(A);case 221:return A=a.view.getUint32(a.offset+1),a.offset+=5,a.array(A);case 222:return A=a.view.getUint16(a.offset+1),a.offset+=3,a.map(A);case 223:return A=a.view.getUint32(a.offset+1),a.offset+=5,a.map(A)}throw new Error("Unknown type 0x"+x.toString(16))},this.offset=c||0,this.view=l}return m}();function D(m){var l=new DataView(m),c=new R(l),a=c.parse();if(c.offset!==m.byteLength)throw new Error(m.byteLength-c.offset+" trailing bytes");return a}function b(m,l){return Object.keys(m).filter(function(c){var a=m[c],x=typeof a;return(!l||a!=null)&&(x!=="function"||!!a.toJSON)})}function g(m,l,c,a){var x=typeof m;if(typeof m=="string"){var d=C(m);if(d<32)return l.setUint8(c,d|160),i(l,c+1,m),1+d;if(d<256)return l.setUint8(c,217),l.setUint8(c+1,d),i(l,c+2,m),2+d;if(d<65536)return l.setUint8(c,218),l.setUint16(c+1,d),i(l,c+3,m),3+d;if(d<4294967296)return l.setUint8(c,219),l.setUint32(c+1,d),i(l,c+5,m),5+d}if(ArrayBuffer.isView&&ArrayBuffer.isView(m)&&(m=m.buffer),m instanceof ArrayBuffer){var A=m.byteLength;if(A<256)return l.setUint8(c,196),l.setUint8(c+1,A),new Uint8Array(l.buffer).set(new Uint8Array(m),c+2),2+A;if(A<65536)return l.setUint8(c,197),l.setUint16(c+1,A),new Uint8Array(l.buffer).set(new Uint8Array(m),c+3),3+A;if(A<4294967296)return l.setUint8(c,198),l.setUint32(c+1,A),new Uint8Array(l.buffer).set(new Uint8Array(m),c+5),5+A}if(typeof m=="number"){if(Math.floor(m)!==m)return l.setUint8(c,203),l.setFloat64(c+1,m),9;if(m>=0){if(m<128)return l.setUint8(c,m),1;if(m<256)return l.setUint8(c,204),l.setUint8(c+1,m),2;if(m<65536)return l.setUint8(c,205),l.setUint16(c+1,m),3;if(m<4294967296)return l.setUint8(c,206),l.setUint32(c+1,m),5;if(m<18446744073709552e3)return l.setUint8(c,207),_(l,c+1,m),9;throw new Error("Number too big 0x"+m.toString(16))}if(m>=-32)return l.setInt8(c,m),1;if(m>=-128)return l.setUint8(c,208),l.setInt8(c+1,m),2;if(m>=-32768)return l.setUint8(c,209),l.setInt16(c+1,m),3;if(m>=-2147483648)return l.setUint8(c,210),l.setInt32(c+1,m),5;if(m>=-9223372036854776e3)return l.setUint8(c,211),f(l,c+1,m),9;throw new Error("Number too small -0x"+(-m).toString(16).substr(1))}if(x==="undefined")return a?0:(l.setUint8(c,212),l.setUint8(c+1,0),l.setUint8(c+2,0),3);if(m===null)return a?0:(l.setUint8(c,192),1);if(x==="boolean")return l.setUint8(c,m?195:194),1;if(typeof m.toJSON=="function")return g(m.toJSON(),l,c,a);if(x==="object"){var B,O=0,k=void 0,F=Array.isArray(m);if(F?B=m.length:(k=b(m,a),B=k.length),B<16?(l.setUint8(c,B|(F?144:128)),O=1):B<65536?(l.setUint8(c,F?220:222),l.setUint16(c+1,B),O=3):B<4294967296&&(l.setUint8(c,F?221:223),l.setUint32(c+1,B),O=5),F)for(var M=0;M<B;M++)O+=g(m[M],l,c+O,a);else if(k)for(var M=0;M<B;M++){var P=k[M];O+=g(P,l,c+O),O+=g(m[P],l,c+O,a)}return O}if(x==="function")return 0;throw new Error("Unknown type "+x)}function S(m,l){var c=typeof m;if(c==="string"){var a=C(m);if(a<32)return 1+a;if(a<256)return 2+a;if(a<65536)return 3+a;if(a<4294967296)return 5+a}if(ArrayBuffer.isView&&ArrayBuffer.isView(m)&&(m=m.buffer),m instanceof ArrayBuffer){var x=m.byteLength;if(x<256)return 2+x;if(x<65536)return 3+x;if(x<4294967296)return 5+x}if(typeof m=="number"){if(Math.floor(m)!==m)return 9;if(m>=0){if(m<128)return 1;if(m<256)return 2;if(m<65536)return 3;if(m<4294967296)return 5;if(m<18446744073709552e3)return 9;throw new Error("Number too big 0x"+m.toString(16))}if(m>=-32)return 1;if(m>=-128)return 2;if(m>=-32768)return 3;if(m>=-2147483648)return 5;if(m>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+m.toString(16).substr(1))}if(c==="boolean")return 1;if(m===null)return l?0:1;if(m===void 0)return l?0:3;if(typeof m.toJSON=="function")return S(m.toJSON(),l);if(c==="object"){var d,A=0;if(Array.isArray(m)){d=m.length;for(var B=0;B<d;B++)A+=S(m[B],l)}else{var O=b(m,l);d=O.length;for(var B=0;B<d;B++){var k=O[B];A+=S(k)+S(m[k],l)}}if(d<16)return 1+A;if(d<65536)return 3+A;if(d<4294967296)return 5+A;throw new Error("Array or object too long 0x"+d.toString(16))}if(c==="function")return 0;throw new Error("Unknown type "+c)}t.default={encode:u,decode:D,inspect:p,utf8Write:i,utf8Read:h,utf8ByteCount:C}},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importDefault(r(30)),h=p.__importDefault(r(50)),C=p.__importDefault(r(3)),u=p.__importDefault(r(4)),v=p.__importDefault(r(55)),E=p.__importDefault(r(57)),y=p.__importDefault(r(62)),w=p.__importDefault(r(64)),f=p.__importDefault(r(68)),_=p.__importDefault(r(2)),R=r(8),D=p.__importDefault(r(65)),b=p.__importDefault(r(66)),g=p.__importDefault(r(41)),S=(0,E.default)(w.default,v.default);C.default.Crypto=S,C.default.BufferUtils=v.default,C.default.Http=y.default,C.default.Config=w.default,C.default.Transports=f.default,C.default.WebStorage=D.default,i.default.Crypto=S,h.default.Crypto=S,_.default.initLogHandlers(),C.default.Defaults=(0,R.getDefaults)(b.default),C.default.Config.agent&&(C.default.Defaults.agent+=" "+C.default.Config.agent),C.default.Config.noUpgrade&&(C.default.Defaults.upgradeTransports=[]),t.default={ErrorInfo:u.default,Rest:i.default,Realtime:h.default,msgpack:g.default}},function(s){s.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.50","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**","src/**","react/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.5","ws":"^8.14.2"},"peerDependencies":{"react":">=16.8.0","react-dom":">=16.8.0"},"peerDependenciesMeta":{"react":{"optional":true},"react-dom":{"optional":true}},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@arethetypeswrong/cli":"^0.13.1","@babel/preset-env":"^7.23.6","@testing-library/react":"^13.3.0","@types/crypto-js":"^4.0.1","@types/jmespath":"^0.15.2","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","@vitejs/plugin-react":"^1.3.2","async":"ably-forks/async#requirejs","aws-sdk":"^2.1413.0","babel-loader":"^8.3.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"^2.8.5","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-import":"^2.28.0","eslint-plugin-jsdoc":"^40.0.0","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.6.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","jmespath":"^0.16.0","jsdom":"^20.0.0","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","mocha-junit-reporter":"^2.2.1","null-loader":"^4.0.1","playwright":"^1.39.0","prettier":"^2.5.1","react":">=18.1.0","react-dom":">=18.1.0","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^4.0.1","tslib":"^2.3.1","typedoc":"^0.23.8","typescript":"^4.6.4","vite":"^4.4.9","vitest":"^0.18.0","webpack":"^4.44.2","webpack-cli":"^4.2.0","webpack-node-externals":"^3.0.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"build"},"main":"ably"},"scripts":{"start:react":"npx vite serve","grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:node:skip-build":"grunt mocha","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","test:react":"vitest run","concat":"grunt concat","build":"grunt build:all && npm run build:react","build:node":"grunt build:node","build:browser":"grunt build:browser","build:react":"npm run build:react:mjs && npm run build:react:cjs && cp src/platform/react-hooks/res/package.react.json react/package.json","build:react:mjs":"tsc --project src/platform/react-hooks/tsconfig.mjs.json && cp src/platform/react-hooks/res/package.mjs.json react/mjs/package.json","build:react:cjs":"tsc --project src/platform/react-hooks/tsconfig.cjs.json && cp src/platform/react-hooks/res/package.cjs.json react/cjs/package.json","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js docs/chrome-mv3.md","format:check":"prettier --check --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js","docs":"typedoc --entryPoints ably.d.ts --out docs/generated/default --readme docs/landing-pages/default.md && typedoc --entryPoints promises.d.ts --out docs/generated/promises --name \\"ably (Promise-based)\\" --readme docs/landing-pages/promises.md && cp docs/landing-pages/choose-library.html docs/generated/index.html"}}')},function(s,t){},function(s,t,r){(function(p,i){s.exports=i(r(6),r(32),r(25))})(this,function(p){return p.HmacSHA256})},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importStar(r(1)),h=p.__importDefault(r(47)),C=p.__importDefault(r(15)),u=p.__importDefault(r(20)),v=p.__importDefault(r(4)),E=p.__importDefault(r(48)),y=function(){},w=function(){function D(b){this.rest=b,this.admin=new f(b)}return D}(),f=function(){function D(b){this.rest=b,this.deviceRegistrations=new _(b),this.channelSubscriptions=new R(b)}return D.prototype.publish=function(b,g,S){var m=this.rest,l=m.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,c=i.defaultPostHeaders(m.options,l),a={},x=i.mixin({recipient:b},g);if(typeof S!="function"){if(this.rest.options.promises)return i.promisify(this,"publish",arguments);S=y}m.options.headers&&i.mixin(c,m.options.headers),m.options.pushFullWait&&i.mixin(a,{fullWait:"true"});var d=i.encodeBody(x,l);C.default.post(m,"/push/publish",d,c,a,null,function(A){return S(A)})},D}(),_=function(){function D(b){this.rest=b}return D.prototype.save=function(b,g){var S=this.rest,m=h.default.fromValues(b),l=S.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,c=i.defaultPostHeaders(S.options,l),a={};if(typeof g!="function"){if(this.rest.options.promises)return i.promisify(this,"save",arguments);g=y}S.options.headers&&i.mixin(c,S.options.headers),S.options.pushFullWait&&i.mixin(a,{fullWait:"true"});var x=i.encodeBody(m,l);C.default.put(S,"/push/deviceRegistrations/"+encodeURIComponent(b.id),x,c,a,null,function(d,A,B,O){g(d,d?void 0:h.default.fromResponseBody(A,O?void 0:l))})},D.prototype.get=function(b,g){var S=this.rest,m=S.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,l=i.defaultGetHeaders(S.options,m),c=b.id||b;if(typeof g!="function"){if(this.rest.options.promises)return i.promisify(this,"get",arguments);g=y}if(typeof c!="string"||!c.length){g(new v.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400));return}S.options.headers&&i.mixin(l,S.options.headers),C.default.get(S,"/push/deviceRegistrations/"+encodeURIComponent(c),l,{},null,function(a,x,d,A){g(a,a?void 0:h.default.fromResponseBody(x,A?void 0:m))})},D.prototype.list=function(b,g){var S=this.rest,m=S.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,l=this.rest.http.supportsLinkHeaders?void 0:m,c=i.defaultGetHeaders(S.options,m);if(typeof g!="function"){if(this.rest.options.promises)return i.promisify(this,"list",arguments);g=y}S.options.headers&&i.mixin(c,S.options.headers),new u.default(S,"/push/deviceRegistrations",c,l,function(a,x,d){return h.default.fromResponseBody(a,d?void 0:m)}).get(b,g)},D.prototype.remove=function(b,g){var S=this.rest,m=S.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,l=i.defaultGetHeaders(S.options,m),c={},a=b.id||b;if(typeof g!="function"){if(this.rest.options.promises)return i.promisify(this,"remove",arguments);g=y}if(typeof a!="string"||!a.length){g(new v.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400));return}S.options.headers&&i.mixin(l,S.options.headers),S.options.pushFullWait&&i.mixin(c,{fullWait:"true"}),C.default.delete(S,"/push/deviceRegistrations/"+encodeURIComponent(a),l,c,null,function(x){return g(x)})},D.prototype.removeWhere=function(b,g){var S=this.rest,m=S.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,l=i.defaultGetHeaders(S.options,m);if(typeof g!="function"){if(this.rest.options.promises)return i.promisify(this,"removeWhere",arguments);g=y}S.options.headers&&i.mixin(l,S.options.headers),S.options.pushFullWait&&i.mixin(b,{fullWait:"true"}),C.default.delete(S,"/push/deviceRegistrations",l,b,null,function(c){return g(c)})},D}(),R=function(){function D(b){this.remove=D.prototype.removeWhere,this.rest=b}return D.prototype.save=function(b,g){var S=this.rest,m=E.default.fromValues(b),l=S.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,c=i.defaultPostHeaders(S.options,l),a={};if(typeof g!="function"){if(this.rest.options.promises)return i.promisify(this,"save",arguments);g=y}S.options.headers&&i.mixin(c,S.options.headers),S.options.pushFullWait&&i.mixin(a,{fullWait:"true"});var x=i.encodeBody(m,l);C.default.post(S,"/push/channelSubscriptions",x,c,a,null,function(d,A,B,O){g(d,!d&&E.default.fromResponseBody(A,O?void 0:l))})},D.prototype.list=function(b,g){var S=this.rest,m=S.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,l=this.rest.http.supportsLinkHeaders?void 0:m,c=i.defaultGetHeaders(S.options,m);if(typeof g!="function"){if(this.rest.options.promises)return i.promisify(this,"list",arguments);g=y}S.options.headers&&i.mixin(c,S.options.headers),new u.default(S,"/push/channelSubscriptions",c,l,function(a,x,d){return E.default.fromResponseBody(a,d?void 0:m)}).get(b,g)},D.prototype.removeWhere=function(b,g){var S=this.rest,m=S.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,l=i.defaultGetHeaders(S.options,m);if(typeof g!="function"){if(this.rest.options.promises)return i.promisify(this,"removeWhere",arguments);g=y}S.options.headers&&i.mixin(l,S.options.headers),S.options.pushFullWait&&i.mixin(b,{fullWait:"true"}),C.default.delete(S,"/push/channelSubscriptions",l,b,null,function(c){return g(c)})},D.prototype.listChannels=function(b,g){var S=this.rest,m=S.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,l=this.rest.http.supportsLinkHeaders?void 0:m,c=i.defaultGetHeaders(S.options,m);if(typeof g!="function"){if(this.rest.options.promises)return i.promisify(this,"listChannels",arguments);g=y}S.options.headers&&i.mixin(c,S.options.headers),S.options.pushFullWait&&i.mixin(b,{fullWait:"true"}),new u.default(S,"/push/channels",c,l,function(a,x,d){for(var A=!d&&m?i.decodeBody(a,m):a,B=0;B<A.length;B++)A[B]=String(A[B]);return A}).get(b,g)},D}();t.default=w},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importStar(r(1)),h=p.__importDefault(r(4)),C;(function(E){E.Phone="phone",E.Tablet="tablet",E.Desktop="desktop",E.TV="tv",E.Watch="watch",E.Car="car",E.Embedded="embedded",E.Other="other"})(C||(C={}));var u;(function(E){E.Android="android",E.IOS="ios",E.Browser="browser"})(u||(u={}));var v=function(){function E(){}return E.prototype.toJSON=function(){var y,w,f;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(y=this.push)===null||y===void 0?void 0:y.recipient,state:(w=this.push)===null||w===void 0?void 0:w.state,error:(f=this.push)===null||f===void 0?void 0:f.error}}},E.prototype.toString=function(){var y,w,f,_,R="[DeviceDetails";return this.id&&(R+="; id="+this.id),this.platform&&(R+="; platform="+this.platform),this.formFactor&&(R+="; formFactor="+this.formFactor),this.clientId&&(R+="; clientId="+this.clientId),this.metadata&&(R+="; metadata="+this.metadata),this.deviceIdentityToken&&(R+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),!((y=this.push)===null||y===void 0)&&y.recipient&&(R+="; push.recipient="+JSON.stringify(this.push.recipient)),!((w=this.push)===null||w===void 0)&&w.state&&(R+="; push.state="+this.push.state),!((f=this.push)===null||f===void 0)&&f.error&&(R+="; push.error="+JSON.stringify(this.push.error)),!((_=this.push)===null||_===void 0)&&_.metadata&&(R+="; push.metadata="+this.push.metadata),R+="]",R},E.fromResponseBody=function(y,w){return w&&(y=i.decodeBody(y,w)),i.isArray(y)?E.fromValuesArray(y):E.fromValues(y)},E.fromValues=function(y){return y.error=y.error&&h.default.fromValues(y.error),Object.assign(new E,y)},E.fromValuesArray=function(y){for(var w=y.length,f=new Array(w),_=0;_<w;_++)f[_]=E.fromValues(y[_]);return f},E.toRequestBody=i.encodeBody,E}();t.default=v},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importStar(r(1)),h=function(){function C(){}return C.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},C.prototype.toString=function(){var u="[PushChannelSubscription";return this.channel&&(u+="; channel="+this.channel),this.deviceId&&(u+="; deviceId="+this.deviceId),this.clientId&&(u+="; clientId="+this.clientId),u+="]",u},C.fromResponseBody=function(u,v){return v&&(u=i.decodeBody(u,v)),i.isArray(u)?C.fromValuesArray(u):C.fromValues(u)},C.fromValues=function(u){return Object.assign(new C,u)},C.fromValuesArray=function(u){for(var v=u.length,E=new Array(v),y=0;y<v;y++)E[y]=C.fromValues(u[y]);return E},C.toRequestBody=i.encodeBody,C}();t.default=h},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importStar(r(1)),h=function(){function S(m){this.count=m&&m.count||0,this.data=m&&m.data||0,this.uncompressedData=m&&m.uncompressedData||0,this.failed=m&&m.failed||0,this.refused=m&&m.refused||0}return S}(),C=function(S){p.__extends(m,S);function m(l){var c=S.call(this,l)||this;return l&&l.category&&(c.category={},i.forInOwnNonNullProperties(l.category,function(a){c.category[a]=new h(l.category[a])})),c}return m}(h),u=function(){function S(m){this.peak=m&&m.peak||0,this.min=m&&m.min||0,this.mean=m&&m.mean||0,this.opened=m&&m.opened||0,this.refused=m&&m.refused||0}return S}(),v=function(){function S(m){this.succeeded=m&&m.succeeded||0,this.failed=m&&m.failed||0,this.refused=m&&m.refused||0}return S}(),E=function(){function S(m){this.plain=new u(m&&m.plain),this.tls=new u(m&&m.tls),this.all=new u(m&&m.all)}return S}(),y=function(){function S(m){this.messages=new C(m&&m.messages),this.presence=new C(m&&m.presence),this.all=new C(m&&m.all)}return S}(),w=function(){function S(m){this.realtime=new y(m&&m.realtime),this.rest=new y(m&&m.rest),this.webhook=new y(m&&m.webhook),this.sharedQueue=new y(m&&m.sharedQueue),this.externalQueue=new y(m&&m.externalQueue),this.httpEvent=new y(m&&m.httpEvent),this.push=new y(m&&m.push),this.all=new y(m&&m.all)}return S}(),f=function(){function S(m){this.all=new y(m&&m.all),this.inbound=new w(m&&m.inbound),this.outbound=new w(m&&m.outbound)}return S}(),_=function(){function S(m){this.all=new y(m&&m.all),this.producerPaid=new f(m&&m.producerPaid),this.consumerPaid=new f(m&&m.consumerPaid)}return S}(),R=function(){function S(m){this.messages=m&&m.messages||0;var l=m&&m.notifications;this.notifications={invalid:l&&l.invalid||0,attempted:l&&l.attempted||0,successful:l&&l.successful||0,failed:l&&l.failed||0},this.directPublishes=m&&m.directPublishes||0}return S}(),D=function(){function S(m){this.succeeded=m&&m.succeeded||0,this.skipped=m&&m.skipped||0,this.failed=m&&m.failed||0}return S}(),b=function(){function S(m){var l=this;this.delta=void 0,m&&m.delta&&(this.delta={},i.forInOwnNonNullProperties(m.delta,function(c){l.delta[c]=new D(m.delta[c])}))}return S}(),g=function(S){p.__extends(m,S);function m(l){var c=S.call(this,l)||this;return c.persisted=new y(l&&l.persisted),c.connections=new E(l&&l.connections),c.channels=new u(l&&l.channels),c.apiRequests=new v(l&&l.apiRequests),c.tokenRequests=new v(l&&l.tokenRequests),c.xchgProducer=new _(l&&l.xchgProducer),c.xchgConsumer=new _(l&&l.xchgConsumer),c.push=new R(l&&l.pushStats),c.processed=new b(l&&l.processed),c.inProgress=l&&l.inProgress||void 0,c.unit=l&&l.unit||void 0,c.intervalId=l&&l.intervalId||void 0,c}return m.fromValues=function(l){return new m(l)},m}(f);t.default=g},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importStar(r(1)),h=p.__importDefault(r(30)),C=p.__importDefault(r(7)),u=p.__importDefault(r(2)),v=p.__importDefault(r(51)),E=p.__importDefault(r(38)),y=p.__importDefault(r(8)),w=p.__importDefault(r(4)),f=p.__importDefault(r(10)),_=p.__importDefault(r(35)),R=p.__importDefault(r(3)),D=p.__importDefault(r(9)),b=function(S){p.__extends(m,S);function m(l){var c=S.call(this,l)||this;return u.default.logAction(u.default.LOG_MINOR,"Realtime()",""),c.connection=new v.default(c,c.options),c.channels=new g(c),l.autoConnect!==!1&&c.connect(),c}return m.prototype.connect=function(){u.default.logAction(u.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},m.prototype.close=function(){u.default.logAction(u.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},m.Promise=function(l){return l=y.default.objectifyOptions(l),l.promises=!0,new m(l)},m.Callbacks=m,m.Utils=i,m.ConnectionManager=_.default,m.Platform=R.default,m.ProtocolMessage=f.default,m.Message=D.default,m}(h.default),g=function(S){p.__extends(m,S);function m(l){var c=S.call(this)||this;return c.realtime=l,c.all=Object.create(null),l.connection.connectionManager.on("transport.active",function(){c.onTransportActive()}),c}return m.prototype.channelSerials=function(){for(var l={},c=0,a=i.keysArray(this.all,!0);c<a.length;c++){var x=a[c],d=this.all[x];d.properties.channelSerial&&(l[x]=d.properties.channelSerial)}return l},m.prototype.recoverChannels=function(l){for(var c=0,a=i.keysArray(l,!0);c<a.length;c++){var x=a[c],d=this.get(x);d.properties.channelSerial=l[x]}},m.prototype.onChannelMessage=function(l){var c=l.channel;if(c===void 0){u.default.logAction(u.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+l.action);return}var a=this.all[c];if(!a){u.default.logAction(u.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+c);return}a.onMessage(l)},m.prototype.onTransportActive=function(){for(var l in this.all){var c=this.all[l];c.state==="attaching"||c.state==="detaching"?c.checkPendingState():c.state==="suspended"?c._attach(!1,null):c.state==="attached"&&c.requestState("attaching")}},m.prototype.propogateConnectionInterruption=function(l,c){var a={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},x=["attaching","attached","detaching","suspended"],d=a[l];for(var A in this.all){var B=this.all[A];i.arrIn(x,B.state)&&B.notifyState(d,c)}},m.prototype.get=function(l,c){l=String(l);var a=this.all[l];if(!a)a=this.all[l]=new E.default(this.realtime,l,c);else if(c){if(a._shouldReattachToSetOptions(c,a.channelOptions))throw new w.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);a.setOptions(c)}return a},m.prototype.getDerived=function(l,c,a){if(c.filter){var x=i.toBase64(c.filter),d=i.matchDerivedChannel(l);l="[filter=".concat(x).concat(d.qualifierParam,"]").concat(d.channelName)}return this.get(l,a)},m.prototype.release=function(l){l=String(l);var c=this.all[l];if(c){var a=c.getReleaseErr();if(a)throw a;delete this.all[l]}},m}(C.default);t.default=b},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importStar(r(1)),h=p.__importDefault(r(7)),C=p.__importDefault(r(35)),u=p.__importDefault(r(2)),v=p.__importDefault(r(37)),E=p.__importDefault(r(3));function y(){}var w=function(f){p.__extends(_,f);function _(R,D){var b=f.call(this)||this;return b.whenState=function(g,S){return h.default.prototype.whenState.call(b,g,b.state,S,new v.default(void 0,g))},b.ably=R,b.connectionManager=new C.default(R,D),b.state=b.connectionManager.state.state,b.key=void 0,b.id=void 0,b.errorReason=null,b.connectionManager.on("connectionstate",function(g){var S=b.state=g.current;E.default.Config.nextTick(function(){b.emit(S,g)})}),b.connectionManager.on("update",function(g){E.default.Config.nextTick(function(){b.emit("update",g)})}),b}return _.prototype.connect=function(){u.default.logAction(u.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},_.prototype.ping=function(R){if(u.default.logAction(u.default.LOG_MINOR,"Connection.ping()",""),!R){if(this.ably.options.promises)return i.promisify(this,"ping",arguments);R=y}this.connectionManager.ping(null,R)},_.prototype.close=function(){u.default.logAction(u.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},Object.defineProperty(_.prototype,"recoveryKey",{get:function(){return this.createRecoveryKey()},enumerable:!1,configurable:!0}),_.prototype.createRecoveryKey=function(){return this.connectionManager.createRecoveryKey()},_}(h.default);t.default=w},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.PendingMessage=void 0;var p=r(0),i=p.__importDefault(r(10)),h=p.__importStar(r(1)),C=p.__importDefault(r(7)),u=p.__importDefault(r(2)),v=p.__importDefault(r(36)),E=p.__importDefault(r(4)),y=i.default.Action,w=function(){function _(R,D){this.message=R,this.callback=D,this.merged=!1;var b=R.action;this.sendAttempted=!1,this.ackRequired=b==y.MESSAGE||b==y.PRESENCE}return _}();t.PendingMessage=w;var f=function(_){p.__extends(R,_);function R(D){var b=_.call(this)||this;return b.transport=D,b.messageQueue=new v.default,D.on("ack",function(g,S){b.onAck(g,S)}),D.on("nack",function(g,S,m){b.onNack(g,S,m)}),b}return R.prototype.onAck=function(D,b){u.default.logAction(u.default.LOG_MICRO,"Protocol.onAck()","serial = "+D+"; count = "+b),this.messageQueue.completeMessages(D,b)},R.prototype.onNack=function(D,b,g){u.default.logAction(u.default.LOG_ERROR,"Protocol.onNack()","serial = "+D+"; count = "+b+"; err = "+h.inspectError(g)),g||(g=new E.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(D,b,g)},R.prototype.onceIdle=function(D){var b=this.messageQueue;if(b.count()===0){D();return}b.once("idle",D)},R.prototype.send=function(D){D.ackRequired&&this.messageQueue.push(D),u.default.shouldLog(u.default.LOG_MICRO)&&u.default.logAction(u.default.LOG_MICRO,"Protocol.send()","sending msg; "+i.default.stringify(D.message)),D.sendAttempted=!0,this.transport.send(D.message)},R.prototype.getTransport=function(){return this.transport},R.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},R.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},R.prototype.finish=function(){var D=this.transport;this.onceIdle(function(){D.disconnect()})},R}(C.default);t.default=f},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importDefault(r(3)),h=p.__importStar(r(1)),C=p.__importDefault(r(26)),u=p.__importDefault(r(8)),v=p.__importDefault(r(2)),E=p.__importDefault(r(10)),y=p.__importDefault(r(4)),w="web_socket";function f(D){return!!D.on}var _=function(D){p.__extends(b,D);function b(g,S,m){var l=D.call(this,g,S,m)||this;return l.shortName=w,m.heartbeats=i.default.Config.useProtocolHeartbeats,l.wsHost=u.default.getHost(m.options,m.host,!0),l}return b.isAvailable=function(){return!!i.default.Config.WebSocket},b.prototype.createWebSocket=function(g,S){return this.uri=g+h.toQueryString(S),new i.default.Config.WebSocket(this.uri)},b.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},b.prototype.connect=function(){v.default.logAction(v.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),C.default.prototype.connect.call(this);var g=this,S=this.params,m=S.options,l=m.tls?"wss://":"ws://",c=l+this.wsHost+":"+u.default.getPort(m)+"/";v.default.logAction(v.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+c),this.auth.getAuthParams(function(a,x){if(!g.isDisposed){var d="";for(var A in x)d+=" "+A+": "+x[A]+";";if(v.default.logAction(v.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+d+" err: "+a),a){g.disconnect(a);return}var B=S.getConnectParams(x);try{var O=g.wsConnection=g.createWebSocket(c,B);O.binaryType=i.default.Config.binaryType,O.onopen=function(){g.onWsOpen()},O.onclose=function(k){g.onWsClose(k)},O.onmessage=function(k){g.onWsData(k.data)},O.onerror=function(k){g.onWsError(k)},f(O)&&O.on("ping",function(){g.onActivity()})}catch(k){v.default.logAction(v.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(k.stack||k.message)),g.disconnect(k)}}})},b.prototype.send=function(g){var S=this.wsConnection;if(!S){v.default.logAction(v.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{S.send(E.default.serialize(g,this.params.format))}catch(l){var m="Exception from ws connection when trying to send: "+h.inspectError(l);v.default.logAction(v.default.LOG_ERROR,"WebSocketTransport.send()",m),this.finish("disconnected",new y.default(m,5e4,500))}},b.prototype.onWsData=function(g){v.default.logAction(v.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+g.length+"; type = "+typeof g);try{this.onProtocolMessage(E.default.deserialize(g,this.format))}catch(S){v.default.logAction(v.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+S.stack)}},b.prototype.onWsOpen=function(){v.default.logAction(v.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},b.prototype.onWsClose=function(g){var S,m;if(typeof g=="object"?(m=g.code,S=g.wasClean||m===1e3):(m=g,S=m==1e3),delete this.wsConnection,S){v.default.logAction(v.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var l=new y.default("Websocket closed",80003,400);this.finish("disconnected",l)}else{var c="Unclean disconnection of WebSocket ; code = "+m,l=new y.default(c,80003,400);v.default.logAction(v.default.LOG_MINOR,"WebSocketTransport.onWsClose()",c),this.finish("disconnected",l)}this.emit("disposed")},b.prototype.onWsError=function(g){var S=this;v.default.logAction(v.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+g.message),i.default.Config.nextTick(function(){S.disconnect(Error(g.message))})},b.prototype.dispose=function(){v.default.logAction(v.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var g=this.wsConnection;g&&(g.onmessage=function(){},delete this.wsConnection,i.default.Config.nextTick(function(){if(v.default.logAction(v.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!g)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");g.close()}))},b}(C.default);function R(D){return _.isAvailable()&&(D.supportedTransports[w]=_),_}t.default=R},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importStar(r(1)),h=p.__importDefault(r(34)),C=p.__importDefault(r(7)),u=p.__importDefault(r(2)),v=p.__importDefault(r(16)),E=p.__importStar(r(4)),y=p.__importDefault(r(38)),w=p.__importDefault(r(24)),f=p.__importDefault(r(39)),_=function(){};function R(l){return l.channel.realtime.auth.clientId}function D(l){var c=l.channel.realtime,a=c.auth.clientId;return(!a||a==="*")&&c.connection.state==="connected"}function b(l,c,a){switch(l.state){case"attached":case"suspended":a();break;case"initialized":case"detached":case"detaching":case"attaching":l.attach(function(x){x?c(x):a()});break;default:c(E.default.fromValues(l.invalidStateError()))}}function g(l,c){if(l.isSynthesized()||c.isSynthesized())return l.timestamp>=c.timestamp;var a=l.parseId(),x=c.parseId();return a.msgSerial===x.msgSerial?a.index>x.index:a.msgSerial>x.msgSerial}var S=function(l){p.__extends(c,l);function c(a){var x=l.call(this,a)||this;return x.channel=a,x.syncComplete=!1,x.members=new m(x,function(d){return d.clientId+":"+d.connectionId}),x._myMembers=new m(x,function(d){return d.clientId}),x.subscriptions=new C.default,x.pendingPresence=[],x}return c.prototype.enter=function(a,x){if(D(this))throw new E.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,a,"enter",x)},c.prototype.update=function(a,x){if(D(this))throw new E.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,a,"update",x)},c.prototype.enterClient=function(a,x,d){return this._enterOrUpdateClient(void 0,a,x,"enter",d)},c.prototype.updateClient=function(a,x,d){return this._enterOrUpdateClient(void 0,a,x,"update",d)},c.prototype._enterOrUpdateClient=function(a,x,d,A,B){var O=this;if(!B)if(typeof d=="function")B=d,d=null;else{if(this.channel.realtime.options.promises)return i.promisify(this,"_enterOrUpdateClient",[a,x,d,A]);B=_}var k=this.channel;if(!k.connectionManager.activeState()){B(k.connectionManager.getError());return}u.default.logAction(u.default.LOG_MICRO,"RealtimePresence."+A+"Client()","channel = "+k.name+", id = "+a+", client = "+(x||"(implicit) "+R(this)));var F=v.default.fromData(d);F.action=A,a&&(F.id=a),x&&(F.clientId=x),v.default.encode(F,k.channelOptions,function(M){if(M){B(M);return}switch(k.state){case"attached":k.sendPresence(F,B);break;case"initialized":case"detached":k.attach();case"attaching":O.pendingPresence.push({presence:F,callback:B});break;default:M=new E.PartialErrorInfo("Unable to "+A+" presence channel while in "+k.state+" state",90001),M.code=90001,B(M)}})},c.prototype.leave=function(a,x){if(D(this))throw new E.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,a,x)},c.prototype.leaveClient=function(a,x,d){if(!d)if(typeof x=="function")d=x,x=null;else{if(this.channel.realtime.options.promises)return i.promisify(this,"leaveClient",[a,x]);d=_}var A=this.channel;if(!A.connectionManager.activeState()){d==null||d(A.connectionManager.getError());return}u.default.logAction(u.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+a);var B=v.default.fromData(x);switch(B.action="leave",a&&(B.clientId=a),A.state){case"attached":A.sendPresence(B,d);break;case"attaching":this.pendingPresence.push({presence:B,callback:d});break;case"initialized":case"failed":{var O=new E.PartialErrorInfo("Unable to leave presence channel (incompatible state)",90001);d==null||d(O);break}default:d==null||d(A.invalidStateError())}},c.prototype.get=function(a,x){var d=this,A=Array.prototype.slice.call(arguments);A.length==1&&typeof A[0]=="function"&&A.unshift(null),a=A[0],x=A[1];var B=!a||("waitForSync"in a?a.waitForSync:!0);if(!x){if(this.channel.realtime.options.promises)return i.promisify(this,"get",A);x=_}function O(k){x(null,a?k.list(a):k.values())}if(this.channel.state==="suspended"){B?x(E.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):O(this.members);return}b(this.channel,x,function(){var k=d.members;B?k.waitSync(function(){O(k)}):O(k)})},c.prototype.history=function(a,x){if(u.default.logAction(u.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),x===void 0)if(typeof a=="function")x=a,a=null;else{if(this.channel.realtime.options.promises)return i.promisify(this,"history",arguments);x=_}a&&a.untilAttach&&(this.channel.state==="attached"?(delete a.untilAttach,a.from_serial=this.channel.properties.attachSerial):x(new E.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),h.default.prototype._history.call(this,a,x)},c.prototype.setPresence=function(a,x,d){u.default.logAction(u.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+a.length+" participants; syncChannelSerial = "+d);var A,B,O=this.members,k=this._myMembers,F=[],M=this.channel.connectionManager.connectionId;x&&(this.members.startSync(),d&&(B=d.match(/^[\w-]+:(.*)$/))&&(A=B[1]));for(var P=0;P<a.length;P++){var U=v.default.fromValues(a[P]);switch(U.action){case"leave":O.remove(U)&&F.push(U),U.connectionId===M&&!U.isSynthesized()&&k.remove(U);break;case"enter":case"present":case"update":O.put(U)&&F.push(U),U.connectionId===M&&k.put(U);break}}x&&!A&&(O.endSync(),this.channel.syncChannelSerial=null);for(var P=0;P<F.length;P++){var U=F[P];this.subscriptions.emit(U.action,U)}},c.prototype.onAttached=function(a){u.default.logAction(u.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+a),a?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();var x=this.pendingPresence,d=x.length;if(d){this.pendingPresence=[];var A=[],B=w.default.create();u.default.logAction(u.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+d+" queued presence messages");for(var O=0;O<d;O++){var k=x[O];A.push(k.presence),B.push(k.callback)}this.channel.sendPresence(A,B)}},c.prototype.actOnChannelState=function(a,x,d){switch(a){case"attached":this.onAttached(x);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(d);break}},c.prototype.failPendingPresence=function(a){if(this.pendingPresence.length){u.default.logAction(u.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+i.inspectError(a));for(var x=0;x<this.pendingPresence.length;x++)try{this.pendingPresence[x].callback(a)}catch{}this.pendingPresence=[]}},c.prototype._clearMyMembers=function(){this._myMembers.clear()},c.prototype._ensureMyMembersPresent=function(){var a=this,x=this._myMembers,d=function(O){if(O){var k="Presence auto-re-enter failed: "+O.toString(),F=new E.default(k,91004,400);u.default.logAction(u.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",k);var M=new f.default(a.channel.state,a.channel.state,!0,!1,F);a.channel.emit("update",M)}};for(var A in x.map){var B=x.map[A];u.default.logAction(u.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+B.clientId+'" into the presence set'),this._enterOrUpdateClient(B.id,B.clientId,B.data,"enter",d)}},c.prototype._synthesizeLeaves=function(a){var x=this.subscriptions;i.arrForEach(a,function(d){var A=v.default.fromValues({action:"leave",connectionId:d.connectionId,clientId:d.clientId,data:d.data,encoding:d.encoding,timestamp:i.now()});x.emit("leave",A)})},c.prototype.on=function(){for(var a=[],x=0;x<arguments.length;x++)a[x]=arguments[x];u.default.renamedMethod("RealtimePresence","on","subscribe"),this.subscribe.apply(this,a)},c.prototype.off=function(){for(var a=[],x=0;x<arguments.length;x++)a[x]=arguments[x];u.default.renamedMethod("RealtimePresence","off","unsubscribe"),this.unsubscribe.apply(this,a)},c.prototype.subscribe=function(){for(var a=[],x=0;x<arguments.length;x++)a[x]=arguments[x];var d=y.default.processListenerArgs(a),A=d[0],B=d[1],O=d[2],k=this.channel;if(!O){if(this.channel.realtime.options.promises)return i.promisify(this,"subscribe",[A,B]);O=_}if(k.state==="failed"){O(E.default.fromValues(k.invalidStateError()));return}this.subscriptions.on(A,B),k.attach(O)},c.prototype.unsubscribe=function(){for(var a=[],x=0;x<arguments.length;x++)a[x]=arguments[x];var d=y.default.processListenerArgs(a),A=d[0],B=d[1];this.subscriptions.off(A,B)},c}(h.default),m=function(l){p.__extends(c,l);function c(a,x){var d=l.call(this)||this;return d.presence=a,d.map=Object.create(null),d.syncInProgress=!1,d.residualMembers=null,d.memberKey=x,d}return c.prototype.get=function(a){return this.map[a]},c.prototype.getClient=function(a){var x=this.map,d=[];for(var A in x){var B=x[A];B.clientId==a&&B.action!="absent"&&d.push(B)}return d},c.prototype.list=function(a){var x=this.map,d=a&&a.clientId,A=a&&a.connectionId,B=[];for(var O in x){var k=x[O];k.action!=="absent"&&(d&&d!=k.clientId||A&&A!=k.connectionId||B.push(k))}return B},c.prototype.put=function(a){(a.action==="enter"||a.action==="update")&&(a=v.default.fromValues(a),a.action="present");var x=this.map,d=this.memberKey(a);this.residualMembers&&delete this.residualMembers[d];var A=x[d];return A&&!g(a,A)?!1:(x[d]=a,!0)},c.prototype.values=function(){var a=this.map,x=[];for(var d in a){var A=a[d];A.action!="absent"&&x.push(A)}return x},c.prototype.remove=function(a){var x=this.map,d=this.memberKey(a),A=x[d];return A&&!g(a,A)?!1:(this.syncInProgress?(a=v.default.fromValues(a),a.action="absent",x[d]=a):delete x[d],!0)},c.prototype.startSync=function(){var a=this.map,x=this.syncInProgress;u.default.logAction(u.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+x),this.syncInProgress||(this.residualMembers=i.copy(a),this.setInProgress(!0))},c.prototype.endSync=function(){var a=this.map,x=this.syncInProgress;if(u.default.logAction(u.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+x),x){for(var d in a){var A=a[d];A.action==="absent"&&delete a[d]}this.presence._synthesizeLeaves(i.valuesArray(this.residualMembers));for(var d in this.residualMembers)delete a[d];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},c.prototype.waitSync=function(a){var x=this.syncInProgress;if(u.default.logAction(u.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+x),!x){a();return}this.once("sync",a)},c.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},c.prototype.setInProgress=function(a){u.default.logAction(u.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+a),this.syncInProgress=a,this.presence.syncComplete=!a},c}(C.default);t.default=S},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=r(56),h=r(31),C=r(11),u=p.__importDefault(r(5)),v=p.__importDefault(r(3)),E=function(){function y(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return y.prototype.isWordArray=function(w){return w!=null&&w.sigBytes!==void 0},y.prototype.isArrayBuffer=function(w){return w!=null&&w.constructor===ArrayBuffer},y.prototype.isTypedArray=function(w){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(w)},y.prototype.uint8ViewToBase64=function(w){for(var f="",_=this.base64CharSet,R=w.byteLength,D=R%3,b=R-D,g,S,m,l,c,a=0;a<b;a=a+3)c=w[a]<<16|w[a+1]<<8|w[a+2],g=(c&16515072)>>18,S=(c&258048)>>12,m=(c&4032)>>6,l=c&63,f+=_[g]+_[S]+_[m]+_[l];return D==1?(c=w[b],g=(c&252)>>2,S=(c&3)<<4,f+=_[g]+_[S]+"=="):D==2&&(c=w[b]<<8|w[b+1],g=(c&64512)>>10,S=(c&1008)>>4,m=(c&15)<<2,f+=_[g]+_[S]+_[m]+"="),f},y.prototype.base64ToArrayBuffer=function(w){for(var f=atob==null?void 0:atob(w),_=f.length,R=new Uint8Array(_),D=0;D<_;D++){var b=f.charCodeAt(D);R[D]=b}return R.buffer},y.prototype.isBuffer=function(w){return this.isArrayBuffer(w)||this.isWordArray(w)||this.isTypedArray(w)},y.prototype.toBuffer=function(w){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(w))return new Uint8Array(w);if(this.isTypedArray(w))return new Uint8Array(w.buffer);if(this.isWordArray(w)){for(var f=new ArrayBuffer(w.sigBytes),_=new Uint8Array(f),R=0;R<w.sigBytes;R++)_[R]=w.words[R>>>2]>>>24-R%4*8&255;return _}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},y.prototype.toArrayBuffer=function(w){return this.isArrayBuffer(w)?w:this.toBuffer(w).buffer},y.prototype.toWordArray=function(w){return this.isTypedArray(w)&&(w=w.buffer),this.isWordArray(w)?w:u.default.create(w)},y.prototype.base64Encode=function(w){return this.isWordArray(w)?(0,C.stringify)(w):this.uint8ViewToBase64(this.toBuffer(w))},y.prototype.base64Decode=function(w){return ArrayBuffer&&v.default.Config.atob?this.base64ToArrayBuffer(w):(0,C.parse)(w)},y.prototype.hexEncode=function(w){return(0,i.stringify)(this.toWordArray(w))},y.prototype.hexDecode=function(w){var f=(0,i.parse)(w);return ArrayBuffer?this.toArrayBuffer(f):f},y.prototype.utf8Encode=function(w){return v.default.Config.TextEncoder?new v.default.Config.TextEncoder().encode(w).buffer:(0,h.parse)(w)},y.prototype.utf8Decode=function(w){if(!this.isBuffer(w))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(w)?new TextDecoder().decode(w):(w=this.toWordArray(w),(0,h.stringify)(w))},y.prototype.bufferCompare=function(w,f){if(!w)return-1;if(!f)return 1;var _=this.toWordArray(w),R=this.toWordArray(f);_.clamp(),R.clamp();var D=_.sigBytes-R.sigBytes;if(D!=0)return D;for(var b=_.words,g=R.words,S=0;S<b.length;S++)if(D=b[S]-g[S],D!=0)return D;return 0},y.prototype.byteLength=function(w){return this.isArrayBuffer(w)||this.isTypedArray(w)?w.byteLength:this.isWordArray(w)?w.sigBytes:-1},y.prototype.typedArrayToBuffer=function(w){return w.buffer},y}();t.default=new E},function(s,t,r){(function(p,i){s.exports=i(r(6))})(this,function(p){return p.enc.Hex})},function(s,t,r){r.r(t);var p=r(5),i=r.n(p),h=r(11),C=r(23),u=r.n(C),v=r(2),E=r.n(v),y=r(4),w=r.n(y),f=function(_,R){var D="aes",b=256,g="cbc",S=16,m=4,l=4294967296,c=2147483648,a;if(_.getRandomWordArray)a=_.getRandomWordArray;else if(typeof Uint32Array<"u"&&_.getRandomValues){var x=new Uint32Array(m);a=function(P,U){var N=P/4,H=N==m?x:new Uint32Array(N);_.getRandomValues(H,function(G){typeof U<"u"&&U(G,R.toWordArray(H))})}}else a=function(P,U){E.a.logAction(E.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var N=P/4,H=new Array(N),G=0;G<N;G++)H[G]=Math.floor(Math.random()*l)-c;U(null,i.a.create(H))};function d(P){return P+S&-16}function A(P){if(P.algorithm==="aes"&&P.mode==="cbc"){if(P.keyLength===128||P.keyLength===256)return;throw new Error("Unsupported key length "+P.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function B(P){return P.replace("_","/").replace("-","+")}var O=[i.a.create([269488144,269488144,269488144,269488144],16),i.a.create([16777216],1),i.a.create([33685504],2),i.a.create([50529024],3),i.a.create([67372036],4),i.a.create([84215045,83886080],5),i.a.create([101058054,101056512],6),i.a.create([117901063,117901056],7),i.a.create([134744072,134744072],8),i.a.create([151587081,151587081,150994944],9),i.a.create([168430090,168430090,168427520],10),i.a.create([185273099,185273099,185273088],11),i.a.create([202116108,202116108,202116108],12),i.a.create([218959117,218959117,218959117,218103808],13),i.a.create([235802126,235802126,235802126,235798528],14),i.a.create([252645135,252645135,252645135,252645135],15),i.a.create([269488144,269488144,269488144,269488144],16)];function k(){}function F(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}k.CipherParams=F,k.getDefaultParams=function(P){var U;if(typeof P=="function"||typeof P=="string"){if(E.a.deprecated("The ability to pass a callback to `Crypto.getDefaultParams()`","This method now directly returns its result, instead of returning it asynchronously via a callback. Please update your code so that it uses the return value of this method instead of passing a callback."),typeof P=="function")E.a.deprecated("The ability to call `Crypto.getDefaultParams()` without specifying an encryption key","Please update your code so that it instead passes an object whose `key` property contains an encryption key. That is, replace `Crypto.getDefaultParams()` with `Crypto.getDefaultParams({ key })`, where `key` is an encryption key that you have generated (for example from the `Crypto.generateRandomKey()` method)."),k.generateRandomKey(function(H){P(null,k.getDefaultParams({key:H}))});else if(typeof arguments[1]=="function")E.a.deprecated("The ability to pass the encryption key as the first argument of `Crypto.getDefaultParams()`","Please update your code so that it instead passes an object whose `key` property contains the key. That is, replace `Crypto.getDefaultParams(key)` with `Crypto.getDefaultParams({ key })`."),arguments[1](null,k.getDefaultParams({key:P}));else throw new Error("Invalid arguments for Crypto.getDefaultParams");return}if(!P.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof P.key=="string"?U=Object(h.parse)(B(P.key)):U=R.toWordArray(P.key);var N=new F;if(N.key=U,N.algorithm=P.algorithm||D,N.keyLength=U.words.length*(4*8),N.mode=P.mode||g,P.keyLength&&P.keyLength!==N.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+P.keyLength+" was specified, but the key actually has length "+N.keyLength);return A(N),N},k.generateRandomKey=function(P,U){arguments.length==1&&typeof P=="function"&&(U=P,P=void 0),a((P||b)/8,function(N,H){U!==void 0&&U(N?w.a.fromValues(N):null,H)})},k.getCipher=function(P){var U=P instanceof F?P:k.getDefaultParams(P);return{cipherParams:U,cipher:new M(U,m,P.iv)}};function M(P,U,N){this.algorithm=P.algorithm+"-"+String(P.keyLength)+"-"+P.mode,this.cjsAlgorithm=P.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=R.toWordArray(P.key),N&&(this.iv=R.toWordArray(N).clone()),this.blockLengthWords=U}return M.prototype.encrypt=function(P,U){E.a.logAction(E.a.LOG_MICRO,"CBCCipher.encrypt()",""),P=R.toWordArray(P);var N=P.sigBytes,H=d(N),G=this,z=function(){G.getIv(function(j,$){if(j){U(j);return}var I=G.encryptCipher.process(P.concat(O[H-N])),L=$.concat(I);U(null,L)})};this.encryptCipher?z():this.iv?(this.encryptCipher=u.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),z()):a(S,function(j,$){if(j){U(j);return}G.encryptCipher=u.a.algo[G.cjsAlgorithm].createEncryptor(G.key,{iv:$}),G.iv=$,z()})},M.prototype.decrypt=function(P){E.a.logAction(E.a.LOG_MICRO,"CBCCipher.decrypt()",""),P=R.toWordArray(P);var U=this.blockLengthWords,N=P.words,H=i.a.create(N.slice(0,U)),G=i.a.create(N.slice(U)),z=u.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:H}),j=z.process(G),$=z.finalize();return z.reset(),$&&$.sigBytes&&j.concat($),j},M.prototype.getIv=function(P){if(this.iv){var U=this.iv;this.iv=null,P(null,U);return}var N=this;a(S,function(H,G){if(H){P(H);return}P(null,N.encryptCipher.process(G))})},k};t.default=f},function(s,t,r){(function(p,i){s.exports=i(r(6))})(this,function(p){return function(){var i=p,h=i.lib,C=h.WordArray,u=i.enc;u.Utf16=u.Utf16BE={stringify:function(E){for(var y=E.words,w=E.sigBytes,f=[],_=0;_<w;_+=2){var R=y[_>>>2]>>>16-_%4*8&65535;f.push(String.fromCharCode(R))}return f.join("")},parse:function(E){for(var y=E.length,w=[],f=0;f<y;f++)w[f>>>1]|=E.charCodeAt(f)<<16-f%2*16;return C.create(w,y*2)}},u.Utf16LE={stringify:function(E){for(var y=E.words,w=E.sigBytes,f=[],_=0;_<w;_+=2){var R=v(y[_>>>2]>>>16-_%4*8&65535);f.push(String.fromCharCode(R))}return f.join("")},parse:function(E){for(var y=E.length,w=[],f=0;f<y;f++)w[f>>>1]|=v(E.charCodeAt(f)<<16-f%2*16);return C.create(w,y*2)}};function v(E){return E<<8&4278255360|E>>>8&16711935}}(),p.enc.Utf16})},function(s,t,r){(function(p,i){s.exports=i(r(6),r(28))})(this,function(p){return function(i){var h=p,C=h.lib,u=C.CipherParams,v=h.enc,E=v.Hex,y=h.format;y.Hex={stringify:function(w){return w.ciphertext.toString(E)},parse:function(w){var f=E.parse(w);return u.create({ciphertext:f})}}}(),p.format.Hex})},function(s,t,r){(function(p,i){s.exports=i(r(6),r(11),r(61),r(27),r(28))})(this,function(p){return function(){var i=p,h=i.lib,C=h.BlockCipher,u=i.algo,v=[],E=[],y=[],w=[],f=[],_=[],R=[],D=[],b=[],g=[];(function(){for(var l=[],c=0;c<256;c++)c<128?l[c]=c<<1:l[c]=c<<1^283;for(var a=0,x=0,c=0;c<256;c++){var d=x^x<<1^x<<2^x<<3^x<<4;d=d>>>8^d&255^99,v[a]=d,E[d]=a;var A=l[a],B=l[A],O=l[B],k=l[d]*257^d*16843008;y[a]=k<<24|k>>>8,w[a]=k<<16|k>>>16,f[a]=k<<8|k>>>24,_[a]=k;var k=O*16843009^B*65537^A*257^a*16843008;R[d]=k<<24|k>>>8,D[d]=k<<16|k>>>16,b[d]=k<<8|k>>>24,g[d]=k,a?(a=A^l[l[l[O^A]]],x^=l[l[x]]):a=x=1}})();var S=[0,1,2,4,8,16,32,64,128,27,54],m=u.AES=C.extend({_doReset:function(){var l;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var c=this._keyPriorReset=this._key,a=c.words,x=c.sigBytes/4,d=this._nRounds=x+6,A=(d+1)*4,B=this._keySchedule=[],O=0;O<A;O++)O<x?B[O]=a[O]:(l=B[O-1],O%x?x>6&&O%x==4&&(l=v[l>>>24]<<24|v[l>>>16&255]<<16|v[l>>>8&255]<<8|v[l&255]):(l=l<<8|l>>>24,l=v[l>>>24]<<24|v[l>>>16&255]<<16|v[l>>>8&255]<<8|v[l&255],l^=S[O/x|0]<<24),B[O]=B[O-x]^l);for(var k=this._invKeySchedule=[],F=0;F<A;F++){var O=A-F;if(F%4)var l=B[O];else var l=B[O-4];F<4||O<=4?k[F]=l:k[F]=R[v[l>>>24]]^D[v[l>>>16&255]]^b[v[l>>>8&255]]^g[v[l&255]]}}},encryptBlock:function(l,c){this._doCryptBlock(l,c,this._keySchedule,y,w,f,_,v)},decryptBlock:function(l,c){var a=l[c+1];l[c+1]=l[c+3],l[c+3]=a,this._doCryptBlock(l,c,this._invKeySchedule,R,D,b,g,E);var a=l[c+1];l[c+1]=l[c+3],l[c+3]=a},_doCryptBlock:function(l,c,a,x,d,A,B,O){for(var k=this._nRounds,F=l[c]^a[0],M=l[c+1]^a[1],P=l[c+2]^a[2],U=l[c+3]^a[3],N=4,H=1;H<k;H++){var G=x[F>>>24]^d[M>>>16&255]^A[P>>>8&255]^B[U&255]^a[N++],z=x[M>>>24]^d[P>>>16&255]^A[U>>>8&255]^B[F&255]^a[N++],j=x[P>>>24]^d[U>>>16&255]^A[F>>>8&255]^B[M&255]^a[N++],$=x[U>>>24]^d[F>>>16&255]^A[M>>>8&255]^B[P&255]^a[N++];F=G,M=z,P=j,U=$}var G=(O[F>>>24]<<24|O[M>>>16&255]<<16|O[P>>>8&255]<<8|O[U&255])^a[N++],z=(O[M>>>24]<<24|O[P>>>16&255]<<16|O[U>>>8&255]<<8|O[F&255])^a[N++],j=(O[P>>>24]<<24|O[U>>>16&255]<<16|O[F>>>8&255]<<8|O[M&255])^a[N++],$=(O[U>>>24]<<24|O[F>>>16&255]<<16|O[M>>>8&255]<<8|O[P&255])^a[N++];l[c]=G,l[c+1]=z,l[c+2]=j,l[c+3]=$},keySize:256/32});i.AES=C._createHelper(m)}(),p.AES})},function(s,t,r){(function(p,i){s.exports=i(r(6))})(this,function(p){return function(i){var h=p,C=h.lib,u=C.WordArray,v=C.Hasher,E=h.algo,y=[];(function(){for(var b=0;b<64;b++)y[b]=i.abs(i.sin(b+1))*4294967296|0})();var w=E.MD5=v.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(b,g){for(var S=0;S<16;S++){var m=g+S,l=b[m];b[m]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360}var c=this._hash.words,a=b[g+0],x=b[g+1],d=b[g+2],A=b[g+3],B=b[g+4],O=b[g+5],k=b[g+6],F=b[g+7],M=b[g+8],P=b[g+9],U=b[g+10],N=b[g+11],H=b[g+12],G=b[g+13],z=b[g+14],j=b[g+15],$=c[0],I=c[1],L=c[2],V=c[3];$=f($,I,L,V,a,7,y[0]),V=f(V,$,I,L,x,12,y[1]),L=f(L,V,$,I,d,17,y[2]),I=f(I,L,V,$,A,22,y[3]),$=f($,I,L,V,B,7,y[4]),V=f(V,$,I,L,O,12,y[5]),L=f(L,V,$,I,k,17,y[6]),I=f(I,L,V,$,F,22,y[7]),$=f($,I,L,V,M,7,y[8]),V=f(V,$,I,L,P,12,y[9]),L=f(L,V,$,I,U,17,y[10]),I=f(I,L,V,$,N,22,y[11]),$=f($,I,L,V,H,7,y[12]),V=f(V,$,I,L,G,12,y[13]),L=f(L,V,$,I,z,17,y[14]),I=f(I,L,V,$,j,22,y[15]),$=_($,I,L,V,x,5,y[16]),V=_(V,$,I,L,k,9,y[17]),L=_(L,V,$,I,N,14,y[18]),I=_(I,L,V,$,a,20,y[19]),$=_($,I,L,V,O,5,y[20]),V=_(V,$,I,L,U,9,y[21]),L=_(L,V,$,I,j,14,y[22]),I=_(I,L,V,$,B,20,y[23]),$=_($,I,L,V,P,5,y[24]),V=_(V,$,I,L,z,9,y[25]),L=_(L,V,$,I,A,14,y[26]),I=_(I,L,V,$,M,20,y[27]),$=_($,I,L,V,G,5,y[28]),V=_(V,$,I,L,d,9,y[29]),L=_(L,V,$,I,F,14,y[30]),I=_(I,L,V,$,H,20,y[31]),$=R($,I,L,V,O,4,y[32]),V=R(V,$,I,L,M,11,y[33]),L=R(L,V,$,I,N,16,y[34]),I=R(I,L,V,$,z,23,y[35]),$=R($,I,L,V,x,4,y[36]),V=R(V,$,I,L,B,11,y[37]),L=R(L,V,$,I,F,16,y[38]),I=R(I,L,V,$,U,23,y[39]),$=R($,I,L,V,G,4,y[40]),V=R(V,$,I,L,a,11,y[41]),L=R(L,V,$,I,A,16,y[42]),I=R(I,L,V,$,k,23,y[43]),$=R($,I,L,V,P,4,y[44]),V=R(V,$,I,L,H,11,y[45]),L=R(L,V,$,I,j,16,y[46]),I=R(I,L,V,$,d,23,y[47]),$=D($,I,L,V,a,6,y[48]),V=D(V,$,I,L,F,10,y[49]),L=D(L,V,$,I,z,15,y[50]),I=D(I,L,V,$,O,21,y[51]),$=D($,I,L,V,H,6,y[52]),V=D(V,$,I,L,A,10,y[53]),L=D(L,V,$,I,U,15,y[54]),I=D(I,L,V,$,x,21,y[55]),$=D($,I,L,V,M,6,y[56]),V=D(V,$,I,L,j,10,y[57]),L=D(L,V,$,I,k,15,y[58]),I=D(I,L,V,$,G,21,y[59]),$=D($,I,L,V,B,6,y[60]),V=D(V,$,I,L,N,10,y[61]),L=D(L,V,$,I,d,15,y[62]),I=D(I,L,V,$,P,21,y[63]),c[0]=c[0]+$|0,c[1]=c[1]+I|0,c[2]=c[2]+L|0,c[3]=c[3]+V|0},_doFinalize:function(){var b=this._data,g=b.words,S=this._nDataBytes*8,m=b.sigBytes*8;g[m>>>5]|=128<<24-m%32;var l=i.floor(S/4294967296),c=S;g[(m+64>>>9<<4)+15]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,g[(m+64>>>9<<4)+14]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360,b.sigBytes=(g.length+1)*4,this._process();for(var a=this._hash,x=a.words,d=0;d<4;d++){var A=x[d];x[d]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}return a},clone:function(){var b=v.clone.call(this);return b._hash=this._hash.clone(),b}});function f(b,g,S,m,l,c,a){var x=b+(g&S|~g&m)+l+a;return(x<<c|x>>>32-c)+g}function _(b,g,S,m,l,c,a){var x=b+(g&m|S&~m)+l+a;return(x<<c|x>>>32-c)+g}function R(b,g,S,m,l,c,a){var x=b+(g^S^m)+l+a;return(x<<c|x>>>32-c)+g}function D(b,g,S,m,l,c,a){var x=b+(S^(g|~m))+l+a;return(x<<c|x>>>32-c)+g}h.MD5=v._createHelper(w),h.HmacMD5=v._createHmacHelper(w)}(Math),p.MD5})},function(s,t,r){var p;Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),h=i.__importDefault(r(3)),C=i.__importStar(r(1)),u=i.__importDefault(r(8)),v=r(4),E=i.__importDefault(r(19)),y=i.__importDefault(r(17)),w=i.__importDefault(r(22)),f=i.__importDefault(r(2)),_=r(29),R=i.__importDefault(r(63)),D=r(14);function b(m){var l=m.statusCode;return l===408&&!m.code||l===400&&!m.code||l>=500&&l<=504}function g(m){var l=m.connection,c=l&&l.connectionManager.host;return c?[c].concat(u.default.getFallbackHosts(m.options)):u.default.getHosts(m.options)}var S=(p=function(){function m(l){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=g,this.options=l||{};var c=this.options.connectivityCheckUrl||u.default.connectivityCheckUrl,a=this.options.connectivityCheckParams,x=!this.options.connectivityCheckUrl;h.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(d,A,B,O,k,F,M){var P=y.default.createRequest(B,O,k,F,w.default.REQ_SEND,A&&A.options.timeouts,d);return P.once("complete",M),P.exec(),P},this.options.disableConnectivityCheck?this.checkConnectivity=function(d){d(null,!0)}:this.checkConnectivity=function(d){f.default.logAction(f.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+c),this.doUri(E.default.Get,null,c,null,null,a,function(A,B,O,k,F){var M=!1;x?M=!A&&(B==null?void 0:B.replace(/\n/,""))=="yes":M=!A&&(0,D.isSuccessCode)(F),f.default.logAction(f.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+M),d(null,M)})}):h.default.Config.jsonpSupported?(this.Request=function(d,A,B,O,k,F,M){var P=(0,_.createRequest)(B,O,k,F,w.default.REQ_SEND,A&&A.options.timeouts,d);return P.once("complete",M),h.default.Config.nextTick(function(){P.exec()}),P},this.options.disableConnectivityCheck?this.checkConnectivity=function(d){d(null,!0)}:this.checkConnectivity=function(d){var A=this,B=u.default.jsonpInternetUpUrl;if(this.checksInProgress){this.checksInProgress.push(d);return}this.checksInProgress=[d],f.default.logAction(f.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+B);var O=new _.Request("isTheInternetUp",B,null,null,null,w.default.REQ_SEND,u.default.TIMEOUTS);O.once("complete",function(k,F){var M=!k&&F;f.default.logAction(f.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+M);for(var P=0;P<A.checksInProgress.length;P++)A.checksInProgress[P](null,M);A.checksInProgress=null}),h.default.Config.nextTick(function(){O.exec()})}):h.default.Config.fetchSupported?(this.supportsAuthHeaders=!0,this.Request=R.default,this.checkConnectivity=function(d){f.default.logAction(f.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+c),this.doUri(E.default.Get,null,c,null,null,null,function(A,B){var O=!A&&(B==null?void 0:B.replace(/\n/,""))=="yes";f.default.logAction(f.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+O),d(null,O)})}):this.Request=function(d,A,B,O,k,F,M){M(new v.PartialErrorInfo("no supported HTTP transports available",null,400),null)}}return m.prototype.do=function(l,c,a,x,d,A,B){var O=this,k=typeof a=="function"?a:function(U){return c.baseUri(U)+a},F=c._currentFallback;if(F)if(F.validUntil>C.now()){if(!this.Request){B==null||B(new v.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(l,c,k(F.host),x,A,d,function(U){for(var N=[],H=1;H<arguments.length;H++)N[H-1]=arguments[H];if(U&&b(U)){c._currentFallback=null,O.do(l,c,a,x,d,A,B);return}B==null||B.apply(void 0,i.__spreadArray([U],N,!1))});return}else c._currentFallback=null;var M=g(c);if(M.length===1){this.doUri(l,c,k(M[0]),x,d,A,B);return}var P=function(U,N){var H=U.shift();O.doUri(l,c,k(H),x,d,A,function(G){for(var z=[],j=1;j<arguments.length;j++)z[j-1]=arguments[j];if(G&&b(G)&&U.length){P(U,!0);return}N&&(c._currentFallback={host:H,validUntil:C.now()+c.options.timeouts.fallbackRetryTimeout}),B==null||B.apply(void 0,i.__spreadArray([G],z,!1))})};P(M)},m.prototype.doUri=function(l,c,a,x,d,A,B){if(!this.Request){B(new v.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(l,c,a,x,A,d,B)},m}(),p.methods=[E.default.Get,E.default.Delete,E.default.Post,E.default.Put,E.default.Patch],p.methodsWithoutBody=[E.default.Get,E.default.Delete],p.methodsWithBody=[E.default.Post,E.default.Put,E.default.Patch],p);t.default=S},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importStar(r(4)),h=p.__importDefault(r(3)),C=p.__importDefault(r(8)),u=p.__importStar(r(1)),v=r(1);function E(f,_){return!!_.get("x-ably-errorcode")}function y(f,_){if(E(f,_))return f.error&&i.default.fromValues(f.error)}function w(f,_,R,D,b,g,S){var m=new Headers(D||{}),l=f?f.toUpperCase():u.isEmptyArg(g)?"GET":"POST",c=new AbortController,a=setTimeout(function(){c.abort(),S(new i.PartialErrorInfo("Request timed out",null,408))},_?_.options.timeouts.httpRequestTimeout:C.default.TIMEOUTS.httpRequestTimeout),x={method:l,headers:m,body:g};h.default.Config.isWebworker||(x.credentials=m.has("authorization")?"include":"same-origin"),(0,v.getGlobalObject)().fetch(R+"?"+new URLSearchParams(b||{}),x).then(function(d){clearTimeout(a);var A=d.headers.get("Content-Type"),B;A&&A.indexOf("application/x-msgpack")>-1?B=d.arrayBuffer():A&&A.indexOf("application/json")>-1?B=d.json():B=d.text(),B.then(function(O){var k=!!A&&A.indexOf("application/x-msgpack")===-1;if(d.ok)S(null,O,d.headers,k,d.status);else{var F=y(O,d.headers)||new i.PartialErrorInfo("Error response received from server: "+d.status+" body was: "+h.default.Config.inspect(O),null,d.status);S(F,O,d.headers,k,d.status)}})}).catch(function(d){clearTimeout(a),S(d)})}t.default=w},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importDefault(r(41)),h=p.__importStar(r(1)),C=h.getGlobalObject();typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function u(){var w=C.location;return!C.WebSocket||!w||!w.origin||w.origin.indexOf("http")>-1}var v=C.navigator&&C.navigator.userAgent.toString(),E=C.location&&C.location.href,y={agent:"browser",logTimestamps:!0,userAgent:v,currentUrl:E,noUpgrade:v&&!!v.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:C.WebSocket,fetchSupported:!!C.fetch,xhrSupported:C.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:typeof document<"u",allowComet:u(),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:i.default,supportsBinary:!!C.TextDecoder,preferBinary:!1,ArrayBuffer:C.ArrayBuffer,atob:C.atob,nextTick:typeof C.setImmediate<"u"?C.setImmediate.bind(C):function(w){setTimeout(w,0)},addEventListener:C.addEventListener,inspect:JSON.stringify,stringByteSize:function(w){return C.TextDecoder&&new C.TextEncoder().encode(w).length||w.length},TextEncoder:C.TextEncoder,TextDecoder:C.TextDecoder,Promise:C.Promise,getRandomValues:function(w){if(w!==void 0)return function(f,_){w.getRandomValues(f),_&&_(null)}}(C.crypto||msCrypto)};t.default=y},function(s,t,r){(function(p){Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),h=i.__importStar(r(1)),C="ablyjs-storage-test",u=function(){function v(){try{p.sessionStorage.setItem(C,C),p.sessionStorage.removeItem(C),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{p.localStorage.setItem(C,C),p.localStorage.removeItem(C),this.localSupported=!0}catch{this.localSupported=!1}}return v.prototype.get=function(E){return this._get(E,!1)},v.prototype.getSession=function(E){return this._get(E,!0)},v.prototype.remove=function(E){return this._remove(E,!1)},v.prototype.removeSession=function(E){return this._remove(E,!0)},v.prototype.set=function(E,y,w){return this._set(E,y,w,!1)},v.prototype.setSession=function(E,y,w){return this._set(E,y,w,!0)},v.prototype._set=function(E,y,w,f){var _={value:y};return w&&(_.expires=h.now()+w),this.storageInterface(f).setItem(E,JSON.stringify(_))},v.prototype._get=function(E,y){if(y&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!y&&!this.localSupported)throw new Error("Local Storage not supported");var w=this.storageInterface(y).getItem(E);if(!w)return null;var f=JSON.parse(w);return f.expires&&f.expires<h.now()?(this.storageInterface(y).removeItem(E),null):f.value},v.prototype._remove=function(E,y){return this.storageInterface(y).removeItem(E)},v.prototype.storageInterface=function(E){return E?p.sessionStorage:p.localStorage},v}();t.default=new u}).call(this,r(13))},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r(0),i=p.__importDefault(r(67)),h={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[i.default.XhrPolling,i.default.XhrStreaming,i.default.JsonP,i.default.WebSocket],baseTransportOrder:[i.default.XhrPolling,i.default.XhrStreaming,i.default.JsonP,i.default.WebSocket],transportPreferenceOrder:[i.default.JsonP,i.default.XhrPolling,i.default.XhrStreaming,i.default.WebSocket],upgradeTransports:[i.default.XhrStreaming,i.default.WebSocket]};t.default=h},function(s,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p;(function(i){i.WebSocket="web_socket",i.Comet="comet",i.XhrStreaming="xhr_streaming",i.XhrPolling="xhr_polling",i.JsonP="jsonp"})(p||(p={})),t.default=p},function(s,t,r){r.r(t);var p=r(29),i=r.n(p),h=r(1),C=r(3),u=r.n(C),v=r(12),E=r.n(v),y=r(17),w=r.n(y),f=function(b){var g="xhr_polling";function S(m,l,c){c.stream=!1,E.a.call(this,m,l,c),this.shortName=g}return h.inherits(S,E.a),S.isAvailable=function(){return u.a.Config.xhrSupported&&u.a.Config.allowComet},S.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},S.prototype.createRequest=function(m,l,c,a,x){return w.a.createRequest(m,l,c,a,x,this.timeouts)},typeof b<"u"&&S.isAvailable()&&(b.supportedTransports[g]=S),S},_=f,R=function(b){var g="xhr_streaming";function S(m,l,c){E.a.call(this,m,l,c),this.shortName=g}return h.inherits(S,E.a),S.isAvailable=function(){return u.a.Config.xhrSupported&&u.a.Config.streamingSupported&&u.a.Config.allowComet},S.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},S.prototype.createRequest=function(m,l,c,a,x){return w.a.createRequest(m,l,c,a,x,this.timeouts)},typeof b<"u"&&S.isAvailable()&&(b.supportedTransports[g]=S),S},D=R;t.default=[i.a,_,D]}]).default})})(hd);console.log("[ABLY] Initialisation du service Ably");Q(!1);const zt=(o,n,s)=>{console.log(`[ABLY] Abonnement au canal ${o}, événement ${n}`);{console.error("[ABLY] Client non initialisé");return}},vd=()=>{console.log("[ABLY] Déconnexion du service de temps réel")},ye=je("notifications",()=>{console.log("[NOTIFICATIONS STORE] Initialisation du store");const o=Q([]),n=Q([]),s=Q({email:!0,push:!0,desktop:!0,types:{ticket:!0,invoice:!0,payment:!0,client:!0,system:!0}}),t=Q(!1),r=Q(null),p=ue(()=>o.value),i=ue(()=>o.value.filter(g=>!g.read).length),h=ue(()=>{const g=new Date;return o.value.filter(S=>new Date(S.created_at).toDateString()===g.toDateString())}),C=ue(()=>n.value),u=async()=>{console.log("[NOTIFICATIONS STORE] Chargement des notifications");try{t.value=!0;const g=await Ee.get("/notifications");return o.value=g.data,console.log("[NOTIFICATIONS STORE] Notifications chargées:",g.data.length),g.data}catch(g){throw console.error("[NOTIFICATIONS STORE] Erreur de chargement:",g),r.value=g,g}finally{t.value=!1}},v=async g=>{console.log(`[NOTIFICATIONS STORE] Marquer comme lu: ${g}`);try{await Ee.put(`/notifications/${g}/read`);const S=o.value.findIndex(m=>m.id===g);S!==-1&&(o.value[S].read=!0)}catch(S){throw console.error("[NOTIFICATIONS STORE] Erreur lors du marquage comme lu:",S),S}},E=async()=>{console.log("[NOTIFICATIONS STORE] Marquer tout comme lu");try{await Ee.put("/notifications/read-all"),o.value=o.value.map(g=>({...g,read:!0}))}catch(g){throw console.error("[NOTIFICATIONS STORE] Erreur lors du marquage de tout comme lu:",g),g}},y=async g=>{console.log(`[NOTIFICATIONS STORE] Supprimer la notification: ${g}`);try{await Ee.delete(`/notifications/${g}`),o.value=o.value.filter(S=>S.id!==g)}catch(S){throw console.error("[NOTIFICATIONS STORE] Erreur lors de la suppression:",S),S}},w=async()=>{console.log("[NOTIFICATIONS STORE] Supprimer toutes les notifications");try{await Ee.delete("/notifications/all"),o.value=[]}catch(g){throw console.error("[NOTIFICATIONS STORE] Erreur lors de la suppression de toutes les notifications:",g),g}},f=async g=>{console.log("[NOTIFICATIONS STORE] Mise à jour des préférences");try{await Ee.put("/notifications/preferences",g),s.value=g}catch(S){throw console.error("[NOTIFICATIONS STORE] Erreur lors de la mise à jour des préférences:",S),S}},_=g=>{console.log("[NOTIFICATIONS STORE] Ajout d'une notification temporaire:",g);const S=Date.now(),m={id:S,...g,timeout:g.timeout||5e3};return n.value.push(m),setTimeout(()=>{n.value=n.value.filter(l=>l.id!==S)},m.timeout),S},R=_,D=g=>{n.value=n.value.filter(S=>S.id!==g)},b=()=>{console.log("[NOTIFICATIONS STORE] Configuration du temps réel"),zt("notifications","new"),zt("notifications","update"),zt("notifications","delete")};return Fe(()=>{console.log("[NOTIFICATIONS STORE] Montage du store"),b()}),ss(()=>{console.log("[NOTIFICATIONS STORE] Démontage du store"),vd()}),{notifications:o,toasts:n,preferences:s,loading:t,error:r,allNotifications:p,unreadCount:i,todayNotifications:h,activeToasts:C,fetchNotifications:u,markAsRead:v,markAllAsRead:E,deleteNotification:y,clearAll:w,updatePreferences:f,addNotification:_,showNotification:R,removeToast:D}}),md={class:"services-view view-container"},gd={class:"header-box"},yd={class:"page-title"},xd={class:"page-description"},bd={class:"filter-box"},Cd={class:"filter-grid"},Ad={class:"filter-group"},Ed={class:"filter-label"},_d={class:"filter-input-wrapper"},Sd=["placeholder"],wd={class:"filter-group"},Rd={class:"filter-label"},Dd={class:"filter-input-wrapper"},Od={value:"all"},Bd={value:"active"},Td={value:"inactive"},kd={value:"maintenance"},$d={class:"filter-group"},Fd={class:"filter-label"},Pd={class:"filter-input-wrapper"},Md={value:""},Id={value:"low"},Nd={value:"medium"},Ud={value:"high"},Ld={class:"filter-group"},Hd={class:"filter-input-wrapper"},jd={key:0,class:"loading-state box"},Vd={key:1,class:"empty-state box"},Gd={key:2,class:"table-box"},Wd={class:"action-buttons"},zd=["onClick"],qd=["onClick"],Kd={class:"form-group"},Xd={class:"form-label"},Jd={key:0,class:"invalid-feedback"},Qd={class:"form-group"},Yd={class:"form-label"},Zd={class:"form-row"},ef={class:"form-group"},tf={class:"form-label"},nf={key:0,class:"invalid-feedback"},rf={class:"form-group"},sf={class:"form-label"},of={value:"active"},af={value:"inactive"},lf={value:"maintenance"},cf={class:"form-group"},uf={class:"form-label"},df={class:"features-list"},ff={class:"feature-controls"},pf=["onUpdate:modelValue","placeholder"],hf={class:"feature-included"},vf=["onUpdate:modelValue","id"],mf=["for"],gf=["onClick"],yf={class:"form-actions"},xf={type:"submit",class:"btn btn-primary"},bf=ke({__name:"ServicesView",setup(o){const{t:n}=Le(),s=Hs(),t=ye(),r=Q([]),p=Q(!0),i=Q(!1),h=Q(null),C=Q("all"),u=Q(""),v=Q(""),E=Q("name"),y=Q(!1),w=Q(!1),f=Q({}),_={id:null,name:"",description:"",price:0,status:"active",features:[],clients:[]},R=[{key:"name",label:n("services.columns.name"),sortable:!0},{key:"description",label:n("services.columns.description"),sortable:!1},{key:"price",label:n("services.columns.price"),sortable:!0,formatter:B=>`${B} €`},{key:"status",label:n("services.columns.status"),sortable:!0,formatter:B=>({active:n("services.status.active"),inactive:n("services.status.inactive"),maintenance:n("services.status.maintenance")})[B]||B},{key:"clients",label:n("services.columns.clients"),sortable:!0,formatter:B=>B.length},{key:"actions",label:n("common.actions"),sortable:!1}],D=ue(()=>{let B=[...s.allServices];if(C.value!=="all"&&(B=B.filter(O=>O.status===C.value)),u.value){const O=u.value.toLowerCase();B=B.filter(k=>k.name.toLowerCase().includes(O)||k.description.toLowerCase().includes(O))}if(v.value){const O={low:k=>k.price<10,medium:k=>k.price>=10&&k.price<50,high:k=>k.price>=50};B=B.filter(O[v.value])}return B}),b=async()=>{try{p.value=!0,await s.fetchServices(),r.value=s.allServices}catch(B){console.error("Erreur lors du chargement des services:",B),t.addNotification({type:"error",title:n("services.errors.fetch"),message:n("services.errors.fetchMessage")})}finally{p.value=!1}},g=(B,O)=>{E.value=B,y.value=O},S=B=>{h.value={...B},w.value=!0,i.value=!0},m=()=>{h.value={..._},w.value=!1,i.value=!0},l=()=>{const B={};return h.value.name||(B.name=n("services.validation.nameRequired")),h.value.price<0&&(B.price=n("services.validation.pricePositive")),f.value=B,Object.keys(B).length===0},c=async()=>{if(l())try{p.value=!0,w.value?(await s.updateService(h.value),t.addNotification({type:"success",title:n("services.success.update"),message:n("services.success.updateMessage",{name:h.value.name})})):(await s.createService(h.value),t.addNotification({type:"success",title:n("services.success.create"),message:n("services.success.createMessage",{name:h.value.name})})),i.value=!1,r.value=D.value}catch(B){console.error("Erreur lors de la sauvegarde du service:",B),t.addNotification({type:"error",title:w.value?n("services.errors.update"):n("services.errors.create"),message:n("services.errors.saveMessage")})}finally{p.value=!1}},a=async B=>{if(confirm(n("services.confirm.delete",{name:B.name})))try{p.value=!0,await s.deleteService(B.id),r.value=D.value,t.addNotification({type:"success",title:n("services.success.delete"),message:n("services.success.deleteMessage",{name:B.name})})}catch(O){console.error("Erreur lors de la suppression du service:",O),t.addNotification({type:"error",title:n("services.errors.delete"),message:n("services.errors.deleteMessage")})}finally{p.value=!1}},x=()=>{h.value.features||(h.value.features=[]),h.value.features.push({name:"",included:!0})},d=B=>{h.value.features.splice(B,1)},A=()=>{r.value=D.value};return Fe(()=>{b()}),(B,O)=>(q(),K("div",md,[e("div",gd,[e("div",null,[e("h1",yd,T(W(n)("services.title")),1),e("span",xd,T(W(n)("services.description")),1)]),e("button",{class:"btn btn-primary",onClick:m},[O[9]||(O[9]=e("i",{class:"fas fa-plus"},null,-1)),ie(" "+T(W(n)("services.add")),1)])]),e("div",bd,[e("div",Cd,[e("div",Ad,[e("label",Ed,T(W(n)("services.filters.search")),1),e("div",_d,[O[10]||(O[10]=e("i",{class:"fas fa-search"},null,-1)),Z(e("input",{type:"text","onUpdate:modelValue":O[0]||(O[0]=k=>u.value=k),class:"filter-input",placeholder:W(n)("services.search")},null,8,Sd),[[le,u.value]])])]),e("div",wd,[e("label",Rd,T(W(n)("services.filters.status")),1),e("div",Dd,[O[11]||(O[11]=e("i",{class:"fas fa-server"},null,-1)),Z(e("select",{"onUpdate:modelValue":O[1]||(O[1]=k=>C.value=k),class:"filter-input"},[e("option",Od,T(W(n)("services.status.all")),1),e("option",Bd,T(W(n)("services.status.active")),1),e("option",Td,T(W(n)("services.status.inactive")),1),e("option",kd,T(W(n)("services.status.maintenance")),1)],512),[[xe,C.value]])])]),e("div",$d,[e("label",Fd,T(W(n)("services.filters.price_range")),1),e("div",Pd,[O[12]||(O[12]=e("i",{class:"fas fa-tag"},null,-1)),Z(e("select",{"onUpdate:modelValue":O[2]||(O[2]=k=>v.value=k),class:"filter-input"},[e("option",Md,T(W(n)("services.filters.all_prices")),1),e("option",Id,T(W(n)("services.filters.price_low")),1),e("option",Nd,T(W(n)("services.filters.price_medium")),1),e("option",Ud,T(W(n)("services.filters.price_high")),1)],512),[[xe,v.value]])])]),e("div",Ld,[O[14]||(O[14]=e("label",{class:"filter-label"}," ",-1)),e("div",Hd,[e("button",{onClick:A,class:"btn btn-gradient filter-button"},[O[13]||(O[13]=e("i",{class:"fas fa-filter"},null,-1)),ie(" "+T(W(n)("services.filters.apply")),1)])])])])]),p.value?(q(),K("div",jd,[O[15]||(O[15]=e("div",{class:"spinner"},null,-1)),e("p",null,T(W(n)("common.loading")),1)])):D.value&&D.value.length===0?(q(),K("div",Vd,[O[16]||(O[16]=e("div",{class:"empty-icon"},[e("i",{class:"fas fa-box"})],-1)),e("h3",null,T(W(n)("services.empty.title")),1),e("p",null,T(W(n)("services.empty.description")),1)])):(q(),K("div",Gd,[Ce(Ls,{columns:R,data:D.value,loading:p.value,"sort-by":E.value,"sort-desc":y.value,onSort:g,onRowClick:S},{"cell(actions)":Ae(({row:k})=>[e("div",Wd,[e("button",{class:"btn btn-icon",onClick:Re(F=>S(k),["stop"])},O[17]||(O[17]=[e("i",{class:"fas fa-edit"},null,-1)]),8,zd),e("button",{class:"btn btn-icon btn-danger",onClick:Re(F=>a(k),["stop"])},O[18]||(O[18]=[e("i",{class:"fas fa-trash"},null,-1)]),8,qd)])]),"cell(status)":Ae(({row:k})=>[e("span",{class:ce(`status-badge status-${k.status}`)},T(W(n)(`services.status.${k.status}`)),3)]),_:1},8,["data","loading","sort-by","sort-desc"])])),i.value?(q(),at(Hn,{key:3,title:w.value?W(n)("services.edit_title"):W(n)("services.add_title"),onClose:O[8]||(O[8]=k=>i.value=!1),class:"modal-box"},{default:Ae(()=>[e("form",{onSubmit:Re(c,["prevent"])},[e("div",Kd,[e("label",Xd,T(W(n)("services.fields.name")),1),Z(e("input",{type:"text",class:ce(["form-control",{"is-invalid":f.value.name}]),"onUpdate:modelValue":O[3]||(O[3]=k=>h.value.name=k),required:""},null,2),[[le,h.value.name]]),f.value.name?(q(),K("div",Jd,T(f.value.name),1)):ae("",!0)]),e("div",Qd,[e("label",Yd,T(W(n)("services.fields.description")),1),Z(e("textarea",{class:"form-control","onUpdate:modelValue":O[4]||(O[4]=k=>h.value.description=k),rows:"4"},null,512),[[le,h.value.description]])]),e("div",Zd,[e("div",ef,[e("label",tf,T(W(n)("services.fields.price")),1),Z(e("input",{type:"number",class:ce(["form-control",{"is-invalid":f.value.price}]),"onUpdate:modelValue":O[5]||(O[5]=k=>h.value.price=k),step:"0.01",required:""},null,2),[[le,h.value.price]]),f.value.price?(q(),K("div",nf,T(f.value.price),1)):ae("",!0)]),e("div",rf,[e("label",sf,T(W(n)("services.fields.status")),1),Z(e("select",{class:"form-control","onUpdate:modelValue":O[6]||(O[6]=k=>h.value.status=k)},[e("option",of,T(W(n)("services.status.active")),1),e("option",af,T(W(n)("services.status.inactive")),1),e("option",lf,T(W(n)("services.status.maintenance")),1)],512),[[xe,h.value.status]])])]),e("div",cf,[e("label",uf,T(W(n)("services.fields.features")),1),e("div",df,[(q(!0),K(_e,null,Se(h.value.features,(k,F)=>(q(),K("div",{key:F,class:"feature-item"},[e("div",ff,[Z(e("input",{type:"text",class:"form-control","onUpdate:modelValue":M=>k.name=M,placeholder:W(n)("services.fields.featureName")},null,8,pf),[[le,k.name]]),e("div",hf,[Z(e("input",{type:"checkbox","onUpdate:modelValue":M=>k.included=M,id:`feature-${F}`},null,8,vf),[[Oe,k.included]]),e("label",{for:`feature-${F}`},T(W(n)("services.fields.included")),9,mf)]),e("button",{type:"button",class:"btn btn-icon btn-danger",onClick:M=>d(F)},O[19]||(O[19]=[e("i",{class:"fas fa-times"},null,-1)]),8,gf)])]))),128)),e("button",{type:"button",class:"btn btn-outline btn-sm",onClick:x},[O[20]||(O[20]=e("i",{class:"fas fa-plus"},null,-1)),ie(" "+T(W(n)("services.fields.addFeature")),1)])])]),e("div",yf,[e("button",{type:"button",class:"btn btn-secondary",onClick:O[7]||(O[7]=k=>i.value=!1)},T(W(n)("common.cancel")),1),e("button",xf,T(W(n)("common.save")),1)])],32)]),_:1},8,["title"])):ae("",!0)]))}}),js=Pe(bf,[["__scopeId","data-v-28a06853"]]),Cf=je("products",()=>{const o=Q([]),n=Q(!1),s=Q(null),t=ue(()=>o.value),r=ue(()=>o.value.filter(v=>v.status==="active")),p=ue(()=>o.value.filter(v=>v.status==="inactive"));return{products:o,loading:n,error:s,allProducts:t,activeProducts:r,inactiveProducts:p,fetchProducts:async()=>{try{n.value=!0;const v=await fe.get("/api/v1/services/products");return o.value=v.data.products,v.data.products}catch(v){throw s.value=v,v}finally{n.value=!1}},updateProduct:async v=>{try{n.value=!0;const E=await fe.put(`/api/v1/products/${v.id}`,v),y=o.value.findIndex(w=>w.id===v.id);return y!==-1&&(o.value[y]=E.data.product),E.data.product}catch(E){throw s.value=E,E}finally{n.value=!1}},createProduct:async v=>{try{n.value=!0;const E=await fe.post("/api/v1/products",v);return o.value.push(E.data.product),E.data.product}catch(E){throw s.value=E,E}finally{n.value=!1}},deleteProduct:async v=>{try{n.value=!0,await fe.delete(`/api/v1/products/${v}`);const E=o.value.findIndex(y=>y.id===v);return E!==-1&&o.value.splice(E,1),!0}catch(E){throw s.value=E,E}finally{n.value=!1}}}}),Af={class:"products-view view-container"},Ef={class:"header-box"},_f={class:"page-title"},Sf={class:"page-description"},wf={class:"filter-box"},Rf={class:"filter-grid"},Df={class:"filter-group"},Of={class:"filter-label"},Bf={class:"filter-input-wrapper"},Tf=["placeholder"],kf={class:"filter-group"},$f={class:"filter-label"},Ff={class:"filter-input-wrapper"},Pf={value:"all"},Mf={value:"active"},If={value:"inactive"},Nf={class:"filter-group"},Uf={class:"filter-label"},Lf={class:"filter-input-wrapper"},Hf={value:""},jf={value:"low"},Vf={value:"medium"},Gf={value:"high"},Wf={class:"filter-group"},zf={class:"filter-input-wrapper"},qf={key:0,class:"loading-state box"},Kf={key:1,class:"empty-state box"},Xf={key:2,class:"table-box"},Jf={class:"actions"},Qf=["onClick"],Yf=["onClick"],Zf={class:"empty-state"},e0={class:"form-group"},t0={class:"form-label"},n0={key:0,class:"invalid-feedback"},r0={class:"form-group"},s0={class:"form-label"},o0={key:0,class:"invalid-feedback"},i0={class:"form-group"},a0={class:"form-label"},l0={class:"input-group"},c0={key:0,class:"invalid-feedback"},u0={class:"form-group"},d0={class:"form-label"},f0={value:"active"},p0={value:"inactive"},h0={class:"form-group"},v0={class:"form-label"},m0={class:"features-list"},g0={class:"input-group"},y0=["onUpdate:modelValue","placeholder"],x0={class:"input-group-append"},b0=["onClick"],C0={class:"form-check mt-1"},A0=["onUpdate:modelValue","id"],E0=["for"],_0={class:"modal-footer"},S0={type:"submit",class:"btn btn-primary"},w0=ke({__name:"ProductsView",setup(o){const{t:n}=Le(),s=Cf(),t=ye(),r=Q([]),p=Q(!0),i=Q(!1),h=Q(null),C=Q("all"),u=Q(""),v=Q("name"),E=Q(!1),y=Q(!1),w=Q({}),f=Q(""),_={id:null,name:"",description:"",price:0,status:"active",features:[]},R=[{key:"name",label:n("products.columns.name"),sortable:!0},{key:"description",label:n("products.columns.description"),sortable:!0,formatter:B=>B.length>50?B.substring(0,50)+"...":B},{key:"price",label:n("products.columns.price"),sortable:!0,formatter:B=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(B)},{key:"status",label:n("products.columns.status"),sortable:!0,formatter:B=>B==="active"?`<span class="badge badge-success">${n("products.status.active")}</span>`:B==="inactive"?`<span class="badge badge-danger">${n("products.status.inactive")}</span>`:B},{key:"actions",label:n("common.actions"),sortable:!1}];n("products.filters.all"),n("products.filters.active"),n("products.filters.inactive");const D=ue(()=>{let B=[...r.value];if(C.value!=="all"&&(B=B.filter(O=>O.status===C.value)),u.value){const O=u.value.toLowerCase();B=B.filter(k=>k.name.toLowerCase().includes(O)||k.description.toLowerCase().includes(O))}return f.value==="low"?B=B.filter(O=>O.price<10):f.value==="medium"?B=B.filter(O=>O.price>=10&&O.price<50):f.value==="high"&&(B=B.filter(O=>O.price>=50)),B}),b=async()=>{try{p.value=!0;const B=await s.fetchProducts();r.value=B}catch(B){console.error("Erreur lors du chargement des produits:",B),t.add({type:"error",message:n("products.errors.fetch")})}finally{p.value=!1}},g=(B,O)=>{v.value=B,E.value=O},S=B=>{h.value={...B},y.value=!0,i.value=!0},m=()=>{h.value={..._},y.value=!1,i.value=!0},l=()=>{const B={};return h.value.name||(B.name=n("products.validation.name_required")),h.value.description||(B.description=n("products.validation.description_required")),h.value.price<0&&(B.price=n("products.validation.price_positive")),w.value=B,Object.keys(B).length===0},c=async()=>{if(l())try{y.value?(await s.updateProduct(h.value),t.add({type:"success",message:n("products.success.update")})):(await s.createProduct(h.value),t.add({type:"success",message:n("products.success.create")})),i.value=!1,b()}catch(B){console.error("Erreur lors de la sauvegarde du produit:",B),t.add({type:"error",message:y.value?n("products.errors.update"):n("products.errors.create")})}},a=async B=>{if(confirm(n("products.confirm.delete")))try{await s.deleteProduct(B.id),t.add({type:"success",message:n("products.success.delete")}),b()}catch(O){console.error("Erreur lors de la suppression du produit:",O),t.add({type:"error",message:n("products.errors.delete")})}},x=()=>{h.value.features||(h.value.features=[]),h.value.features.push({name:"",included:!0})},d=B=>{h.value.features.splice(B,1)},A=()=>{C.value="all",u.value="",f.value=""};return Fe(()=>{b()}),(B,O)=>(q(),K("div",Af,[e("div",Ef,[e("div",null,[e("h1",_f,T(W(n)("products.title")),1),e("span",Sf,T(W(n)("products.description")),1)]),e("button",{class:"btn btn-primary",onClick:m},[O[9]||(O[9]=e("i",{class:"fas fa-plus"},null,-1)),ie(" "+T(W(n)("products.actions.add")),1)])]),e("div",wf,[e("div",Rf,[e("div",Df,[e("label",Of,T(W(n)("products.filters.search")),1),e("div",Bf,[O[10]||(O[10]=e("i",{class:"fas fa-search"},null,-1)),Z(e("input",{type:"text","onUpdate:modelValue":O[0]||(O[0]=k=>u.value=k),class:"filter-input",placeholder:W(n)("products.search.placeholder")},null,8,Tf),[[le,u.value]])])]),e("div",kf,[e("label",$f,T(W(n)("products.filters.status")),1),e("div",Ff,[O[11]||(O[11]=e("i",{class:"fas fa-box"},null,-1)),Z(e("select",{"onUpdate:modelValue":O[1]||(O[1]=k=>C.value=k),class:"filter-input"},[e("option",Pf,T(W(n)("products.filters.all")),1),e("option",Mf,T(W(n)("products.filters.active")),1),e("option",If,T(W(n)("products.filters.inactive")),1)],512),[[xe,C.value]])])]),e("div",Nf,[e("label",Uf,T(W(n)("products.filters.price_range")),1),e("div",Lf,[O[12]||(O[12]=e("i",{class:"fas fa-tag"},null,-1)),Z(e("select",{"onUpdate:modelValue":O[2]||(O[2]=k=>f.value=k),class:"filter-input"},[e("option",Hf,T(W(n)("products.filters.all_prices")),1),e("option",jf,T(W(n)("products.filters.price_low")),1),e("option",Vf,T(W(n)("products.filters.price_medium")),1),e("option",Gf,T(W(n)("products.filters.price_high")),1)],512),[[xe,f.value]])])]),e("div",Wf,[O[14]||(O[14]=e("label",{class:"filter-label"}," ",-1)),e("div",zf,[e("button",{onClick:A,class:"btn btn-gradient filter-button"},[O[13]||(O[13]=e("i",{class:"fas fa-filter"},null,-1)),ie(" "+T(W(n)("products.filters.apply")),1)])])])])]),p.value?(q(),K("div",qf,[O[15]||(O[15]=e("div",{class:"spinner"},null,-1)),e("p",null,T(W(n)("common.loading")),1)])):D.value&&D.value.length===0?(q(),K("div",Kf,[O[16]||(O[16]=e("div",{class:"empty-icon"},[e("i",{class:"fas fa-box"})],-1)),e("h3",null,T(W(n)("products.empty.title")),1),e("p",null,T(W(n)("products.empty.description")),1)])):(q(),K("div",Xf,[Ce(Ls,{columns:R,data:D.value,loading:p.value,"sort-by":v.value,"sort-desc":E.value,onSort:g},{"cell-actions":Ae(({item:k})=>[e("div",Jf,[e("button",{class:"btn btn-sm btn-primary",onClick:F=>S(k)},[O[17]||(O[17]=e("i",{class:"fas fa-edit"},null,-1)),ie(" "+T(W(n)("common.edit")),1)],8,Qf),e("button",{class:"btn btn-sm btn-danger",onClick:F=>a(k)},[O[18]||(O[18]=e("i",{class:"fas fa-trash"},null,-1)),ie(" "+T(W(n)("common.delete")),1)],8,Yf)])]),empty:Ae(()=>[e("div",Zf,[O[19]||(O[19]=e("i",{class:"fas fa-box fa-3x"},null,-1)),e("p",null,T(W(n)("products.empty.message")),1),e("button",{class:"btn btn-primary",onClick:m},T(W(n)("products.empty.action")),1)])]),_:1},8,["data","loading","sort-by","sort-desc"])])),i.value?(q(),at(Hn,{key:3,title:y.value?W(n)("products.modal.edit_title"):W(n)("products.modal.add_title"),onClose:O[8]||(O[8]=k=>i.value=!1),class:"modal-box"},{default:Ae(()=>[e("form",{onSubmit:Re(c,["prevent"])},[e("div",e0,[e("label",t0,T(W(n)("products.fields.name")),1),Z(e("input",{type:"text","onUpdate:modelValue":O[3]||(O[3]=k=>h.value.name=k),class:ce(["form-control",{"is-invalid":w.value.name}])},null,2),[[le,h.value.name]]),w.value.name?(q(),K("div",n0,T(w.value.name),1)):ae("",!0)]),e("div",r0,[e("label",s0,T(W(n)("products.fields.description")),1),Z(e("textarea",{"onUpdate:modelValue":O[4]||(O[4]=k=>h.value.description=k),class:ce(["form-control",{"is-invalid":w.value.description}]),rows:"3"},null,2),[[le,h.value.description]]),w.value.description?(q(),K("div",o0,T(w.value.description),1)):ae("",!0)]),e("div",i0,[e("label",a0,T(W(n)("products.fields.price")),1),e("div",l0,[O[20]||(O[20]=e("span",{class:"input-group-text"},"€",-1)),Z(e("input",{type:"number","onUpdate:modelValue":O[5]||(O[5]=k=>h.value.price=k),class:ce(["form-control",{"is-invalid":w.value.price}]),step:"0.01"},null,2),[[le,h.value.price,void 0,{number:!0}]]),w.value.price?(q(),K("div",c0,T(w.value.price),1)):ae("",!0)])]),e("div",u0,[e("label",d0,T(W(n)("products.fields.status")),1),Z(e("select",{"onUpdate:modelValue":O[6]||(O[6]=k=>h.value.status=k),class:"form-select"},[e("option",f0,T(W(n)("products.status.active")),1),e("option",p0,T(W(n)("products.status.inactive")),1)],512),[[xe,h.value.status]])]),e("div",h0,[e("label",v0,T(W(n)("products.fields.features")),1),e("div",m0,[(q(!0),K(_e,null,Se(h.value.features,(k,F)=>(q(),K("div",{key:F,class:"feature-item"},[e("div",g0,[Z(e("input",{type:"text","onUpdate:modelValue":M=>k.name=M,class:"form-control",placeholder:W(n)("products.fields.feature_name")},null,8,y0),[[le,k.name]]),e("div",x0,[e("button",{type:"button",class:"btn btn-danger",onClick:M=>d(F)},O[21]||(O[21]=[e("i",{class:"fas fa-times"},null,-1)]),8,b0)])]),e("div",C0,[Z(e("input",{type:"checkbox","onUpdate:modelValue":M=>k.included=M,class:"form-check-input",id:`feature-included-${F}`},null,8,A0),[[Oe,k.included]]),e("label",{class:"form-check-label",for:`feature-included-${F}`},T(W(n)("products.fields.feature_included")),9,E0)])]))),128)),e("button",{type:"button",class:"btn btn-sm btn-outline-primary mt-2",onClick:x},[O[22]||(O[22]=e("i",{class:"fas fa-plus"},null,-1)),ie(" "+T(W(n)("products.actions.add_feature")),1)])])]),e("div",_0,[e("button",{type:"button",class:"btn btn-secondary",onClick:O[7]||(O[7]=k=>i.value=!1)},T(W(n)("common.cancel")),1),e("button",S0,T(W(n)("common.save")),1)])],32)]),_:1},8,["title"])):ae("",!0)]))}}),Vs=Pe(w0,[["__scopeId","data-v-681f27a6"]]),R0=je("invoices",{state:()=>({invoices:[],currentInvoice:null,loading:!1,error:null}),getters:{getInvoiceById:o=>n=>o.invoices.find(s=>s.id===n)||null,getInvoicesByStatus:o=>n=>n==="all"?o.invoices:o.invoices.filter(s=>s.status===n)},actions:{async fetchInvoices(){var o,n;this.loading=!0,this.error=null;try{const s=await fe.get("/api/v1/invoices");this.invoices=s.data.invoices}catch(s){console.error("Erreur lors du chargement des factures:",s),this.error=((n=(o=s.response)==null?void 0:o.data)==null?void 0:n.message)||"Erreur lors du chargement des factures",ye().addNotification({title:"Erreur",message:this.error,type:"error"})}finally{this.loading=!1}},async fetchInvoice(o){var n,s;this.loading=!0,this.error=null;try{const t=await fe.get(`/api/v1/invoices/${o}`);return this.currentInvoice=t.data.invoice,t.data.invoice}catch(t){return console.error(`Erreur lors du chargement de la facture ${o}:`,t),this.error=((s=(n=t.response)==null?void 0:n.data)==null?void 0:s.message)||`Erreur lors du chargement de la facture ${o}`,ye().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async createInvoice(o){var n,s;this.loading=!0,this.error=null;try{const t=await fe.post("/api/v1/invoices",o);return this.invoices.unshift(t.data.invoice),ye().addNotification({title:"Succès",message:"Facture créée avec succès",type:"success"}),t.data.invoice}catch(t){return console.error("Erreur lors de la création de la facture:",t),this.error=((s=(n=t.response)==null?void 0:n.data)==null?void 0:s.message)||"Erreur lors de la création de la facture",ye().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async updateInvoice(o){var n,s;this.loading=!0,this.error=null;try{const t=await fe.put(`/api/v1/invoices/${o.id}`,o),r=this.invoices.findIndex(i=>i.id===o.id);return r!==-1&&(this.invoices[r]=t.data.invoice),ye().addNotification({title:"Succès",message:"Facture mise à jour avec succès",type:"success"}),t.data.invoice}catch(t){return console.error(`Erreur lors de la mise à jour de la facture ${o.id}:`,t),this.error=((s=(n=t.response)==null?void 0:n.data)==null?void 0:s.message)||`Erreur lors de la mise à jour de la facture ${o.id}`,ye().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async deleteInvoice(o){var n,s;this.loading=!0,this.error=null;try{return await fe.delete(`/api/v1/invoices/${o}`),this.invoices=this.invoices.filter(r=>r.id!==o),ye().addNotification({title:"Succès",message:"Facture supprimée avec succès",type:"success"}),!0}catch(t){return console.error(`Erreur lors de la suppression de la facture ${o}:`,t),this.error=((s=(n=t.response)==null?void 0:n.data)==null?void 0:s.message)||`Erreur lors de la suppression de la facture ${o}`,ye().addNotification({title:"Erreur",message:this.error,type:"error"}),!1}finally{this.loading=!1}},async markAsPaid(o){var n,s;this.loading=!0,this.error=null;try{const t=await fe.put(`/api/v1/invoices/${o}`,{status:"paid",paid_at:new Date().toISOString()}),r=this.invoices.findIndex(i=>i.id===o);return r!==-1&&(this.invoices[r]=t.data.invoice),ye().addNotification({title:"Succès",message:"Facture marquée comme payée",type:"success"}),t.data.invoice}catch(t){return console.error(`Erreur lors du marquage de la facture ${o} comme payée:`,t),this.error=((s=(n=t.response)==null?void 0:n.data)==null?void 0:s.message)||`Erreur lors du marquage de la facture ${o} comme payée`,ye().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}}}}),D0={key:0,class:"modal-wrapper"},O0={class:"modal-container"},B0={class:"modal-header"},T0={class:"modal-body"},k0={class:"form-group"},$0={for:"service_id"},F0=["disabled"],P0={value:""},M0=["value"],I0={class:"form-group"},N0={for:"amount"},U0=["disabled"],L0={class:"form-group"},H0={for:"due_date"},j0=["disabled"],V0={key:0,class:"form-group"},G0={for:"status"},W0=["disabled"],z0={value:"pending"},q0={value:"paid"},K0={value:"overdue"},X0={value:"cancelled"},J0={key:1,class:"form-group"},Q0={key:2,class:"form-group"},Y0={class:"form-actions"},Z0=["disabled"],ep={key:0},tp={key:1},np=["disabled"],rp=ke({__name:"InvoiceModal",props:{show:{type:Boolean,default:!1},mode:{type:String,default:"add",validator:o=>["add","edit","view"].includes(o)},invoice:{type:Object,default:()=>({})}},emits:["close","submit"],setup(o,{emit:n}){const s=o,t=n,{t:r}=Le(),p=Q([]),i=Q(!1),h=Q({service_id:"",amount:0,due_date:new Date().toISOString().split("T")[0],status:"pending"}),C=ue(()=>s.mode==="add"),u=ue(()=>s.mode==="edit"),v=ue(()=>s.mode==="view"),E=ue(()=>C.value?r("invoices.modal.add_title"):u.value?r("invoices.modal.edit_title"):r("invoices.modal.view_title")),y=async()=>{try{const D=await fe.get("/api/v1/services");p.value=D.data.services}catch(D){console.error("Erreur lors du chargement des services:",D)}},w=()=>{C.value?h.value={service_id:"",amount:0,due_date:new Date().toISOString().split("T")[0],status:"pending"}:h.value={service_id:s.invoice.service_id||"",amount:s.invoice.amount||0,due_date:s.invoice.due_date?new Date(s.invoice.due_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],status:s.invoice.status||"pending"}},f=D=>{if(!D)return"";const b=new Date(D);return new Intl.DateTimeFormat("fr-FR").format(b)},_=()=>{t("submit",{...h.value})},R=()=>{t("close")};return pt(()=>s.show,D=>{D&&w()}),pt(()=>s.invoice,()=>{s.show&&w()},{deep:!0}),Fe(()=>{y()}),(D,b)=>o.show?(q(),K("div",D0,[e("div",{class:"modal-backdrop",onClick:R}),e("div",O0,[e("div",B0,[e("h3",null,T(E.value),1),e("button",{class:"close-btn",onClick:R},b[4]||(b[4]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",T0,[e("form",{onSubmit:Re(_,["prevent"])},[e("div",k0,[e("label",$0,T(D.$t("invoices.columns.service")),1),Z(e("select",{id:"service_id","onUpdate:modelValue":b[0]||(b[0]=g=>h.value.service_id=g),class:"form-select",disabled:v.value||i.value,required:""},[e("option",P0,T(D.$t("common.select")),1),(q(!0),K(_e,null,Se(p.value,g=>(q(),K("option",{key:g.id,value:g.id},T(g.name),9,M0))),128))],8,F0),[[xe,h.value.service_id]])]),e("div",I0,[e("label",N0,T(D.$t("invoices.columns.amount")),1),Z(e("input",{type:"number",id:"amount","onUpdate:modelValue":b[1]||(b[1]=g=>h.value.amount=g),class:"form-control",disabled:v.value||i.value,step:"0.01",min:"0",required:""},null,8,U0),[[le,h.value.amount]])]),e("div",L0,[e("label",H0,T(D.$t("invoices.columns.due_date")),1),Z(e("input",{type:"date",id:"due_date","onUpdate:modelValue":b[2]||(b[2]=g=>h.value.due_date=g),class:"form-control",disabled:v.value||i.value,required:""},null,8,j0),[[le,h.value.due_date]])]),C.value?ae("",!0):(q(),K("div",V0,[e("label",G0,T(D.$t("invoices.columns.status")),1),Z(e("select",{id:"status","onUpdate:modelValue":b[3]||(b[3]=g=>h.value.status=g),class:"form-select",disabled:v.value||i.value},[e("option",z0,T(D.$t("invoices.status.pending")),1),e("option",q0,T(D.$t("invoices.status.paid")),1),e("option",K0,T(D.$t("invoices.status.overdue")),1),e("option",X0,T(D.$t("invoices.status.cancelled")),1)],8,W0),[[xe,h.value.status]])])),v.value&&o.invoice.paid_at?(q(),K("div",J0,[e("label",null,T(D.$t("invoices.columns.paid_date")),1),e("p",null,T(f(o.invoice.paid_at)),1)])):ae("",!0),v.value?(q(),K("div",Q0,[e("label",null,T(D.$t("invoices.columns.created_at")),1),e("p",null,T(f(o.invoice.created_at)),1)])):ae("",!0),e("div",Y0,[v.value?ae("",!0):(q(),K("button",{key:0,type:"submit",class:"btn btn-primary",disabled:i.value},[i.value?(q(),K("span",ep,[b[5]||(b[5]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),ie(" "+T(D.$t("common.loading")),1)])):(q(),K("span",tp,T(D.$t("common.save")),1))],8,Z0)),e("button",{type:"button",class:"btn btn-secondary",onClick:R,disabled:i.value},T(v.value?D.$t("common.close"):D.$t("common.cancel")),9,np)])],32)])])])):ae("",!0)}}),sp=Pe(rp,[["__scopeId","data-v-9ad4fb7a"]]),op={class:"invoices-view view-container"},ip={class:"header-box"},ap={class:"page-title"},lp={class:"page-description"},cp={class:"filter-box"},up={class:"filter-grid"},dp={class:"filter-group"},fp={class:"filter-label"},pp={class:"filter-input-wrapper"},hp=["placeholder"],vp={class:"filter-group"},mp={class:"filter-label"},gp={class:"filter-input-wrapper"},yp=["value"],xp={class:"filter-group"},bp={class:"filter-label"},Cp={class:"filter-input-wrapper"},Ap={value:"all"},Ep={value:"this_month"},_p={value:"last_month"},Sp={value:"this_year"},wp={class:"filter-group"},Rp={class:"filter-input-wrapper"},Dp={class:"table-box"},Op={key:0,class:"invoices-table"},Bp={class:"actions-cell"},Tp=["onClick"],kp=["onClick"],$p=["onClick"],Fp={key:1,class:"loading-container"},Pp={key:2,class:"empty-state"},Mp={class:"modal-box"},Gs=ke({__name:"InvoicesView",setup(o){const{t:n}=Le(),s=R0(),t=Q(!1),r=Q("create"),p=Q(null),i=Q("all"),h=Q(""),C=Q("all"),u=ue(()=>s.loading),v=ue(()=>[{value:"all",label:n("invoices.filters.all")},{value:"paid",label:n("invoices.filters.paid")},{value:"unpaid",label:n("invoices.filters.unpaid")},{value:"overdue",label:n("invoices.filters.overdue")},{value:"cancelled",label:n("invoices.filters.cancelled")}]),E=ue(()=>{let x=s.invoices;if(i.value!=="all"&&(x=x.filter(d=>d.status===i.value)),h.value.trim()){const d=h.value.toLowerCase();x=x.filter(A=>String(A.id).includes(d)||A.client_name&&A.client_name.toLowerCase().includes(d)||A.service_name&&A.service_name.toLowerCase().includes(d))}if(C.value!=="all"){const d=new Date,A=d.getMonth(),B=d.getFullYear(),O=A-1;switch(C.value){case"this_month":x=x.filter(k=>new Date(k.date).getMonth()===A&&new Date(k.date).getFullYear()===B);break;case"last_month":x=x.filter(k=>new Date(k.date).getMonth()===O&&new Date(k.date).getFullYear()===B);break;case"this_year":x=x.filter(k=>new Date(k.date).getFullYear()===B);break}}return x}),y=x=>x==="all"?s.invoices.length:s.invoices.filter(d=>d.status===x).length,w=x=>x?new Date(x).toLocaleDateString("fr-FR"):"",f=x=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(x),_=x=>({paid:n("invoices.statuses.paid"),unpaid:n("invoices.statuses.unpaid"),overdue:n("invoices.statuses.overdue"),cancelled:n("invoices.statuses.cancelled")})[x]||x,R=()=>{p.value=null,r.value="create",t.value=!0},D=x=>{p.value=x,r.value="edit",t.value=!0},b=x=>{p.value=x,r.value="view",t.value=!0},g=()=>{t.value=!1},S=()=>{s.fetchInvoices()},m=()=>{s.fetchInvoices()},l=()=>{s.fetchInvoices()},c=async x=>{p.value=x,r.value="pay",t.value=!0},a=()=>{};return Fe(async()=>{console.log("InvoicesView - Chargement des données"),await s.fetchInvoices()}),(x,d)=>(q(),K("div",op,[e("div",ip,[e("div",null,[e("h1",ap,T(x.$t("invoices.title")),1),e("span",lp,T(x.$t("invoices.description")),1)]),e("button",{class:"btn btn-primary",onClick:R},[d[3]||(d[3]=e("i",{class:"fas fa-plus"},null,-1)),ie(" "+T(x.$t("invoices.actions.add")),1)])]),e("div",cp,[e("div",up,[e("div",dp,[e("label",fp,T(x.$t("invoices.filters.search")),1),e("div",pp,[d[4]||(d[4]=e("i",{class:"fas fa-search"},null,-1)),Z(e("input",{type:"text","onUpdate:modelValue":d[0]||(d[0]=A=>h.value=A),class:"filter-input",placeholder:x.$t("invoices.search.placeholder")},null,8,hp),[[le,h.value]])])]),e("div",vp,[e("label",mp,T(x.$t("invoices.filters.status")),1),e("div",gp,[d[5]||(d[5]=e("i",{class:"fas fa-file-invoice-dollar"},null,-1)),Z(e("select",{"onUpdate:modelValue":d[1]||(d[1]=A=>i.value=A),class:"filter-input"},[(q(!0),K(_e,null,Se(v.value,A=>(q(),K("option",{key:A.value,value:A.value},T(A.label)+" ("+T(y(A.value))+") ",9,yp))),128))],512),[[xe,i.value]])])]),e("div",xp,[e("label",bp,T(x.$t("invoices.filters.date_range")),1),e("div",Cp,[d[6]||(d[6]=e("i",{class:"fas fa-calendar"},null,-1)),Z(e("select",{"onUpdate:modelValue":d[2]||(d[2]=A=>C.value=A),class:"filter-input"},[e("option",Ap,T(x.$t("invoices.filters.all_time")),1),e("option",Ep,T(x.$t("invoices.filters.this_month")),1),e("option",_p,T(x.$t("invoices.filters.last_month")),1),e("option",Sp,T(x.$t("invoices.filters.this_year")),1)],512),[[xe,C.value]])])]),e("div",wp,[d[8]||(d[8]=e("label",{class:"filter-label"}," ",-1)),e("div",Rp,[e("button",{onClick:a,class:"btn btn-gradient filter-button"},[d[7]||(d[7]=e("i",{class:"fas fa-filter"},null,-1)),ie(" "+T(x.$t("invoices.filters.apply")),1)])])])])]),e("div",Dp,[!u.value&&E.value.length>0?(q(),K("table",Op,[e("thead",null,[e("tr",null,[e("th",null,T(x.$t("invoices.table.id")),1),e("th",null,T(x.$t("invoices.table.client")),1),e("th",null,T(x.$t("invoices.table.service")),1),e("th",null,T(x.$t("invoices.table.date")),1),e("th",null,T(x.$t("invoices.table.dueDate")),1),e("th",null,T(x.$t("invoices.table.amount")),1),e("th",null,T(x.$t("invoices.table.status")),1),e("th",null,T(x.$t("invoices.table.actions")),1)])]),e("tbody",null,[(q(!0),K(_e,null,Se(E.value,A=>(q(),K("tr",{key:A.id},[e("td",null,T(A.id),1),e("td",null,T(A.client_name),1),e("td",null,T(A.service_name),1),e("td",null,T(w(A.date)),1),e("td",null,T(A.due_date?w(A.due_date):"-"),1),e("td",null,T(f(A.amount)),1),e("td",null,[e("span",{class:ce(["status-badge",A.status])},T(_(A.status)),3)]),e("td",Bp,[e("button",{class:"action-btn view-btn",onClick:B=>b(A.id),title:"Voir"},d[9]||(d[9]=[e("i",{class:"fas fa-eye"},null,-1)]),8,Tp),e("button",{class:"action-btn edit-btn",onClick:B=>D(A.id),title:"Modifier"},d[10]||(d[10]=[e("i",{class:"fas fa-edit"},null,-1)]),8,kp),A.status!=="paid"?(q(),K("button",{key:0,class:"action-btn pay-btn",onClick:B=>c(A.id),title:"Payer"},d[11]||(d[11]=[e("i",{class:"fas fa-credit-card"},null,-1)]),8,$p)):ae("",!0)])]))),128))])])):u.value?(q(),K("div",Fp,[d[12]||(d[12]=e("div",{class:"spinner"},null,-1)),e("p",null,T(x.$t("common.loading")),1)])):(q(),K("div",Pp,[d[13]||(d[13]=e("i",{class:"fas fa-file-invoice-dollar empty-icon"},null,-1)),e("h3",null,T(x.$t("invoices.empty.title")),1),e("p",null,T(x.$t("invoices.empty.message")),1),e("button",{class:"btn btn-primary",onClick:R},T(x.$t("invoices.actions.add")),1)]))]),(q(),at(xo,{to:"body"},[t.value?(q(),K("div",{key:0,class:"modal-backdrop",onClick:Re(g,["self"])},[e("div",Mp,[Ce(sp,{"invoice-id":p.value,mode:r.value,onClose:g,onCreated:S,onUpdated:m,onPaid:l,onEdit:D},null,8,["invoice-id","mode"])])])):ae("",!0)]))]))}}),Ip=je("payments",{state:()=>({payments:[],currentPayment:null,loading:!1,error:null}),getters:{getPaymentById:o=>n=>o.payments.find(s=>s.id===n)||null,getPaymentsByStatus:o=>n=>n==="all"?o.payments:o.payments.filter(s=>s.status===n)},actions:{async fetchPayments(){var o,n;this.loading=!0,this.error=null;try{const s=await fe.get("/api/v1/payments");this.payments=s.data.payments}catch(s){console.error("Erreur lors du chargement des paiements:",s),this.error=((n=(o=s.response)==null?void 0:o.data)==null?void 0:n.message)||"Erreur lors du chargement des paiements",ye().addNotification({title:"Erreur",message:this.error,type:"error"})}finally{this.loading=!1}},async fetchPayment(o){var n,s;this.loading=!0,this.error=null;try{const t=await fe.get(`/api/v1/payments/${o}`);return this.currentPayment=t.data.payment,t.data.payment}catch(t){return console.error(`Erreur lors du chargement du paiement ${o}:`,t),this.error=((s=(n=t.response)==null?void 0:n.data)==null?void 0:s.message)||`Erreur lors du chargement du paiement ${o}`,ye().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async createPayment(o){var n,s;this.loading=!0,this.error=null;try{const t=await fe.post("/api/v1/payments",o);return this.payments.unshift(t.data.payment),ye().addNotification({title:"Succès",message:"Paiement créé avec succès",type:"success"}),t.data.payment}catch(t){return console.error("Erreur lors de la création du paiement:",t),this.error=((s=(n=t.response)==null?void 0:n.data)==null?void 0:s.message)||"Erreur lors de la création du paiement",ye().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async updatePayment(o){var n,s;this.loading=!0,this.error=null;try{const t=await fe.put(`/api/v1/payments/${o.id}`,o),r=this.payments.findIndex(i=>i.id===o.id);return r!==-1&&(this.payments[r]=t.data.payment),ye().addNotification({title:"Succès",message:"Paiement mis à jour avec succès",type:"success"}),t.data.payment}catch(t){return console.error(`Erreur lors de la mise à jour du paiement ${o.id}:`,t),this.error=((s=(n=t.response)==null?void 0:n.data)==null?void 0:s.message)||`Erreur lors de la mise à jour du paiement ${o.id}`,ye().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async deletePayment(o){var n,s;this.loading=!0,this.error=null;try{return await fe.delete(`/api/v1/payments/${o}`),this.payments=this.payments.filter(r=>r.id!==o),ye().addNotification({title:"Succès",message:"Paiement supprimé avec succès",type:"success"}),!0}catch(t){return console.error(`Erreur lors de la suppression du paiement ${o}:`,t),this.error=((s=(n=t.response)==null?void 0:n.data)==null?void 0:s.message)||`Erreur lors de la suppression du paiement ${o}`,ye().addNotification({title:"Erreur",message:this.error,type:"error"}),!1}finally{this.loading=!1}},async processRefund(o,n){var s,t;this.loading=!0,this.error=null;try{const r=await fe.post(`/api/v1/payments/${o}/refund`,{reason:n}),p=this.payments.findIndex(h=>h.id===o);return p!==-1&&(this.payments[p]=r.data.payment),ye().addNotification({title:"Succès",message:"Remboursement traité avec succès",type:"success"}),r.data.payment}catch(r){return console.error(`Erreur lors du remboursement du paiement ${o}:`,r),this.error=((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.message)||`Erreur lors du remboursement du paiement ${o}`,ye().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}}}}),Np={key:0,class:"modal-wrapper"},Up={class:"modal-container"},Lp={class:"modal-header"},Hp={class:"modal-body"},jp={class:"form-group"},Vp={for:"invoice_id"},Gp=["disabled"],Wp={value:""},zp=["value"],qp={class:"form-group"},Kp={for:"amount"},Xp=["disabled"],Jp={class:"form-group"},Qp={for:"payment_date"},Yp=["disabled"],Zp={class:"form-group"},eh={for:"payment_method"},th=["disabled"],nh={value:"card"},rh={value:"bank_transfer"},sh={value:"paypal"},oh={value:"cash"},ih={value:"check"},ah={class:"form-group"},lh={for:"transaction_id"},ch=["disabled"],uh={class:"form-text text-muted"},dh={key:0,class:"form-group"},fh={for:"status"},ph=["disabled"],hh={value:"completed"},vh={value:"pending"},mh={value:"failed"},gh={value:"refunded"},yh={class:"form-group"},xh={for:"notes"},bh=["disabled"],Ch={key:1,class:"form-group"},Ah={class:"form-actions"},Eh=["disabled"],_h={key:0},Sh={key:1},wh=["disabled"],Rh=ke({__name:"PaymentModal",props:{show:{type:Boolean,default:!1},mode:{type:String,default:"add",validator:o=>["add","edit","view"].includes(o)},payment:{type:Object,default:()=>({})}},emits:["close","submit"],setup(o,{emit:n}){const s=o,t=n,{t:r}=Le(),p=Q([]),i=Q(!1),h=Q({invoice_id:"",amount:0,payment_date:new Date().toISOString().split("T")[0],payment_method:"card",transaction_id:"",status:"completed",notes:""}),C=ue(()=>s.mode==="add"),u=ue(()=>s.mode==="edit"),v=ue(()=>s.mode==="view"),E=ue(()=>C.value?r("payments.modal.add_title"):u.value?r("payments.modal.edit_title"):r("payments.modal.view_title")),y=async()=>{try{const b=await fe.get("/api/v1/invoices");p.value=b.data.invoices.filter(g=>g.status==="pending")}catch(b){console.error("Erreur lors du chargement des factures:",b)}},w=()=>{C.value?h.value={invoice_id:"",amount:0,payment_date:new Date().toISOString().split("T")[0],payment_method:"card",transaction_id:"",status:"completed",notes:""}:h.value={invoice_id:s.payment.invoice_id||"",amount:s.payment.amount||0,payment_date:s.payment.payment_date?new Date(s.payment.payment_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],payment_method:s.payment.payment_method||"card",transaction_id:s.payment.transaction_id||"",status:s.payment.status||"completed",notes:s.payment.notes||""}},f=b=>{if(!b)return"";const g=new Date(b);return new Intl.DateTimeFormat("fr-FR").format(g)},_=b=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(b),R=()=>{t("submit",{...h.value})},D=()=>{t("close")};return pt(()=>s.show,b=>{b&&w()}),pt(()=>s.payment,()=>{s.show&&w()},{deep:!0}),Fe(()=>{y()}),(b,g)=>o.show?(q(),K("div",Np,[e("div",{class:"modal-backdrop",onClick:D}),e("div",Up,[e("div",Lp,[e("h3",null,T(E.value),1),e("button",{class:"close-btn",onClick:D},g[7]||(g[7]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",Hp,[e("form",{onSubmit:Re(R,["prevent"])},[e("div",jp,[e("label",Vp,T(b.$t("payments.columns.invoice")),1),Z(e("select",{id:"invoice_id","onUpdate:modelValue":g[0]||(g[0]=S=>h.value.invoice_id=S),class:"form-select",disabled:v.value||i.value,required:""},[e("option",Wp,T(b.$t("common.select")),1),(q(!0),K(_e,null,Se(p.value,S=>(q(),K("option",{key:S.id,value:S.id},T(S.id)+" - "+T(S.client_name)+" ("+T(_(S.amount))+") ",9,zp))),128))],8,Gp),[[xe,h.value.invoice_id]])]),e("div",qp,[e("label",Kp,T(b.$t("payments.columns.amount")),1),Z(e("input",{type:"number",id:"amount","onUpdate:modelValue":g[1]||(g[1]=S=>h.value.amount=S),class:"form-control",disabled:v.value||i.value,step:"0.01",min:"0",required:""},null,8,Xp),[[le,h.value.amount]])]),e("div",Jp,[e("label",Qp,T(b.$t("payments.columns.date")),1),Z(e("input",{type:"date",id:"payment_date","onUpdate:modelValue":g[2]||(g[2]=S=>h.value.payment_date=S),class:"form-control",disabled:v.value||i.value,required:""},null,8,Yp),[[le,h.value.payment_date]])]),e("div",Zp,[e("label",eh,T(b.$t("payments.columns.method")),1),Z(e("select",{id:"payment_method","onUpdate:modelValue":g[3]||(g[3]=S=>h.value.payment_method=S),class:"form-select",disabled:v.value||i.value,required:""},[e("option",nh,T(b.$t("payments.methods.card")),1),e("option",rh,T(b.$t("payments.methods.bank_transfer")),1),e("option",sh,T(b.$t("payments.methods.paypal")),1),e("option",oh,T(b.$t("payments.methods.cash")),1),e("option",ih,T(b.$t("payments.methods.check")),1)],8,th),[[xe,h.value.payment_method]])]),e("div",ah,[e("label",lh,T(b.$t("payments.columns.transaction_id")),1),Z(e("input",{type:"text",id:"transaction_id","onUpdate:modelValue":g[4]||(g[4]=S=>h.value.transaction_id=S),class:"form-control",disabled:v.value||i.value},null,8,ch),[[le,h.value.transaction_id]]),e("small",uh,T(b.$t("payments.fields.transaction_id_help")),1)]),C.value?ae("",!0):(q(),K("div",dh,[e("label",fh,T(b.$t("payments.columns.status")),1),Z(e("select",{id:"status","onUpdate:modelValue":g[5]||(g[5]=S=>h.value.status=S),class:"form-select",disabled:v.value||i.value},[e("option",hh,T(b.$t("payments.status.completed")),1),e("option",vh,T(b.$t("payments.status.pending")),1),e("option",mh,T(b.$t("payments.status.failed")),1),e("option",gh,T(b.$t("payments.status.refunded")),1)],8,ph),[[xe,h.value.status]])])),e("div",yh,[e("label",xh,T(b.$t("payments.columns.notes")),1),Z(e("textarea",{id:"notes","onUpdate:modelValue":g[6]||(g[6]=S=>h.value.notes=S),class:"form-control",disabled:v.value||i.value,rows:"3"},null,8,bh),[[le,h.value.notes]])]),v.value?(q(),K("div",Ch,[e("label",null,T(b.$t("payments.columns.created_at")),1),e("p",null,T(f(o.payment.created_at)),1)])):ae("",!0),e("div",Ah,[v.value?ae("",!0):(q(),K("button",{key:0,type:"submit",class:"btn btn-primary",disabled:i.value},[i.value?(q(),K("span",_h,[g[8]||(g[8]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),ie(" "+T(b.$t("common.loading")),1)])):(q(),K("span",Sh,T(b.$t("common.save")),1))],8,Eh)),e("button",{type:"button",class:"btn btn-secondary",onClick:D,disabled:i.value},T(v.value?b.$t("common.close"):b.$t("common.cancel")),9,wh)])],32)])])])):ae("",!0)}}),Dh=Pe(Rh,[["__scopeId","data-v-baa74c3d"]]),Oh={class:"payments-view view-container"},Bh={class:"header-box"},Th={class:"page-title"},kh={class:"page-description"},$h={class:"filter-box"},Fh={class:"filter-grid"},Ph={class:"filter-group"},Mh={class:"filter-label"},Ih={class:"filter-input-wrapper"},Nh=["placeholder"],Uh={class:"filter-group"},Lh={class:"filter-label"},Hh={class:"filter-input-wrapper"},jh=["value"],Vh={class:"filter-group"},Gh={class:"filter-label"},Wh={class:"filter-input-wrapper"},zh={value:""},qh={value:"card"},Kh={value:"bank_transfer"},Xh={value:"paypal"},Jh={class:"filter-group"},Qh={class:"filter-input-wrapper"},Yh={class:"table-box"},Zh={key:0,class:"payments-table"},ev={class:"actions-cell"},tv=["onClick"],nv=["onClick"],rv=["onClick"],sv={key:1,class:"loading-container"},ov={key:2,class:"empty-state"},iv={class:"modal-box"},Ws=ke({__name:"PaymentsView",setup(o){const{t:n}=Le(),s=Ip(),t=Q(!1),r=Q("create"),p=Q(null),i=Q("all"),h=Q(""),C=Q(""),u=ue(()=>s.loading),v=ue(()=>[{value:"all",label:n("payments.filters.all")},{value:"completed",label:n("payments.filters.completed")},{value:"pending",label:n("payments.filters.pending")},{value:"refunded",label:n("payments.filters.refunded")},{value:"failed",label:n("payments.filters.failed")}]),E=ue(()=>{let d=s.payments;if(i.value!=="all"&&(d=d.filter(A=>A.status===i.value)),C.value&&(d=d.filter(A=>A.method===C.value)),h.value.trim()){const A=h.value.toLowerCase();d=d.filter(B=>String(B.id).includes(A)||B.client_name&&B.client_name.toLowerCase().includes(A)||String(B.invoice_id).includes(A))}return d}),y=d=>d==="all"?s.payments.length:s.payments.filter(A=>A.status===d).length,w=d=>d?new Date(d).toLocaleDateString("fr-FR"):"",f=d=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(d),_=d=>({card:n("payments.methods.card"),bank_transfer:n("payments.methods.bankTransfer"),paypal:n("payments.methods.paypal"),cash:n("payments.methods.cash")})[d]||d,R=d=>({completed:n("payments.statuses.completed"),pending:n("payments.statuses.pending"),refunded:n("payments.statuses.refunded"),failed:n("payments.statuses.failed")})[d]||d,D=()=>{p.value=null,r.value="create",t.value=!0},b=d=>{p.value=d,r.value="edit",t.value=!0},g=d=>{p.value=d,r.value="view",t.value=!0},S=d=>{p.value=d,r.value="refund",t.value=!0},m=()=>{t.value=!1},l=()=>{s.fetchPayments()},c=()=>{s.fetchPayments()},a=()=>{s.fetchPayments()},x=()=>{};return Fe(async()=>{console.log("PaymentsView - Chargement des données"),await s.fetchPayments()}),(d,A)=>(q(),K("div",Oh,[e("div",Bh,[e("div",null,[e("h1",Th,T(d.$t("payments.title")),1),e("span",kh,T(d.$t("payments.description")),1)]),e("button",{class:"btn btn-primary",onClick:D},[A[3]||(A[3]=e("i",{class:"fas fa-plus"},null,-1)),ie(" "+T(d.$t("payments.actions.add")),1)])]),e("div",$h,[e("div",Fh,[e("div",Ph,[e("label",Mh,T(d.$t("payments.filters.search")),1),e("div",Ih,[A[4]||(A[4]=e("i",{class:"fas fa-search"},null,-1)),Z(e("input",{type:"text","onUpdate:modelValue":A[0]||(A[0]=B=>h.value=B),class:"filter-input",placeholder:d.$t("payments.search.placeholder")},null,8,Nh),[[le,h.value]])])]),e("div",Uh,[e("label",Lh,T(d.$t("payments.filters.status")),1),e("div",Hh,[A[5]||(A[5]=e("i",{class:"fas fa-money-bill-wave"},null,-1)),Z(e("select",{"onUpdate:modelValue":A[1]||(A[1]=B=>i.value=B),class:"filter-input"},[(q(!0),K(_e,null,Se(v.value,B=>(q(),K("option",{key:B.value,value:B.value},T(B.label)+" ("+T(y(B.value))+") ",9,jh))),128))],512),[[xe,i.value]])])]),e("div",Vh,[e("label",Gh,T(d.$t("payments.filters.payment_method")),1),e("div",Wh,[A[6]||(A[6]=e("i",{class:"fas fa-credit-card"},null,-1)),Z(e("select",{"onUpdate:modelValue":A[2]||(A[2]=B=>C.value=B),class:"filter-input"},[e("option",zh,T(d.$t("payments.filters.all_methods")),1),e("option",qh,T(d.$t("payments.methods.card")),1),e("option",Kh,T(d.$t("payments.methods.bank_transfer")),1),e("option",Xh,T(d.$t("payments.methods.paypal")),1)],512),[[xe,C.value]])])]),e("div",Jh,[A[8]||(A[8]=e("label",{class:"filter-label"}," ",-1)),e("div",Qh,[e("button",{onClick:x,class:"btn btn-gradient filter-button"},[A[7]||(A[7]=e("i",{class:"fas fa-filter"},null,-1)),ie(" "+T(d.$t("payments.filters.apply")),1)])])])])]),e("div",Yh,[!u.value&&E.value.length>0?(q(),K("table",Zh,[e("thead",null,[e("tr",null,[e("th",null,T(d.$t("payments.table.id")),1),e("th",null,T(d.$t("payments.table.client")),1),e("th",null,T(d.$t("payments.table.invoice")),1),e("th",null,T(d.$t("payments.table.date")),1),e("th",null,T(d.$t("payments.table.amount")),1),e("th",null,T(d.$t("payments.table.method")),1),e("th",null,T(d.$t("payments.table.status")),1),e("th",null,T(d.$t("payments.table.actions")),1)])]),e("tbody",null,[(q(!0),K(_e,null,Se(E.value,B=>(q(),K("tr",{key:B.id},[e("td",null,T(B.id),1),e("td",null,T(B.client_name),1),e("td",null,T(B.invoice_id),1),e("td",null,T(w(B.date)),1),e("td",null,T(f(B.amount)),1),e("td",null,T(_(B.method)),1),e("td",null,[e("span",{class:ce(["status-badge",B.status])},T(R(B.status)),3)]),e("td",ev,[e("button",{class:"action-btn view-btn",onClick:O=>g(B.id),title:"Voir"},A[9]||(A[9]=[e("i",{class:"fas fa-eye"},null,-1)]),8,tv),e("button",{class:"action-btn edit-btn",onClick:O=>b(B.id),title:"Modifier"},A[10]||(A[10]=[e("i",{class:"fas fa-edit"},null,-1)]),8,nv),B.status==="completed"?(q(),K("button",{key:0,class:"action-btn refund-btn",onClick:O=>S(B.id),title:"Rembourser"},A[11]||(A[11]=[e("i",{class:"fas fa-undo"},null,-1)]),8,rv)):ae("",!0)])]))),128))])])):u.value?(q(),K("div",sv,[A[12]||(A[12]=e("div",{class:"spinner"},null,-1)),e("p",null,T(d.$t("common.loading")),1)])):(q(),K("div",ov,[A[13]||(A[13]=e("i",{class:"fas fa-money-bill-wave empty-icon"},null,-1)),e("h3",null,T(d.$t("payments.empty.title")),1),e("p",null,T(d.$t("payments.empty.message")),1),e("button",{class:"btn btn-primary",onClick:D},T(d.$t("payments.actions.add")),1)]))]),t.value?(q(),K("div",{key:0,class:"modal-backdrop",onClick:Re(m,["self"])},[e("div",iv,[Ce(Dh,{"payment-id":p.value,mode:r.value,onClose:m,onCreated:l,onUpdated:c,onRefunded:a,onEdit:b},null,8,["payment-id","mode"])])])):ae("",!0)]))}}),zs=je("subscriptions",{state:()=>({subscriptions:[],currentSubscription:null,loading:!1,error:null}),getters:{getSubscriptionById:o=>n=>o.subscriptions.find(s=>s.id===n)||null,getSubscriptionsByStatus:o=>n=>n==="all"?o.subscriptions:o.subscriptions.filter(s=>s.status===n),getActiveSubscriptions:o=>o.subscriptions.filter(n=>n.status==="active"),getExpiringSoonSubscriptions:o=>{const n=new Date,s=new Date;return s.setDate(n.getDate()+30),o.subscriptions.filter(t=>{if(t.status!=="active"||!t.renewal_date)return!1;const r=new Date(t.renewal_date);return r>n&&r<=s})}},actions:{async fetchSubscriptions(){var o,n;this.loading=!0,this.error=null;try{const s=await fe.get("/api/v1/subscriptions");this.subscriptions=s.data.subscriptions}catch(s){console.error("Erreur lors du chargement des abonnements:",s),this.error=((n=(o=s.response)==null?void 0:o.data)==null?void 0:n.message)||"Erreur lors du chargement des abonnements",ye().addNotification({title:"Erreur",message:this.error,type:"error"})}finally{this.loading=!1}},async fetchSubscription(o){var n,s;this.loading=!0,this.error=null;try{const t=await fe.get(`/api/v1/subscriptions/${o}`);return this.currentSubscription=t.data.subscription,t.data.subscription}catch(t){return console.error(`Erreur lors du chargement de l'abonnement ${o}:`,t),this.error=((s=(n=t.response)==null?void 0:n.data)==null?void 0:s.message)||`Erreur lors du chargement de l'abonnement ${o}`,ye().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async createSubscription(o){var n,s;this.loading=!0,this.error=null;try{const t=await fe.post("/api/v1/subscriptions",o);return this.subscriptions.unshift(t.data.subscription),ye().addNotification({title:"Succès",message:"Abonnement créé avec succès",type:"success"}),t.data.subscription}catch(t){return console.error("Erreur lors de la création de l'abonnement:",t),this.error=((s=(n=t.response)==null?void 0:n.data)==null?void 0:s.message)||"Erreur lors de la création de l'abonnement",ye().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async updateSubscription(o){var n,s;this.loading=!0,this.error=null;try{const t=await fe.put(`/api/v1/subscriptions/${o.id}`,o),r=this.subscriptions.findIndex(i=>i.id===o.id);return r!==-1&&(this.subscriptions[r]=t.data.subscription),ye().addNotification({title:"Succès",message:"Abonnement mis à jour avec succès",type:"success"}),t.data.subscription}catch(t){return console.error(`Erreur lors de la mise à jour de l'abonnement ${o.id}:`,t),this.error=((s=(n=t.response)==null?void 0:n.data)==null?void 0:s.message)||`Erreur lors de la mise à jour de l'abonnement ${o.id}`,ye().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async cancelSubscription(o,n){var s,t;this.loading=!0,this.error=null;try{const r=await fe.put(`/api/v1/subscriptions/${o}/cancel`,{reason:n}),p=this.subscriptions.findIndex(h=>h.id===o);return p!==-1&&(this.subscriptions[p]=r.data.subscription),ye().addNotification({title:"Succès",message:"Abonnement annulé avec succès",type:"success"}),r.data.subscription}catch(r){return console.error(`Erreur lors de l'annulation de l'abonnement ${o}:`,r),this.error=((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.message)||`Erreur lors de l'annulation de l'abonnement ${o}`,ye().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}},async renewSubscription(o){var n,s;this.loading=!0,this.error=null;try{const t=await fe.put(`/api/v1/subscriptions/${o}/renew`),r=this.subscriptions.findIndex(i=>i.id===o);return r!==-1&&(this.subscriptions[r]=t.data.subscription),ye().addNotification({title:"Succès",message:"Abonnement renouvelé avec succès",type:"success"}),t.data.subscription}catch(t){return console.error(`Erreur lors du renouvellement de l'abonnement ${o}:`,t),this.error=((s=(n=t.response)==null?void 0:n.data)==null?void 0:s.message)||`Erreur lors du renouvellement de l'abonnement ${o}`,ye().addNotification({title:"Erreur",message:this.error,type:"error"}),null}finally{this.loading=!1}}}}),av={class:"modal-container"},lv={class:"modal-header"},cv={class:"modal-body"},uv={class:"form-group"},dv=["disabled"],fv=["value"],pv={class:"form-group"},hv=["value"],vv={class:"form-group"},mv={class:"form-group"},gv={class:"form-group"},yv={class:"form-group"},xv={class:"form-group"},bv={class:"form-group form-check"},Cv={class:"form-group"},Av={class:"form-actions"},Ev={type:"submit",class:"btn btn-primary"},_v={key:1,class:"subscription-details"},Sv={class:"detail-row"},wv={class:"detail-value"},Rv={class:"detail-row"},Dv={class:"detail-value"},Ov={class:"detail-row"},Bv={class:"detail-value"},Tv={class:"detail-row"},kv={class:"detail-value"},$v={class:"detail-row"},Fv={class:"detail-value"},Pv={class:"detail-row"},Mv={class:"detail-value"},Iv={class:"detail-row"},Nv={class:"detail-value"},Uv={class:"detail-row"},Lv={class:"detail-value"},Hv={class:"detail-row"},jv={class:"detail-value"},Vv={class:"detail-row"},Gv={class:"detail-value"},Wv={class:"detail-row"},zv={class:"detail-value"},qv={key:0,class:"detail-row"},Kv={class:"detail-value"},Xv={class:"form-actions"},Jv={key:0,class:"confirmation-modal"},Qv={class:"confirmation-content"},Yv={class:"form-group"},Zv={class:"confirmation-actions"},em=ke({__name:"SubscriptionModal",props:{subscriptionId:{type:Number,default:null},mode:{type:String,default:"create",validator:o=>["create","edit","view"].includes(o)}},emits:["close","created","updated","cancelled","renewed"],setup(o,{emit:n}){const s=o,t=n,r=zs(),p=Ut(),i=Hs(),h=Q({id:null,client_id:"",service_id:"",start_date:new Date().toISOString().split("T")[0],end_date:"",price:0,billing_cycle:"monthly",status:"active",auto_renew:!0,notes:""}),C=Q(!1),u=Q(""),v=ue(()=>s.mode==="edit"),E=ue(()=>s.mode==="view"),y=ue(()=>p.clients),w=ue(()=>i.services),f=ue(()=>r.currentSubscription||{}),_=a=>a?new Date(a).toLocaleDateString("fr-FR"):"",R=a=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(a),D=a=>({monthly:"Mensuel",quarterly:"Trimestriel",semi_annual:"Semestriel",annual:"Annuel"})[a]||a,b=a=>({active:"Actif",pending:"En attente",cancelled:"Annulé",expired:"Expiré"})[a]||a,g=async()=>{if(s.subscriptionId&&(await r.fetchSubscription(s.subscriptionId),r.currentSubscription)){const a=r.currentSubscription;h.value={id:a.id,client_id:a.client_id,service_id:a.service_id,start_date:a.start_date.split("T")[0],end_date:a.end_date?a.end_date.split("T")[0]:"",price:a.price,billing_cycle:a.billing_cycle,status:a.status,auto_renew:a.auto_renew,notes:a.notes||""}}},S=async()=>{if(v.value&&h.value.id){const a=await r.updateSubscription(h.value);a&&(t("updated",a),t("close"))}else{const a=await r.createSubscription(h.value);a&&(t("created",a),t("close"))}},m=async()=>{if(s.subscriptionId&&u.value.trim()){const a=await r.cancelSubscription(s.subscriptionId,u.value);a&&(t("cancelled",a),C.value=!1,t("close"))}},l=async()=>{if(s.subscriptionId){const a=await r.renewSubscription(s.subscriptionId);a&&(t("renewed",a),t("close"))}},c=()=>{t("close"),t("edit",s.subscriptionId)};return Fe(async()=>{p.clients.length||await p.fetchClients(),i.services.length||await i.fetchServices(),s.mode!=="create"&&await g()}),pt(()=>s.subscriptionId,async a=>{a&&(v.value||E.value)&&await g()}),(a,x)=>(q(),K("div",av,[e("div",lv,[e("h3",null,T(v.value?"Modifier l'abonnement":E.value?"Détails de l'abonnement":"Nouvel abonnement"),1),e("button",{class:"close-btn",onClick:x[0]||(x[0]=d=>a.$emit("close"))},"×")]),e("div",cv,[E.value?ae("",!0):(q(),K("form",{key:0,onSubmit:Re(S,["prevent"])},[e("div",uv,[x[16]||(x[16]=e("label",{for:"client"},"Client",-1)),Z(e("select",{id:"client","onUpdate:modelValue":x[1]||(x[1]=d=>h.value.client_id=d),class:"form-control",disabled:v.value,required:""},[x[15]||(x[15]=e("option",{value:""},"Sélectionner un client",-1)),(q(!0),K(_e,null,Se(y.value,d=>(q(),K("option",{key:d.id,value:d.id},T(d.firstname)+" "+T(d.lastname)+" ("+T(d.email)+") ",9,fv))),128))],8,dv),[[xe,h.value.client_id]])]),e("div",pv,[x[18]||(x[18]=e("label",{for:"service"},"Service",-1)),Z(e("select",{id:"service","onUpdate:modelValue":x[2]||(x[2]=d=>h.value.service_id=d),class:"form-control",required:""},[x[17]||(x[17]=e("option",{value:""},"Sélectionner un service",-1)),(q(!0),K(_e,null,Se(w.value,d=>(q(),K("option",{key:d.id,value:d.id},T(d.name),9,hv))),128))],512),[[xe,h.value.service_id]])]),e("div",vv,[x[19]||(x[19]=e("label",{for:"start_date"},"Date de début",-1)),Z(e("input",{type:"date",id:"start_date","onUpdate:modelValue":x[3]||(x[3]=d=>h.value.start_date=d),class:"form-control",required:""},null,512),[[le,h.value.start_date]])]),e("div",mv,[x[20]||(x[20]=e("label",{for:"end_date"},"Date de fin (optionnel)",-1)),Z(e("input",{type:"date",id:"end_date","onUpdate:modelValue":x[4]||(x[4]=d=>h.value.end_date=d),class:"form-control"},null,512),[[le,h.value.end_date]])]),e("div",gv,[x[21]||(x[21]=e("label",{for:"price"},"Prix",-1)),Z(e("input",{type:"number",id:"price","onUpdate:modelValue":x[5]||(x[5]=d=>h.value.price=d),class:"form-control",step:"0.01",min:"0",required:""},null,512),[[le,h.value.price]])]),e("div",yv,[x[23]||(x[23]=e("label",{for:"billing_cycle"},"Cycle de facturation",-1)),Z(e("select",{id:"billing_cycle","onUpdate:modelValue":x[6]||(x[6]=d=>h.value.billing_cycle=d),class:"form-control",required:""},x[22]||(x[22]=[e("option",{value:"monthly"},"Mensuel",-1),e("option",{value:"quarterly"},"Trimestriel",-1),e("option",{value:"semi_annual"},"Semestriel",-1),e("option",{value:"annual"},"Annuel",-1)]),512),[[xe,h.value.billing_cycle]])]),e("div",xv,[x[25]||(x[25]=e("label",{for:"status"},"Statut",-1)),Z(e("select",{id:"status","onUpdate:modelValue":x[7]||(x[7]=d=>h.value.status=d),class:"form-control",required:""},x[24]||(x[24]=[e("option",{value:"active"},"Actif",-1),e("option",{value:"pending"},"En attente",-1),e("option",{value:"cancelled"},"Annulé",-1),e("option",{value:"expired"},"Expiré",-1)]),512),[[xe,h.value.status]])]),e("div",bv,[Z(e("input",{type:"checkbox",id:"auto_renew","onUpdate:modelValue":x[8]||(x[8]=d=>h.value.auto_renew=d),class:"form-check-input"},null,512),[[Oe,h.value.auto_renew]]),x[26]||(x[26]=e("label",{class:"form-check-label",for:"auto_renew"},"Renouvellement automatique",-1))]),e("div",Cv,[x[27]||(x[27]=e("label",{for:"notes"},"Notes",-1)),Z(e("textarea",{id:"notes","onUpdate:modelValue":x[9]||(x[9]=d=>h.value.notes=d),class:"form-control",rows:"3"},null,512),[[le,h.value.notes]])]),e("div",Av,[e("button",{type:"button",class:"btn btn-secondary",onClick:x[10]||(x[10]=d=>a.$emit("close"))},"Annuler"),e("button",Ev,T(v.value?"Mettre à jour":"Créer"),1)])],32)),E.value?(q(),K("div",_v,[e("div",Sv,[x[28]||(x[28]=e("div",{class:"detail-label"},"Client:",-1)),e("div",wv,T(f.value.client_name),1)]),e("div",Rv,[x[29]||(x[29]=e("div",{class:"detail-label"},"Service:",-1)),e("div",Dv,T(f.value.service_name),1)]),e("div",Ov,[x[30]||(x[30]=e("div",{class:"detail-label"},"Date de début:",-1)),e("div",Bv,T(_(f.value.start_date)),1)]),e("div",Tv,[x[31]||(x[31]=e("div",{class:"detail-label"},"Date de fin:",-1)),e("div",kv,T(f.value.end_date?_(f.value.end_date):"N/A"),1)]),e("div",$v,[x[32]||(x[32]=e("div",{class:"detail-label"},"Date de renouvellement:",-1)),e("div",Fv,T(f.value.renewal_date?_(f.value.renewal_date):"N/A"),1)]),e("div",Pv,[x[33]||(x[33]=e("div",{class:"detail-label"},"Prix:",-1)),e("div",Mv,T(R(f.value.price)),1)]),e("div",Iv,[x[34]||(x[34]=e("div",{class:"detail-label"},"Cycle de facturation:",-1)),e("div",Nv,T(D(f.value.billing_cycle)),1)]),e("div",Uv,[x[35]||(x[35]=e("div",{class:"detail-label"},"Statut:",-1)),e("div",Lv,[e("span",{class:ce("status-badge "+f.value.status)},T(b(f.value.status)),3)])]),e("div",Hv,[x[36]||(x[36]=e("div",{class:"detail-label"},"Renouvellement automatique:",-1)),e("div",jv,T(f.value.auto_renew?"Oui":"Non"),1)]),e("div",Vv,[x[37]||(x[37]=e("div",{class:"detail-label"},"Notes:",-1)),e("div",Gv,T(f.value.notes||"Aucune note"),1)]),e("div",Wv,[x[38]||(x[38]=e("div",{class:"detail-label"},"Créé le:",-1)),e("div",zv,T(_(f.value.created_at)),1)]),f.value.updated_at?(q(),K("div",qv,[x[39]||(x[39]=e("div",{class:"detail-label"},"Mis à jour le:",-1)),e("div",Kv,T(_(f.value.updated_at)),1)])):ae("",!0),e("div",Xv,[e("button",{type:"button",class:"btn btn-secondary",onClick:x[11]||(x[11]=d=>a.$emit("close"))},"Fermer"),f.value.status==="active"?(q(),K("button",{key:0,type:"button",class:"btn btn-danger",onClick:x[12]||(x[12]=d=>C.value=!0)}," Annuler l'abonnement ")):ae("",!0),f.value.status!=="active"?(q(),K("button",{key:1,type:"button",class:"btn btn-success",onClick:l}," Renouveler ")):ae("",!0),e("button",{type:"button",class:"btn btn-primary",onClick:c}," Modifier ")])])):ae("",!0)]),C.value?(q(),K("div",Jv,[e("div",Qv,[x[41]||(x[41]=e("h4",null,"Confirmer l'annulation",-1)),x[42]||(x[42]=e("p",null,"Êtes-vous sûr de vouloir annuler cet abonnement ?",-1)),e("div",Yv,[x[40]||(x[40]=e("label",{for:"cancel_reason"},"Raison de l'annulation",-1)),Z(e("textarea",{id:"cancel_reason","onUpdate:modelValue":x[13]||(x[13]=d=>u.value=d),class:"form-control",rows:"3",required:""},null,512),[[le,u.value]])]),e("div",Zv,[e("button",{type:"button",class:"btn btn-secondary",onClick:x[14]||(x[14]=d=>C.value=!1)},"Non"),e("button",{type:"button",class:"btn btn-danger",onClick:m},"Oui, annuler")])])])):ae("",!0)]))}}),tm=Pe(em,[["__scopeId","data-v-beee17d1"]]),nm={class:"subscriptions-view view-container"},rm={class:"header-box"},sm={class:"page-title"},om={class:"page-description"},im={class:"filter-box"},am={class:"filter-grid"},lm={class:"filter-group"},cm={class:"filter-label"},um={class:"filter-input-wrapper"},dm=["placeholder"],fm={class:"filter-group"},pm={class:"filter-label"},hm={class:"filter-input-wrapper"},vm=["value"],mm={class:"filter-group"},gm={class:"filter-label"},ym={class:"filter-input-wrapper"},xm={value:""},bm={value:"monthly"},Cm={value:"quarterly"},Am={value:"semi_annual"},Em={value:"annual"},_m={class:"filter-group"},Sm={class:"filter-input-wrapper"},wm={class:"table-box"},Rm={key:0,class:"subscriptions-table"},Dm={class:"actions-cell"},Om=["onClick"],Bm=["onClick"],Tm=["onClick"],km=["onClick"],$m={key:1,class:"loading-container"},Fm={key:2,class:"empty-state"},Pm={class:"modal-box"},qs=ke({__name:"SubscriptionsView",setup(o){const{t:n}=Le(),s=zs(),t=Q(!1),r=Q("create"),p=Q(null),i=Q("all"),h=Q(""),C=Q(""),u=ue(()=>s.loading),v=ue(()=>[{value:"all",label:n("subscriptions.filters.all")},{value:"active",label:n("subscriptions.filters.active")},{value:"pending",label:n("subscriptions.filters.pending")},{value:"cancelled",label:n("subscriptions.filters.cancelled")},{value:"expired",label:n("subscriptions.filters.expired")}]),E=ue(()=>{let B=s.subscriptions;if(i.value!=="all"&&(B=B.filter(O=>O.status===i.value)),h.value.trim()){const O=h.value.toLowerCase();B=B.filter(k=>String(k.id).includes(O)||k.client_name&&k.client_name.toLowerCase().includes(O)||k.service_name&&k.service_name.toLowerCase().includes(O))}return C.value&&(B=B.filter(O=>O.billing_cycle===C.value)),B}),y=B=>B==="all"?s.subscriptions.length:s.subscriptions.filter(O=>O.status===B).length,w=B=>B?new Date(B).toLocaleDateString("fr-FR"):"",f=B=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(B),_=B=>({monthly:n("subscriptions.billingCycles.monthly"),quarterly:n("subscriptions.billingCycles.quarterly"),semi_annual:n("subscriptions.billingCycles.semiAnnual"),annual:n("subscriptions.billingCycles.annual")})[B]||B,R=B=>({active:n("subscriptions.statuses.active"),pending:n("subscriptions.statuses.pending"),cancelled:n("subscriptions.statuses.cancelled"),expired:n("subscriptions.statuses.expired")})[B]||B,D=()=>{p.value=null,r.value="create",t.value=!0},b=B=>{p.value=B,r.value="edit",t.value=!0},g=B=>{p.value=B,r.value="view",t.value=!0},S=B=>{p.value=B,r.value="view",t.value=!0},m=()=>{t.value=!1},l=()=>{s.fetchSubscriptions()},c=()=>{s.fetchSubscriptions()},a=()=>{s.fetchSubscriptions()},x=async B=>{await s.renewSubscription(B),s.fetchSubscriptions()},d=()=>{s.fetchSubscriptions()},A=()=>{};return Fe(async()=>{await s.fetchSubscriptions()}),(B,O)=>(q(),K("div",nm,[e("div",rm,[e("div",null,[e("h1",sm,T(B.$t("subscriptions.title")),1),e("span",om,T(B.$t("subscriptions.description")),1)]),e("button",{class:"btn btn-primary",onClick:D},[O[3]||(O[3]=e("i",{class:"fas fa-plus"},null,-1)),ie(" "+T(B.$t("subscriptions.actions.add")),1)])]),e("div",im,[e("div",am,[e("div",lm,[e("label",cm,T(B.$t("subscriptions.filters.search")),1),e("div",um,[O[4]||(O[4]=e("i",{class:"fas fa-search"},null,-1)),Z(e("input",{type:"text","onUpdate:modelValue":O[0]||(O[0]=k=>h.value=k),class:"filter-input",placeholder:B.$t("subscriptions.search.placeholder")},null,8,dm),[[le,h.value]])])]),e("div",fm,[e("label",pm,T(B.$t("subscriptions.filters.status")),1),e("div",hm,[O[5]||(O[5]=e("i",{class:"fas fa-sync-alt"},null,-1)),Z(e("select",{"onUpdate:modelValue":O[1]||(O[1]=k=>i.value=k),class:"filter-input"},[(q(!0),K(_e,null,Se(v.value,k=>(q(),K("option",{key:k.value,value:k.value},T(k.label)+" ("+T(y(k.value))+") ",9,vm))),128))],512),[[xe,i.value]])])]),e("div",mm,[e("label",gm,T(B.$t("subscriptions.filters.billing_cycle")),1),e("div",ym,[O[6]||(O[6]=e("i",{class:"fas fa-calendar-alt"},null,-1)),Z(e("select",{"onUpdate:modelValue":O[2]||(O[2]=k=>C.value=k),class:"filter-input"},[e("option",xm,T(B.$t("subscriptions.filters.all_cycles")),1),e("option",bm,T(B.$t("subscriptions.billingCycles.monthly")),1),e("option",Cm,T(B.$t("subscriptions.billingCycles.quarterly")),1),e("option",Am,T(B.$t("subscriptions.billingCycles.semiAnnual")),1),e("option",Em,T(B.$t("subscriptions.billingCycles.annual")),1)],512),[[xe,C.value]])])]),e("div",_m,[O[8]||(O[8]=e("label",{class:"filter-label"}," ",-1)),e("div",Sm,[e("button",{onClick:A,class:"btn btn-gradient filter-button"},[O[7]||(O[7]=e("i",{class:"fas fa-filter"},null,-1)),ie(" "+T(B.$t("subscriptions.filters.apply")),1)])])])])]),e("div",wm,[!u.value&&E.value.length>0?(q(),K("table",Rm,[e("thead",null,[e("tr",null,[e("th",null,T(B.$t("subscriptions.table.id")),1),e("th",null,T(B.$t("subscriptions.table.client")),1),e("th",null,T(B.$t("subscriptions.table.service")),1),e("th",null,T(B.$t("subscriptions.table.startDate")),1),e("th",null,T(B.$t("subscriptions.table.renewalDate")),1),e("th",null,T(B.$t("subscriptions.table.price")),1),e("th",null,T(B.$t("subscriptions.table.billingCycle")),1),e("th",null,T(B.$t("subscriptions.table.status")),1),e("th",null,T(B.$t("subscriptions.table.actions")),1)])]),e("tbody",null,[(q(!0),K(_e,null,Se(E.value,k=>(q(),K("tr",{key:k.id},[e("td",null,T(k.id),1),e("td",null,T(k.client_name),1),e("td",null,T(k.service_name),1),e("td",null,T(w(k.start_date)),1),e("td",null,T(k.renewal_date?w(k.renewal_date):"-"),1),e("td",null,T(f(k.price)),1),e("td",null,T(_(k.billing_cycle)),1),e("td",null,[e("span",{class:ce(["status-badge",k.status])},T(R(k.status)),3)]),e("td",Dm,[e("button",{class:"action-btn view-btn",onClick:F=>g(k.id),title:"Voir"},O[9]||(O[9]=[e("i",{class:"fas fa-eye"},null,-1)]),8,Om),e("button",{class:"action-btn edit-btn",onClick:F=>b(k.id),title:"Modifier"},O[10]||(O[10]=[e("i",{class:"fas fa-edit"},null,-1)]),8,Bm),k.status==="active"?(q(),K("button",{key:0,class:"action-btn cancel-btn",onClick:F=>S(k.id),title:"Annuler"},O[11]||(O[11]=[e("i",{class:"fas fa-ban"},null,-1)]),8,Tm)):ae("",!0),k.status!=="active"?(q(),K("button",{key:1,class:"action-btn renew-btn",onClick:F=>x(k.id),title:"Renouveler"},O[12]||(O[12]=[e("i",{class:"fas fa-sync"},null,-1)]),8,km)):ae("",!0)])]))),128))])])):u.value?(q(),K("div",$m,[O[13]||(O[13]=e("div",{class:"spinner"},null,-1)),e("p",null,T(B.$t("common.loading")),1)])):(q(),K("div",Fm,[O[14]||(O[14]=e("i",{class:"fas fa-calendar-alt empty-icon"},null,-1)),e("h3",null,T(B.$t("subscriptions.empty.title")),1),e("p",null,T(B.$t("subscriptions.empty.message")),1),e("button",{class:"btn btn-primary",onClick:D},T(B.$t("subscriptions.actions.add")),1)]))]),t.value?(q(),K("div",{key:0,class:"modal-backdrop",onClick:Re(m,["self"])},[e("div",Pm,[Ce(tm,{"subscription-id":p.value,mode:r.value,onClose:m,onCreated:l,onUpdated:c,onCancelled:a,onRenewed:d,onEdit:b},null,8,["subscription-id","mode"])])])):ae("",!0)]))}}),Ks=je("tickets",()=>{const o=Q([]),n=Q(!1),s=Q(null),t=ue(()=>o.value),r=ue(()=>o.value.filter(_=>_.status==="open")),p=ue(()=>o.value.filter(_=>_.priority==="urgent")),i=ue(()=>o.value.filter(_=>!_.assignedTo));return{tickets:o,loading:n,error:s,allTickets:t,openTickets:r,urgentTickets:p,unassignedTickets:i,fetchTickets:async()=>{try{n.value=!0;const _=await fe.get("/api/v1/tickets");return o.value=_.data.tickets,_.data.tickets}catch(_){throw s.value=_,_}finally{n.value=!1}},getTicket:async _=>{try{return n.value=!0,(await fe.get(`/api/v1/tickets/${_}`)).data.ticket}catch(R){throw s.value=R,R}finally{n.value=!1}},createTicket:async _=>{try{n.value=!0;const R=await fe.post("/api/v1/tickets",_);return o.value.push(R.data.ticket),R.data.ticket}catch(R){throw s.value=R,R}finally{n.value=!1}},updateTicket:async _=>{try{n.value=!0;const R=await fe.put(`/api/v1/tickets/${_.id}`,_),D=o.value.findIndex(b=>b.id===_.id);return D!==-1&&(o.value[D]=R.data.ticket),R.data.ticket}catch(R){throw s.value=R,R}finally{n.value=!1}},deleteTicket:async _=>{try{n.value=!0,await fe.delete(`/api/v1/tickets/${_}`),o.value=o.value.filter(R=>R.id!==_)}catch(R){throw s.value=R,R}finally{n.value=!1}},addReply:async(_,R)=>{try{return n.value=!0,(await fe.post(`/api/v1/tickets/${_}/replies`,R)).data.ticket}catch(D){throw s.value=D,D}finally{n.value=!1}},closeTicket:async _=>{try{n.value=!0;const R=await fe.post(`/api/v1/tickets/${_}/close`),D=o.value.findIndex(b=>b.id===_);return D!==-1&&(o.value[D]=R.data.ticket),R.data.ticket}catch(R){throw s.value=R,R}finally{n.value=!1}},reopenTicket:async _=>{try{n.value=!0;const R=await fe.post(`/api/v1/tickets/${_}/reopen`),D=o.value.findIndex(b=>b.id===_);return D!==-1&&(o.value[D]=R.data.ticket),R.data.ticket}catch(R){throw s.value=R,R}finally{n.value=!1}}}}),Mm={class:"modal-container"},Im={class:"modal-header"},Nm={class:"modal-body"},Um={key:0,class:"ticket-details"},Lm={class:"ticket-header"},Hm={class:"ticket-id"},jm={class:"ticket-subject"},Vm={class:"ticket-meta"},Gm={class:"ticket-client"},Wm={class:"ticket-date"},zm={class:"ticket-messages"},qm={key:0},Km={class:"message-header"},Xm={class:"author"},Jm={class:"date"},Qm={class:"message-content"},Ym={key:1,class:"no-messages"},Zm={class:"reply-form"},e1=["placeholder"],t1={class:"form-actions"},n1=["disabled"],r1={class:"form-group"},s1=["disabled"],o1={value:""},i1=["value"],a1={class:"form-group"},l1={class:"form-row"},c1={class:"form-group"},u1={value:"low"},d1={value:"medium"},f1={value:"high"},p1={value:"urgent"},h1={key:0,class:"form-group"},v1={value:"open"},m1={value:"pending"},g1={value:"resolved"},y1={value:"closed"},x1={key:0,class:"form-group"},b1={class:"form-actions"},C1=["disabled"],A1={key:0,class:"fas fa-spinner fa-spin"},E1={__name:"TicketModal",props:{ticket:{type:Object,required:!0},mode:{type:String,default:"create",validator:o=>["create","edit","view"].includes(o)}},emits:["close","created","updated"],setup(o,{emit:n}){const s=o,t=n,{t:r}=Le(),p=Ks(),i=Ut(),h=ct(),C=ye(),u=Q({...s.ticket}),v=Q(!1),E=Q(""),y=ue(()=>i.clients),w=ue(()=>s.mode==="create"?r("tickets.modal.add_title"):s.mode==="edit"?r("tickets.modal.edit_title"):r("tickets.modal.view_title")),f=ue(()=>s.mode==="create"?r("tickets.actions.create"):r("tickets.actions.update"));function _(S){if(!S)return"-";const m=new Date(S);return new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(m)}function R(S){return{low:r("tickets.priority.low"),medium:r("tickets.priority.medium"),high:r("tickets.priority.high"),urgent:r("tickets.priority.urgent")}[S]||S}function D(S){return{open:r("tickets.status.open"),pending:r("tickets.status.pending"),closed:r("tickets.status.closed"),resolved:r("tickets.status.resolved")}[S]||S}async function b(){try{v.value=!0,s.mode==="create"?(await p.createTicket(u.value),C.showNotification("success",r("tickets.success.create")),t("created")):(await p.updateTicket(u.value),C.showNotification("success",r("tickets.success.update")),t("updated"))}catch(S){console.error("Error submitting ticket:",S),C.showNotification("error",s.mode==="create"?r("tickets.errors.create"):r("tickets.errors.update"))}finally{v.value=!1}}async function g(){if(E.value.trim())try{v.value=!0,await p.addReply(s.ticket.id,{message:E.value,user_id:h.currentUser.id,user_type:"admin"}),E.value="";const S=await p.getTicket(s.ticket.id);Object.assign(s.ticket,S),C.showNotification("success",r("tickets.success.reply"))}catch(S){console.error("Error submitting reply:",S),C.showNotification("error",r("tickets.errors.reply"))}finally{v.value=!1}}return Fe(()=>{(s.mode==="create"||s.mode==="edit")&&(u.value={...s.ticket})}),(S,m)=>(q(),K("div",{class:"modal-overlay",onClick:m[8]||(m[8]=Re(l=>S.$emit("close"),["self"]))},[e("div",Mm,[e("div",Im,[e("h2",null,T(w.value),1),e("button",{class:"close-btn",onClick:m[0]||(m[0]=l=>S.$emit("close"))},m[9]||(m[9]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",Nm,[o.mode==="view"?(q(),K("div",Um,[e("div",Lm,[e("div",Hm,"#"+T(o.ticket.id),1),e("div",jm,T(o.ticket.subject),1),e("div",Vm,[e("span",Gm,[m[10]||(m[10]=e("i",{class:"fas fa-user"},null,-1)),ie(" "+T(o.ticket.client_name),1)]),e("span",Wm,[m[11]||(m[11]=e("i",{class:"fas fa-calendar-alt"},null,-1)),ie(" "+T(_(o.ticket.created_at)),1)]),e("span",{class:ce(["ticket-priority",`priority-${o.ticket.priority}`])},[m[12]||(m[12]=e("i",{class:"fas fa-flag"},null,-1)),ie(" "+T(R(o.ticket.priority)),1)],2),e("span",{class:ce(["ticket-status",`status-${o.ticket.status}`])},[m[13]||(m[13]=e("i",{class:"fas fa-circle"},null,-1)),ie(" "+T(D(o.ticket.status)),1)],2)])]),e("div",zm,[o.ticket.replies&&o.ticket.replies.length>0?(q(),K("div",qm,[(q(!0),K(_e,null,Se(o.ticket.replies,l=>(q(),K("div",{key:l.id,class:ce(["message",l.user_type])},[e("div",Km,[e("span",Xm,T(l.author_name),1),e("span",Jm,T(_(l.created_at)),1)]),e("div",Qm,T(l.message),1)],2))),128))])):(q(),K("div",Ym,T(S.$t("tickets.noMessages")),1))]),e("div",Zm,[e("h3",null,T(S.$t("tickets.addReply")),1),Z(e("textarea",{"onUpdate:modelValue":m[1]||(m[1]=l=>E.value=l),placeholder:S.$t("tickets.replyPlaceholder"),rows:"4",class:"form-control"},null,8,e1),[[le,E.value]]),e("div",t1,[e("button",{class:"btn btn-primary",onClick:g,disabled:!E.value.trim()||v.value},[m[14]||(m[14]=e("i",{class:"fas fa-paper-plane"},null,-1)),ie(" "+T(S.$t("tickets.sendReply")),1)],8,n1)])])])):(q(),K("form",{key:1,onSubmit:Re(b,["prevent"]),class:"ticket-form"},[e("div",r1,[e("label",null,[ie(T(S.$t("tickets.fields.client"))+" ",1),m[15]||(m[15]=e("span",{class:"required"},"*",-1))]),Z(e("select",{"onUpdate:modelValue":m[2]||(m[2]=l=>u.value.client_id=l),class:"form-control",required:"",disabled:o.mode==="edit"},[e("option",o1,T(S.$t("tickets.selectClient")),1),(q(!0),K(_e,null,Se(y.value,l=>(q(),K("option",{key:l.id,value:l.id},T(l.name),9,i1))),128))],8,s1),[[xe,u.value.client_id]])]),e("div",a1,[e("label",null,[ie(T(S.$t("tickets.fields.subject"))+" ",1),m[16]||(m[16]=e("span",{class:"required"},"*",-1))]),Z(e("input",{type:"text","onUpdate:modelValue":m[3]||(m[3]=l=>u.value.subject=l),class:"form-control",required:""},null,512),[[le,u.value.subject]])]),e("div",l1,[e("div",c1,[e("label",null,T(S.$t("tickets.fields.priority")),1),Z(e("select",{"onUpdate:modelValue":m[4]||(m[4]=l=>u.value.priority=l),class:"form-control"},[e("option",u1,T(S.$t("tickets.priority.low")),1),e("option",d1,T(S.$t("tickets.priority.medium")),1),e("option",f1,T(S.$t("tickets.priority.high")),1),e("option",p1,T(S.$t("tickets.priority.urgent")),1)],512),[[xe,u.value.priority]])]),o.mode==="edit"?(q(),K("div",h1,[e("label",null,T(S.$t("tickets.fields.status")),1),Z(e("select",{"onUpdate:modelValue":m[5]||(m[5]=l=>u.value.status=l),class:"form-control"},[e("option",v1,T(S.$t("tickets.status.open")),1),e("option",m1,T(S.$t("tickets.status.pending")),1),e("option",g1,T(S.$t("tickets.status.resolved")),1),e("option",y1,T(S.$t("tickets.status.closed")),1)],512),[[xe,u.value.status]])])):ae("",!0)]),o.mode==="create"?(q(),K("div",x1,[e("label",null,[ie(T(S.$t("tickets.fields.message"))+" ",1),m[17]||(m[17]=e("span",{class:"required"},"*",-1))]),Z(e("textarea",{"onUpdate:modelValue":m[6]||(m[6]=l=>u.value.message=l),class:"form-control",rows:"5",required:""},null,512),[[le,u.value.message]])])):ae("",!0),e("div",b1,[e("button",{type:"button",class:"btn btn-secondary",onClick:m[7]||(m[7]=l=>S.$emit("close"))},T(S.$t("common.cancel")),1),e("button",{type:"submit",class:"btn btn-primary",disabled:v.value},[v.value?(q(),K("i",A1)):ae("",!0),ie(" "+T(f.value),1)],8,C1)])],32))])])]))}},_1=Pe(E1,[["__scopeId","data-v-56d6b34a"]]),S1={class:"tickets-view view-container"},w1={class:"header-box"},R1={class:"page-title"},D1={class:"page-description"},O1={class:"filter-box"},B1={class:"filter-grid"},T1={class:"filter-group"},k1={class:"filter-label"},$1={class:"filter-input-wrapper"},F1=["placeholder"],P1={class:"filter-group"},M1={class:"filter-label"},I1={class:"filter-input-wrapper"},N1=["value"],U1={class:"filter-group"},L1={class:"filter-label"},H1={class:"filter-input-wrapper"},j1={value:""},V1={value:"low"},G1={value:"medium"},W1={value:"high"},z1={value:"urgent"},q1={class:"filter-group"},K1={class:"filter-input-wrapper"},X1={class:"table-box"},J1={key:0,class:"tickets-table"},Q1={class:"subject-cell"},Y1={class:"actions-cell"},Z1=["onClick"],eg=["onClick"],tg=["onClick"],ng=["onClick"],rg=["onClick"],sg={key:1,class:"empty-state"},og={key:2,class:"loading-container"},Xs=ke({__name:"TicketsView",setup(o){const{t:n}=Le(),s=Ks(),t=Ut(),r=ye(),p=Q(!0),i=Q([]),h=Q(""),C=Q("all"),u=Q(""),v=Q(!1),E=Q("create"),y=Q(null),w=Q(!1),f=Q(null),_=[{value:"all",label:n("tickets.filters.all")},{value:"open",label:n("tickets.filters.open")},{value:"pending",label:n("tickets.filters.pending")},{value:"closed",label:n("tickets.filters.closed")},{value:"resolved",label:n("tickets.filters.resolved")}],R=ue(()=>{let N=[...i.value];if(C.value!=="all"&&(N=N.filter(H=>H.status===C.value)),h.value){const H=h.value.toLowerCase();N=N.filter(G=>G.subject.toLowerCase().includes(H)||G.client_name.toLowerCase().includes(H)||G.id.toString().includes(H))}return u.value&&(N=N.filter(H=>H.priority===u.value)),N}),D=N=>N==="all"?i.value.length:i.value.filter(H=>H.status===N).length,b=N=>{if(!N)return"-";const H=new Date(N);return new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(H)},g=N=>`priority-${N}`,S=N=>`status-${N}`,m=N=>n(`tickets.priority.${N}`),l=N=>n(`tickets.status.${N}`),c=async()=>{p.value=!0;try{const N=await s.fetchTickets();i.value=N}catch(N){console.error("Error fetching tickets:",N),r.addNotification({title:n("common.error"),message:n("tickets.errors.fetch"),type:"error"})}finally{p.value=!1}},a=()=>{y.value=null,E.value="create",v.value=!0},x=N=>{y.value=N,E.value="view",v.value=!0},d=N=>{y.value=N,E.value="edit",v.value=!0},A=()=>{v.value=!1,y.value=null},B=()=>{c(),A(),r.addNotification({title:n("common.success"),message:n("tickets.success.create"),type:"success"})},O=()=>{c(),A(),r.addNotification({title:n("common.success"),message:n("tickets.success.update"),type:"success"})},k=N=>{f.value=N,w.value=!0},F=async()=>{if(f.value)try{await s.deleteTicket(f.value.id),r.addNotification({title:n("common.success"),message:n("tickets.success.delete"),type:"success"}),c()}catch(N){console.error("Error deleting ticket:",N),r.addNotification({title:n("common.error"),message:n("tickets.errors.delete"),type:"error"})}finally{w.value=!1,f.value=null}},M=async N=>{try{await s.closeTicket(N.id),r.addNotification({title:n("common.success"),message:n("tickets.success.close"),type:"success"}),c()}catch(H){console.error("Error closing ticket:",H),r.addNotification({title:n("common.error"),message:n("tickets.errors.close"),type:"error"})}},P=async N=>{try{await s.reopenTicket(N.id),r.addNotification({title:n("common.success"),message:n("tickets.success.reopen"),type:"success"}),c()}catch(H){console.error("Error reopening ticket:",H),r.addNotification({title:n("common.error"),message:n("tickets.errors.reopen"),type:"error"})}},U=()=>{};return Fe(async()=>{try{await t.fetchClients(),await c()}catch(N){console.error("Error initializing tickets view:",N)}}),(N,H)=>(q(),K("div",S1,[e("div",w1,[e("div",null,[e("h1",R1,T(N.$t("tickets.title")),1),e("span",D1,T(N.$t("tickets.description")),1)]),e("button",{class:"btn btn-primary",onClick:a},[H[4]||(H[4]=e("i",{class:"fas fa-plus"},null,-1)),ie(" "+T(N.$t("tickets.actions.add")),1)])]),e("div",O1,[e("div",B1,[e("div",T1,[e("label",k1,T(N.$t("tickets.filters.search")),1),e("div",$1,[H[5]||(H[5]=e("i",{class:"fas fa-search"},null,-1)),Z(e("input",{type:"text","onUpdate:modelValue":H[0]||(H[0]=G=>h.value=G),class:"filter-input",placeholder:N.$t("tickets.search.placeholder")},null,8,F1),[[le,h.value]])])]),e("div",P1,[e("label",M1,T(N.$t("tickets.filters.status")),1),e("div",I1,[H[6]||(H[6]=e("i",{class:"fas fa-ticket-alt"},null,-1)),Z(e("select",{"onUpdate:modelValue":H[1]||(H[1]=G=>C.value=G),class:"filter-input"},[(q(),K(_e,null,Se(_,G=>e("option",{key:G.value,value:G.value},T(G.label)+" ("+T(D(G.value))+") ",9,N1)),64))],512),[[xe,C.value]])])]),e("div",U1,[e("label",L1,T(N.$t("tickets.filters.priority")),1),e("div",H1,[H[7]||(H[7]=e("i",{class:"fas fa-flag"},null,-1)),Z(e("select",{"onUpdate:modelValue":H[2]||(H[2]=G=>u.value=G),class:"filter-input"},[e("option",j1,T(N.$t("tickets.priority.all")),1),e("option",V1,T(N.$t("tickets.priority.low")),1),e("option",G1,T(N.$t("tickets.priority.medium")),1),e("option",W1,T(N.$t("tickets.priority.high")),1),e("option",z1,T(N.$t("tickets.priority.urgent")),1)],512),[[xe,u.value]])])]),e("div",q1,[H[9]||(H[9]=e("label",{class:"filter-label"}," ",-1)),e("div",K1,[e("button",{onClick:U,class:"btn btn-gradient filter-button"},[H[8]||(H[8]=e("i",{class:"fas fa-filter"},null,-1)),ie(" "+T(N.$t("tickets.filters.apply")),1)])])])])]),e("div",X1,[!p.value&&R.value.length>0?(q(),K("table",J1,[e("thead",null,[e("tr",null,[e("th",null,T(N.$t("tickets.table.id")),1),e("th",null,T(N.$t("tickets.table.subject")),1),e("th",null,T(N.$t("tickets.table.client")),1),e("th",null,T(N.$t("tickets.table.priority")),1),e("th",null,T(N.$t("tickets.table.status")),1),e("th",null,T(N.$t("tickets.table.lastReply")),1),e("th",null,T(N.$t("tickets.table.createdAt")),1),e("th",null,T(N.$t("tickets.table.actions")),1)])]),e("tbody",null,[(q(!0),K(_e,null,Se(R.value,G=>(q(),K("tr",{key:G.id},[e("td",null,"#"+T(G.id),1),e("td",Q1,T(G.subject),1),e("td",null,T(G.client_name),1),e("td",null,[e("span",{class:ce(["priority-badge",g(G.priority)])},T(m(G.priority)),3)]),e("td",null,[e("span",{class:ce(["status-badge",S(G.status)])},T(l(G.status)),3)]),e("td",null,T(b(G.last_reply)),1),e("td",null,T(b(G.created_at)),1),e("td",Y1,[e("button",{class:"btn btn-sm btn-info",onClick:z=>x(G)},H[10]||(H[10]=[e("i",{class:"fas fa-eye"},null,-1)]),8,Z1),e("button",{class:"btn btn-sm btn-primary",onClick:z=>d(G)},H[11]||(H[11]=[e("i",{class:"fas fa-edit"},null,-1)]),8,eg),G.status==="closed"||G.status==="resolved"?(q(),K("button",{key:0,class:"btn btn-sm btn-success",onClick:z=>P(G)},H[12]||(H[12]=[e("i",{class:"fas fa-redo"},null,-1)]),8,tg)):(q(),K("button",{key:1,class:"btn btn-sm btn-warning",onClick:z=>M(G)},H[13]||(H[13]=[e("i",{class:"fas fa-check"},null,-1)]),8,ng)),e("button",{class:"btn btn-sm btn-danger",onClick:z=>k(G)},H[14]||(H[14]=[e("i",{class:"fas fa-trash"},null,-1)]),8,rg)])]))),128))])])):!p.value&&R.value.length===0?(q(),K("div",sg,[H[16]||(H[16]=e("i",{class:"fas fa-ticket-alt empty-icon"},null,-1)),e("h3",null,T(N.$t("tickets.empty.message")),1),e("p",null,T(N.$t("tickets.empty.description")),1),e("button",{class:"btn btn-primary",onClick:a},[H[15]||(H[15]=e("i",{class:"fas fa-plus"},null,-1)),ie(" "+T(N.$t("tickets.actions.add")),1)])])):(q(),K("div",og,[H[17]||(H[17]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),e("p",null,T(N.$t("common.loading")),1)]))]),v.value?(q(),at(_1,{key:0,ticket:y.value,mode:E.value,onClose:A,onCreated:B,onUpdated:O,class:"modal-box"},null,8,["ticket","mode"])):ae("",!0),w.value?(q(),at(Hn,{key:1,title:N.$t("tickets.confirm.delete.title"),class:"modal-box"},{footer:Ae(()=>[e("button",{class:"btn btn-danger",onClick:F},T(N.$t("common.confirm")),1),e("button",{class:"btn btn-secondary",onClick:H[3]||(H[3]=G=>w.value=!1)},T(N.$t("common.cancel")),1)]),default:Ae(()=>[e("p",null,T(N.$t("tickets.confirm.delete.message")),1)]),_:1},8,["title"])):ae("",!0)]))}}),Tt=je("license",()=>{const o=Q(null),n=Q(!1),s=Q(null),t=ye();return{licenseInfo:o,loading:n,error:s,fetchLicenseInfo:async()=>{var i,h;n.value=!0,s.value=null;try{const C=await Ee.get("/api/v1/license");return o.value=C.data.data,C.data.data}catch(C){return console.error("Erreur lors de la récupération des infos de licence:",C),s.value=((h=(i=C.response)==null?void 0:i.data)==null?void 0:h.message)||"Erreur lors de la récupération des informations de licence",null}finally{n.value=!1}},updateLicense:async i=>{var h,C;n.value=!0,s.value=null;try{const u=await Ee.put("/api/v1/license",{license_key:i});return o.value=u.data.data,t.showNotification({title:"Licence mise à jour",message:u.data.message||"La licence a été mise à jour avec succès",type:u.data.success?"success":"error"}),u.data}catch(u){return console.error("Erreur lors de la mise à jour de la licence:",u),s.value=((C=(h=u.response)==null?void 0:h.data)==null?void 0:C.message)||"Erreur lors de la mise à jour de la licence",t.showNotification({title:"Erreur",message:s.value,type:"error"}),null}finally{n.value=!1}}}}),ig=je("settings",()=>{const o=Q({general:{siteName:"",siteUrl:"",adminEmail:"",defaultLanguage:"fr",timezone:"Europe/Paris",dateFormat:"DD/MM/YYYY",timeFormat:"24h",currency:"EUR",maintenanceMode:!1,maintenanceMessage:""},security:{twoFactorAuth:!1,sessionTimeout:30,passwordPolicy:{minLength:8,requireNumbers:!0,requireSymbols:!0,requireUppercase:!0},ipWhitelist:[],apiKeys:[]},billing:{vatRate:20,defaultPaymentTerms:30,paymentMethods:{stripe:{enabled:!1,testMode:!0,publishableKey:"",secretKey:""},paypal:{enabled:!1,testMode:!0,clientId:"",clientSecret:""}},invoicePrefix:"INV-",autoReminders:!0,reminderDays:[7,3,1]},integrations:{smtp:{host:"",port:587,username:"",password:"",encryption:"tls"},webhooks:[]}}),n=Q(!1),s=Q(null),t=ue(()=>o.value),r=ue(()=>o.value.general),p=ue(()=>o.value.security),i=ue(()=>o.value.billing),h=ue(()=>o.value.integrations);return{settings:o,loading:n,error:s,allSettings:t,generalSettings:r,securitySettings:p,billingSettings:i,integrationSettings:h,fetchGeneralSettings:async()=>{try{n.value=!0;const c=await Ee.get("/api/v1/settings/general");return o.value.general=c.data,c.data}catch(c){throw s.value=c,c}finally{n.value=!1}},updateGeneralSettings:async c=>{try{n.value=!0;const a=await Ee.post("/api/v1/settings/general",c);return o.value.general=a.data,a.data}catch(a){throw s.value=a,a}finally{n.value=!1}},fetchSecuritySettings:async()=>{try{n.value=!0;const c=await Ee.get("/api/v1/settings/security");return o.value.security=c.data,c.data}catch(c){throw s.value=c,c}finally{n.value=!1}},updateSecuritySettings:async c=>{try{n.value=!0;const a=await Ee.post("/api/v1/settings/security",c);return o.value.security=a.data,a.data}catch(a){throw s.value=a,a}finally{n.value=!1}},fetchBillingSettings:async()=>{try{n.value=!0;const c=await Ee.get("/api/v1/settings/billing");return o.value.billing=c.data,c.data}catch(c){throw s.value=c,c}finally{n.value=!1}},updateBillingSettings:async c=>{try{n.value=!0;const a=await Ee.post("/api/v1/settings/billing",c);return o.value.billing=a.data,a.data}catch(a){throw s.value=a,a}finally{n.value=!1}},fetchIntegrationSettings:async()=>{try{n.value=!0;const c=await Ee.get("/api/v1/settings/integration");return o.value.integrations=c.data,c.data}catch(c){throw s.value=c,c}finally{n.value=!1}},updateIntegrationSettings:async c=>{try{n.value=!0;const a=await Ee.post("/api/v1/settings/integration",c);return o.value.integrations=a.data,a.data}catch(a){throw s.value=a,a}finally{n.value=!1}},testSmtpConnection:async()=>{try{return n.value=!0,(await Ee.post("/api/v1/settings/integrations/smtp/test")).data}catch(c){throw s.value=c,c}finally{n.value=!1}},generateApiKey:async()=>{try{n.value=!0;const c=await Ee.post("/api/v1/settings/security/api-keys");return o.value.security.apiKeys.push(c.data),c.data}catch(c){throw s.value=c,c}finally{n.value=!1}},deleteApiKey:async c=>{try{n.value=!0,await Ee.delete(`/api/v1/settings/security/api-keys/${c}`),o.value.security.apiKeys=o.value.security.apiKeys.filter(a=>a.id!==c)}catch(a){throw s.value=a,a}finally{n.value=!1}},fetchLicenseSettings:async()=>{const c=Tt();return await c.fetchLicenseInfo(),c.licenseInfo||{key:null,status:"inactive",is_valid:!1}},updateLicenseSettings:async c=>{const a=Tt();return c.licenseKey&&await a.updateLicense(c.licenseKey),a.licenseInfo},showSuccessMessage:async c=>{},showErrorMessage:async c=>{}}}),ag={class:"settings-view"},lg={class:"header-box"},cg={class:"settings-container"},ug={class:"filter-box"},dg={class:"settings-tabs"},fg={class:"table-box"},pg={key:0,class:"settings-loading"},hg={key:1,class:"settings-section"},vg={class:"form-group"},mg={class:"form-label"},gg={class:"form-group"},yg={class:"form-label"},xg={class:"form-group"},bg={class:"form-label"},Cg={class:"form-row"},Ag={class:"form-group"},Eg={class:"form-label"},_g={class:"form-group"},Sg={class:"form-label"},wg={class:"form-row"},Rg={class:"form-group"},Dg={class:"form-label"},Og={class:"form-group"},Bg={class:"form-label"},Tg={class:"form-group"},kg={class:"form-label"},$g={class:"form-group"},Fg={class:"form-check"},Pg={class:"form-check-label",for:"maintenanceMode"},Mg={key:0,class:"form-group"},Ig={class:"form-label"},Ng={class:"form-actions"},Ug=["disabled"],Lg={key:0,class:"fas fa-spinner fa-spin"},Hg={key:2,class:"settings-section"},jg={class:"form-group"},Vg={class:"form-check"},Gg={class:"form-check-label",for:"emailNotifications"},Wg={class:"form-group"},zg={class:"form-check"},qg={class:"form-check-label",for:"pushNotifications"},Kg={class:"form-group"},Xg={class:"form-check"},Jg={class:"form-check-label",for:"desktopNotifications"},Qg={class:"form-group"},Yg={class:"form-check"},Zg={class:"form-check-label",for:"notifyNewTicket"},ey={class:"form-group"},ty={class:"form-check"},ny={class:"form-check-label",for:"notifyTicketReply"},ry={class:"form-group"},sy={class:"form-check"},oy={class:"form-check-label",for:"notifyNewInvoice"},iy={class:"form-group"},ay={class:"form-check"},ly={class:"form-check-label",for:"notifyPaymentReceived"},cy={class:"form-group"},uy={class:"form-check"},dy={class:"form-check-label",for:"notifySystemUpdates"},fy={class:"form-actions"},py=["disabled"],hy={key:0,class:"fas fa-spinner fa-spin"},vy={key:3,class:"settings-section"},my={class:"form-group"},gy={class:"form-check"},yy={class:"form-check-label",for:"twoFactorAuth"},xy={class:"form-group"},by={class:"form-label"},Cy={class:"form-group"},Ay={class:"form-label"},Ey={class:"form-group"},_y={class:"form-check"},Sy={class:"form-check-label",for:"requireNumbers"},wy={class:"form-group"},Ry={class:"form-check"},Dy={class:"form-check-label",for:"requireSymbols"},Oy={class:"form-group"},By={class:"form-check"},Ty={class:"form-check-label",for:"requireUppercase"},ky={class:"api-keys"},$y={class:"key-info"},Fy={class:"key-name"},Py={class:"key-created"},My=["onClick"],Iy={class:"form-actions"},Ny=["disabled"],Uy={key:0,class:"fas fa-spinner fa-spin"},Ly={key:4,class:"settings-section"},Hy={class:"form-group"},jy={class:"form-label"},Vy={class:"input-group"},Gy={class:"form-group"},Wy={class:"form-label"},zy={class:"input-group"},qy={class:"form-group"},Ky={class:"form-check"},Xy={class:"form-check-label",for:"stripeEnabled"},Jy={key:0},Qy={class:"form-group"},Yy={class:"form-check"},Zy={class:"form-check-label",for:"stripeTestMode"},ex={class:"form-group"},tx={class:"form-label"},nx={class:"form-group"},rx={class:"form-label"},sx={class:"form-group"},ox={class:"form-check"},ix={class:"form-check-label",for:"paypalEnabled"},ax={key:1},lx={class:"form-group"},cx={class:"form-check"},ux={class:"form-check-label",for:"paypalTestMode"},dx={class:"form-group"},fx={class:"form-label"},px={class:"form-group"},hx={class:"form-label"},vx={class:"form-group"},mx={class:"form-label"},gx={class:"form-group"},yx={class:"form-check"},xx={class:"form-check-label",for:"autoReminders"},bx={key:2,class:"form-group"},Cx={class:"form-label"},Ax={class:"reminder-days"},Ex=["onUpdate:modelValue"],_x=["onClick"],Sx={class:"form-actions"},wx=["disabled"],Rx={key:0,class:"fas fa-spinner fa-spin"},Dx={key:5,class:"settings-section"},Ox={class:"form-group"},Bx={class:"form-check"},Tx={class:"form-check-label",for:"ablyEnabled"},kx={key:0,class:"form-group"},$x={class:"form-label"},Fx={class:"form-group"},Px={class:"form-label"},Mx={class:"form-group"},Ix={class:"form-label"},Nx={class:"form-group"},Ux={class:"form-label"},Lx={class:"form-group"},Hx={class:"form-label"},jx={class:"form-group"},Vx={class:"form-label"},Gx={value:"none"},Wx=["disabled"],zx={key:0,class:"fas fa-spinner fa-spin"},qx={class:"webhooks"},Kx={class:"webhook-header"},Xx=["onUpdate:modelValue","placeholder"],Jx=["onClick"],Qx={class:"webhook-url"},Yx=["onUpdate:modelValue","placeholder"],Zx={class:"webhook-events"},eb={class:"form-check"},tb=["onUpdate:modelValue","value","id"],nb=["for"],rb={class:"form-actions"},sb=["disabled"],ob={key:0,class:"fas fa-spinner fa-spin"},ib={key:6,class:"settings-section"},Js=ke({__name:"SettingsView",setup(o){const{t:n}=Le(),s=ig(),t=ye(),r=Q("general"),p=Q(!0),i=Q(!1),h=Q({siteName:"",siteUrl:"",adminEmail:"",defaultLanguage:"fr",timezone:"Europe/Paris",dateFormat:"DD/MM/YYYY",timeFormat:"24h",currency:"EUR",maintenanceMode:!1,maintenanceMessage:""}),C=Q({emailNotifications:!0,pushNotifications:!0,desktopNotifications:!0,notifyOn:{newTicket:!0,ticketReply:!0,newInvoice:!0,paymentReceived:!0,systemUpdates:!0}}),u=Q({twoFactorAuth:!1,sessionTimeout:30,passwordPolicy:{minLength:8,requireNumbers:!0,requireSymbols:!0,requireUppercase:!0},ipWhitelist:[],apiKeys:[]}),v=Q({vatRate:20,defaultPaymentTerms:30,paymentMethods:{stripe:{enabled:!1,testMode:!0,publishableKey:"",secretKey:""},paypal:{enabled:!1,testMode:!0,clientId:"",clientSecret:""}},invoicePrefix:"INV-",autoReminders:!0,reminderDays:[7,3,1]}),E=Q({ably:{enabled:!0,apiKey:""},smtp:{host:"",port:587,username:"",password:"",encryption:"tls"},webhooks:[]}),y=Q({licenseKey:"",licenseType:""}),w=async()=>{try{i.value=!0,await s.updateGeneralSettings(h.value),await s.showSuccessMessage(n("settings.saveSuccess"))}catch(m){console.error("Erreur lors de la sauvegarde des paramètres généraux:",m),await s.showErrorMessage(n("settings.saveError"))}finally{i.value=!1}},f=async()=>{try{i.value=!0,await t.updatePreferences(C.value),await s.showSuccessMessage(n("settings.saveSuccess"))}catch(m){console.error("Erreur lors de la sauvegarde des paramètres de notification:",m),await s.showErrorMessage(n("settings.saveError"))}finally{i.value=!1}},_=async()=>{try{i.value=!0,await s.updateSecuritySettings(u.value),await s.showSuccessMessage(n("settings.saveSuccess"))}catch(m){console.error("Erreur lors de la sauvegarde des paramètres de sécurité:",m),await s.showErrorMessage(n("settings.saveError"))}finally{i.value=!1}},R=async()=>{try{i.value=!0,await s.updateBillingSettings(v.value),await s.showSuccessMessage(n("settings.saveSuccess"))}catch(m){console.error("Erreur lors de la sauvegarde des paramètres de facturation:",m),await s.showErrorMessage(n("settings.saveError"))}finally{i.value=!1}},D=async()=>{try{i.value=!0,await s.updateIntegrationSettings(E.value),await s.showSuccessMessage(n("settings.saveSuccess"))}catch(m){console.error("Erreur lors de la sauvegarde des paramètres d'intégration:",m),await s.showErrorMessage(n("settings.saveError"))}finally{i.value=!1}},b=async m=>{try{await s.deleteApiKey(m),await s.showSuccessMessage(n("settings.apiKeyDeleted"))}catch(l){console.error("Erreur lors de la suppression de la clé API:",l),await s.showErrorMessage(n("settings.apiKeyDeleteError"))}},g=async()=>{try{const m=await s.generateApiKey();u.value.apiKeys.push(m),await s.showSuccessMessage(n("settings.security.keyGenerated"))}catch(m){console.error("Erreur lors de la génération de la clé API:",m),await s.showErrorMessage(n("settings.security.keyGenerationError"))}},S=async()=>{try{i.value=!0,await s.testSmtpConnection(),await s.showSuccessMessage(n("settings.integrations.smtpTestSuccess"))}catch(m){console.error("Erreur lors du test SMTP:",m),await s.showErrorMessage(n("settings.integrations.smtpTestError"))}finally{i.value=!1}};return Fe(async()=>{try{const[m,l,c,a,x]=await Promise.all([s.fetchGeneralSettings(),s.fetchSecuritySettings(),s.fetchBillingSettings(),s.fetchIntegrationSettings(),s.fetchLicenseSettings()]);h.value=m,u.value=l,v.value=c,E.value=a,y.value=x}catch(m){console.error("Erreur lors du chargement des paramètres:",m),await s.showErrorMessage(n("settings.loadError"))}finally{p.value=!1}}),(m,l)=>(q(),K("div",ag,[e("div",lg,[e("h1",null,T(W(n)("settings.title")),1)]),e("div",cg,[e("div",ug,[e("div",dg,[e("button",{class:ce(["tab-btn",{active:r.value==="general"}]),onClick:l[0]||(l[0]=c=>r.value="general")},[l[51]||(l[51]=e("i",{class:"fas fa-cog"},null,-1)),ie(" "+T(W(n)("settings.tabs.general")),1)],2),e("button",{class:ce(["tab-btn",{active:r.value==="notifications"}]),onClick:l[1]||(l[1]=c=>r.value="notifications")},[l[52]||(l[52]=e("i",{class:"fas fa-bell"},null,-1)),ie(" "+T(W(n)("settings.tabs.notifications")),1)],2),e("button",{class:ce(["tab-btn",{active:r.value==="security"}]),onClick:l[2]||(l[2]=c=>r.value="security")},[l[53]||(l[53]=e("i",{class:"fas fa-shield-alt"},null,-1)),ie(" "+T(W(n)("settings.tabs.security")),1)],2),e("button",{class:ce(["tab-btn",{active:r.value==="billing"}]),onClick:l[3]||(l[3]=c=>r.value="billing")},[l[54]||(l[54]=e("i",{class:"fas fa-credit-card"},null,-1)),ie(" "+T(W(n)("settings.tabs.billing")),1)],2),e("button",{class:ce(["tab-btn",{active:r.value==="integrations"}]),onClick:l[4]||(l[4]=c=>r.value="integrations")},[l[55]||(l[55]=e("i",{class:"fas fa-plug"},null,-1)),ie(" "+T(W(n)("settings.tabs.integrations")),1)],2),e("button",{class:ce(["tab-btn",{active:r.value==="license"}]),onClick:l[5]||(l[5]=c=>r.value="license")},[l[56]||(l[56]=e("i",{class:"fas fa-key"},null,-1)),ie(" "+T(W(n)("settings.tabs.license")),1)],2)])]),e("div",fg,[p.value?(q(),K("div",pg,[l[57]||(l[57]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),ie(" "+T(W(n)("common.loading")),1)])):r.value==="general"?(q(),K("div",hg,[e("h2",null,T(W(n)("settings.general.title")),1),e("form",{onSubmit:Re(w,["prevent"])},[e("div",vg,[e("label",mg,T(W(n)("settings.general.siteName")),1),Z(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[6]||(l[6]=c=>h.value.siteName=c),required:""},null,512),[[le,h.value.siteName]])]),e("div",gg,[e("label",yg,T(W(n)("settings.general.siteUrl")),1),Z(e("input",{type:"url",class:"form-control","onUpdate:modelValue":l[7]||(l[7]=c=>h.value.siteUrl=c),required:""},null,512),[[le,h.value.siteUrl]])]),e("div",xg,[e("label",bg,T(W(n)("settings.general.adminEmail")),1),Z(e("input",{type:"email",class:"form-control","onUpdate:modelValue":l[8]||(l[8]=c=>h.value.adminEmail=c),required:""},null,512),[[le,h.value.adminEmail]])]),e("div",Cg,[e("div",Ag,[e("label",Eg,T(W(n)("settings.general.language")),1),Z(e("select",{class:"form-control","onUpdate:modelValue":l[9]||(l[9]=c=>h.value.defaultLanguage=c)},l[58]||(l[58]=[e("option",{value:"fr"},"Français",-1),e("option",{value:"en"},"English",-1),e("option",{value:"es"},"Español",-1)]),512),[[xe,h.value.defaultLanguage]])]),e("div",_g,[e("label",Sg,T(W(n)("settings.general.timezone")),1),Z(e("select",{class:"form-control","onUpdate:modelValue":l[10]||(l[10]=c=>h.value.timezone=c)},l[59]||(l[59]=[e("option",{value:"Europe/Paris"},"Europe/Paris",-1),e("option",{value:"UTC"},"UTC",-1),e("option",{value:"America/New_York"},"America/New_York",-1)]),512),[[xe,h.value.timezone]])])]),e("div",wg,[e("div",Rg,[e("label",Dg,T(W(n)("settings.general.dateFormat")),1),Z(e("select",{class:"form-control","onUpdate:modelValue":l[11]||(l[11]=c=>h.value.dateFormat=c)},l[60]||(l[60]=[e("option",{value:"DD/MM/YYYY"},"DD/MM/YYYY",-1),e("option",{value:"MM/DD/YYYY"},"MM/DD/YYYY",-1),e("option",{value:"YYYY-MM-DD"},"YYYY-MM-DD",-1)]),512),[[xe,h.value.dateFormat]])]),e("div",Og,[e("label",Bg,T(W(n)("settings.general.timeFormat")),1),Z(e("select",{class:"form-control","onUpdate:modelValue":l[12]||(l[12]=c=>h.value.timeFormat=c)},l[61]||(l[61]=[e("option",{value:"24h"},"24h",-1),e("option",{value:"12h"},"12h",-1)]),512),[[xe,h.value.timeFormat]])]),e("div",Tg,[e("label",kg,T(W(n)("settings.general.currency")),1),Z(e("select",{class:"form-control","onUpdate:modelValue":l[13]||(l[13]=c=>h.value.currency=c)},l[62]||(l[62]=[e("option",{value:"EUR"},"EUR (€)",-1),e("option",{value:"USD"},"USD ($)",-1),e("option",{value:"GBP"},"GBP (£)",-1)]),512),[[xe,h.value.currency]])])]),e("div",$g,[e("div",Fg,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[14]||(l[14]=c=>h.value.maintenanceMode=c),id:"maintenanceMode"},null,512),[[Oe,h.value.maintenanceMode]]),e("label",Pg,T(W(n)("settings.general.maintenanceMode")),1)])]),h.value.maintenanceMode?(q(),K("div",Mg,[e("label",Ig,T(W(n)("settings.general.maintenanceMessage")),1),Z(e("textarea",{class:"form-control","onUpdate:modelValue":l[15]||(l[15]=c=>h.value.maintenanceMessage=c),rows:"3"},null,512),[[le,h.value.maintenanceMessage]])])):ae("",!0),e("div",Ng,[e("button",{type:"submit",class:"btn btn-primary",disabled:i.value},[i.value?(q(),K("i",Lg)):ae("",!0),ie(" "+T(W(n)("common.save")),1)],8,Ug)])],32)])):r.value==="notifications"?(q(),K("div",Hg,[e("h2",null,T(W(n)("settings.notifications.title")),1),e("form",{onSubmit:Re(f,["prevent"])},[e("div",jg,[e("div",Vg,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[16]||(l[16]=c=>C.value.emailNotifications=c),id:"emailNotifications"},null,512),[[Oe,C.value.emailNotifications]]),e("label",Gg,T(W(n)("settings.notifications.email")),1)])]),e("div",Wg,[e("div",zg,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[17]||(l[17]=c=>C.value.pushNotifications=c),id:"pushNotifications"},null,512),[[Oe,C.value.pushNotifications]]),e("label",qg,T(W(n)("settings.notifications.push")),1)])]),e("div",Kg,[e("div",Xg,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[18]||(l[18]=c=>C.value.desktopNotifications=c),id:"desktopNotifications"},null,512),[[Oe,C.value.desktopNotifications]]),e("label",Jg,T(W(n)("settings.notifications.desktop")),1)])]),e("h3",null,T(W(n)("settings.notifications.events")),1),e("div",Qg,[e("div",Yg,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[19]||(l[19]=c=>C.value.notifyOn.newTicket=c),id:"notifyNewTicket"},null,512),[[Oe,C.value.notifyOn.newTicket]]),e("label",Zg,T(W(n)("settings.notifications.newTicket")),1)])]),e("div",ey,[e("div",ty,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[20]||(l[20]=c=>C.value.notifyOn.ticketReply=c),id:"notifyTicketReply"},null,512),[[Oe,C.value.notifyOn.ticketReply]]),e("label",ny,T(W(n)("settings.notifications.ticketReply")),1)])]),e("div",ry,[e("div",sy,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[21]||(l[21]=c=>C.value.notifyOn.newInvoice=c),id:"notifyNewInvoice"},null,512),[[Oe,C.value.notifyOn.newInvoice]]),e("label",oy,T(W(n)("settings.notifications.newInvoice")),1)])]),e("div",iy,[e("div",ay,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[22]||(l[22]=c=>C.value.notifyOn.paymentReceived=c),id:"notifyPaymentReceived"},null,512),[[Oe,C.value.notifyOn.paymentReceived]]),e("label",ly,T(W(n)("settings.notifications.paymentReceived")),1)])]),e("div",cy,[e("div",uy,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[23]||(l[23]=c=>C.value.notifyOn.systemUpdates=c),id:"notifySystemUpdates"},null,512),[[Oe,C.value.notifyOn.systemUpdates]]),e("label",dy,T(W(n)("settings.notifications.systemUpdates")),1)])]),e("div",fy,[e("button",{type:"submit",class:"btn btn-primary",disabled:i.value},[i.value?(q(),K("i",hy)):ae("",!0),ie(" "+T(W(n)("common.save")),1)],8,py)])],32)])):r.value==="security"?(q(),K("div",vy,[e("h2",null,T(W(n)("settings.security.title")),1),e("form",{onSubmit:Re(_,["prevent"])},[e("div",my,[e("div",gy,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[24]||(l[24]=c=>u.value.twoFactorAuth=c),id:"twoFactorAuth"},null,512),[[Oe,u.value.twoFactorAuth]]),e("label",yy,T(W(n)("settings.security.twoFactorAuth")),1)])]),e("div",xy,[e("label",by,T(W(n)("settings.security.sessionTimeout")),1),Z(e("select",{class:"form-control","onUpdate:modelValue":l[25]||(l[25]=c=>u.value.sessionTimeout=c)},l[63]||(l[63]=[e("option",{value:"15"},"15 minutes",-1),e("option",{value:"30"},"30 minutes",-1),e("option",{value:"60"},"1 heure",-1),e("option",{value:"120"},"2 heures",-1)]),512),[[xe,u.value.sessionTimeout]])]),e("h3",null,T(W(n)("settings.security.passwordPolicy")),1),e("div",Cy,[e("label",Ay,T(W(n)("settings.security.minLength")),1),Z(e("input",{type:"number",class:"form-control","onUpdate:modelValue":l[26]||(l[26]=c=>u.value.passwordPolicy.minLength=c),min:"8",max:"32"},null,512),[[le,u.value.passwordPolicy.minLength]])]),e("div",Ey,[e("div",_y,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[27]||(l[27]=c=>u.value.passwordPolicy.requireNumbers=c),id:"requireNumbers"},null,512),[[Oe,u.value.passwordPolicy.requireNumbers]]),e("label",Sy,T(W(n)("settings.security.requireNumbers")),1)])]),e("div",wy,[e("div",Ry,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[28]||(l[28]=c=>u.value.passwordPolicy.requireSymbols=c),id:"requireSymbols"},null,512),[[Oe,u.value.passwordPolicy.requireSymbols]]),e("label",Dy,T(W(n)("settings.security.requireSymbols")),1)])]),e("div",Oy,[e("div",By,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[29]||(l[29]=c=>u.value.passwordPolicy.requireUppercase=c),id:"requireUppercase"},null,512),[[Oe,u.value.passwordPolicy.requireUppercase]]),e("label",Ty,T(W(n)("settings.security.requireUppercase")),1)])]),e("h3",null,T(W(n)("settings.security.apiKeys")),1),e("div",ky,[(q(!0),K(_e,null,Se(u.value.apiKeys,c=>(q(),K("div",{key:c.id,class:"api-key"},[e("div",$y,[e("span",Fy,T(c.name),1),e("span",Py,T(new Date(c.createdAt).toLocaleDateString()),1)]),e("button",{class:"btn btn-danger btn-sm",onClick:a=>b(c.id)},l[64]||(l[64]=[e("i",{class:"fas fa-trash"},null,-1)]),8,My)]))),128)),e("button",{type:"button",class:"btn btn-outline",onClick:g},[l[65]||(l[65]=e("i",{class:"fas fa-plus"},null,-1)),ie(" "+T(W(n)("settings.security.generateKey")),1)])]),e("div",Iy,[e("button",{type:"submit",class:"btn btn-primary",disabled:i.value},[i.value?(q(),K("i",Uy)):ae("",!0),ie(" "+T(W(n)("common.save")),1)],8,Ny)])],32)])):r.value==="billing"?(q(),K("div",Ly,[e("h2",null,T(W(n)("settings.billing.title")),1),e("form",{onSubmit:Re(R,["prevent"])},[e("div",Hy,[e("label",jy,T(W(n)("settings.billing.vatRate")),1),e("div",Vy,[Z(e("input",{type:"number",class:"form-control","onUpdate:modelValue":l[30]||(l[30]=c=>v.value.vatRate=c),min:"0",max:"100",step:"0.1"},null,512),[[le,v.value.vatRate]]),l[66]||(l[66]=e("span",{class:"input-group-text"},"%",-1))])]),e("div",Gy,[e("label",Wy,T(W(n)("settings.billing.paymentTerms")),1),e("div",zy,[Z(e("input",{type:"number",class:"form-control","onUpdate:modelValue":l[31]||(l[31]=c=>v.value.defaultPaymentTerms=c),min:"0"},null,512),[[le,v.value.defaultPaymentTerms]]),l[67]||(l[67]=e("span",{class:"input-group-text"},"jours",-1))])]),e("h3",null,T(W(n)("settings.billing.stripe")),1),e("div",qy,[e("div",Ky,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[32]||(l[32]=c=>v.value.paymentMethods.stripe.enabled=c),id:"stripeEnabled"},null,512),[[Oe,v.value.paymentMethods.stripe.enabled]]),e("label",Xy,T(W(n)("settings.billing.enableStripe")),1)])]),v.value.paymentMethods.stripe.enabled?(q(),K("div",Jy,[e("div",Qy,[e("div",Yy,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[33]||(l[33]=c=>v.value.paymentMethods.stripe.testMode=c),id:"stripeTestMode"},null,512),[[Oe,v.value.paymentMethods.stripe.testMode]]),e("label",Zy,T(W(n)("settings.billing.testMode")),1)])]),e("div",ex,[e("label",tx,T(W(n)("settings.billing.stripePublishable")),1),Z(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[34]||(l[34]=c=>v.value.paymentMethods.stripe.publishableKey=c)},null,512),[[le,v.value.paymentMethods.stripe.publishableKey]])]),e("div",nx,[e("label",rx,T(W(n)("settings.billing.stripeSecret")),1),Z(e("input",{type:"password",class:"form-control","onUpdate:modelValue":l[35]||(l[35]=c=>v.value.paymentMethods.stripe.secretKey=c)},null,512),[[le,v.value.paymentMethods.stripe.secretKey]])])])):ae("",!0),e("h3",null,T(W(n)("settings.billing.paypal")),1),e("div",sx,[e("div",ox,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[36]||(l[36]=c=>v.value.paymentMethods.paypal.enabled=c),id:"paypalEnabled"},null,512),[[Oe,v.value.paymentMethods.paypal.enabled]]),e("label",ix,T(W(n)("settings.billing.enablePaypal")),1)])]),v.value.paymentMethods.paypal.enabled?(q(),K("div",ax,[e("div",lx,[e("div",cx,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[37]||(l[37]=c=>v.value.paymentMethods.paypal.testMode=c),id:"paypalTestMode"},null,512),[[Oe,v.value.paymentMethods.paypal.testMode]]),e("label",ux,T(W(n)("settings.billing.testMode")),1)])]),e("div",dx,[e("label",fx,T(W(n)("settings.billing.paypalClientId")),1),Z(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[38]||(l[38]=c=>v.value.paymentMethods.paypal.clientId=c)},null,512),[[le,v.value.paymentMethods.paypal.clientId]])]),e("div",px,[e("label",hx,T(W(n)("settings.billing.paypalSecret")),1),Z(e("input",{type:"password",class:"form-control","onUpdate:modelValue":l[39]||(l[39]=c=>v.value.paymentMethods.paypal.clientSecret=c)},null,512),[[le,v.value.paymentMethods.paypal.clientSecret]])])])):ae("",!0),e("h3",null,T(W(n)("settings.billing.invoices")),1),e("div",vx,[e("label",mx,T(W(n)("settings.billing.invoicePrefix")),1),Z(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[40]||(l[40]=c=>v.value.invoicePrefix=c)},null,512),[[le,v.value.invoicePrefix]])]),e("div",gx,[e("div",yx,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[41]||(l[41]=c=>v.value.autoReminders=c),id:"autoReminders"},null,512),[[Oe,v.value.autoReminders]]),e("label",xx,T(W(n)("settings.billing.autoReminders")),1)])]),v.value.autoReminders?(q(),K("div",bx,[e("label",Cx,T(W(n)("settings.billing.reminderDays")),1),e("div",Ax,[(q(!0),K(_e,null,Se(v.value.reminderDays,(c,a)=>(q(),K("div",{key:a,class:"reminder-day"},[Z(e("input",{type:"number",class:"form-control","onUpdate:modelValue":x=>v.value.reminderDays[a]=x,min:"1"},null,8,Ex),[[le,v.value.reminderDays[a]]]),e("button",{type:"button",class:"btn btn-danger btn-sm",onClick:x=>v.value.reminderDays.splice(a,1)},l[68]||(l[68]=[e("i",{class:"fas fa-trash"},null,-1)]),8,_x)]))),128)),e("button",{type:"button",class:"btn btn-outline btn-sm",onClick:l[42]||(l[42]=c=>v.value.reminderDays.push(1))},l[69]||(l[69]=[e("i",{class:"fas fa-plus"},null,-1)]))])])):ae("",!0),e("div",Sx,[e("button",{type:"submit",class:"btn btn-primary",disabled:i.value},[i.value?(q(),K("i",Rx)):ae("",!0),ie(" "+T(W(n)("common.save")),1)],8,wx)])],32)])):r.value==="integrations"?(q(),K("div",Dx,[e("h2",null,T(W(n)("settings.integrations.title")),1),e("form",{onSubmit:Re(D,["prevent"])},[e("h3",null,T(W(n)("settings.integrations.ably")),1),e("div",Ox,[e("div",Bx,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[43]||(l[43]=c=>E.value.ably.enabled=c),id:"ablyEnabled"},null,512),[[Oe,E.value.ably.enabled]]),e("label",Tx,T(W(n)("settings.integrations.enableAbly")),1)])]),E.value.ably.enabled?(q(),K("div",kx,[e("label",$x,T(W(n)("settings.integrations.ablyKey")),1),Z(e("input",{type:"password",class:"form-control","onUpdate:modelValue":l[44]||(l[44]=c=>E.value.ably.apiKey=c)},null,512),[[le,E.value.ably.apiKey]])])):ae("",!0),e("h3",null,T(W(n)("settings.integrations.smtp")),1),e("div",Fx,[e("label",Px,T(W(n)("settings.integrations.smtpHost")),1),Z(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[45]||(l[45]=c=>E.value.smtp.host=c)},null,512),[[le,E.value.smtp.host]])]),e("div",Mx,[e("label",Ix,T(W(n)("settings.integrations.smtpPort")),1),Z(e("input",{type:"number",class:"form-control","onUpdate:modelValue":l[46]||(l[46]=c=>E.value.smtp.port=c)},null,512),[[le,E.value.smtp.port]])]),e("div",Nx,[e("label",Ux,T(W(n)("settings.integrations.smtpUsername")),1),Z(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[47]||(l[47]=c=>E.value.smtp.username=c)},null,512),[[le,E.value.smtp.username]])]),e("div",Lx,[e("label",Hx,T(W(n)("settings.integrations.smtpPassword")),1),Z(e("input",{type:"password",class:"form-control","onUpdate:modelValue":l[48]||(l[48]=c=>E.value.smtp.password=c)},null,512),[[le,E.value.smtp.password]])]),e("div",jx,[e("label",Vx,T(W(n)("settings.integrations.smtpEncryption")),1),Z(e("select",{class:"form-control","onUpdate:modelValue":l[49]||(l[49]=c=>E.value.smtp.encryption=c)},[l[70]||(l[70]=e("option",{value:"tls"},"TLS",-1)),l[71]||(l[71]=e("option",{value:"ssl"},"SSL",-1)),e("option",Gx,T(W(n)("settings.integrations.none")),1)],512),[[xe,E.value.smtp.encryption]])]),e("button",{type:"button",class:"btn btn-outline",onClick:S,disabled:i.value},[i.value?(q(),K("i",zx)):ae("",!0),ie(" "+T(W(n)("settings.integrations.testSmtp")),1)],8,Wx),e("h3",null,T(W(n)("settings.integrations.webhooks")),1),e("div",qx,[(q(!0),K(_e,null,Se(E.value.webhooks,(c,a)=>(q(),K("div",{key:a,class:"webhook"},[e("div",Kx,[Z(e("input",{type:"text",class:"form-control","onUpdate:modelValue":x=>c.name=x,placeholder:W(n)("settings.integrations.webhookName")},null,8,Xx),[[le,c.name]]),e("button",{type:"button",class:"btn btn-danger btn-sm",onClick:x=>E.value.webhooks.splice(a,1)},l[72]||(l[72]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Jx)]),e("div",Qx,[Z(e("input",{type:"url",class:"form-control","onUpdate:modelValue":x=>c.url=x,placeholder:W(n)("settings.integrations.webhookUrl")},null,8,Yx),[[le,c.url]])]),e("div",Zx,[(q(),K(_e,null,Se(["ticket.created","ticket.updated","invoice.paid","client.created"],x=>e("div",{key:x,class:"webhook-event"},[e("div",eb,[Z(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":d=>c.events=d,value:x,id:`webhook-${a}-${x}`},null,8,tb),[[Oe,c.events]]),e("label",{class:"form-check-label",for:`webhook-${a}-${x}`},T(x),9,nb)])])),64))])]))),128)),e("button",{type:"button",class:"btn btn-outline",onClick:l[50]||(l[50]=c=>E.value.webhooks.push({name:"",url:"",events:[]}))},[l[73]||(l[73]=e("i",{class:"fas fa-plus"},null,-1)),ie(" "+T(W(n)("settings.integrations.addWebhook")),1)])]),e("div",rb,[e("button",{type:"submit",class:"btn btn-primary",disabled:i.value},[i.value?(q(),K("i",ob)):ae("",!0),ie(" "+T(W(n)("common.save")),1)],8,sb)])],32)])):r.value==="license"?(q(),K("div",ib,[e("h2",null,T(W(n)("settings.license.title")),1),l[74]||(l[74]=e("iframe",{src:"settings/license",style:{width:"100%",height:"500px",border:"none",overflow:"hidden"}},null,-1))])):ae("",!0)])])]))}}),ab={class:"view-container"},lb={class:"content-box"},cb={key:0,class:"loading-spinner"},ub={key:1,class:"license-container"},db={class:"license-status"},fb={key:0,class:"status-box"},pb={class:"license-key"},hb={key:1,class:"status-box"},vb={class:"license-form"},mb={class:"form-group"},gb={key:0,class:"error-message"},yb={class:"form-actions"},xb=["disabled"],bb={key:0,class:"fas fa-spinner fa-spin"},Cb=ke({__name:"LicenseView",setup(o){const n=Tt(),s=Q(""),t=Q(!1),r=Q(null),p=Q(n.licenseInfo);Fe(async()=>{t.value=!0;try{await n.fetchLicenseInfo(),p.value=n.licenseInfo}catch(h){console.error("Erreur lors du chargement des informations de licence",h)}finally{t.value=!1}});const i=async()=>{if(!s.value){r.value="Veuillez entrer une clé de licence";return}t.value=!0,r.value=null;try{const h=await n.updateLicense(s.value);h&&h.success?(p.value=n.licenseInfo,s.value=""):r.value=(h==null?void 0:h.message)||"Erreur lors de la mise à jour de la licence"}catch(h){r.value=h.message||"Une erreur est survenue"}finally{t.value=!1}};return(h,C)=>(q(),K("div",ab,[C[7]||(C[7]=e("div",{class:"header-box"},[e("h1",{class:"page-title"},"Gestion de Licence"),e("p",{class:"page-description"}," Gérez votre licence TechCMS pour accéder à toutes les fonctionnalités et mises à jour. ")],-1)),e("div",lb,[t.value?(q(),K("div",cb,C[1]||(C[1]=[e("i",{class:"fas fa-spinner fa-spin"},null,-1),ie(" Chargement... ")]))):(q(),K("div",ub,[e("div",db,[C[4]||(C[4]=e("h3",null,"Statut de la Licence",-1)),p.value?(q(),K("div",fb,[e("div",{class:ce(["status-badge",p.value.is_valid?"status-active":"status-inactive"])},T(p.value.is_valid?"Active":"Inactive"),3),e("div",pb,[C[2]||(C[2]=e("strong",null,"Clé de licence:",-1)),ie(" "+T(p.value.key||"Non définie"),1)])])):(q(),K("div",hb,C[3]||(C[3]=[e("div",{class:"status-badge status-inactive"},"Non configurée",-1),e("p",null,"Aucune licence n'est actuellement configurée.",-1)])))]),e("div",vb,[C[6]||(C[6]=e("h3",null,"Mettre à jour la Licence",-1)),e("form",{onSubmit:Re(i,["prevent"])},[e("div",mb,[C[5]||(C[5]=e("label",{for:"licenseKey"},"Clé de Licence",-1)),Z(e("input",{type:"text",id:"licenseKey","onUpdate:modelValue":C[0]||(C[0]=u=>s.value=u),placeholder:"Entrez votre clé de licence",class:"form-control",required:""},null,512),[[le,s.value]])]),r.value?(q(),K("div",gb,T(r.value),1)):ae("",!0),e("div",yb,[e("button",{type:"submit",class:"btn btn-primary",disabled:t.value},[t.value?(q(),K("i",bb)):ae("",!0),ie(" "+T(t.value?"Mise à jour...":"Mettre à jour la licence"),1)],8,xb)])],32)])]))])]))}}),Qs=Pe(Cb,[["__scopeId","data-v-4a331889"]]),Ab={class:"view-container license-invalid-container"},Eb={class:"license-form-container"},_b={class:"license-form"},Sb={class:"form-group"},wb={key:0,class:"error-message"},Rb={key:1,class:"success-message"},Db={class:"form-actions"},Ob=["disabled"],Bb={key:0,class:"fas fa-spinner fa-spin"},Tb=ke({__name:"InvalidLicenseView",setup(o){const n=Tt(),s=kt(),t=Q(""),r=Q(!1),p=Q(null),i=Q(null),h=async()=>{if(!t.value){p.value="Veuillez entrer une clé de licence";return}r.value=!0,p.value=null,i.value=null;try{const C=await n.updateLicense(t.value);C&&C.success?(i.value="Licence activée avec succès ! Redirection vers le panneau d'administration...",setTimeout(()=>{s.push("/dashboard")},2e3)):p.value=(C==null?void 0:C.message)||"Erreur lors de la mise à jour de la licence"}catch(C){p.value=C.message||"Une erreur est survenue"}finally{r.value=!1}};return(C,u)=>(q(),K("div",Ab,[u[6]||(u[6]=bo('<div class="header-box" data-v-6c3aeebe><h1 class="page-title" data-v-6c3aeebe>Licence Invalide</h1><p class="page-description" data-v-6c3aeebe> Votre licence TechCMS est invalide ou a expiré. Veuillez entrer une clé de licence valide pour continuer. </p></div><div class="alert-box alert-warning" data-v-6c3aeebe><i class="fas fa-exclamation-triangle" data-v-6c3aeebe></i><div data-v-6c3aeebe><h3 data-v-6c3aeebe>Attention</h3><p data-v-6c3aeebe>L&#39;accès au panneau d&#39;administration est limité jusqu&#39;à ce qu&#39;une licence valide soit fournie.</p></div></div>',2)),e("div",Eb,[e("div",_b,[u[3]||(u[3]=e("h3",null,"Activer votre licence",-1)),u[4]||(u[4]=e("div",{class:"license-format-hint"},[e("i",{class:"fas fa-info-circle"}),e("span",null,"Format: XXXX-XXXX-XXXX-XXXX")],-1)),e("form",{onSubmit:Re(h,["prevent"])},[e("div",Sb,[u[1]||(u[1]=e("label",{for:"licenseKey"},"Clé de Licence",-1)),Z(e("input",{type:"text",id:"licenseKey","onUpdate:modelValue":u[0]||(u[0]=v=>t.value=v),placeholder:"Entrez votre clé de licence",class:"form-control",required:""},null,512),[[le,t.value]])]),p.value?(q(),K("div",wb,T(p.value),1)):ae("",!0),i.value?(q(),K("div",Rb,[u[2]||(u[2]=e("i",{class:"fas fa-check-circle"},null,-1)),ie(" "+T(i.value),1)])):ae("",!0),e("div",Db,[e("button",{type:"submit",class:"btn btn-primary",disabled:r.value},[r.value?(q(),K("i",Bb)):ae("",!0),ie(" "+T(r.value?"Activation...":"Activer la licence"),1)],8,Ob)])],32)]),u[5]||(u[5]=e("div",{class:"license-help"},[e("h3",null,"Besoin d'aide ?"),e("p",null,"Si vous avez perdu votre clé de licence ou si vous rencontrez des problèmes, veuillez contacter notre support :"),e("a",{href:"mailto:support@tech-cms.com",class:"support-link"},[e("i",{class:"fas fa-envelope"}),ie(" support@tech-cms.com ")])],-1))])]))}}),Ys=Pe(Tb,[["__scopeId","data-v-6c3aeebe"]]),kb={class:"view-container not-found-container"},$b={class:"not-found-content"},Fb={class:"not-found-message"},Pb={class:"action-buttons"},Mb=ke({__name:"NotFoundView",setup(o){const n=kt(),s=()=>{n.go(-1)};return(t,r)=>{const p=xt("router-link");return q(),K("div",kb,[r[5]||(r[5]=e("div",{class:"header-box"},[e("h1",{class:"page-title"},"404 - Page Non Trouvée"),e("p",{class:"page-description"}," La page que vous recherchez n'existe pas ou a été déplacée. ")],-1)),e("div",$b,[r[4]||(r[4]=e("div",{class:"not-found-illustration"},[e("i",{class:"fas fa-search fa-4x"}),e("div",{class:"error-code"},"404")],-1)),e("div",Fb,[r[2]||(r[2]=e("div",{class:"alert-box alert-info"},[e("i",{class:"fas fa-info-circle"}),e("div",null,[e("h3",null,"Que s'est-il passé ?"),e("p",null,"L'URL que vous avez saisie n'a pas été trouvée sur ce serveur.")])],-1)),r[3]||(r[3]=e("div",{class:"suggestions"},[e("h3",null,"Suggestions :"),e("ul",null,[e("li",null,"Vérifiez que l'URL est correctement saisie"),e("li",null,"Retournez à la page précédente"),e("li",null,"Accédez au tableau de bord")])],-1)),e("div",Pb,[e("button",{onClick:s,class:"btn btn-secondary"},r[0]||(r[0]=[e("i",{class:"fas fa-arrow-left"},null,-1),ie(" Retour ")])),Ce(p,{to:"/dashboard",class:"btn btn-primary"},{default:Ae(()=>r[1]||(r[1]=[e("i",{class:"fas fa-home"},null,-1),ie(" Tableau de bord ")])),_:1})])])])])}}}),Zs=Pe(Mb,[["__scopeId","data-v-b95a8a1f"]]);console.log("[ROUTER] Importation des composants:");console.log("- DashboardView:",!!Fs);console.log("- LoginView:",!!Ps);console.log("- ClientsView:",!!Us);console.log("- ServicesView:",!!js);console.log("- ProductsView:",!!Vs);console.log("- InvoicesView:",!!Gs);console.log("- PaymentsView:",!!Ws);console.log("- SubscriptionsView:",!!qs);console.log("- TicketsView:",!!Xs);console.log("- SettingsView:",!!Js);console.log("- LicenseView:",!!Qs);console.log("- InvalidLicenseView:",!!Ys);console.log("- NotFoundView:",!!Zs);const Ib="/admin",yt=Co({history:Ao(Ib),routes:[{path:"/",redirect:"/dashboard"},{path:"/login",name:"login",component:Ps,meta:{public:!0,onlyWhenLoggedOut:!0,requiresAuth:!1}},{path:"/dashboard",name:"dashboard",component:Fs,meta:{public:!1,requiresAuth:!0}},{path:"/clients",name:"clients",component:Us,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/services",name:"services",component:js,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/products",name:"products",component:Vs,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/invoices",name:"invoices",component:Gs,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/payments",name:"payments",component:Ws,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/subscriptions",name:"subscriptions",component:qs,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/tickets",name:"tickets",component:Xs,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/settings",name:"settings",component:Js,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/settings/license",name:"license",component:Qs,meta:{public:!1,requiresAuth:!0,onlyWhenLoggedOut:!1}},{path:"/license",name:"invalid-license",component:Ys,meta:{public:!0,requiresAuth:!1,onlyWhenLoggedOut:!1}},{path:"/:pathMatch(.*)*",name:"not-found",component:Zs,meta:{public:!0,requiresAuth:!1,onlyWhenLoggedOut:!1}}]});yt.beforeEach(async(o,n,s)=>{const t=ct();if(console.log("[ROUTER] Navigation de",n.path,"vers",o.path,"Route:",o.name),t.initialized||(console.log("[ROUTER] Initialisation du store d'authentification"),await t.init()),o.meta.requiresAuth&&(console.log("[ROUTER] Route protégée, vérification auth:",t.isAuthenticated),!t.isAuthenticated))try{if(console.log("[ROUTER] Vérification de l'authentification avec le serveur"),!await t.checkAuth())return console.log("[ROUTER] Redirection vers login - Authentification requise"),s({name:"login",query:{redirect:o.fullPath}});console.log("[ROUTER] Authentification confirmée par le serveur")}catch(r){return console.error("[ROUTER] Erreur lors de la vérification de l'authentification:",r),s({name:"login",query:{redirect:o.fullPath}})}if(o.meta.onlyWhenLoggedOut&&t.isAuthenticated)return console.log("[ROUTER] Redirection vers dashboard - Déjà authentifié"),s({name:"dashboard"});if(o.matched.length===0)return console.log("[ROUTER] Route non trouvée, redirection vers dashboard"),s({name:"dashboard"});console.log("[ROUTER] Navigation autorisée vers",o.path),s()});console.log("[AXIOS] Configuration de l'instance Axios");const Ee=fe.create({baseURL:"",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},withCredentials:!0});Ee.interceptors.request.use(o=>{var n;return console.log("[AXIOS] Requête sortante:",(n=o.method)==null?void 0:n.toUpperCase(),o.url),o.url&&(o.url=o.url.replace(/([^:]\/)\/+/g,"$1")),o},o=>(console.error("[AXIOS] Erreur de requête:",o),Promise.reject(o)));let qt=!1;Ee.interceptors.response.use(o=>(console.log("[AXIOS] Réponse reçue:",o.status,o.config.url),o),async o=>{var s,t,r,p,i;console.error("[AXIOS] Erreur de réponse:",(s=o.response)==null?void 0:s.status,o.config.url);const n=ct();return((t=o.response)==null?void 0:t.status)===401&&(console.log("[AXIOS] Erreur 401 détectée",o.config.url),!((r=o.config.url)!=null&&r.includes("/auth/check"))&&!((p=o.config.url)!=null&&p.includes("/auth/login"))&&!((i=o.config.url)!=null&&i.includes("/auth/logout"))&&!qt&&(console.log("[AXIOS] Déconnexion requise"),qt=!0,await n.logout(),qt=!1,yt.push("/login"))),Promise.reject(o)});console.log("[AUTH STORE] Initialisation du store d'authentification");const ct=je("auth",{persist:{key:"auth-state",paths:["initialized"],storage:sessionStorage},state:()=>({user:null,loading:!1,error:null,initialized:!1}),getters:{isAuthenticated:o=>!!o.user,userFullName:o=>o.user?`${o.user.firstName} ${o.user.lastName}`:""},actions:{async init(){var o;if(this.initialized){console.log("[AUTH STORE] Déjà initialisé");return}console.log("[AUTH STORE] Initialisation...");try{const n=await Ee.get("/api/v1/auth/check");(o=n.data)!=null&&o.user&&(console.log("[AUTH STORE] Utilisateur authentifié:",n.data.user),this.user=n.data.user)}catch{console.log("[AUTH STORE] Non authentifié"),this.user=null}finally{this.initialized=!0}},async login(o,n,s=!1){var t;console.log("[AUTH STORE] Tentative de connexion pour:",o);try{this.loading=!0,this.error=null;const r=await Ee.post("/api/v1/auth/login",{email:o,password:n,remember:s});if(!((t=r.data)!=null&&t.user))throw new Error("Réponse invalide du serveur");return this.user=r.data.user,yt.push("/dashboard"),!0}catch(r){return console.error("[AUTH STORE] Erreur de connexion:",r),this.error=r.message,!1}finally{this.loading=!1}},async logout(){if(!this.user){console.log("[AUTH STORE] Utilisateur déjà déconnecté");return}try{console.log("[AUTH STORE] Tentative de déconnexion"),await Ee.post("/api/v1/auth/logout")}catch(o){console.error("[AUTH STORE] Erreur lors de la déconnexion:",o)}finally{this.user=null,this.initialized=!1,yt.push("/login")}},async checkAuth(){var o;try{console.log("[AUTH STORE] Vérification de l'authentification");const n=await Ee.get("/api/v1/auth/check");return(o=n.data)!=null&&o.user?(console.log("[AUTH STORE] Utilisateur authentifié:",n.data.user),this.user=n.data.user,!0):(console.log("[AUTH STORE] Utilisateur non authentifié"),!1)}catch(n){return console.error("[AUTH STORE] Erreur lors de la vérification de l'authentification:",n),this.user=null,!1}},async forgotPassword(o){console.log("[AUTH STORE] Demande de réinitialisation pour:",o);try{const n=await Ee.post("/api/v1/auth/forgot-password",{email:o});return console.log("[AUTH STORE] Email de réinitialisation envoyé"),n.data}catch(n){throw console.error("[AUTH STORE] Erreur lors de la demande:",n),n}},async resetPassword(o,n){try{return this.loading=!0,this.error=null,await Ee.post("/api/v1/auth/reset-password",{token:o,password:n}),!0}catch(s){return this.error=s.message,!1}finally{this.loading=!1}},async updateLanguage(o){console.log(`[AUTH STORE] Changement de langue vers: ${o}`);try{return this.user&&(this.user={...this.user,language:o}),!0}catch(n){return console.error("[AUTH STORE] Erreur lors du changement de langue:",n),!1}}}}),jn=je("theme",()=>{console.log("[THEME STORE] Initialisation du store de thème");const o=Q(localStorage.getItem("darkMode")==="true"),n=()=>{console.log("[THEME STORE] Basculement du mode sombre"),o.value=!o.value,localStorage.setItem("darkMode",o.value.toString())};return pt(o,s=>{console.log("[THEME STORE] Application du thème:",s?"sombre":"clair"),s?(document.documentElement.classList.add("dark"),document.body.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.body.classList.remove("dark"))},{immediate:!0}),{darkMode:o,toggleDarkMode:n}}),Nb=je("language",{state:()=>({currentLanguage:localStorage.getItem("language")||"fr"}),actions:{setLanguage(o){return console.log(`[LANGUAGE STORE] Changement de langue vers: ${o}`),this.currentLanguage=o,localStorage.setItem("language",o),!0}},persist:{key:"language-state",storage:localStorage}}),Et=43200,xr=1440,br=Symbol.for("constructDateFrom");function Vn(o,n){return typeof o=="function"?o(n):o&&typeof o=="object"&&br in o?o[br](n):o instanceof Date?new o.constructor(n):new Date(n)}function nt(o,n){return Vn(o,o)}let Ub={};function Lb(){return Ub}function Cr(o){const n=nt(o),s=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return s.setUTCFullYear(n.getFullYear()),+o-+s}function Gn(o,...n){const s=Vn.bind(null,o||n.find(t=>typeof t=="object"));return n.map(s)}function Rt(o,n){const s=+nt(o)-+nt(n);return s<0?-1:s>0?1:s}function Hb(o){return Vn(o,Date.now())}function jb(o,n,s){const[t,r]=Gn(s==null?void 0:s.in,o,n),p=t.getFullYear()-r.getFullYear(),i=t.getMonth()-r.getMonth();return p*12+i}function Vb(o){return n=>{const t=(o?Math[o]:Math.trunc)(n);return t===0?0:t}}function Gb(o,n){return+nt(o)-+nt(n)}function Wb(o,n){const s=nt(o);return s.setHours(23,59,59,999),s}function zb(o,n){const s=nt(o),t=s.getMonth();return s.setFullYear(s.getFullYear(),t+1,0),s.setHours(23,59,59,999),s}function qb(o,n){const s=nt(o);return+Wb(s)==+zb(s)}function Kb(o,n,s){const[t,r,p]=Gn(s==null?void 0:s.in,o,o,n),i=Rt(r,p),h=Math.abs(jb(r,p));if(h<1)return 0;r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-i*h);let C=Rt(r,p)===-i;qb(t)&&h===1&&Rt(t,p)===1&&(C=!1);const u=i*(h-+C);return u===0?0:u}function Xb(o,n,s){const t=Gb(o,n)/1e3;return Vb(s==null?void 0:s.roundingMethod)(t)}const Jb={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Qb=(o,n,s)=>{let t;const r=Jb[o];return typeof r=="string"?t=r:n===1?t=r.one:t=r.other.replace("{{count}}",n.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"in "+t:t+" ago":t};function ft(o){return(n={})=>{const s=n.width?String(n.width):o.defaultWidth;return o.formats[s]||o.formats[o.defaultWidth]}}const Yb={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Zb={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},e2={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},t2={date:ft({formats:Yb,defaultWidth:"full"}),time:ft({formats:Zb,defaultWidth:"full"}),dateTime:ft({formats:e2,defaultWidth:"full"})},n2={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},r2=(o,n,s,t)=>n2[o];function Je(o){return(n,s)=>{const t=s!=null&&s.context?String(s.context):"standalone";let r;if(t==="formatting"&&o.formattingValues){const i=o.defaultFormattingWidth||o.defaultWidth,h=s!=null&&s.width?String(s.width):i;r=o.formattingValues[h]||o.formattingValues[i]}else{const i=o.defaultWidth,h=s!=null&&s.width?String(s.width):o.defaultWidth;r=o.values[h]||o.values[i]}const p=o.argumentCallback?o.argumentCallback(n):n;return r[p]}}const s2={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},o2={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},i2={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},a2={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},l2={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},c2={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},u2=(o,n)=>{const s=Number(o),t=s%100;if(t>20||t<10)switch(t%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},d2={ordinalNumber:u2,era:Je({values:s2,defaultWidth:"wide"}),quarter:Je({values:o2,defaultWidth:"wide",argumentCallback:o=>o-1}),month:Je({values:i2,defaultWidth:"wide"}),day:Je({values:a2,defaultWidth:"wide"}),dayPeriod:Je({values:l2,defaultWidth:"wide",formattingValues:c2,defaultFormattingWidth:"wide"})};function Qe(o){return(n,s={})=>{const t=s.width,r=t&&o.matchPatterns[t]||o.matchPatterns[o.defaultMatchWidth],p=n.match(r);if(!p)return null;const i=p[0],h=t&&o.parsePatterns[t]||o.parsePatterns[o.defaultParseWidth],C=Array.isArray(h)?p2(h,E=>E.test(i)):f2(h,E=>E.test(i));let u;u=o.valueCallback?o.valueCallback(C):C,u=s.valueCallback?s.valueCallback(u):u;const v=n.slice(i.length);return{value:u,rest:v}}}function f2(o,n){for(const s in o)if(Object.prototype.hasOwnProperty.call(o,s)&&n(o[s]))return s}function p2(o,n){for(let s=0;s<o.length;s++)if(n(o[s]))return s}function eo(o){return(n,s={})=>{const t=n.match(o.matchPattern);if(!t)return null;const r=t[0],p=n.match(o.parsePattern);if(!p)return null;let i=o.valueCallback?o.valueCallback(p[0]):p[0];i=s.valueCallback?s.valueCallback(i):i;const h=n.slice(r.length);return{value:i,rest:h}}}const h2=/^(\d+)(th|st|nd|rd)?/i,v2=/\d+/i,m2={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},g2={any:[/^b/i,/^(a|c)/i]},y2={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},x2={any:[/1/i,/2/i,/3/i,/4/i]},b2={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},C2={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},A2={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},E2={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},_2={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},S2={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},w2={ordinalNumber:eo({matchPattern:h2,parsePattern:v2,valueCallback:o=>parseInt(o,10)}),era:Qe({matchPatterns:m2,defaultMatchWidth:"wide",parsePatterns:g2,defaultParseWidth:"any"}),quarter:Qe({matchPatterns:y2,defaultMatchWidth:"wide",parsePatterns:x2,defaultParseWidth:"any",valueCallback:o=>o+1}),month:Qe({matchPatterns:b2,defaultMatchWidth:"wide",parsePatterns:C2,defaultParseWidth:"any"}),day:Qe({matchPatterns:A2,defaultMatchWidth:"wide",parsePatterns:E2,defaultParseWidth:"any"}),dayPeriod:Qe({matchPatterns:_2,defaultMatchWidth:"any",parsePatterns:S2,defaultParseWidth:"any"})},to={code:"en-US",formatDistance:Qb,formatLong:t2,formatRelative:r2,localize:d2,match:w2,options:{weekStartsOn:0,firstWeekContainsDate:1}};function R2(o,n,s){const t=Lb(),r=(s==null?void 0:s.locale)??t.locale??to,p=2520,i=Rt(o,n);if(isNaN(i))throw new RangeError("Invalid time value");const h=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:i}),[C,u]=Gn(s==null?void 0:s.in,...i>0?[n,o]:[o,n]),v=Xb(u,C),E=(Cr(u)-Cr(C))/1e3,y=Math.round((v-E)/60);let w;if(y<2)return s!=null&&s.includeSeconds?v<5?r.formatDistance("lessThanXSeconds",5,h):v<10?r.formatDistance("lessThanXSeconds",10,h):v<20?r.formatDistance("lessThanXSeconds",20,h):v<40?r.formatDistance("halfAMinute",0,h):v<60?r.formatDistance("lessThanXMinutes",1,h):r.formatDistance("xMinutes",1,h):y===0?r.formatDistance("lessThanXMinutes",1,h):r.formatDistance("xMinutes",y,h);if(y<45)return r.formatDistance("xMinutes",y,h);if(y<90)return r.formatDistance("aboutXHours",1,h);if(y<xr){const f=Math.round(y/60);return r.formatDistance("aboutXHours",f,h)}else{if(y<p)return r.formatDistance("xDays",1,h);if(y<Et){const f=Math.round(y/xr);return r.formatDistance("xDays",f,h)}else if(y<Et*2)return w=Math.round(y/Et),r.formatDistance("aboutXMonths",w,h)}if(w=Kb(u,C),w<12){const f=Math.round(y/Et);return r.formatDistance("xMonths",f,h)}else{const f=w%12,_=Math.trunc(w/12);return f<3?r.formatDistance("aboutXYears",_,h):f<9?r.formatDistance("overXYears",_,h):r.formatDistance("almostXYears",_+1,h)}}function D2(o,n){return R2(o,Hb(o),n)}const O2={lessThanXSeconds:{one:"moins d’une seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins d’une minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus d’un an",other:"plus de {{count}} ans"},almostXYears:{one:"presqu’un an",other:"presque {{count}} ans"}},B2=(o,n,s)=>{let t;const r=O2[o];return typeof r=="string"?t=r:n===1?t=r.one:t=r.other.replace("{{count}}",String(n)),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"dans "+t:"il y a "+t:t},T2={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},k2={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},$2={full:"{{date}} 'à' {{time}}",long:"{{date}} 'à' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},F2={date:ft({formats:T2,defaultWidth:"full"}),time:ft({formats:k2,defaultWidth:"full"}),dateTime:ft({formats:$2,defaultWidth:"full"})},P2={lastWeek:"eeee 'dernier à' p",yesterday:"'hier à' p",today:"'aujourd’hui à' p",tomorrow:"'demain à' p'",nextWeek:"eeee 'prochain à' p",other:"P"},M2=(o,n,s,t)=>P2[o],I2={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jésus-Christ","après Jésus-Christ"]},N2={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2ème trim.","3ème trim.","4ème trim."],wide:["1er trimestre","2ème trimestre","3ème trimestre","4ème trimestre"]},U2={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],wide:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]},L2={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},H2={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"après-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de l’après-midi",evening:"du soir",night:"du matin"}},j2=(o,n)=>{const s=Number(o),t=n==null?void 0:n.unit;if(s===0)return"0";const r=["year","week","hour","minute","second"];let p;return s===1?p=t&&r.includes(t)?"ère":"er":p="ème",s+p},V2=["MMM","MMMM"],G2={preprocessor:(o,n)=>o.getDate()===1||!n.some(t=>t.isToken&&V2.includes(t.value))?n:n.map(t=>t.isToken&&t.value==="do"?{isToken:!0,value:"d"}:t),ordinalNumber:j2,era:Je({values:I2,defaultWidth:"wide"}),quarter:Je({values:N2,defaultWidth:"wide",argumentCallback:o=>o-1}),month:Je({values:U2,defaultWidth:"wide"}),day:Je({values:L2,defaultWidth:"wide"}),dayPeriod:Je({values:H2,defaultWidth:"wide"})},W2=/^(\d+)(ième|ère|ème|er|e)?/i,z2=/\d+/i,q2={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jésus-Christ|après Jésus-Christ)/i},K2={any:[/^av/i,/^ap/i]},X2={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|ème|e)? trim\.?/i,wide:/^[1234](er|ème|e)? trimestre/i},J2={any:[/1/i,/2/i,/3/i,/4/i]},Q2={narrow:/^[jfmasond]/i,abbreviated:/^(janv|févr|mars|avr|mai|juin|juill|juil|août|sept|oct|nov|déc)\.?/i,wide:/^(janvier|février|mars|avril|mai|juin|juillet|août|septembre|octobre|novembre|décembre)/i},Y2={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},Z2={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},e4={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},t4={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'après[-\s]midi|du soir|de la nuit)/i},n4={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},r4={ordinalNumber:eo({matchPattern:W2,parsePattern:z2,valueCallback:o=>parseInt(o)}),era:Qe({matchPatterns:q2,defaultMatchWidth:"wide",parsePatterns:K2,defaultParseWidth:"any"}),quarter:Qe({matchPatterns:X2,defaultMatchWidth:"wide",parsePatterns:J2,defaultParseWidth:"any",valueCallback:o=>o+1}),month:Qe({matchPatterns:Q2,defaultMatchWidth:"wide",parsePatterns:Y2,defaultParseWidth:"any"}),day:Qe({matchPatterns:Z2,defaultMatchWidth:"wide",parsePatterns:e4,defaultParseWidth:"any"}),dayPeriod:Qe({matchPatterns:t4,defaultMatchWidth:"any",parsePatterns:n4,defaultParseWidth:"any"})},s4={code:"fr",formatDistance:B2,formatLong:F2,formatRelative:M2,localize:G2,match:r4,options:{weekStartsOn:1,firstWeekContainsDate:4}};var no={exports:{}};function o4(o){throw new Error('Could not dynamically require "'+o+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Kt={exports:{}};const i4={},a4=Object.freeze(Object.defineProperty({__proto__:null,default:i4},Symbol.toStringTag,{value:"Module"})),l4=Fl(a4);var Ar;function be(){return Ar||(Ar=1,function(o,n){(function(s,t){o.exports=t()})(ge,function(){var s=s||function(t,r){var p;if(typeof window<"u"&&window.crypto&&(p=window.crypto),typeof self<"u"&&self.crypto&&(p=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(p=globalThis.crypto),!p&&typeof window<"u"&&window.msCrypto&&(p=window.msCrypto),!p&&typeof ge<"u"&&ge.crypto&&(p=ge.crypto),!p&&typeof o4=="function")try{p=l4}catch{}var i=function(){if(p){if(typeof p.getRandomValues=="function")try{return p.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof p.randomBytes=="function")try{return p.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},h=Object.create||function(){function b(){}return function(g){var S;return b.prototype=g,S=new b,b.prototype=null,S}}(),C={},u=C.lib={},v=u.Base=function(){return{extend:function(b){var g=h(this);return b&&g.mixIn(b),(!g.hasOwnProperty("init")||this.init===g.init)&&(g.init=function(){g.$super.init.apply(this,arguments)}),g.init.prototype=g,g.$super=this,g},create:function(){var b=this.extend();return b.init.apply(b,arguments),b},init:function(){},mixIn:function(b){for(var g in b)b.hasOwnProperty(g)&&(this[g]=b[g]);b.hasOwnProperty("toString")&&(this.toString=b.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),E=u.WordArray=v.extend({init:function(b,g){b=this.words=b||[],g!=r?this.sigBytes=g:this.sigBytes=b.length*4},toString:function(b){return(b||w).stringify(this)},concat:function(b){var g=this.words,S=b.words,m=this.sigBytes,l=b.sigBytes;if(this.clamp(),m%4)for(var c=0;c<l;c++){var a=S[c>>>2]>>>24-c%4*8&255;g[m+c>>>2]|=a<<24-(m+c)%4*8}else for(var x=0;x<l;x+=4)g[m+x>>>2]=S[x>>>2];return this.sigBytes+=l,this},clamp:function(){var b=this.words,g=this.sigBytes;b[g>>>2]&=4294967295<<32-g%4*8,b.length=t.ceil(g/4)},clone:function(){var b=v.clone.call(this);return b.words=this.words.slice(0),b},random:function(b){for(var g=[],S=0;S<b;S+=4)g.push(i());return new E.init(g,b)}}),y=C.enc={},w=y.Hex={stringify:function(b){for(var g=b.words,S=b.sigBytes,m=[],l=0;l<S;l++){var c=g[l>>>2]>>>24-l%4*8&255;m.push((c>>>4).toString(16)),m.push((c&15).toString(16))}return m.join("")},parse:function(b){for(var g=b.length,S=[],m=0;m<g;m+=2)S[m>>>3]|=parseInt(b.substr(m,2),16)<<24-m%8*4;return new E.init(S,g/2)}},f=y.Latin1={stringify:function(b){for(var g=b.words,S=b.sigBytes,m=[],l=0;l<S;l++){var c=g[l>>>2]>>>24-l%4*8&255;m.push(String.fromCharCode(c))}return m.join("")},parse:function(b){for(var g=b.length,S=[],m=0;m<g;m++)S[m>>>2]|=(b.charCodeAt(m)&255)<<24-m%4*8;return new E.init(S,g)}},_=y.Utf8={stringify:function(b){try{return decodeURIComponent(escape(f.stringify(b)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(b){return f.parse(unescape(encodeURIComponent(b)))}},R=u.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new E.init,this._nDataBytes=0},_append:function(b){typeof b=="string"&&(b=_.parse(b)),this._data.concat(b),this._nDataBytes+=b.sigBytes},_process:function(b){var g,S=this._data,m=S.words,l=S.sigBytes,c=this.blockSize,a=c*4,x=l/a;b?x=t.ceil(x):x=t.max((x|0)-this._minBufferSize,0);var d=x*c,A=t.min(d*4,l);if(d){for(var B=0;B<d;B+=c)this._doProcessBlock(m,B);g=m.splice(0,d),S.sigBytes-=A}return new E.init(g,A)},clone:function(){var b=v.clone.call(this);return b._data=this._data.clone(),b},_minBufferSize:0});u.Hasher=R.extend({cfg:v.extend(),init:function(b){this.cfg=this.cfg.extend(b),this.reset()},reset:function(){R.reset.call(this),this._doReset()},update:function(b){return this._append(b),this._process(),this},finalize:function(b){b&&this._append(b);var g=this._doFinalize();return g},blockSize:16,_createHelper:function(b){return function(g,S){return new b.init(S).finalize(g)}},_createHmacHelper:function(b){return function(g,S){return new D.HMAC.init(b,S).finalize(g)}}});var D=C.algo={};return C}(Math);return s})}(Kt)),Kt.exports}var Xt={exports:{}},Er;function Lt(){return Er||(Er=1,function(o,n){(function(s,t){o.exports=t(be())})(ge,function(s){return function(t){var r=s,p=r.lib,i=p.Base,h=p.WordArray,C=r.x64={};C.Word=i.extend({init:function(u,v){this.high=u,this.low=v}}),C.WordArray=i.extend({init:function(u,v){u=this.words=u||[],v!=t?this.sigBytes=v:this.sigBytes=u.length*8},toX32:function(){for(var u=this.words,v=u.length,E=[],y=0;y<v;y++){var w=u[y];E.push(w.high),E.push(w.low)}return h.create(E,this.sigBytes)},clone:function(){for(var u=i.clone.call(this),v=u.words=this.words.slice(0),E=v.length,y=0;y<E;y++)v[y]=v[y].clone();return u}})}(),s})}(Xt)),Xt.exports}var Jt={exports:{}},_r;function c4(){return _r||(_r=1,function(o,n){(function(s,t){o.exports=t(be())})(ge,function(s){return function(){if(typeof ArrayBuffer=="function"){var t=s,r=t.lib,p=r.WordArray,i=p.init,h=p.init=function(C){if(C instanceof ArrayBuffer&&(C=new Uint8Array(C)),(C instanceof Int8Array||typeof Uint8ClampedArray<"u"&&C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array)&&(C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength)),C instanceof Uint8Array){for(var u=C.byteLength,v=[],E=0;E<u;E++)v[E>>>2]|=C[E]<<24-E%4*8;i.call(this,v,u)}else i.apply(this,arguments)};h.prototype=p}}(),s.lib.WordArray})}(Jt)),Jt.exports}var Qt={exports:{}},Sr;function u4(){return Sr||(Sr=1,function(o,n){(function(s,t){o.exports=t(be())})(ge,function(s){return function(){var t=s,r=t.lib,p=r.WordArray,i=t.enc;i.Utf16=i.Utf16BE={stringify:function(C){for(var u=C.words,v=C.sigBytes,E=[],y=0;y<v;y+=2){var w=u[y>>>2]>>>16-y%4*8&65535;E.push(String.fromCharCode(w))}return E.join("")},parse:function(C){for(var u=C.length,v=[],E=0;E<u;E++)v[E>>>1]|=C.charCodeAt(E)<<16-E%2*16;return p.create(v,u*2)}},i.Utf16LE={stringify:function(C){for(var u=C.words,v=C.sigBytes,E=[],y=0;y<v;y+=2){var w=h(u[y>>>2]>>>16-y%4*8&65535);E.push(String.fromCharCode(w))}return E.join("")},parse:function(C){for(var u=C.length,v=[],E=0;E<u;E++)v[E>>>1]|=h(C.charCodeAt(E)<<16-E%2*16);return p.create(v,u*2)}};function h(C){return C<<8&4278255360|C>>>8&16711935}}(),s.enc.Utf16})}(Qt)),Qt.exports}var Yt={exports:{}},wr;function ut(){return wr||(wr=1,function(o,n){(function(s,t){o.exports=t(be())})(ge,function(s){return function(){var t=s,r=t.lib,p=r.WordArray,i=t.enc;i.Base64={stringify:function(C){var u=C.words,v=C.sigBytes,E=this._map;C.clamp();for(var y=[],w=0;w<v;w+=3)for(var f=u[w>>>2]>>>24-w%4*8&255,_=u[w+1>>>2]>>>24-(w+1)%4*8&255,R=u[w+2>>>2]>>>24-(w+2)%4*8&255,D=f<<16|_<<8|R,b=0;b<4&&w+b*.75<v;b++)y.push(E.charAt(D>>>6*(3-b)&63));var g=E.charAt(64);if(g)for(;y.length%4;)y.push(g);return y.join("")},parse:function(C){var u=C.length,v=this._map,E=this._reverseMap;if(!E){E=this._reverseMap=[];for(var y=0;y<v.length;y++)E[v.charCodeAt(y)]=y}var w=v.charAt(64);if(w){var f=C.indexOf(w);f!==-1&&(u=f)}return h(C,u,E)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function h(C,u,v){for(var E=[],y=0,w=0;w<u;w++)if(w%4){var f=v[C.charCodeAt(w-1)]<<w%4*2,_=v[C.charCodeAt(w)]>>>6-w%4*2,R=f|_;E[y>>>2]|=R<<24-y%4*8,y++}return p.create(E,y)}}(),s.enc.Base64})}(Yt)),Yt.exports}var Zt={exports:{}},Rr;function d4(){return Rr||(Rr=1,function(o,n){(function(s,t){o.exports=t(be())})(ge,function(s){return function(){var t=s,r=t.lib,p=r.WordArray,i=t.enc;i.Base64url={stringify:function(C,u){u===void 0&&(u=!0);var v=C.words,E=C.sigBytes,y=u?this._safe_map:this._map;C.clamp();for(var w=[],f=0;f<E;f+=3)for(var _=v[f>>>2]>>>24-f%4*8&255,R=v[f+1>>>2]>>>24-(f+1)%4*8&255,D=v[f+2>>>2]>>>24-(f+2)%4*8&255,b=_<<16|R<<8|D,g=0;g<4&&f+g*.75<E;g++)w.push(y.charAt(b>>>6*(3-g)&63));var S=y.charAt(64);if(S)for(;w.length%4;)w.push(S);return w.join("")},parse:function(C,u){u===void 0&&(u=!0);var v=C.length,E=u?this._safe_map:this._map,y=this._reverseMap;if(!y){y=this._reverseMap=[];for(var w=0;w<E.length;w++)y[E.charCodeAt(w)]=w}var f=E.charAt(64);if(f){var _=C.indexOf(f);_!==-1&&(v=_)}return h(C,v,y)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function h(C,u,v){for(var E=[],y=0,w=0;w<u;w++)if(w%4){var f=v[C.charCodeAt(w-1)]<<w%4*2,_=v[C.charCodeAt(w)]>>>6-w%4*2,R=f|_;E[y>>>2]|=R<<24-y%4*8,y++}return p.create(E,y)}}(),s.enc.Base64url})}(Zt)),Zt.exports}var en={exports:{}},Dr;function dt(){return Dr||(Dr=1,function(o,n){(function(s,t){o.exports=t(be())})(ge,function(s){return function(t){var r=s,p=r.lib,i=p.WordArray,h=p.Hasher,C=r.algo,u=[];(function(){for(var _=0;_<64;_++)u[_]=t.abs(t.sin(_+1))*4294967296|0})();var v=C.MD5=h.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(_,R){for(var D=0;D<16;D++){var b=R+D,g=_[b];_[b]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360}var S=this._hash.words,m=_[R+0],l=_[R+1],c=_[R+2],a=_[R+3],x=_[R+4],d=_[R+5],A=_[R+6],B=_[R+7],O=_[R+8],k=_[R+9],F=_[R+10],M=_[R+11],P=_[R+12],U=_[R+13],N=_[R+14],H=_[R+15],G=S[0],z=S[1],j=S[2],$=S[3];G=E(G,z,j,$,m,7,u[0]),$=E($,G,z,j,l,12,u[1]),j=E(j,$,G,z,c,17,u[2]),z=E(z,j,$,G,a,22,u[3]),G=E(G,z,j,$,x,7,u[4]),$=E($,G,z,j,d,12,u[5]),j=E(j,$,G,z,A,17,u[6]),z=E(z,j,$,G,B,22,u[7]),G=E(G,z,j,$,O,7,u[8]),$=E($,G,z,j,k,12,u[9]),j=E(j,$,G,z,F,17,u[10]),z=E(z,j,$,G,M,22,u[11]),G=E(G,z,j,$,P,7,u[12]),$=E($,G,z,j,U,12,u[13]),j=E(j,$,G,z,N,17,u[14]),z=E(z,j,$,G,H,22,u[15]),G=y(G,z,j,$,l,5,u[16]),$=y($,G,z,j,A,9,u[17]),j=y(j,$,G,z,M,14,u[18]),z=y(z,j,$,G,m,20,u[19]),G=y(G,z,j,$,d,5,u[20]),$=y($,G,z,j,F,9,u[21]),j=y(j,$,G,z,H,14,u[22]),z=y(z,j,$,G,x,20,u[23]),G=y(G,z,j,$,k,5,u[24]),$=y($,G,z,j,N,9,u[25]),j=y(j,$,G,z,a,14,u[26]),z=y(z,j,$,G,O,20,u[27]),G=y(G,z,j,$,U,5,u[28]),$=y($,G,z,j,c,9,u[29]),j=y(j,$,G,z,B,14,u[30]),z=y(z,j,$,G,P,20,u[31]),G=w(G,z,j,$,d,4,u[32]),$=w($,G,z,j,O,11,u[33]),j=w(j,$,G,z,M,16,u[34]),z=w(z,j,$,G,N,23,u[35]),G=w(G,z,j,$,l,4,u[36]),$=w($,G,z,j,x,11,u[37]),j=w(j,$,G,z,B,16,u[38]),z=w(z,j,$,G,F,23,u[39]),G=w(G,z,j,$,U,4,u[40]),$=w($,G,z,j,m,11,u[41]),j=w(j,$,G,z,a,16,u[42]),z=w(z,j,$,G,A,23,u[43]),G=w(G,z,j,$,k,4,u[44]),$=w($,G,z,j,P,11,u[45]),j=w(j,$,G,z,H,16,u[46]),z=w(z,j,$,G,c,23,u[47]),G=f(G,z,j,$,m,6,u[48]),$=f($,G,z,j,B,10,u[49]),j=f(j,$,G,z,N,15,u[50]),z=f(z,j,$,G,d,21,u[51]),G=f(G,z,j,$,P,6,u[52]),$=f($,G,z,j,a,10,u[53]),j=f(j,$,G,z,F,15,u[54]),z=f(z,j,$,G,l,21,u[55]),G=f(G,z,j,$,O,6,u[56]),$=f($,G,z,j,H,10,u[57]),j=f(j,$,G,z,A,15,u[58]),z=f(z,j,$,G,U,21,u[59]),G=f(G,z,j,$,x,6,u[60]),$=f($,G,z,j,M,10,u[61]),j=f(j,$,G,z,c,15,u[62]),z=f(z,j,$,G,k,21,u[63]),S[0]=S[0]+G|0,S[1]=S[1]+z|0,S[2]=S[2]+j|0,S[3]=S[3]+$|0},_doFinalize:function(){var _=this._data,R=_.words,D=this._nDataBytes*8,b=_.sigBytes*8;R[b>>>5]|=128<<24-b%32;var g=t.floor(D/4294967296),S=D;R[(b+64>>>9<<4)+15]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,R[(b+64>>>9<<4)+14]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,_.sigBytes=(R.length+1)*4,this._process();for(var m=this._hash,l=m.words,c=0;c<4;c++){var a=l[c];l[c]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360}return m},clone:function(){var _=h.clone.call(this);return _._hash=this._hash.clone(),_}});function E(_,R,D,b,g,S,m){var l=_+(R&D|~R&b)+g+m;return(l<<S|l>>>32-S)+R}function y(_,R,D,b,g,S,m){var l=_+(R&b|D&~b)+g+m;return(l<<S|l>>>32-S)+R}function w(_,R,D,b,g,S,m){var l=_+(R^D^b)+g+m;return(l<<S|l>>>32-S)+R}function f(_,R,D,b,g,S,m){var l=_+(D^(R|~b))+g+m;return(l<<S|l>>>32-S)+R}r.MD5=h._createHelper(v),r.HmacMD5=h._createHmacHelper(v)}(Math),s.MD5})}(en)),en.exports}var tn={exports:{}},Or;function ro(){return Or||(Or=1,function(o,n){(function(s,t){o.exports=t(be())})(ge,function(s){return function(){var t=s,r=t.lib,p=r.WordArray,i=r.Hasher,h=t.algo,C=[],u=h.SHA1=i.extend({_doReset:function(){this._hash=new p.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(v,E){for(var y=this._hash.words,w=y[0],f=y[1],_=y[2],R=y[3],D=y[4],b=0;b<80;b++){if(b<16)C[b]=v[E+b]|0;else{var g=C[b-3]^C[b-8]^C[b-14]^C[b-16];C[b]=g<<1|g>>>31}var S=(w<<5|w>>>27)+D+C[b];b<20?S+=(f&_|~f&R)+1518500249:b<40?S+=(f^_^R)+1859775393:b<60?S+=(f&_|f&R|_&R)-1894007588:S+=(f^_^R)-899497514,D=R,R=_,_=f<<30|f>>>2,f=w,w=S}y[0]=y[0]+w|0,y[1]=y[1]+f|0,y[2]=y[2]+_|0,y[3]=y[3]+R|0,y[4]=y[4]+D|0},_doFinalize:function(){var v=this._data,E=v.words,y=this._nDataBytes*8,w=v.sigBytes*8;return E[w>>>5]|=128<<24-w%32,E[(w+64>>>9<<4)+14]=Math.floor(y/4294967296),E[(w+64>>>9<<4)+15]=y,v.sigBytes=E.length*4,this._process(),this._hash},clone:function(){var v=i.clone.call(this);return v._hash=this._hash.clone(),v}});t.SHA1=i._createHelper(u),t.HmacSHA1=i._createHmacHelper(u)}(),s.SHA1})}(tn)),tn.exports}var nn={exports:{}},Br;function Wn(){return Br||(Br=1,function(o,n){(function(s,t){o.exports=t(be())})(ge,function(s){return function(t){var r=s,p=r.lib,i=p.WordArray,h=p.Hasher,C=r.algo,u=[],v=[];(function(){function w(D){for(var b=t.sqrt(D),g=2;g<=b;g++)if(!(D%g))return!1;return!0}function f(D){return(D-(D|0))*4294967296|0}for(var _=2,R=0;R<64;)w(_)&&(R<8&&(u[R]=f(t.pow(_,1/2))),v[R]=f(t.pow(_,1/3)),R++),_++})();var E=[],y=C.SHA256=h.extend({_doReset:function(){this._hash=new i.init(u.slice(0))},_doProcessBlock:function(w,f){for(var _=this._hash.words,R=_[0],D=_[1],b=_[2],g=_[3],S=_[4],m=_[5],l=_[6],c=_[7],a=0;a<64;a++){if(a<16)E[a]=w[f+a]|0;else{var x=E[a-15],d=(x<<25|x>>>7)^(x<<14|x>>>18)^x>>>3,A=E[a-2],B=(A<<15|A>>>17)^(A<<13|A>>>19)^A>>>10;E[a]=d+E[a-7]+B+E[a-16]}var O=S&m^~S&l,k=R&D^R&b^D&b,F=(R<<30|R>>>2)^(R<<19|R>>>13)^(R<<10|R>>>22),M=(S<<26|S>>>6)^(S<<21|S>>>11)^(S<<7|S>>>25),P=c+M+O+v[a]+E[a],U=F+k;c=l,l=m,m=S,S=g+P|0,g=b,b=D,D=R,R=P+U|0}_[0]=_[0]+R|0,_[1]=_[1]+D|0,_[2]=_[2]+b|0,_[3]=_[3]+g|0,_[4]=_[4]+S|0,_[5]=_[5]+m|0,_[6]=_[6]+l|0,_[7]=_[7]+c|0},_doFinalize:function(){var w=this._data,f=w.words,_=this._nDataBytes*8,R=w.sigBytes*8;return f[R>>>5]|=128<<24-R%32,f[(R+64>>>9<<4)+14]=t.floor(_/4294967296),f[(R+64>>>9<<4)+15]=_,w.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var w=h.clone.call(this);return w._hash=this._hash.clone(),w}});r.SHA256=h._createHelper(y),r.HmacSHA256=h._createHmacHelper(y)}(Math),s.SHA256})}(nn)),nn.exports}var rn={exports:{}},Tr;function f4(){return Tr||(Tr=1,function(o,n){(function(s,t,r){o.exports=t(be(),Wn())})(ge,function(s){return function(){var t=s,r=t.lib,p=r.WordArray,i=t.algo,h=i.SHA256,C=i.SHA224=h.extend({_doReset:function(){this._hash=new p.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var u=h._doFinalize.call(this);return u.sigBytes-=4,u}});t.SHA224=h._createHelper(C),t.HmacSHA224=h._createHmacHelper(C)}(),s.SHA224})}(rn)),rn.exports}var sn={exports:{}},kr;function so(){return kr||(kr=1,function(o,n){(function(s,t,r){o.exports=t(be(),Lt())})(ge,function(s){return function(){var t=s,r=t.lib,p=r.Hasher,i=t.x64,h=i.Word,C=i.WordArray,u=t.algo;function v(){return h.create.apply(h,arguments)}var E=[v(1116352408,3609767458),v(1899447441,602891725),v(3049323471,3964484399),v(3921009573,2173295548),v(961987163,4081628472),v(1508970993,3053834265),v(2453635748,2937671579),v(2870763221,3664609560),v(3624381080,2734883394),v(310598401,1164996542),v(607225278,1323610764),v(1426881987,3590304994),v(1925078388,4068182383),v(2162078206,991336113),v(2614888103,633803317),v(3248222580,3479774868),v(3835390401,2666613458),v(4022224774,944711139),v(264347078,2341262773),v(604807628,2007800933),v(770255983,1495990901),v(1249150122,1856431235),v(1555081692,3175218132),v(1996064986,2198950837),v(2554220882,3999719339),v(2821834349,766784016),v(2952996808,2566594879),v(3210313671,3203337956),v(3336571891,1034457026),v(3584528711,2466948901),v(113926993,3758326383),v(338241895,168717936),v(666307205,1188179964),v(773529912,1546045734),v(1294757372,1522805485),v(1396182291,2643833823),v(1695183700,2343527390),v(1986661051,1014477480),v(2177026350,1206759142),v(2456956037,344077627),v(2730485921,1290863460),v(2820302411,3158454273),v(3259730800,3505952657),v(3345764771,106217008),v(3516065817,3606008344),v(3600352804,1432725776),v(4094571909,1467031594),v(275423344,851169720),v(430227734,3100823752),v(506948616,1363258195),v(659060556,3750685593),v(883997877,3785050280),v(958139571,3318307427),v(1322822218,3812723403),v(1537002063,2003034995),v(1747873779,3602036899),v(1955562222,1575990012),v(2024104815,1125592928),v(2227730452,2716904306),v(2361852424,442776044),v(2428436474,593698344),v(2756734187,3733110249),v(3204031479,2999351573),v(3329325298,3815920427),v(3391569614,3928383900),v(3515267271,566280711),v(3940187606,3454069534),v(4118630271,4000239992),v(116418474,1914138554),v(174292421,2731055270),v(289380356,3203993006),v(460393269,320620315),v(685471733,587496836),v(852142971,1086792851),v(1017036298,365543100),v(1126000580,2618297676),v(1288033470,3409855158),v(1501505948,4234509866),v(1607167915,987167468),v(1816402316,1246189591)],y=[];(function(){for(var f=0;f<80;f++)y[f]=v()})();var w=u.SHA512=p.extend({_doReset:function(){this._hash=new C.init([new h.init(1779033703,4089235720),new h.init(3144134277,2227873595),new h.init(1013904242,4271175723),new h.init(2773480762,1595750129),new h.init(1359893119,2917565137),new h.init(2600822924,725511199),new h.init(528734635,4215389547),new h.init(1541459225,327033209)])},_doProcessBlock:function(f,_){for(var R=this._hash.words,D=R[0],b=R[1],g=R[2],S=R[3],m=R[4],l=R[5],c=R[6],a=R[7],x=D.high,d=D.low,A=b.high,B=b.low,O=g.high,k=g.low,F=S.high,M=S.low,P=m.high,U=m.low,N=l.high,H=l.low,G=c.high,z=c.low,j=a.high,$=a.low,I=x,L=d,V=A,J=B,ne=O,se=k,de=F,pe=M,me=P,re=U,we=N,Be=H,$e=G,De=z,Ve=j,Ke=$,Te=0;Te<80;Te++){var Ie,ze,Ye=y[Te];if(Te<16)ze=Ye.high=f[_+Te*2]|0,Ie=Ye.low=f[_+Te*2+1]|0;else{var At=y[Te-15],Ze=At.high,st=At.low,X=(Ze>>>1|st<<31)^(Ze>>>8|st<<24)^Ze>>>7,ee=(st>>>1|Ze<<31)^(st>>>8|Ze<<24)^(st>>>7|Ze<<25),te=y[Te-2],oe=te.high,he=te.low,Ne=(oe>>>19|he<<13)^(oe<<3|he>>>29)^oe>>>6,et=(he>>>19|oe<<13)^(he<<3|oe>>>29)^(he>>>6|oe<<26),qn=y[Te-7],io=qn.high,ao=qn.low,Kn=y[Te-16],lo=Kn.high,Xn=Kn.low;Ie=ee+ao,ze=X+io+(Ie>>>0<ee>>>0?1:0),Ie=Ie+et,ze=ze+Ne+(Ie>>>0<et>>>0?1:0),Ie=Ie+Xn,ze=ze+lo+(Ie>>>0<Xn>>>0?1:0),Ye.high=ze,Ye.low=Ie}var co=me&we^~me&$e,Jn=re&Be^~re&De,uo=I&V^I&ne^V&ne,fo=L&J^L&se^J&se,po=(I>>>28|L<<4)^(I<<30|L>>>2)^(I<<25|L>>>7),Qn=(L>>>28|I<<4)^(L<<30|I>>>2)^(L<<25|I>>>7),ho=(me>>>14|re<<18)^(me>>>18|re<<14)^(me<<23|re>>>9),vo=(re>>>14|me<<18)^(re>>>18|me<<14)^(re<<23|me>>>9),Yn=E[Te],mo=Yn.high,Zn=Yn.low,Ge=Ke+vo,tt=Ve+ho+(Ge>>>0<Ke>>>0?1:0),Ge=Ge+Jn,tt=tt+co+(Ge>>>0<Jn>>>0?1:0),Ge=Ge+Zn,tt=tt+mo+(Ge>>>0<Zn>>>0?1:0),Ge=Ge+Ie,tt=tt+ze+(Ge>>>0<Ie>>>0?1:0),er=Qn+fo,go=po+uo+(er>>>0<Qn>>>0?1:0);Ve=$e,Ke=De,$e=we,De=Be,we=me,Be=re,re=pe+Ge|0,me=de+tt+(re>>>0<pe>>>0?1:0)|0,de=ne,pe=se,ne=V,se=J,V=I,J=L,L=Ge+er|0,I=tt+go+(L>>>0<Ge>>>0?1:0)|0}d=D.low=d+L,D.high=x+I+(d>>>0<L>>>0?1:0),B=b.low=B+J,b.high=A+V+(B>>>0<J>>>0?1:0),k=g.low=k+se,g.high=O+ne+(k>>>0<se>>>0?1:0),M=S.low=M+pe,S.high=F+de+(M>>>0<pe>>>0?1:0),U=m.low=U+re,m.high=P+me+(U>>>0<re>>>0?1:0),H=l.low=H+Be,l.high=N+we+(H>>>0<Be>>>0?1:0),z=c.low=z+De,c.high=G+$e+(z>>>0<De>>>0?1:0),$=a.low=$+Ke,a.high=j+Ve+($>>>0<Ke>>>0?1:0)},_doFinalize:function(){var f=this._data,_=f.words,R=this._nDataBytes*8,D=f.sigBytes*8;_[D>>>5]|=128<<24-D%32,_[(D+128>>>10<<5)+30]=Math.floor(R/4294967296),_[(D+128>>>10<<5)+31]=R,f.sigBytes=_.length*4,this._process();var b=this._hash.toX32();return b},clone:function(){var f=p.clone.call(this);return f._hash=this._hash.clone(),f},blockSize:1024/32});t.SHA512=p._createHelper(w),t.HmacSHA512=p._createHmacHelper(w)}(),s.SHA512})}(sn)),sn.exports}var on={exports:{}},$r;function p4(){return $r||($r=1,function(o,n){(function(s,t,r){o.exports=t(be(),Lt(),so())})(ge,function(s){return function(){var t=s,r=t.x64,p=r.Word,i=r.WordArray,h=t.algo,C=h.SHA512,u=h.SHA384=C.extend({_doReset:function(){this._hash=new i.init([new p.init(3418070365,3238371032),new p.init(1654270250,914150663),new p.init(2438529370,812702999),new p.init(355462360,4144912697),new p.init(1731405415,4290775857),new p.init(2394180231,1750603025),new p.init(3675008525,1694076839),new p.init(1203062813,3204075428)])},_doFinalize:function(){var v=C._doFinalize.call(this);return v.sigBytes-=16,v}});t.SHA384=C._createHelper(u),t.HmacSHA384=C._createHmacHelper(u)}(),s.SHA384})}(on)),on.exports}var an={exports:{}},Fr;function h4(){return Fr||(Fr=1,function(o,n){(function(s,t,r){o.exports=t(be(),Lt())})(ge,function(s){return function(t){var r=s,p=r.lib,i=p.WordArray,h=p.Hasher,C=r.x64,u=C.Word,v=r.algo,E=[],y=[],w=[];(function(){for(var R=1,D=0,b=0;b<24;b++){E[R+5*D]=(b+1)*(b+2)/2%64;var g=D%5,S=(2*R+3*D)%5;R=g,D=S}for(var R=0;R<5;R++)for(var D=0;D<5;D++)y[R+5*D]=D+(2*R+3*D)%5*5;for(var m=1,l=0;l<24;l++){for(var c=0,a=0,x=0;x<7;x++){if(m&1){var d=(1<<x)-1;d<32?a^=1<<d:c^=1<<d-32}m&128?m=m<<1^113:m<<=1}w[l]=u.create(c,a)}})();var f=[];(function(){for(var R=0;R<25;R++)f[R]=u.create()})();var _=v.SHA3=h.extend({cfg:h.cfg.extend({outputLength:512}),_doReset:function(){for(var R=this._state=[],D=0;D<25;D++)R[D]=new u.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(R,D){for(var b=this._state,g=this.blockSize/2,S=0;S<g;S++){var m=R[D+2*S],l=R[D+2*S+1];m=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,l=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360;var c=b[S];c.high^=l,c.low^=m}for(var a=0;a<24;a++){for(var x=0;x<5;x++){for(var d=0,A=0,B=0;B<5;B++){var c=b[x+5*B];d^=c.high,A^=c.low}var O=f[x];O.high=d,O.low=A}for(var x=0;x<5;x++)for(var k=f[(x+4)%5],F=f[(x+1)%5],M=F.high,P=F.low,d=k.high^(M<<1|P>>>31),A=k.low^(P<<1|M>>>31),B=0;B<5;B++){var c=b[x+5*B];c.high^=d,c.low^=A}for(var U=1;U<25;U++){var d,A,c=b[U],N=c.high,H=c.low,G=E[U];G<32?(d=N<<G|H>>>32-G,A=H<<G|N>>>32-G):(d=H<<G-32|N>>>64-G,A=N<<G-32|H>>>64-G);var z=f[y[U]];z.high=d,z.low=A}var j=f[0],$=b[0];j.high=$.high,j.low=$.low;for(var x=0;x<5;x++)for(var B=0;B<5;B++){var U=x+5*B,c=b[U],I=f[U],L=f[(x+1)%5+5*B],V=f[(x+2)%5+5*B];c.high=I.high^~L.high&V.high,c.low=I.low^~L.low&V.low}var c=b[0],J=w[a];c.high^=J.high,c.low^=J.low}},_doFinalize:function(){var R=this._data,D=R.words;this._nDataBytes*8;var b=R.sigBytes*8,g=this.blockSize*32;D[b>>>5]|=1<<24-b%32,D[(t.ceil((b+1)/g)*g>>>5)-1]|=128,R.sigBytes=D.length*4,this._process();for(var S=this._state,m=this.cfg.outputLength/8,l=m/8,c=[],a=0;a<l;a++){var x=S[a],d=x.high,A=x.low;d=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,c.push(A),c.push(d)}return new i.init(c,m)},clone:function(){for(var R=h.clone.call(this),D=R._state=this._state.slice(0),b=0;b<25;b++)D[b]=D[b].clone();return R}});r.SHA3=h._createHelper(_),r.HmacSHA3=h._createHmacHelper(_)}(Math),s.SHA3})}(an)),an.exports}var ln={exports:{}},Pr;function v4(){return Pr||(Pr=1,function(o,n){(function(s,t){o.exports=t(be())})(ge,function(s){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(t){var r=s,p=r.lib,i=p.WordArray,h=p.Hasher,C=r.algo,u=i.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),v=i.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),E=i.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),y=i.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),w=i.create([0,1518500249,1859775393,2400959708,2840853838]),f=i.create([1352829926,1548603684,1836072691,2053994217,0]),_=C.RIPEMD160=h.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(l,c){for(var a=0;a<16;a++){var x=c+a,d=l[x];l[x]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360}var A=this._hash.words,B=w.words,O=f.words,k=u.words,F=v.words,M=E.words,P=y.words,U,N,H,G,z,j,$,I,L,V;j=U=A[0],$=N=A[1],I=H=A[2],L=G=A[3],V=z=A[4];for(var J,a=0;a<80;a+=1)J=U+l[c+k[a]]|0,a<16?J+=R(N,H,G)+B[0]:a<32?J+=D(N,H,G)+B[1]:a<48?J+=b(N,H,G)+B[2]:a<64?J+=g(N,H,G)+B[3]:J+=S(N,H,G)+B[4],J=J|0,J=m(J,M[a]),J=J+z|0,U=z,z=G,G=m(H,10),H=N,N=J,J=j+l[c+F[a]]|0,a<16?J+=S($,I,L)+O[0]:a<32?J+=g($,I,L)+O[1]:a<48?J+=b($,I,L)+O[2]:a<64?J+=D($,I,L)+O[3]:J+=R($,I,L)+O[4],J=J|0,J=m(J,P[a]),J=J+V|0,j=V,V=L,L=m(I,10),I=$,$=J;J=A[1]+H+L|0,A[1]=A[2]+G+V|0,A[2]=A[3]+z+j|0,A[3]=A[4]+U+$|0,A[4]=A[0]+N+I|0,A[0]=J},_doFinalize:function(){var l=this._data,c=l.words,a=this._nDataBytes*8,x=l.sigBytes*8;c[x>>>5]|=128<<24-x%32,c[(x+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360,l.sigBytes=(c.length+1)*4,this._process();for(var d=this._hash,A=d.words,B=0;B<5;B++){var O=A[B];A[B]=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360}return d},clone:function(){var l=h.clone.call(this);return l._hash=this._hash.clone(),l}});function R(l,c,a){return l^c^a}function D(l,c,a){return l&c|~l&a}function b(l,c,a){return(l|~c)^a}function g(l,c,a){return l&a|c&~a}function S(l,c,a){return l^(c|~a)}function m(l,c){return l<<c|l>>>32-c}r.RIPEMD160=h._createHelper(_),r.HmacRIPEMD160=h._createHmacHelper(_)}(),s.RIPEMD160})}(ln)),ln.exports}var cn={exports:{}},Mr;function zn(){return Mr||(Mr=1,function(o,n){(function(s,t){o.exports=t(be())})(ge,function(s){(function(){var t=s,r=t.lib,p=r.Base,i=t.enc,h=i.Utf8,C=t.algo;C.HMAC=p.extend({init:function(u,v){u=this._hasher=new u.init,typeof v=="string"&&(v=h.parse(v));var E=u.blockSize,y=E*4;v.sigBytes>y&&(v=u.finalize(v)),v.clamp();for(var w=this._oKey=v.clone(),f=this._iKey=v.clone(),_=w.words,R=f.words,D=0;D<E;D++)_[D]^=1549556828,R[D]^=909522486;w.sigBytes=f.sigBytes=y,this.reset()},reset:function(){var u=this._hasher;u.reset(),u.update(this._iKey)},update:function(u){return this._hasher.update(u),this},finalize:function(u){var v=this._hasher,E=v.finalize(u);v.reset();var y=v.finalize(this._oKey.clone().concat(E));return y}})})()})}(cn)),cn.exports}var un={exports:{}},Ir;function m4(){return Ir||(Ir=1,function(o,n){(function(s,t,r){o.exports=t(be(),Wn(),zn())})(ge,function(s){return function(){var t=s,r=t.lib,p=r.Base,i=r.WordArray,h=t.algo,C=h.SHA256,u=h.HMAC,v=h.PBKDF2=p.extend({cfg:p.extend({keySize:128/32,hasher:C,iterations:25e4}),init:function(E){this.cfg=this.cfg.extend(E)},compute:function(E,y){for(var w=this.cfg,f=u.create(w.hasher,E),_=i.create(),R=i.create([1]),D=_.words,b=R.words,g=w.keySize,S=w.iterations;D.length<g;){var m=f.update(y).finalize(R);f.reset();for(var l=m.words,c=l.length,a=m,x=1;x<S;x++){a=f.finalize(a),f.reset();for(var d=a.words,A=0;A<c;A++)l[A]^=d[A]}_.concat(m),b[0]++}return _.sigBytes=g*4,_}});t.PBKDF2=function(E,y,w){return v.create(w).compute(E,y)}}(),s.PBKDF2})}(un)),un.exports}var dn={exports:{}},Nr;function rt(){return Nr||(Nr=1,function(o,n){(function(s,t,r){o.exports=t(be(),ro(),zn())})(ge,function(s){return function(){var t=s,r=t.lib,p=r.Base,i=r.WordArray,h=t.algo,C=h.MD5,u=h.EvpKDF=p.extend({cfg:p.extend({keySize:128/32,hasher:C,iterations:1}),init:function(v){this.cfg=this.cfg.extend(v)},compute:function(v,E){for(var y,w=this.cfg,f=w.hasher.create(),_=i.create(),R=_.words,D=w.keySize,b=w.iterations;R.length<D;){y&&f.update(y),y=f.update(v).finalize(E),f.reset();for(var g=1;g<b;g++)y=f.finalize(y),f.reset();_.concat(y)}return _.sigBytes=D*4,_}});t.EvpKDF=function(v,E,y){return u.create(y).compute(v,E)}}(),s.EvpKDF})}(dn)),dn.exports}var fn={exports:{}},Ur;function Me(){return Ur||(Ur=1,function(o,n){(function(s,t,r){o.exports=t(be(),rt())})(ge,function(s){s.lib.Cipher||function(t){var r=s,p=r.lib,i=p.Base,h=p.WordArray,C=p.BufferedBlockAlgorithm,u=r.enc;u.Utf8;var v=u.Base64,E=r.algo,y=E.EvpKDF,w=p.Cipher=C.extend({cfg:i.extend(),createEncryptor:function(d,A){return this.create(this._ENC_XFORM_MODE,d,A)},createDecryptor:function(d,A){return this.create(this._DEC_XFORM_MODE,d,A)},init:function(d,A,B){this.cfg=this.cfg.extend(B),this._xformMode=d,this._key=A,this.reset()},reset:function(){C.reset.call(this),this._doReset()},process:function(d){return this._append(d),this._process()},finalize:function(d){d&&this._append(d);var A=this._doFinalize();return A},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function d(A){return typeof A=="string"?x:l}return function(A){return{encrypt:function(B,O,k){return d(O).encrypt(A,B,O,k)},decrypt:function(B,O,k){return d(O).decrypt(A,B,O,k)}}}}()});p.StreamCipher=w.extend({_doFinalize:function(){var d=this._process(!0);return d},blockSize:1});var f=r.mode={},_=p.BlockCipherMode=i.extend({createEncryptor:function(d,A){return this.Encryptor.create(d,A)},createDecryptor:function(d,A){return this.Decryptor.create(d,A)},init:function(d,A){this._cipher=d,this._iv=A}}),R=f.CBC=function(){var d=_.extend();d.Encryptor=d.extend({processBlock:function(B,O){var k=this._cipher,F=k.blockSize;A.call(this,B,O,F),k.encryptBlock(B,O),this._prevBlock=B.slice(O,O+F)}}),d.Decryptor=d.extend({processBlock:function(B,O){var k=this._cipher,F=k.blockSize,M=B.slice(O,O+F);k.decryptBlock(B,O),A.call(this,B,O,F),this._prevBlock=M}});function A(B,O,k){var F,M=this._iv;M?(F=M,this._iv=t):F=this._prevBlock;for(var P=0;P<k;P++)B[O+P]^=F[P]}return d}(),D=r.pad={},b=D.Pkcs7={pad:function(d,A){for(var B=A*4,O=B-d.sigBytes%B,k=O<<24|O<<16|O<<8|O,F=[],M=0;M<O;M+=4)F.push(k);var P=h.create(F,O);d.concat(P)},unpad:function(d){var A=d.words[d.sigBytes-1>>>2]&255;d.sigBytes-=A}};p.BlockCipher=w.extend({cfg:w.cfg.extend({mode:R,padding:b}),reset:function(){var d;w.reset.call(this);var A=this.cfg,B=A.iv,O=A.mode;this._xformMode==this._ENC_XFORM_MODE?d=O.createEncryptor:(d=O.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==d?this._mode.init(this,B&&B.words):(this._mode=d.call(O,this,B&&B.words),this._mode.__creator=d)},_doProcessBlock:function(d,A){this._mode.processBlock(d,A)},_doFinalize:function(){var d,A=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(A.pad(this._data,this.blockSize),d=this._process(!0)):(d=this._process(!0),A.unpad(d)),d},blockSize:128/32});var g=p.CipherParams=i.extend({init:function(d){this.mixIn(d)},toString:function(d){return(d||this.formatter).stringify(this)}}),S=r.format={},m=S.OpenSSL={stringify:function(d){var A,B=d.ciphertext,O=d.salt;return O?A=h.create([1398893684,1701076831]).concat(O).concat(B):A=B,A.toString(v)},parse:function(d){var A,B=v.parse(d),O=B.words;return O[0]==1398893684&&O[1]==1701076831&&(A=h.create(O.slice(2,4)),O.splice(0,4),B.sigBytes-=16),g.create({ciphertext:B,salt:A})}},l=p.SerializableCipher=i.extend({cfg:i.extend({format:m}),encrypt:function(d,A,B,O){O=this.cfg.extend(O);var k=d.createEncryptor(B,O),F=k.finalize(A),M=k.cfg;return g.create({ciphertext:F,key:B,iv:M.iv,algorithm:d,mode:M.mode,padding:M.padding,blockSize:d.blockSize,formatter:O.format})},decrypt:function(d,A,B,O){O=this.cfg.extend(O),A=this._parse(A,O.format);var k=d.createDecryptor(B,O).finalize(A.ciphertext);return k},_parse:function(d,A){return typeof d=="string"?A.parse(d,this):d}}),c=r.kdf={},a=c.OpenSSL={execute:function(d,A,B,O,k){if(O||(O=h.random(64/8)),k)var F=y.create({keySize:A+B,hasher:k}).compute(d,O);else var F=y.create({keySize:A+B}).compute(d,O);var M=h.create(F.words.slice(A),B*4);return F.sigBytes=A*4,g.create({key:F,iv:M,salt:O})}},x=p.PasswordBasedCipher=l.extend({cfg:l.cfg.extend({kdf:a}),encrypt:function(d,A,B,O){O=this.cfg.extend(O);var k=O.kdf.execute(B,d.keySize,d.ivSize,O.salt,O.hasher);O.iv=k.iv;var F=l.encrypt.call(this,d,A,k.key,O);return F.mixIn(k),F},decrypt:function(d,A,B,O){O=this.cfg.extend(O),A=this._parse(A,O.format);var k=O.kdf.execute(B,d.keySize,d.ivSize,A.salt,O.hasher);O.iv=k.iv;var F=l.decrypt.call(this,d,A,k.key,O);return F}})}()})}(fn)),fn.exports}var pn={exports:{}},Lr;function g4(){return Lr||(Lr=1,function(o,n){(function(s,t,r){o.exports=t(be(),Me())})(ge,function(s){return s.mode.CFB=function(){var t=s.lib.BlockCipherMode.extend();t.Encryptor=t.extend({processBlock:function(p,i){var h=this._cipher,C=h.blockSize;r.call(this,p,i,C,h),this._prevBlock=p.slice(i,i+C)}}),t.Decryptor=t.extend({processBlock:function(p,i){var h=this._cipher,C=h.blockSize,u=p.slice(i,i+C);r.call(this,p,i,C,h),this._prevBlock=u}});function r(p,i,h,C){var u,v=this._iv;v?(u=v.slice(0),this._iv=void 0):u=this._prevBlock,C.encryptBlock(u,0);for(var E=0;E<h;E++)p[i+E]^=u[E]}return t}(),s.mode.CFB})}(pn)),pn.exports}var hn={exports:{}},Hr;function y4(){return Hr||(Hr=1,function(o,n){(function(s,t,r){o.exports=t(be(),Me())})(ge,function(s){return s.mode.CTR=function(){var t=s.lib.BlockCipherMode.extend(),r=t.Encryptor=t.extend({processBlock:function(p,i){var h=this._cipher,C=h.blockSize,u=this._iv,v=this._counter;u&&(v=this._counter=u.slice(0),this._iv=void 0);var E=v.slice(0);h.encryptBlock(E,0),v[C-1]=v[C-1]+1|0;for(var y=0;y<C;y++)p[i+y]^=E[y]}});return t.Decryptor=r,t}(),s.mode.CTR})}(hn)),hn.exports}var vn={exports:{}},jr;function x4(){return jr||(jr=1,function(o,n){(function(s,t,r){o.exports=t(be(),Me())})(ge,function(s){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return s.mode.CTRGladman=function(){var t=s.lib.BlockCipherMode.extend();function r(h){if((h>>24&255)===255){var C=h>>16&255,u=h>>8&255,v=h&255;C===255?(C=0,u===255?(u=0,v===255?v=0:++v):++u):++C,h=0,h+=C<<16,h+=u<<8,h+=v}else h+=1<<24;return h}function p(h){return(h[0]=r(h[0]))===0&&(h[1]=r(h[1])),h}var i=t.Encryptor=t.extend({processBlock:function(h,C){var u=this._cipher,v=u.blockSize,E=this._iv,y=this._counter;E&&(y=this._counter=E.slice(0),this._iv=void 0),p(y);var w=y.slice(0);u.encryptBlock(w,0);for(var f=0;f<v;f++)h[C+f]^=w[f]}});return t.Decryptor=i,t}(),s.mode.CTRGladman})}(vn)),vn.exports}var mn={exports:{}},Vr;function b4(){return Vr||(Vr=1,function(o,n){(function(s,t,r){o.exports=t(be(),Me())})(ge,function(s){return s.mode.OFB=function(){var t=s.lib.BlockCipherMode.extend(),r=t.Encryptor=t.extend({processBlock:function(p,i){var h=this._cipher,C=h.blockSize,u=this._iv,v=this._keystream;u&&(v=this._keystream=u.slice(0),this._iv=void 0),h.encryptBlock(v,0);for(var E=0;E<C;E++)p[i+E]^=v[E]}});return t.Decryptor=r,t}(),s.mode.OFB})}(mn)),mn.exports}var gn={exports:{}},Gr;function C4(){return Gr||(Gr=1,function(o,n){(function(s,t,r){o.exports=t(be(),Me())})(ge,function(s){return s.mode.ECB=function(){var t=s.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(r,p){this._cipher.encryptBlock(r,p)}}),t.Decryptor=t.extend({processBlock:function(r,p){this._cipher.decryptBlock(r,p)}}),t}(),s.mode.ECB})}(gn)),gn.exports}var yn={exports:{}},Wr;function A4(){return Wr||(Wr=1,function(o,n){(function(s,t,r){o.exports=t(be(),Me())})(ge,function(s){return s.pad.AnsiX923={pad:function(t,r){var p=t.sigBytes,i=r*4,h=i-p%i,C=p+h-1;t.clamp(),t.words[C>>>2]|=h<<24-C%4*8,t.sigBytes+=h},unpad:function(t){var r=t.words[t.sigBytes-1>>>2]&255;t.sigBytes-=r}},s.pad.Ansix923})}(yn)),yn.exports}var xn={exports:{}},zr;function E4(){return zr||(zr=1,function(o,n){(function(s,t,r){o.exports=t(be(),Me())})(ge,function(s){return s.pad.Iso10126={pad:function(t,r){var p=r*4,i=p-t.sigBytes%p;t.concat(s.lib.WordArray.random(i-1)).concat(s.lib.WordArray.create([i<<24],1))},unpad:function(t){var r=t.words[t.sigBytes-1>>>2]&255;t.sigBytes-=r}},s.pad.Iso10126})}(xn)),xn.exports}var bn={exports:{}},qr;function _4(){return qr||(qr=1,function(o,n){(function(s,t,r){o.exports=t(be(),Me())})(ge,function(s){return s.pad.Iso97971={pad:function(t,r){t.concat(s.lib.WordArray.create([2147483648],1)),s.pad.ZeroPadding.pad(t,r)},unpad:function(t){s.pad.ZeroPadding.unpad(t),t.sigBytes--}},s.pad.Iso97971})}(bn)),bn.exports}var Cn={exports:{}},Kr;function S4(){return Kr||(Kr=1,function(o,n){(function(s,t,r){o.exports=t(be(),Me())})(ge,function(s){return s.pad.ZeroPadding={pad:function(t,r){var p=r*4;t.clamp(),t.sigBytes+=p-(t.sigBytes%p||p)},unpad:function(t){for(var r=t.words,p=t.sigBytes-1,p=t.sigBytes-1;p>=0;p--)if(r[p>>>2]>>>24-p%4*8&255){t.sigBytes=p+1;break}}},s.pad.ZeroPadding})}(Cn)),Cn.exports}var An={exports:{}},Xr;function w4(){return Xr||(Xr=1,function(o,n){(function(s,t,r){o.exports=t(be(),Me())})(ge,function(s){return s.pad.NoPadding={pad:function(){},unpad:function(){}},s.pad.NoPadding})}(An)),An.exports}var En={exports:{}},Jr;function R4(){return Jr||(Jr=1,function(o,n){(function(s,t,r){o.exports=t(be(),Me())})(ge,function(s){return function(t){var r=s,p=r.lib,i=p.CipherParams,h=r.enc,C=h.Hex,u=r.format;u.Hex={stringify:function(v){return v.ciphertext.toString(C)},parse:function(v){var E=C.parse(v);return i.create({ciphertext:E})}}}(),s.format.Hex})}(En)),En.exports}var _n={exports:{}},Qr;function D4(){return Qr||(Qr=1,function(o,n){(function(s,t,r){o.exports=t(be(),ut(),dt(),rt(),Me())})(ge,function(s){return function(){var t=s,r=t.lib,p=r.BlockCipher,i=t.algo,h=[],C=[],u=[],v=[],E=[],y=[],w=[],f=[],_=[],R=[];(function(){for(var g=[],S=0;S<256;S++)S<128?g[S]=S<<1:g[S]=S<<1^283;for(var m=0,l=0,S=0;S<256;S++){var c=l^l<<1^l<<2^l<<3^l<<4;c=c>>>8^c&255^99,h[m]=c,C[c]=m;var a=g[m],x=g[a],d=g[x],A=g[c]*257^c*16843008;u[m]=A<<24|A>>>8,v[m]=A<<16|A>>>16,E[m]=A<<8|A>>>24,y[m]=A;var A=d*16843009^x*65537^a*257^m*16843008;w[c]=A<<24|A>>>8,f[c]=A<<16|A>>>16,_[c]=A<<8|A>>>24,R[c]=A,m?(m=a^g[g[g[d^a]]],l^=g[g[l]]):m=l=1}})();var D=[0,1,2,4,8,16,32,64,128,27,54],b=i.AES=p.extend({_doReset:function(){var g;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var S=this._keyPriorReset=this._key,m=S.words,l=S.sigBytes/4,c=this._nRounds=l+6,a=(c+1)*4,x=this._keySchedule=[],d=0;d<a;d++)d<l?x[d]=m[d]:(g=x[d-1],d%l?l>6&&d%l==4&&(g=h[g>>>24]<<24|h[g>>>16&255]<<16|h[g>>>8&255]<<8|h[g&255]):(g=g<<8|g>>>24,g=h[g>>>24]<<24|h[g>>>16&255]<<16|h[g>>>8&255]<<8|h[g&255],g^=D[d/l|0]<<24),x[d]=x[d-l]^g);for(var A=this._invKeySchedule=[],B=0;B<a;B++){var d=a-B;if(B%4)var g=x[d];else var g=x[d-4];B<4||d<=4?A[B]=g:A[B]=w[h[g>>>24]]^f[h[g>>>16&255]]^_[h[g>>>8&255]]^R[h[g&255]]}}},encryptBlock:function(g,S){this._doCryptBlock(g,S,this._keySchedule,u,v,E,y,h)},decryptBlock:function(g,S){var m=g[S+1];g[S+1]=g[S+3],g[S+3]=m,this._doCryptBlock(g,S,this._invKeySchedule,w,f,_,R,C);var m=g[S+1];g[S+1]=g[S+3],g[S+3]=m},_doCryptBlock:function(g,S,m,l,c,a,x,d){for(var A=this._nRounds,B=g[S]^m[0],O=g[S+1]^m[1],k=g[S+2]^m[2],F=g[S+3]^m[3],M=4,P=1;P<A;P++){var U=l[B>>>24]^c[O>>>16&255]^a[k>>>8&255]^x[F&255]^m[M++],N=l[O>>>24]^c[k>>>16&255]^a[F>>>8&255]^x[B&255]^m[M++],H=l[k>>>24]^c[F>>>16&255]^a[B>>>8&255]^x[O&255]^m[M++],G=l[F>>>24]^c[B>>>16&255]^a[O>>>8&255]^x[k&255]^m[M++];B=U,O=N,k=H,F=G}var U=(d[B>>>24]<<24|d[O>>>16&255]<<16|d[k>>>8&255]<<8|d[F&255])^m[M++],N=(d[O>>>24]<<24|d[k>>>16&255]<<16|d[F>>>8&255]<<8|d[B&255])^m[M++],H=(d[k>>>24]<<24|d[F>>>16&255]<<16|d[B>>>8&255]<<8|d[O&255])^m[M++],G=(d[F>>>24]<<24|d[B>>>16&255]<<16|d[O>>>8&255]<<8|d[k&255])^m[M++];g[S]=U,g[S+1]=N,g[S+2]=H,g[S+3]=G},keySize:256/32});t.AES=p._createHelper(b)}(),s.AES})}(_n)),_n.exports}var Sn={exports:{}},Yr;function O4(){return Yr||(Yr=1,function(o,n){(function(s,t,r){o.exports=t(be(),ut(),dt(),rt(),Me())})(ge,function(s){return function(){var t=s,r=t.lib,p=r.WordArray,i=r.BlockCipher,h=t.algo,C=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],u=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],v=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],E=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],y=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],w=h.DES=i.extend({_doReset:function(){for(var D=this._key,b=D.words,g=[],S=0;S<56;S++){var m=C[S]-1;g[S]=b[m>>>5]>>>31-m%32&1}for(var l=this._subKeys=[],c=0;c<16;c++){for(var a=l[c]=[],x=v[c],S=0;S<24;S++)a[S/6|0]|=g[(u[S]-1+x)%28]<<31-S%6,a[4+(S/6|0)]|=g[28+(u[S+24]-1+x)%28]<<31-S%6;a[0]=a[0]<<1|a[0]>>>31;for(var S=1;S<7;S++)a[S]=a[S]>>>(S-1)*4+3;a[7]=a[7]<<5|a[7]>>>27}for(var d=this._invSubKeys=[],S=0;S<16;S++)d[S]=l[15-S]},encryptBlock:function(D,b){this._doCryptBlock(D,b,this._subKeys)},decryptBlock:function(D,b){this._doCryptBlock(D,b,this._invSubKeys)},_doCryptBlock:function(D,b,g){this._lBlock=D[b],this._rBlock=D[b+1],f.call(this,4,252645135),f.call(this,16,65535),_.call(this,2,858993459),_.call(this,8,16711935),f.call(this,1,1431655765);for(var S=0;S<16;S++){for(var m=g[S],l=this._lBlock,c=this._rBlock,a=0,x=0;x<8;x++)a|=E[x][((c^m[x])&y[x])>>>0];this._lBlock=c,this._rBlock=l^a}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,f.call(this,1,1431655765),_.call(this,8,16711935),_.call(this,2,858993459),f.call(this,16,65535),f.call(this,4,252645135),D[b]=this._lBlock,D[b+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function f(D,b){var g=(this._lBlock>>>D^this._rBlock)&b;this._rBlock^=g,this._lBlock^=g<<D}function _(D,b){var g=(this._rBlock>>>D^this._lBlock)&b;this._lBlock^=g,this._rBlock^=g<<D}t.DES=i._createHelper(w);var R=h.TripleDES=i.extend({_doReset:function(){var D=this._key,b=D.words;if(b.length!==2&&b.length!==4&&b.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var g=b.slice(0,2),S=b.length<4?b.slice(0,2):b.slice(2,4),m=b.length<6?b.slice(0,2):b.slice(4,6);this._des1=w.createEncryptor(p.create(g)),this._des2=w.createEncryptor(p.create(S)),this._des3=w.createEncryptor(p.create(m))},encryptBlock:function(D,b){this._des1.encryptBlock(D,b),this._des2.decryptBlock(D,b),this._des3.encryptBlock(D,b)},decryptBlock:function(D,b){this._des3.decryptBlock(D,b),this._des2.encryptBlock(D,b),this._des1.decryptBlock(D,b)},keySize:192/32,ivSize:64/32,blockSize:64/32});t.TripleDES=i._createHelper(R)}(),s.TripleDES})}(Sn)),Sn.exports}var wn={exports:{}},Zr;function B4(){return Zr||(Zr=1,function(o,n){(function(s,t,r){o.exports=t(be(),ut(),dt(),rt(),Me())})(ge,function(s){return function(){var t=s,r=t.lib,p=r.StreamCipher,i=t.algo,h=i.RC4=p.extend({_doReset:function(){for(var v=this._key,E=v.words,y=v.sigBytes,w=this._S=[],f=0;f<256;f++)w[f]=f;for(var f=0,_=0;f<256;f++){var R=f%y,D=E[R>>>2]>>>24-R%4*8&255;_=(_+w[f]+D)%256;var b=w[f];w[f]=w[_],w[_]=b}this._i=this._j=0},_doProcessBlock:function(v,E){v[E]^=C.call(this)},keySize:256/32,ivSize:0});function C(){for(var v=this._S,E=this._i,y=this._j,w=0,f=0;f<4;f++){E=(E+1)%256,y=(y+v[E])%256;var _=v[E];v[E]=v[y],v[y]=_,w|=v[(v[E]+v[y])%256]<<24-f*8}return this._i=E,this._j=y,w}t.RC4=p._createHelper(h);var u=i.RC4Drop=h.extend({cfg:h.cfg.extend({drop:192}),_doReset:function(){h._doReset.call(this);for(var v=this.cfg.drop;v>0;v--)C.call(this)}});t.RC4Drop=p._createHelper(u)}(),s.RC4})}(wn)),wn.exports}var Rn={exports:{}},es;function T4(){return es||(es=1,function(o,n){(function(s,t,r){o.exports=t(be(),ut(),dt(),rt(),Me())})(ge,function(s){return function(){var t=s,r=t.lib,p=r.StreamCipher,i=t.algo,h=[],C=[],u=[],v=i.Rabbit=p.extend({_doReset:function(){for(var y=this._key.words,w=this.cfg.iv,f=0;f<4;f++)y[f]=(y[f]<<8|y[f]>>>24)&16711935|(y[f]<<24|y[f]>>>8)&4278255360;var _=this._X=[y[0],y[3]<<16|y[2]>>>16,y[1],y[0]<<16|y[3]>>>16,y[2],y[1]<<16|y[0]>>>16,y[3],y[2]<<16|y[1]>>>16],R=this._C=[y[2]<<16|y[2]>>>16,y[0]&4294901760|y[1]&65535,y[3]<<16|y[3]>>>16,y[1]&4294901760|y[2]&65535,y[0]<<16|y[0]>>>16,y[2]&4294901760|y[3]&65535,y[1]<<16|y[1]>>>16,y[3]&4294901760|y[0]&65535];this._b=0;for(var f=0;f<4;f++)E.call(this);for(var f=0;f<8;f++)R[f]^=_[f+4&7];if(w){var D=w.words,b=D[0],g=D[1],S=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,m=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,l=S>>>16|m&4294901760,c=m<<16|S&65535;R[0]^=S,R[1]^=l,R[2]^=m,R[3]^=c,R[4]^=S,R[5]^=l,R[6]^=m,R[7]^=c;for(var f=0;f<4;f++)E.call(this)}},_doProcessBlock:function(y,w){var f=this._X;E.call(this),h[0]=f[0]^f[5]>>>16^f[3]<<16,h[1]=f[2]^f[7]>>>16^f[5]<<16,h[2]=f[4]^f[1]>>>16^f[7]<<16,h[3]=f[6]^f[3]>>>16^f[1]<<16;for(var _=0;_<4;_++)h[_]=(h[_]<<8|h[_]>>>24)&16711935|(h[_]<<24|h[_]>>>8)&4278255360,y[w+_]^=h[_]},blockSize:128/32,ivSize:64/32});function E(){for(var y=this._X,w=this._C,f=0;f<8;f++)C[f]=w[f];w[0]=w[0]+1295307597+this._b|0,w[1]=w[1]+3545052371+(w[0]>>>0<C[0]>>>0?1:0)|0,w[2]=w[2]+886263092+(w[1]>>>0<C[1]>>>0?1:0)|0,w[3]=w[3]+1295307597+(w[2]>>>0<C[2]>>>0?1:0)|0,w[4]=w[4]+3545052371+(w[3]>>>0<C[3]>>>0?1:0)|0,w[5]=w[5]+886263092+(w[4]>>>0<C[4]>>>0?1:0)|0,w[6]=w[6]+1295307597+(w[5]>>>0<C[5]>>>0?1:0)|0,w[7]=w[7]+3545052371+(w[6]>>>0<C[6]>>>0?1:0)|0,this._b=w[7]>>>0<C[7]>>>0?1:0;for(var f=0;f<8;f++){var _=y[f]+w[f],R=_&65535,D=_>>>16,b=((R*R>>>17)+R*D>>>15)+D*D,g=((_&4294901760)*_|0)+((_&65535)*_|0);u[f]=b^g}y[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,y[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,y[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,y[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,y[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,y[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,y[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,y[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}t.Rabbit=p._createHelper(v)}(),s.Rabbit})}(Rn)),Rn.exports}var Dn={exports:{}},ts;function k4(){return ts||(ts=1,function(o,n){(function(s,t,r){o.exports=t(be(),ut(),dt(),rt(),Me())})(ge,function(s){return function(){var t=s,r=t.lib,p=r.StreamCipher,i=t.algo,h=[],C=[],u=[],v=i.RabbitLegacy=p.extend({_doReset:function(){var y=this._key.words,w=this.cfg.iv,f=this._X=[y[0],y[3]<<16|y[2]>>>16,y[1],y[0]<<16|y[3]>>>16,y[2],y[1]<<16|y[0]>>>16,y[3],y[2]<<16|y[1]>>>16],_=this._C=[y[2]<<16|y[2]>>>16,y[0]&4294901760|y[1]&65535,y[3]<<16|y[3]>>>16,y[1]&4294901760|y[2]&65535,y[0]<<16|y[0]>>>16,y[2]&4294901760|y[3]&65535,y[1]<<16|y[1]>>>16,y[3]&4294901760|y[0]&65535];this._b=0;for(var R=0;R<4;R++)E.call(this);for(var R=0;R<8;R++)_[R]^=f[R+4&7];if(w){var D=w.words,b=D[0],g=D[1],S=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,m=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,l=S>>>16|m&4294901760,c=m<<16|S&65535;_[0]^=S,_[1]^=l,_[2]^=m,_[3]^=c,_[4]^=S,_[5]^=l,_[6]^=m,_[7]^=c;for(var R=0;R<4;R++)E.call(this)}},_doProcessBlock:function(y,w){var f=this._X;E.call(this),h[0]=f[0]^f[5]>>>16^f[3]<<16,h[1]=f[2]^f[7]>>>16^f[5]<<16,h[2]=f[4]^f[1]>>>16^f[7]<<16,h[3]=f[6]^f[3]>>>16^f[1]<<16;for(var _=0;_<4;_++)h[_]=(h[_]<<8|h[_]>>>24)&16711935|(h[_]<<24|h[_]>>>8)&4278255360,y[w+_]^=h[_]},blockSize:128/32,ivSize:64/32});function E(){for(var y=this._X,w=this._C,f=0;f<8;f++)C[f]=w[f];w[0]=w[0]+1295307597+this._b|0,w[1]=w[1]+3545052371+(w[0]>>>0<C[0]>>>0?1:0)|0,w[2]=w[2]+886263092+(w[1]>>>0<C[1]>>>0?1:0)|0,w[3]=w[3]+1295307597+(w[2]>>>0<C[2]>>>0?1:0)|0,w[4]=w[4]+3545052371+(w[3]>>>0<C[3]>>>0?1:0)|0,w[5]=w[5]+886263092+(w[4]>>>0<C[4]>>>0?1:0)|0,w[6]=w[6]+1295307597+(w[5]>>>0<C[5]>>>0?1:0)|0,w[7]=w[7]+3545052371+(w[6]>>>0<C[6]>>>0?1:0)|0,this._b=w[7]>>>0<C[7]>>>0?1:0;for(var f=0;f<8;f++){var _=y[f]+w[f],R=_&65535,D=_>>>16,b=((R*R>>>17)+R*D>>>15)+D*D,g=((_&4294901760)*_|0)+((_&65535)*_|0);u[f]=b^g}y[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,y[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,y[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,y[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,y[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,y[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,y[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,y[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}t.RabbitLegacy=p._createHelper(v)}(),s.RabbitLegacy})}(Dn)),Dn.exports}var On={exports:{}},ns;function $4(){return ns||(ns=1,function(o,n){(function(s,t,r){o.exports=t(be(),ut(),dt(),rt(),Me())})(ge,function(s){return function(){var t=s,r=t.lib,p=r.BlockCipher,i=t.algo;const h=16,C=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],u=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var v={pbox:[],sbox:[]};function E(R,D){let b=D>>24&255,g=D>>16&255,S=D>>8&255,m=D&255,l=R.sbox[0][b]+R.sbox[1][g];return l=l^R.sbox[2][S],l=l+R.sbox[3][m],l}function y(R,D,b){let g=D,S=b,m;for(let l=0;l<h;++l)g=g^R.pbox[l],S=E(R,g)^S,m=g,g=S,S=m;return m=g,g=S,S=m,S=S^R.pbox[h],g=g^R.pbox[h+1],{left:g,right:S}}function w(R,D,b){let g=D,S=b,m;for(let l=h+1;l>1;--l)g=g^R.pbox[l],S=E(R,g)^S,m=g,g=S,S=m;return m=g,g=S,S=m,S=S^R.pbox[1],g=g^R.pbox[0],{left:g,right:S}}function f(R,D,b){for(let c=0;c<4;c++){R.sbox[c]=[];for(let a=0;a<256;a++)R.sbox[c][a]=u[c][a]}let g=0;for(let c=0;c<h+2;c++)R.pbox[c]=C[c]^D[g],g++,g>=b&&(g=0);let S=0,m=0,l=0;for(let c=0;c<h+2;c+=2)l=y(R,S,m),S=l.left,m=l.right,R.pbox[c]=S,R.pbox[c+1]=m;for(let c=0;c<4;c++)for(let a=0;a<256;a+=2)l=y(R,S,m),S=l.left,m=l.right,R.sbox[c][a]=S,R.sbox[c][a+1]=m;return!0}var _=i.Blowfish=p.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var R=this._keyPriorReset=this._key,D=R.words,b=R.sigBytes/4;f(v,D,b)}},encryptBlock:function(R,D){var b=y(v,R[D],R[D+1]);R[D]=b.left,R[D+1]=b.right},decryptBlock:function(R,D){var b=w(v,R[D],R[D+1]);R[D]=b.left,R[D+1]=b.right},blockSize:64/32,keySize:128/32,ivSize:64/32});t.Blowfish=p._createHelper(_)}(),s.Blowfish})}(On)),On.exports}(function(o,n){(function(s,t,r){o.exports=t(be(),Lt(),c4(),u4(),ut(),d4(),dt(),ro(),Wn(),f4(),so(),p4(),h4(),v4(),zn(),m4(),rt(),Me(),g4(),y4(),x4(),b4(),C4(),A4(),E4(),_4(),S4(),w4(),R4(),D4(),O4(),B4(),T4(),k4(),$4())})(ge,function(s){return s})})(no);var F4=no.exports;const P4={md5(o){return F4.MD5(o).toString()}},M4={class:"top-bar","data-component":"topbar"},I4={class:"search-bar"},N4=["placeholder"],U4={class:"top-bar-actions"},L4={class:"current-lang"},H4={class:"menu-header"},j4={class:"menu-items"},V4={class:"label"},G4={key:0,class:"fas fa-check"},W4={class:"label"},z4={key:0,class:"fas fa-check"},q4=["aria-label"],K4={key:0,class:"badge"},X4={class:"notifications-header"},J4={id:"notification-title"},Q4=["aria-label"],Y4={class:"notifications-list"},Z4={key:0,class:"empty-notifications"},eC={class:"notification-icon"},tC={class:"notification-content"},nC={class:"notification-title"},rC={class:"notification-message"},sC={class:"notification-time"},oC=["onClick"],iC=["src"],aC={class:"username"},lC={class:"menu-header"},cC={class:"user-info"},uC=["src"],dC={class:"user-details"},fC={class:"username"},pC={class:"email"},hC={class:"menu-items"},vC=ke({__name:"AppHeader",setup(o){const{t:n,locale:s}=Le(),t=kt(),r=ct(),p=ye(),i=jn(),h=Nb(),C=Q(""),u=Q(!1),v=Q(!1),E=Q(!1),y=Q(null),w=Q(null),f=Q(null),_=ue(()=>h.currentLanguage),R=ue(()=>i.isDarkMode),D=ue(()=>p.unreadCount),b=ue(()=>p.notifications),g=ue(()=>{var P;return((P=r.user)==null?void 0:P.username)||""}),S=ue(()=>{var P;return((P=r.user)==null?void 0:P.email)||""}),m=ue(()=>{var U;return`https://www.gravatar.com/avatar/${(U=r.user)!=null&&U.email?P4.md5(r.user.email.toLowerCase().trim()):""}?s=40&d=identicon`}),l=()=>{},c=()=>{u.value=!u.value,v.value=!1,E.value=!1},a=async P=>{await r.updateLanguage(P),h.setLanguage(P),s.value=P,u.value=!1},x=()=>{i.toggleDarkMode()},d=()=>{v.value=!v.value,u.value=!1,E.value=!1},A=P=>{p.markAsRead(P)},B=()=>{p.markAllAsRead()},O=()=>{E.value=!E.value,u.value=!1,v.value=!1},k=async()=>{await r.logout(),t.push("/login")},F=P=>{const U=typeof P=="string"?new Date(P):P;return D2(U,{addSuffix:!0,locale:s.value==="fr"?s4:to})},M=P=>{y.value&&!y.value.contains(P.target)&&(u.value=!1),w.value&&!w.value.contains(P.target)&&(v.value=!1),f.value&&!f.value.contains(P.target)&&(E.value=!1)};return Fe(()=>{document.addEventListener("click",M)}),ss(()=>{document.removeEventListener("click",M)}),(P,U)=>{const N=xt("router-link");return q(),K("div",M4,[e("div",I4,[U[3]||(U[3]=e("i",{class:"fas fa-search"},null,-1)),Z(e("input",{type:"text",placeholder:P.$t("common.search"),"onUpdate:modelValue":U[0]||(U[0]=H=>C.value=H),onInput:l},null,40,N4),[[le,C.value]])]),e("div",U4,[e("div",{class:"dropdown",ref_key:"languageDropdown",ref:y},[e("button",{class:"btn-icon dropdown-toggle",onClick:c},[U[4]||(U[4]=e("i",{class:"fas fa-globe"},null,-1)),e("span",L4,T(_.value.toUpperCase()),1),U[5]||(U[5]=e("i",{class:"fas fa-chevron-down"},null,-1))]),e("div",{class:ce(["dropdown-menu",{show:u.value}])},[e("div",H4,[e("h3",null,T(P.$t("common.language.select")),1)]),e("div",j4,[e("a",{href:"#",class:ce(["menu-item",{active:_.value==="fr"}]),onClick:U[1]||(U[1]=Re(H=>a("fr"),["prevent"]))},[U[6]||(U[6]=e("span",{class:"flag"},"🇫🇷",-1)),e("span",V4,T(P.$t("common.language.fr")),1),_.value==="fr"?(q(),K("i",G4)):ae("",!0)],2),e("a",{href:"#",class:ce(["menu-item",{active:_.value==="en"}]),onClick:U[2]||(U[2]=Re(H=>a("en"),["prevent"]))},[U[7]||(U[7]=e("span",{class:"flag"},"🇬🇧",-1)),e("span",W4,T(P.$t("common.language.en")),1),_.value==="en"?(q(),K("i",z4)):ae("",!0)],2)])],2)],512),e("button",{class:"btn-icon",onClick:x},[e("i",{class:ce(R.value?"fas fa-sun":"fas fa-moon")},null,2)]),e("div",{class:"notifications-container",ref_key:"notificationsDropdown",ref:w},[e("button",{type:"button",class:"btn-icon notification-btn","aria-label":P.$t("topbar.notifications.toggle"),onClick:d},[U[8]||(U[8]=e("i",{class:"fas fa-bell"},null,-1)),D.value>0?(q(),K("span",K4,T(D.value),1)):ae("",!0)],8,q4),e("div",{class:ce(["notification-panel",{show:v.value}]),role:"dialog","aria-labelledby":"notification-title"},[e("div",X4,[e("h3",J4,T(P.$t("topbar.notifications.title")),1),e("button",{type:"button",class:"mark-all-read",onClick:B,"aria-label":P.$t("topbar.notifications.mark_all_read")},[U[9]||(U[9]=e("i",{class:"fas fa-check-double"},null,-1)),e("span",null,T(P.$t("topbar.notifications.mark_all_read")),1)],8,Q4)]),e("div",Y4,[b.value.length===0?(q(),K("div",Z4,[U[10]||(U[10]=e("i",{class:"fas fa-bell-slash"},null,-1)),e("p",null,T(P.$t("topbar.notifications.empty")),1)])):(q(!0),K(_e,{key:1},Se(b.value,H=>(q(),K("div",{key:H.id,class:ce(["notification-item",{unread:!H.read}])},[e("div",eC,[e("i",{class:ce(H.icon)},null,2)]),e("div",tC,[e("div",nC,T(H.title),1),e("div",rC,T(H.message),1),e("div",sC,T(F(H.time)),1)]),H.read?ae("",!0):(q(),K("button",{key:0,class:"notification-action",onClick:G=>A(H.id)},U[11]||(U[11]=[e("i",{class:"fas fa-check"},null,-1)]),8,oC))],2))),128))])],2)],512),e("div",{class:"profile-container",ref_key:"profileDropdown",ref:f},[e("button",{class:"profile-btn",onClick:O},[e("img",{src:m.value,alt:"Avatar",class:"avatar"},null,8,iC),e("span",aC,T(g.value),1),U[12]||(U[12]=e("i",{class:"fas fa-chevron-down"},null,-1))]),e("div",{class:ce(["profile-menu",{show:E.value}])},[e("div",lC,[e("div",cC,[e("img",{src:m.value,alt:"Avatar",class:"avatar"},null,8,uC),e("div",dC,[e("div",fC,T(g.value),1),e("div",pC,T(S.value),1)])])]),e("div",hC,[Ce(N,{to:"/profile",class:"menu-item"},{default:Ae(()=>[U[13]||(U[13]=e("i",{class:"fas fa-user"},null,-1)),e("span",null,T(P.$t("topbar.profile.my_profile")),1)]),_:1}),Ce(N,{to:"/settings",class:"menu-item"},{default:Ae(()=>[U[14]||(U[14]=e("i",{class:"fas fa-cog"},null,-1)),e("span",null,T(P.$t("topbar.profile.settings")),1)]),_:1}),U[16]||(U[16]=e("div",{class:"menu-divider"},null,-1)),e("a",{href:"#",class:"menu-item text-red-600",onClick:Re(k,["prevent"])},[U[15]||(U[15]=e("i",{class:"fas fa-sign-out-alt"},null,-1)),e("span",null,T(P.$t("topbar.profile.logout")),1)])])],2)],512)])])}}}),mC=Pe(vC,[["__scopeId","data-v-a0c824dd"]]),gC="/admin/dist/assets/logo-Bg22NIcH.png",yC={class:"sidebar","data-component":"sidebar"},xC={class:"sidebar-header"},bC={class:"sidebar-nav"},CC={key:0,class:"badge"},AC=ke({__name:"AppSidebar",setup(o){const n=os(),{t:s}=Le(),t=ye(),r=Q([]),p=ue(()=>t.unreadCount),i=C=>{console.log("Tentative d'ouverture du sous-menu:",C),r.value.indexOf(C)===-1?(r.value=[C],console.log(`Sous-menu ${C} ouvert`)):(r.value=[],console.log(`Sous-menu ${C} fermé`)),console.log("État des sous-menus après toggle:",r.value)};Fe(()=>{var v;console.log("Route actuelle:",n.name);const C=((v=n.name)==null?void 0:v.toString())||"";let u="";C==="services"||C==="products"?u="catalogue":C==="invoices"||C==="payments"||C==="subscriptions"?u="billing":(C==="tickets"||C==="kb")&&(u="support"),console.log("Menu à ouvrir:",u),u&&!r.value.includes(u)&&r.value.push(u)});const h=()=>{document.body.classList.toggle("sidebar-collapsed")};return(C,u)=>{const v=xt("router-link");return q(),K("aside",yC,[e("div",xC,[Ce(v,{to:"/dashboard",class:"logo"},{default:Ae(()=>u[3]||(u[3]=[e("img",{src:gC,alt:"TechCMS"},null,-1)])),_:1}),e("button",{class:"sidebar-toggle",onClick:h},u[4]||(u[4]=[e("i",{class:"fas fa-bars"},null,-1)]))]),e("nav",bC,[e("ul",null,[e("li",{class:ce({active:W(n).name==="dashboard"})},[Ce(v,{to:"/dashboard"},{default:Ae(()=>[u[5]||(u[5]=e("i",{class:"fas fa-home"},null,-1)),e("span",null,T(C.$t("sidebar.menu.dashboard")),1)]),_:1})],2),e("li",{class:ce({active:W(n).name==="clients"})},[Ce(v,{to:"/clients"},{default:Ae(()=>[u[6]||(u[6]=e("i",{class:"fas fa-users"},null,-1)),e("span",null,T(C.$t("sidebar.menu.clients")),1)]),_:1})],2),e("li",{class:ce(["has-submenu",{"submenu-open":r.value.includes("catalogue")}])},[e("a",{href:"#",class:ce(["menu-toggle",{active:W(n).name==="services"||W(n).name==="products"}]),onClick:u[0]||(u[0]=Re(E=>i("catalogue"),["prevent"]))},[u[7]||(u[7]=e("i",{class:"fas fa-cube"},null,-1)),e("span",null,T(C.$t("sidebar.menu.catalog.title")),1),u[8]||(u[8]=e("i",{class:"fas fa-chevron-right menu-arrow"},null,-1))],2),e("ul",{class:ce(["submenu",{show:r.value.includes("catalogue")}])},[e("li",{class:ce({active:W(n).name==="services"})},[Ce(v,{to:"/services"},{default:Ae(()=>[u[9]||(u[9]=e("i",{class:"fas fa-cogs"},null,-1)),e("span",null,T(C.$t("sidebar.menu.catalog.services")),1)]),_:1})],2),e("li",{class:ce({active:W(n).name==="products"})},[Ce(v,{to:"/products"},{default:Ae(()=>[u[10]||(u[10]=e("i",{class:"fas fa-box"},null,-1)),e("span",null,T(C.$t("sidebar.menu.catalog.products")),1)]),_:1})],2)],2)],2),e("li",{class:ce(["has-submenu",{"submenu-open":r.value.includes("billing")}])},[e("a",{href:"#",class:ce(["menu-toggle",{active:W(n).name==="invoices"||W(n).name==="payments"||W(n).name==="subscriptions"}]),onClick:u[1]||(u[1]=Re(E=>i("billing"),["prevent"]))},[u[11]||(u[11]=e("i",{class:"fas fa-file-invoice-dollar"},null,-1)),e("span",null,T(C.$t("sidebar.menu.billing.title")),1),u[12]||(u[12]=e("i",{class:"fas fa-chevron-right menu-arrow"},null,-1))],2),e("ul",{class:ce(["submenu",{show:r.value.includes("billing")}])},[e("li",{class:ce({active:W(n).name==="invoices"})},[Ce(v,{to:"/invoices"},{default:Ae(()=>[u[13]||(u[13]=e("i",{class:"fas fa-file-invoice"},null,-1)),e("span",null,T(C.$t("sidebar.menu.billing.invoices")),1)]),_:1})],2),e("li",{class:ce({active:W(n).name==="payments"})},[Ce(v,{to:"/payments"},{default:Ae(()=>[u[14]||(u[14]=e("i",{class:"fas fa-credit-card"},null,-1)),e("span",null,T(C.$t("sidebar.menu.billing.payments")),1)]),_:1})],2),e("li",{class:ce({active:W(n).name==="subscriptions"})},[Ce(v,{to:"/subscriptions"},{default:Ae(()=>[u[15]||(u[15]=e("i",{class:"fas fa-sync"},null,-1)),e("span",null,T(C.$t("sidebar.menu.billing.subscriptions")),1)]),_:1})],2)],2)],2),e("li",{class:ce(["has-submenu",{"submenu-open":r.value.includes("support")}])},[e("a",{href:"#",class:ce(["menu-toggle",{active:W(n).name==="tickets"||W(n).name==="kb"}]),onClick:u[2]||(u[2]=Re(E=>i("support"),["prevent"]))},[u[16]||(u[16]=e("i",{class:"fas fa-headset"},null,-1)),e("span",null,T(C.$t("sidebar.menu.support.title")),1),p.value>0?(q(),K("span",CC,T(p.value),1)):ae("",!0),u[17]||(u[17]=e("i",{class:"fas fa-chevron-right menu-arrow"},null,-1))],2),e("ul",{class:ce(["submenu",{show:r.value.includes("support")}])},[e("li",{class:ce({active:W(n).name==="tickets"})},[Ce(v,{to:"/tickets"},{default:Ae(()=>[u[18]||(u[18]=e("i",{class:"fas fa-ticket-alt"},null,-1)),e("span",null,T(C.$t("sidebar.menu.support.tickets")),1)]),_:1})],2),e("li",{class:ce({active:W(n).name==="kb"})},[Ce(v,{to:"/kb"},{default:Ae(()=>[u[19]||(u[19]=e("i",{class:"fas fa-book"},null,-1)),e("span",null,T(C.$t("sidebar.menu.support.kb")),1)]),_:1})],2)],2)],2),e("li",{class:ce({active:W(n).name==="settings"})},[Ce(v,{to:"/settings"},{default:Ae(()=>[u[20]||(u[20]=e("i",{class:"fas fa-cog"},null,-1)),e("span",null,T(C.$t("sidebar.menu.settings")),1)]),_:1})],2)])])])}}}),EC=Pe(AC,[["__scopeId","data-v-a7ffe686"]]),_C={class:"app-container"},SC={class:"app-content"},wC={key:1},RC=ke({__name:"AppLayout",setup(o){const n=os(),s=jn(),t=ue(()=>n.meta.public),r=ue(()=>s.darkMode);return(p,i)=>t.value?(q(),K("div",wC,[Dt(p.$slots,"default",{},void 0)])):(q(),K("div",{key:0,class:ce(["app-layout",{dark:r.value}])},[Ce(mC),e("div",_C,[Ce(EC),e("main",SC,[Dt(p.$slots,"default",{},void 0)])])],2))}}),DC=Pe(RC,[["__scopeId","data-v-f49d8a57"]]),OC={class:"fixed top-4 right-4 z-50 space-y-4"},BC={class:"flex items-start"},TC={class:"flex-shrink-0"},kC={class:"ml-3 w-0 flex-1"},$C={class:"font-medium"},FC={class:"mt-1 text-sm"},PC={class:"ml-4 flex-shrink-0"},MC=["onClick"],IC=ke({__name:"NotificationsContainer",setup(o,{expose:n}){const s=Q([]),t=h=>({"bg-green-50 text-green-800":h==="success","bg-red-50 text-red-800":h==="error","bg-yellow-50 text-yellow-800":h==="warning","bg-blue-50 text-blue-800":h==="info"}),r=h=>({"fas fa-check-circle text-green-400":h==="success","fas fa-times-circle text-red-400":h==="error","fas fa-exclamation-circle text-yellow-400":h==="warning","fas fa-info-circle text-blue-400":h==="info"}),p=h=>{const C=Date.now();s.value.push({...h,id:C}),setTimeout(()=>i(C),5e3)},i=h=>{s.value=s.value.filter(C=>C.id!==h)};return n({addNotification:p}),(h,C)=>(q(),K("div",OC,[Ce(Eo,{name:"notification"},{default:Ae(()=>[(q(!0),K(_e,null,Se(s.value,u=>(q(),K("div",{key:u.id,class:ce(["notification p-4 rounded-lg shadow-lg max-w-sm",t(u.type)])},[e("div",BC,[e("div",TC,[e("i",{class:ce([r(u.type),"text-xl"])},null,2)]),e("div",kC,[e("p",$C,T(u.title),1),e("p",FC,T(u.message),1)]),e("div",PC,[e("button",{onClick:v=>i(u.id),class:"inline-flex text-gray-400 hover:text-gray-500"},C[0]||(C[0]=[e("i",{class:"fas fa-times"},null,-1)]),8,MC)])])],2))),128))]),_:1})]))}}),NC=Pe(IC,[["__scopeId","data-v-a6ea4072"]]),UC=ke({__name:"App",setup(o){const n=ct(),s=jn(),t=ue(()=>s.darkMode);return Fe(async()=>{console.log("TechCMS Admin - Initialisation..."),await n.init()}),(r,p)=>{const i=xt("router-view");return q(),K("div",{id:"app",class:ce(["tech-cms-app",{dark:t.value}])},[Ce(DC,null,{default:Ae(()=>[Ce(i,null,{default:Ae(({Component:h})=>[Ce(rs,{name:"fade",mode:"out-in"},{default:Ae(()=>[(q(),at(_o(h)))]),_:2},1024)]),_:1})]),_:1}),Ce(NC)],2)}}}),LC={back:"Retour",save:"Enregistrer",cancel:"Annuler",delete:"Supprimer",edit:"Modifier",loading:"Chargement...",actions:"Actions",select:"Sélectionner...",close:"Fermer"},HC={welcome:"Bienvenue sur TechCMS",subtitle:"Connectez-vous pour accéder à votre espace d'administration",email:"Email",emailPlaceholder:"Votre adresse email",password:"Mot de passe",passwordPlaceholder:"Votre mot de passe",rememberMe:"Se souvenir de moi",forgotPassword:"Mot de passe oublié ?",signIn:"Se connecter",resetPassword:"Réinitialiser le mot de passe",resetInstructions:"Entrez votre adresse email pour recevoir les instructions de réinitialisation",sendReset:"Envoyer les instructions",resetSent:"Les instructions de réinitialisation ont été envoyées à votre adresse email",errorFields:"Veuillez remplir tous les champs",errorEmail:"Veuillez entrer une adresse email valide",errorGeneral:"Email ou mot de passe incorrect",errorForgot:"Une erreur est survenue lors de l'envoi des instructions",copyright:" {year} TechCMS. Tous droits réservés."},jC={title:"Services",add:"Ajouter un service",edit:"Modifier le service",search:"Rechercher un service...",columns:{name:"Nom",description:"Description",price:"Prix",status:"Statut",clients:"Clients"},status:{all:"Tous",active:"Actif",inactive:"Inactif",maintenance:"Maintenance"},fields:{name:"Nom",description:"Description",price:"Prix",status:"Statut",features:"Fonctionnalités",featureName:"Nom de la fonctionnalité",included:"Inclus",addFeature:"Ajouter une fonctionnalité"},validation:{nameRequired:"Le nom est obligatoire",pricePositive:"Le prix doit être positif"},success:{create:"Service créé",createMessage:"Le service {name} a été créé avec succès",update:"Service mis à jour",updateMessage:"Le service {name} a été mis à jour avec succès",delete:"Service supprimé",deleteMessage:"Le service {name} a été supprimé avec succès"},errors:{fetch:"Erreur de chargement",fetchMessage:"Impossible de charger les services",create:"Erreur de création",update:"Erreur de mise à jour",saveMessage:"Une erreur est survenue lors de l'enregistrement du service",delete:"Erreur de suppression",deleteMessage:"Une erreur est survenue lors de la suppression du service"},confirm:{delete:"Êtes-vous sûr de vouloir supprimer le service {name} ?"}},VC={title:"Produits",actions:{add:"Ajouter un produit",add_feature:"Ajouter une fonctionnalité"},modal:{add_title:"Ajouter un produit",edit_title:"Modifier le produit"},columns:{name:"Nom",description:"Description",price:"Prix",status:"Statut"},status:{active:"Actif",inactive:"Inactif"},fields:{name:"Nom",description:"Description",price:"Prix",status:"Statut",features:"Fonctionnalités",feature_name:"Nom de la fonctionnalité",feature_included:"Inclus"},filters:{label:"Filtrer par statut",all:"Tous",active:"Actifs",inactive:"Inactifs"},search:{placeholder:"Rechercher un produit..."},empty:{message:"Aucun produit trouvé",action:"Ajouter un produit"},validation:{name_required:"Le nom est obligatoire",description_required:"La description est obligatoire",price_positive:"Le prix doit être positif"},confirm:{delete:"Êtes-vous sûr de vouloir supprimer ce produit ?"},success:{create:"Produit créé avec succès",update:"Produit mis à jour avec succès",delete:"Produit supprimé avec succès"},errors:{fetch:"Erreur lors du chargement des produits",create:"Erreur lors de la création du produit",update:"Erreur lors de la mise à jour du produit",delete:"Erreur lors de la suppression du produit"}},GC={title:"Factures",actions:{add:"Ajouter une facture",edit:"Modifier la facture",view:"Voir la facture",delete:"Supprimer la facture",mark_paid:"Marquer comme payée"},modal:{add_title:"Ajouter une facture",edit_title:"Modifier la facture",view_title:"Détails de la facture"},columns:{number:"Numéro",client:"Client",service:"Service",amount:"Montant",due_date:"Date d'échéance",paid_date:"Date de paiement",status:"Statut",created_at:"Date de création"},status:{pending:"En attente",paid:"Payée",overdue:"En retard",cancelled:"Annulée",deleted:"Supprimée"},filters:{label:"Filtrer par statut",all:"Toutes",pending:"En attente",paid:"Payées",overdue:"En retard",cancelled:"Annulées"},search:{placeholder:"Rechercher une facture..."},empty:{message:"Aucune facture trouvée",action:"Ajouter une facture"},confirm:{delete:"Êtes-vous sûr de vouloir supprimer cette facture ?",mark_paid:"Êtes-vous sûr de vouloir marquer cette facture comme payée ?"},success:{create:"Facture créée avec succès",update:"Facture mise à jour avec succès",delete:"Facture supprimée avec succès",mark_paid:"Facture marquée comme payée avec succès"},errors:{fetch:"Erreur lors du chargement des factures",create:"Erreur lors de la création de la facture",update:"Erreur lors de la mise à jour de la facture",delete:"Erreur lors de la suppression de la facture",mark_paid:"Erreur lors du marquage de la facture comme payée"}},WC={title:"Abonnements",actions:{add:"Ajouter un abonnement",edit:"Modifier l'abonnement",view:"Voir l'abonnement",cancel:"Annuler l'abonnement",renew:"Renouveler l'abonnement"},table:{id:"ID",client:"Client",service:"Service",startDate:"Date de début",endDate:"Date de fin",renewalDate:"Date de renouvellement",price:"Prix",billingCycle:"Cycle de facturation",status:"Statut",actions:"Actions"},filters:{all:"Tous",active:"Actifs",pending:"En attente",cancelled:"Annulés",expired:"Expirés"},search:{placeholder:"Rechercher un abonnement..."},empty:{title:"Aucun abonnement trouvé",message:"Vous n'avez pas encore d'abonnements. Commencez par en créer un."},statuses:{active:"Actif",pending:"En attente",cancelled:"Annulé",expired:"Expiré"},billingCycles:{monthly:"Mensuel",quarterly:"Trimestriel",semiAnnual:"Semestriel",annual:"Annuel"},form:{client:"Client",service:"Service",startDate:"Date de début",endDate:"Date de fin",price:"Prix",billingCycle:"Cycle de facturation",status:"Statut",autoRenew:"Renouvellement automatique",notes:"Notes",cancelReason:"Raison de l'annulation"},confirm:{cancel:"Êtes-vous sûr de vouloir annuler cet abonnement ?",renew:"Êtes-vous sûr de vouloir renouveler cet abonnement ?"},success:{create:"Abonnement créé avec succès",update:"Abonnement mis à jour avec succès",cancel:"Abonnement annulé avec succès",renew:"Abonnement renouvelé avec succès"},errors:{fetch:"Erreur lors du chargement des abonnements",fetchOne:"Erreur lors du chargement de l'abonnement",create:"Erreur lors de la création de l'abonnement",update:"Erreur lors de la mise à jour de l'abonnement",cancel:"Erreur lors de l'annulation de l'abonnement",renew:"Erreur lors du renouvellement de l'abonnement"}},zC={title:"Paiements",actions:{add:"Ajouter un paiement",edit:"Modifier le paiement",view:"Voir le paiement",delete:"Supprimer le paiement",refund:"Rembourser"},modal:{add_title:"Ajouter un paiement",edit_title:"Modifier le paiement",view_title:"Détails du paiement"},columns:{id:"ID",invoice:"Facture",client:"Client",amount:"Montant",date:"Date de paiement",method:"Méthode",transaction_id:"ID de transaction",status:"Statut",notes:"Notes",created_at:"Date de création"},status:{completed:"Complété",pending:"En attente",failed:"Échoué",refunded:"Remboursé"},methods:{card:"Carte bancaire",bank_transfer:"Virement bancaire",paypal:"PayPal",cash:"Espèces",check:"Chèque"},fields:{transaction_id_help:"Numéro de référence de la transaction (facultatif)"},filters:{label:"Filtrer par statut",all:"Tous",completed:"Complétés",pending:"En attente",failed:"Échoués",refunded:"Remboursés"},search:{placeholder:"Rechercher un paiement..."},empty:{message:"Aucun paiement trouvé",action:"Ajouter un paiement"},confirm:{delete:"Êtes-vous sûr de vouloir supprimer ce paiement ?"},refund:{title:"Rembourser le paiement",reason:"Motif du remboursement",reason_placeholder:"Veuillez indiquer le motif du remboursement",confirm:"Confirmer le remboursement",error_title:"Erreur de remboursement",error_reason_required:"Le motif du remboursement est obligatoire"},success:{create:"Paiement créé avec succès",update:"Paiement mis à jour avec succès",delete:"Paiement supprimé avec succès",refund:"Remboursement traité avec succès"},errors:{fetch:"Erreur lors du chargement des paiements",create:"Erreur lors de la création du paiement",update:"Erreur lors de la mise à jour du paiement",delete:"Erreur lors de la suppression du paiement",refund:"Erreur lors du traitement du remboursement"}},qC={title:"Tickets",actions:{add:"Ajouter un ticket",create:"Créer",update:"Mettre à jour",delete:"Supprimer",view:"Voir"},modal:{add_title:"Ajouter un ticket",edit_title:"Modifier le ticket",view_title:"Détails du ticket"},fields:{client:"Client",subject:"Sujet",message:"Message",priority:"Priorité",status:"Statut"},priority:{low:"Basse",medium:"Moyenne",high:"Haute",urgent:"Urgente"},status:{open:"Ouvert",pending:"En attente",closed:"Fermé",resolved:"Résolu"},filters:{all:"Tous",open:"Ouverts",pending:"En attente",closed:"Fermés",resolved:"Résolus"},table:{id:"ID",subject:"Sujet",client:"Client",priority:"Priorité",status:"Statut",lastReply:"Dernière réponse",createdAt:"Créé le",actions:"Actions"},search:{placeholder:"Rechercher un ticket..."},empty:{message:"Aucun ticket trouvé",description:"Créez un nouveau ticket ou modifiez vos filtres"},confirm:{delete:{title:"Supprimer le ticket",message:"Êtes-vous sûr de vouloir supprimer ce ticket ? Cette action est irréversible."}},success:{create:"Le ticket a été créé avec succès",update:"Le ticket a été mis à jour avec succès",delete:"Le ticket a été supprimé avec succès",close:"Le ticket a été fermé avec succès",reopen:"Le ticket a été rouvert avec succès",reply:"Votre réponse a été ajoutée avec succès"},errors:{create:"Une erreur est survenue lors de la création du ticket",update:"Une erreur est survenue lors de la mise à jour du ticket",delete:"Une erreur est survenue lors de la suppression du ticket",fetch:"Une erreur est survenue lors de la récupération des tickets",close:"Une erreur est survenue lors de la fermeture du ticket",reopen:"Une erreur est survenue lors de la réouverture du ticket",reply:"Une erreur est survenue lors de l'ajout de votre réponse"},selectClient:"Sélectionner un client",noMessages:"Aucun message pour ce ticket",addReply:"Ajouter une réponse",replyPlaceholder:"Votre réponse...",sendReply:"Envoyer"},KC={menu:{dashboard:"Tableau de bord",clients:"Clients",catalog:{title:"Catalogue",services:"Services",products:"Produits"},billing:{title:"Facturation",invoices:"Factures",payments:"Paiements",subscriptions:"Abonnements"},support:{title:"Support",tickets:"Tickets",kb:"Base de connaissances"},settings:"Paramètres",logout:"Déconnexion"}},XC={title:"Paramètres",general:{title:"Paramètres généraux",siteName:"Nom du site",siteDescription:"Description du site",siteEmail:"Email du site",sitePhone:"Téléphone du site",siteAddress:"Adresse du site",siteUrl:"URL du site",logo:"Logo",favicon:"Favicon",timezone:"Fuseau horaire",dateFormat:"Format de date",timeFormat:"Format d'heure",language:"Langue",currency:"Devise",currencySymbol:"Symbole de devise",currencyPosition:"Position du symbole de devise",decimalSeparator:"Séparateur décimal",thousandSeparator:"Séparateur de milliers",decimalPlaces:"Nombre de décimales"},security:{title:"Paramètres de sécurité",sessionTimeout:"Délai d'expiration de session (minutes)",loginAttempts:"Nombre de tentatives de connexion avant blocage",loginBlockTime:"Durée de blocage après tentatives échouées (minutes)",passwordMinLength:"Longueur minimale du mot de passe",passwordRequireUppercase:"Exiger une majuscule dans le mot de passe",passwordRequireLowercase:"Exiger une minuscule dans le mot de passe",passwordRequireNumber:"Exiger un chiffre dans le mot de passe",passwordRequireSpecial:"Exiger un caractère spécial dans le mot de passe",passwordExpiration:"Expiration du mot de passe (jours, 0 = jamais)",twoFactorAuth:"Authentification à deux facteurs",twoFactorAuthRequired:"Exiger l'authentification à deux facteurs",apiTokenExpiration:"Expiration des jetons API (jours, 0 = jamais)"},billing:{title:"Paramètres de facturation",invoicePrefix:"Préfixe des factures",invoiceStartNumber:"Numéro de départ des factures",invoiceFooter:"Pied de page des factures",invoiceTerms:"Conditions des factures",invoiceDueDays:"Délai de paiement par défaut (jours)",invoiceAutoReminder:"Envoyer des rappels automatiques",invoiceReminderDays:"Jours avant échéance pour le rappel",taxEnabled:"Activer la taxe",taxName:"Nom de la taxe",taxRate:"Taux de taxe (%)",taxNumber:"Numéro de taxe",paymentMethods:"Méthodes de paiement",bankTransfer:"Virement bancaire",bankName:"Nom de la banque",bankAccount:"Numéro de compte",bankIban:"IBAN",bankSwift:"SWIFT/BIC"},integration:{title:"Paramètres d'intégration",mailDriver:"Service d'envoi d'emails",mailHost:"Hôte SMTP",mailPort:"Port SMTP",mailUsername:"Nom d'utilisateur SMTP",mailPassword:"Mot de passe SMTP",mailEncryption:"Chiffrement SMTP",mailFromAddress:"Adresse d'expédition",mailFromName:"Nom d'expédition",smsEnabled:"Activer les SMS",smsProvider:"Fournisseur SMS",smsApiKey:"Clé API SMS",smsFromNumber:"Numéro d'expédition SMS",pushEnabled:"Activer les notifications push",pushProvider:"Fournisseur de notifications push",pushApiKey:"Clé API notifications push",googleAnalyticsId:"ID Google Analytics",recaptchaSiteKey:"Clé de site reCAPTCHA",recaptchaSecretKey:"Clé secrète reCAPTCHA"},actions:{save:"Enregistrer les paramètres",reset:"Réinitialiser les paramètres",testEmail:"Tester l'envoi d'email",testSms:"Tester l'envoi de SMS"},messages:{saved:"Paramètres enregistrés avec succès",error:"Une erreur est survenue lors de l'enregistrement des paramètres",emailTestSent:"Email de test envoyé avec succès",emailTestError:"Une erreur est survenue lors de l'envoi de l'email de test",smsTestSent:"SMS de test envoyé avec succès",smsTestError:"Une erreur est survenue lors de l'envoi du SMS de test"},tabs:{general:"Général",notifications:"Notifications",security:"Sécurité",billing:"Facturation",integrations:"Intégrations",license:"Licence"},license:{title:"Gestion de Licence",licenseKey:"Clé de licence",licenseType:"Type de licence",licenseStatus:"Statut de la licence",licenseExpiration:"Date d'expiration",active:"Active",inactive:"Inactive",free:"Gratuit",pro:"Professionnel",updateSuccess:"Licence mise à jour avec succès",updateError:"Erreur lors de la mise à jour de la licence",verifyingLicense:"Vérification de la licence...",enterLicenseKey:"Veuillez entrer une clé de licence valide"}},JC={common:LC,login:HC,services:jC,products:VC,invoices:GC,subscriptions:WC,payments:zC,tickets:qC,sidebar:KC,settings:XC},QC={back:"Back",save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",loading:"Loading...",actions:"Actions",select:"Select...",close:"Close",search:"Search",view_all:"View all",client:"Client",email:"Email",status:"Status",date:"Date",profile:"Profile",settings:"Settings",logout:"Logout",notifications:"Notifications","notifications.mark_all_read":"Mark all as read","notifications.empty":"No notifications",language:{select:"Select language",fr:"French",en:"English"}},YC={welcome:"Welcome to TechCMS",subtitle:"Log in to access your admin panel",email:"Email",emailPlaceholder:"Your email address",password:"Password",passwordPlaceholder:"Your password",rememberMe:"Remember me",forgotPassword:"Forgot password?",signIn:"Sign in",resetPassword:"Reset password",resetInstructions:"Enter your email address to receive reset instructions",sendReset:"Send instructions",resetSent:"Reset instructions have been sent to your email address",errorFields:"Please fill in all fields",errorEmail:"Please enter a valid email address",errorGeneral:"Incorrect email or password",errorForgot:"An error occurred while sending instructions",copyright:" {year} TechCMS. All rights reserved."},ZC={menu:{dashboard:"Dashboard",clients:"Clients",catalog:{title:"Catalog",services:"Services",products:"Products"},billing:{title:"Billing",invoices:"Invoices",payments:"Payments",subscriptions:"Subscriptions"},support:{title:"Support",tickets:"Tickets",kb:"Knowledge base"},settings:"Settings",logout:"Logout"}},e8={title:"Dashboard",stats:{active_clients:"Active clients",active_services:"Active services",total_products:"Products",monthly_revenue:"Monthly revenue"},recent_clients:{title:"Recent clients"},recent_tickets:{title:"Recent tickets"}},t8={title:"Clients",add_new:"Add client",description:"Manage your client accounts and their information",filters:{search:"Search",search_placeholder:"Search clients...",status:"Status",service_type:"Service type",apply:"Apply filters"},status:{all:"All statuses",active:"Active",inactive:"Inactive",pending:"Pending"},services:{all:"All services",hosting:"Hosting",domain:"Domain",ssl:"SSL"}},n8={title:"Services",add:"Add a service",edit:"Edit service",description:"Manage your service offerings and their configurations",search:"Search for a service...",columns:{name:"Name",description:"Description",price:"Price",status:"Status",clients:"Clients"},status:{all:"All",active:"Active",inactive:"Inactive",maintenance:"Maintenance"},filters:{search:"Search",status:"Status",price_range:"Price range",all_prices:"All prices",price_low:"Low (< €10)",price_medium:"Medium (€10 - €50)",price_high:"High (> €50)",apply:"Apply filters"},fields:{name:"Name",description:"Description",price:"Price",status:"Status",features:"Features",featureName:"Feature name",included:"Included",addFeature:"Add a feature"},validation:{nameRequired:"Name is required",pricePositive:"Price must be positive"},success:{create:"Service created",createMessage:"The service {name} has been created successfully",update:"Service updated",updateMessage:"The service {name} has been updated successfully",delete:"Service deleted",deleteMessage:"The service {name} has been deleted successfully"},errors:{fetch:"Error loading",fetchMessage:"Unable to load services",create:"Error creating",update:"Error updating",saveMessage:"An error occurred while saving the service",delete:"Error deleting",deleteMessage:"An error occurred while deleting the service"},confirm:{delete:"Are you sure you want to delete the service {name}?"}},r8={title:"Invoices",description:"Manage your invoices and billing documents",actions:{add:"Add invoice"},search:{placeholder:"Search invoices..."},table:{id:"ID",client:"Client",date:"Date",dueDate:"Due date",amount:"Amount",status:"Status",actions:"Actions"},filters:{search:"Search",status:"Status",date_range:"Date range",all_time:"All time",this_month:"This month",last_month:"Last month",this_year:"This year",apply:"Apply filters"},status:{all:"All",paid:"Paid",unpaid:"Unpaid",overdue:"Overdue",cancelled:"Cancelled"}},s8={title:"Products",description:"Manage your product catalog and their features",actions:{add:"Add a product",add_feature:"Add a feature"},modal:{add_title:"Add a product",edit_title:"Edit product"},columns:{name:"Name",description:"Description",price:"Price",status:"Status"},status:{active:"Active",inactive:"Inactive"},fields:{name:"Name",description:"Description",price:"Price",status:"Status",features:"Features",feature_name:"Feature name",feature_included:"Included"},filters:{search:"Search",status:"Status",price_range:"Price range",all_prices:"All prices",price_low:"Low (< €10)",price_medium:"Medium (€10 - €50)",price_high:"High (> €50)",apply:"Apply filters",all:"All",active:"Active",inactive:"Inactive"},search:{placeholder:"Search for a product..."},empty:{message:"No products found",action:"Add a product"},validation:{name_required:"Name is required",description_required:"Description is required",price_positive:"Price must be positive"},confirm:{delete:"Are you sure you want to delete this product?"},success:{create:"Product created successfully",update:"Product updated successfully",delete:"Product deleted successfully"},errors:{fetch:"Error loading products",create:"Error creating product",update:"Error updating product",delete:"Error deleting product"}},o8={title:"Payments",description:"Track and manage all payment transactions",actions:{add:"Add payment"},search:{placeholder:"Search payments..."},table:{id:"ID",client:"Client",date:"Date",amount:"Amount",method:"Method",status:"Status",actions:"Actions"},filters:{search:"Search",status:"Status",payment_method:"Payment method",all_methods:"All methods",apply:"Apply filters"},methods:{card:"Credit card",bank_transfer:"Bank transfer",paypal:"PayPal"},status:{all:"All",completed:"Completed",pending:"Pending",failed:"Failed",refunded:"Refunded"}},i8={title:"Subscriptions",description:"Manage recurring subscriptions and billing cycles",actions:{add:"Add subscription"},search:{placeholder:"Search subscriptions..."},table:{id:"ID",client:"Client",service:"Service",startDate:"Start date",renewalDate:"Renewal date",price:"Price",billingCycle:"Billing cycle",status:"Status",actions:"Actions"},filters:{search:"Search",status:"Status",billing_cycle:"Billing cycle",all_cycles:"All cycles",apply:"Apply filters"},billingCycles:{monthly:"Monthly",quarterly:"Quarterly",semiAnnual:"Semi-annual",annual:"Annual"},status:{all:"All",active:"Active",pending:"Pending",cancelled:"Cancelled",expired:"Expired"}},a8={title:"Tickets",description:"Handle support requests and client communications",actions:{add:"Add ticket"},search:{placeholder:"Search tickets..."},table:{id:"ID",client:"Client",subject:"Subject",date:"Date",lastUpdate:"Last update",status:"Status",priority:"Priority",actions:"Actions"},filters:{search:"Search",status:"Status",priority:"Priority",apply:"Apply filters"},priority:{all:"All priorities",low:"Low",medium:"Medium",high:"High",urgent:"Urgent"},status:{all:"All",open:"Open",in_progress:"In progress",waiting:"Waiting for client",resolved:"Resolved",closed:"Closed"}},l8={messages:{saved:"Settings saved successfully",error:"An error occurred while saving settings",emailTestSent:"Test email sent successfully",emailTestError:"An error occurred while sending test email",smsTestSent:"Test SMS sent successfully",smsTestError:"An error occurred while sending test SMS"},tabs:{general:"General",notifications:"Notifications",security:"Security",billing:"Billing",integrations:"Integrations",license:"License"},license:{title:"License Management",licenseKey:"License Key",licenseType:"License Type",licenseStatus:"License Status",licenseExpiration:"Expiration Date",active:"Active",inactive:"Inactive",free:"Free",pro:"Professional",updateSuccess:"License updated successfully",updateError:"Error updating license",verifyingLicense:"Verifying license...",enterLicenseKey:"Please enter a valid license key"}},c8={common:QC,login:YC,sidebar:ZC,dashboard:e8,clients:t8,services:n8,invoices:r8,products:s8,payments:o8,subscriptions:i8,tickets:a8,settings:l8},u8=localStorage.getItem("language")||"fr",d8=So({legacy:!1,locale:u8,fallbackLocale:"en",messages:{fr:JC,en:c8}});console.log("[MAIN] Démarrage de l'application");console.log("[MAIN] Création de l'application Vue");const Ht=wo(UC);console.log("[MAIN] Initialisation de Pinia");const oo=Ro();oo.use(Io);Ht.use(oo);console.log("[MAIN] Initialisation du Router");Ht.use(yt);console.log("[MAIN] Initialisation de i18n");Ht.use(d8);console.log("[MAIN] Montage de l'application");Ht.mount("#vue-app");console.log("[MAIN] Application montée avec succès");
